function R1(p,b){for(var T=0;T<b.length;T++){const S=b[T];if(typeof S!="string"&&!Array.isArray(S)){for(const R in S)if(R!=="default"&&!(R in p)){const I=Object.getOwnPropertyDescriptor(S,R);I&&Object.defineProperty(p,R,I.get?I:{enumerable:!0,get:()=>S[R]})}}}return Object.freeze(Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}))}(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const R of document.querySelectorAll('link[rel="modulepreload"]'))S(R);new MutationObserver(R=>{for(const I of R)if(I.type==="childList")for(const E of I.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&S(E)}).observe(document,{childList:!0,subtree:!0});function T(R){const I={};return R.integrity&&(I.integrity=R.integrity),R.referrerPolicy&&(I.referrerPolicy=R.referrerPolicy),R.crossOrigin==="use-credentials"?I.credentials="include":R.crossOrigin==="anonymous"?I.credentials="omit":I.credentials="same-origin",I}function S(R){if(R.ep)return;R.ep=!0;const I=T(R);fetch(R.href,I)}})();function j_(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var zy={exports:{}},og={};var b0;function I1(){if(b0)return og;b0=1;var p=Symbol.for("react.transitional.element"),b=Symbol.for("react.fragment");function T(S,R,I){var E=null;if(I!==void 0&&(E=""+I),R.key!==void 0&&(E=""+R.key),"key"in R){I={};for(var l in R)l!=="key"&&(I[l]=R[l])}else I=R;return R=I.ref,{$$typeof:p,type:S,key:E,ref:R!==void 0?R:null,props:I}}return og.Fragment=b,og.jsx=T,og.jsxs=T,og}var w0;function L1(){return w0||(w0=1,zy.exports=I1()),zy.exports}var Te=L1(),Dy={exports:{}},sg={},Py={exports:{}},Ry={};var S0;function O1(){return S0||(S0=1,(function(p){function b(Pe,Xe){var ft=Pe.length;Pe.push(Xe);e:for(;0<ft;){var yt=ft-1>>>1,It=Pe[yt];if(0<R(It,Xe))Pe[yt]=Xe,Pe[ft]=It,ft=yt;else break e}}function T(Pe){return Pe.length===0?null:Pe[0]}function S(Pe){if(Pe.length===0)return null;var Xe=Pe[0],ft=Pe.pop();if(ft!==Xe){Pe[0]=ft;e:for(var yt=0,It=Pe.length,Ee=It>>>1;yt<Ee;){var rt=2*(yt+1)-1,Tt=Pe[rt],At=rt+1,Ut=Pe[At];if(0>R(Tt,ft))At<It&&0>R(Ut,Tt)?(Pe[yt]=Ut,Pe[At]=ft,yt=At):(Pe[yt]=Tt,Pe[rt]=ft,yt=rt);else if(At<It&&0>R(Ut,ft))Pe[yt]=Ut,Pe[At]=ft,yt=At;else break e}}return Xe}function R(Pe,Xe){var ft=Pe.sortIndex-Xe.sortIndex;return ft!==0?ft:Pe.id-Xe.id}if(p.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var I=performance;p.unstable_now=function(){return I.now()}}else{var E=Date,l=E.now();p.unstable_now=function(){return E.now()-l}}var N=[],X=[],Q=1,ee=null,le=3,ce=!1,Ce=!1,xe=!1,ie=!1,Ue=typeof setTimeout=="function"?setTimeout:null,$e=typeof clearTimeout=="function"?clearTimeout:null,Le=typeof setImmediate<"u"?setImmediate:null;function Ye(Pe){for(var Xe=T(X);Xe!==null;){if(Xe.callback===null)S(X);else if(Xe.startTime<=Pe)S(X),Xe.sortIndex=Xe.expirationTime,b(N,Xe);else break;Xe=T(X)}}function it(Pe){if(xe=!1,Ye(Pe),!Ce)if(T(N)!==null)Ce=!0,pt||(pt=!0,Ot());else{var Xe=T(X);Xe!==null&&Ht(it,Xe.startTime-Pe)}}var pt=!1,Qe=-1,_t=5,Pt=-1;function Rt(){return ie?!0:!(p.unstable_now()-Pt<_t)}function Zt(){if(ie=!1,pt){var Pe=p.unstable_now();Pt=Pe;var Xe=!0;try{e:{Ce=!1,xe&&(xe=!1,$e(Qe),Qe=-1),ce=!0;var ft=le;try{t:{for(Ye(Pe),ee=T(N);ee!==null&&!(ee.expirationTime>Pe&&Rt());){var yt=ee.callback;if(typeof yt=="function"){ee.callback=null,le=ee.priorityLevel;var It=yt(ee.expirationTime<=Pe);if(Pe=p.unstable_now(),typeof It=="function"){ee.callback=It,Ye(Pe),Xe=!0;break t}ee===T(N)&&S(N),Ye(Pe)}else S(N);ee=T(N)}if(ee!==null)Xe=!0;else{var Ee=T(X);Ee!==null&&Ht(it,Ee.startTime-Pe),Xe=!1}}break e}finally{ee=null,le=ft,ce=!1}Xe=void 0}}finally{Xe?Ot():pt=!1}}}var Ot;if(typeof Le=="function")Ot=function(){Le(Zt)};else if(typeof MessageChannel<"u"){var Vt=new MessageChannel,Ft=Vt.port2;Vt.port1.onmessage=Zt,Ot=function(){Ft.postMessage(null)}}else Ot=function(){Ue(Zt,0)};function Ht(Pe,Xe){Qe=Ue(function(){Pe(p.unstable_now())},Xe)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(Pe){Pe.callback=null},p.unstable_forceFrameRate=function(Pe){0>Pe||125<Pe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_t=0<Pe?Math.floor(1e3/Pe):5},p.unstable_getCurrentPriorityLevel=function(){return le},p.unstable_next=function(Pe){switch(le){case 1:case 2:case 3:var Xe=3;break;default:Xe=le}var ft=le;le=Xe;try{return Pe()}finally{le=ft}},p.unstable_requestPaint=function(){ie=!0},p.unstable_runWithPriority=function(Pe,Xe){switch(Pe){case 1:case 2:case 3:case 4:case 5:break;default:Pe=3}var ft=le;le=Pe;try{return Xe()}finally{le=ft}},p.unstable_scheduleCallback=function(Pe,Xe,ft){var yt=p.unstable_now();switch(typeof ft=="object"&&ft!==null?(ft=ft.delay,ft=typeof ft=="number"&&0<ft?yt+ft:yt):ft=yt,Pe){case 1:var It=-1;break;case 2:It=250;break;case 5:It=1073741823;break;case 4:It=1e4;break;default:It=5e3}return It=ft+It,Pe={id:Q++,callback:Xe,priorityLevel:Pe,startTime:ft,expirationTime:It,sortIndex:-1},ft>yt?(Pe.sortIndex=ft,b(X,Pe),T(N)===null&&Pe===T(X)&&(xe?($e(Qe),Qe=-1):xe=!0,Ht(it,ft-yt))):(Pe.sortIndex=It,b(N,Pe),Ce||ce||(Ce=!0,pt||(pt=!0,Ot()))),Pe},p.unstable_shouldYield=Rt,p.unstable_wrapCallback=function(Pe){var Xe=le;return function(){var ft=le;le=Xe;try{return Pe.apply(this,arguments)}finally{le=ft}}}})(Ry)),Ry}var T0;function k1(){return T0||(T0=1,Py.exports=O1()),Py.exports}var Iy={exports:{}},gn={};var E0;function B1(){if(E0)return gn;E0=1;var p=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),E=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),X=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),ee=Symbol.for("react.activity"),le=Symbol.iterator;function ce(Ee){return Ee===null||typeof Ee!="object"?null:(Ee=le&&Ee[le]||Ee["@@iterator"],typeof Ee=="function"?Ee:null)}var Ce={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xe=Object.assign,ie={};function Ue(Ee,rt,Tt){this.props=Ee,this.context=rt,this.refs=ie,this.updater=Tt||Ce}Ue.prototype.isReactComponent={},Ue.prototype.setState=function(Ee,rt){if(typeof Ee!="object"&&typeof Ee!="function"&&Ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ee,rt,"setState")},Ue.prototype.forceUpdate=function(Ee){this.updater.enqueueForceUpdate(this,Ee,"forceUpdate")};function $e(){}$e.prototype=Ue.prototype;function Le(Ee,rt,Tt){this.props=Ee,this.context=rt,this.refs=ie,this.updater=Tt||Ce}var Ye=Le.prototype=new $e;Ye.constructor=Le,xe(Ye,Ue.prototype),Ye.isPureReactComponent=!0;var it=Array.isArray;function pt(){}var Qe={H:null,A:null,T:null,S:null},_t=Object.prototype.hasOwnProperty;function Pt(Ee,rt,Tt){var At=Tt.ref;return{$$typeof:p,type:Ee,key:rt,ref:At!==void 0?At:null,props:Tt}}function Rt(Ee,rt){return Pt(Ee.type,rt,Ee.props)}function Zt(Ee){return typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===p}function Ot(Ee){var rt={"=":"=0",":":"=2"};return"$"+Ee.replace(/[=:]/g,function(Tt){return rt[Tt]})}var Vt=/\/+/g;function Ft(Ee,rt){return typeof Ee=="object"&&Ee!==null&&Ee.key!=null?Ot(""+Ee.key):rt.toString(36)}function Ht(Ee){switch(Ee.status){case"fulfilled":return Ee.value;case"rejected":throw Ee.reason;default:switch(typeof Ee.status=="string"?Ee.then(pt,pt):(Ee.status="pending",Ee.then(function(rt){Ee.status==="pending"&&(Ee.status="fulfilled",Ee.value=rt)},function(rt){Ee.status==="pending"&&(Ee.status="rejected",Ee.reason=rt)})),Ee.status){case"fulfilled":return Ee.value;case"rejected":throw Ee.reason}}throw Ee}function Pe(Ee,rt,Tt,At,Ut){var Nt=typeof Ee;(Nt==="undefined"||Nt==="boolean")&&(Ee=null);var tn=!1;if(Ee===null)tn=!0;else switch(Nt){case"bigint":case"string":case"number":tn=!0;break;case"object":switch(Ee.$$typeof){case p:case b:tn=!0;break;case Q:return tn=Ee._init,Pe(tn(Ee._payload),rt,Tt,At,Ut)}}if(tn)return Ut=Ut(Ee),tn=At===""?"."+Ft(Ee,0):At,it(Ut)?(Tt="",tn!=null&&(Tt=tn.replace(Vt,"$&/")+"/"),Pe(Ut,rt,Tt,"",function($i){return $i})):Ut!=null&&(Zt(Ut)&&(Ut=Rt(Ut,Tt+(Ut.key==null||Ee&&Ee.key===Ut.key?"":(""+Ut.key).replace(Vt,"$&/")+"/")+tn)),rt.push(Ut)),1;tn=0;var fn=At===""?".":At+":";if(it(Ee))for(var _n=0;_n<Ee.length;_n++)At=Ee[_n],Nt=fn+Ft(At,_n),tn+=Pe(At,rt,Tt,Nt,Ut);else if(_n=ce(Ee),typeof _n=="function")for(Ee=_n.call(Ee),_n=0;!(At=Ee.next()).done;)At=At.value,Nt=fn+Ft(At,_n++),tn+=Pe(At,rt,Tt,Nt,Ut);else if(Nt==="object"){if(typeof Ee.then=="function")return Pe(Ht(Ee),rt,Tt,At,Ut);throw rt=String(Ee),Error("Objects are not valid as a React child (found: "+(rt==="[object Object]"?"object with keys {"+Object.keys(Ee).join(", ")+"}":rt)+"). If you meant to render a collection of children, use an array instead.")}return tn}function Xe(Ee,rt,Tt){if(Ee==null)return Ee;var At=[],Ut=0;return Pe(Ee,At,"","",function(Nt){return rt.call(Tt,Nt,Ut++)}),At}function ft(Ee){if(Ee._status===-1){var rt=Ee._result;rt=rt(),rt.then(function(Tt){(Ee._status===0||Ee._status===-1)&&(Ee._status=1,Ee._result=Tt)},function(Tt){(Ee._status===0||Ee._status===-1)&&(Ee._status=2,Ee._result=Tt)}),Ee._status===-1&&(Ee._status=0,Ee._result=rt)}if(Ee._status===1)return Ee._result.default;throw Ee._result}var yt=typeof reportError=="function"?reportError:function(Ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var rt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ee=="object"&&Ee!==null&&typeof Ee.message=="string"?String(Ee.message):String(Ee),error:Ee});if(!window.dispatchEvent(rt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ee);return}console.error(Ee)},It={map:Xe,forEach:function(Ee,rt,Tt){Xe(Ee,function(){rt.apply(this,arguments)},Tt)},count:function(Ee){var rt=0;return Xe(Ee,function(){rt++}),rt},toArray:function(Ee){return Xe(Ee,function(rt){return rt})||[]},only:function(Ee){if(!Zt(Ee))throw Error("React.Children.only expected to receive a single React element child.");return Ee}};return gn.Activity=ee,gn.Children=It,gn.Component=Ue,gn.Fragment=T,gn.Profiler=R,gn.PureComponent=Le,gn.StrictMode=S,gn.Suspense=N,gn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Qe,gn.__COMPILER_RUNTIME={__proto__:null,c:function(Ee){return Qe.H.useMemoCache(Ee)}},gn.cache=function(Ee){return function(){return Ee.apply(null,arguments)}},gn.cacheSignal=function(){return null},gn.cloneElement=function(Ee,rt,Tt){if(Ee==null)throw Error("The argument must be a React element, but you passed "+Ee+".");var At=xe({},Ee.props),Ut=Ee.key;if(rt!=null)for(Nt in rt.key!==void 0&&(Ut=""+rt.key),rt)!_t.call(rt,Nt)||Nt==="key"||Nt==="__self"||Nt==="__source"||Nt==="ref"&&rt.ref===void 0||(At[Nt]=rt[Nt]);var Nt=arguments.length-2;if(Nt===1)At.children=Tt;else if(1<Nt){for(var tn=Array(Nt),fn=0;fn<Nt;fn++)tn[fn]=arguments[fn+2];At.children=tn}return Pt(Ee.type,Ut,At)},gn.createContext=function(Ee){return Ee={$$typeof:E,_currentValue:Ee,_currentValue2:Ee,_threadCount:0,Provider:null,Consumer:null},Ee.Provider=Ee,Ee.Consumer={$$typeof:I,_context:Ee},Ee},gn.createElement=function(Ee,rt,Tt){var At,Ut={},Nt=null;if(rt!=null)for(At in rt.key!==void 0&&(Nt=""+rt.key),rt)_t.call(rt,At)&&At!=="key"&&At!=="__self"&&At!=="__source"&&(Ut[At]=rt[At]);var tn=arguments.length-2;if(tn===1)Ut.children=Tt;else if(1<tn){for(var fn=Array(tn),_n=0;_n<tn;_n++)fn[_n]=arguments[_n+2];Ut.children=fn}if(Ee&&Ee.defaultProps)for(At in tn=Ee.defaultProps,tn)Ut[At]===void 0&&(Ut[At]=tn[At]);return Pt(Ee,Nt,Ut)},gn.createRef=function(){return{current:null}},gn.forwardRef=function(Ee){return{$$typeof:l,render:Ee}},gn.isValidElement=Zt,gn.lazy=function(Ee){return{$$typeof:Q,_payload:{_status:-1,_result:Ee},_init:ft}},gn.memo=function(Ee,rt){return{$$typeof:X,type:Ee,compare:rt===void 0?null:rt}},gn.startTransition=function(Ee){var rt=Qe.T,Tt={};Qe.T=Tt;try{var At=Ee(),Ut=Qe.S;Ut!==null&&Ut(Tt,At),typeof At=="object"&&At!==null&&typeof At.then=="function"&&At.then(pt,yt)}catch(Nt){yt(Nt)}finally{rt!==null&&Tt.types!==null&&(rt.types=Tt.types),Qe.T=rt}},gn.unstable_useCacheRefresh=function(){return Qe.H.useCacheRefresh()},gn.use=function(Ee){return Qe.H.use(Ee)},gn.useActionState=function(Ee,rt,Tt){return Qe.H.useActionState(Ee,rt,Tt)},gn.useCallback=function(Ee,rt){return Qe.H.useCallback(Ee,rt)},gn.useContext=function(Ee){return Qe.H.useContext(Ee)},gn.useDebugValue=function(){},gn.useDeferredValue=function(Ee,rt){return Qe.H.useDeferredValue(Ee,rt)},gn.useEffect=function(Ee,rt){return Qe.H.useEffect(Ee,rt)},gn.useEffectEvent=function(Ee){return Qe.H.useEffectEvent(Ee)},gn.useId=function(){return Qe.H.useId()},gn.useImperativeHandle=function(Ee,rt,Tt){return Qe.H.useImperativeHandle(Ee,rt,Tt)},gn.useInsertionEffect=function(Ee,rt){return Qe.H.useInsertionEffect(Ee,rt)},gn.useLayoutEffect=function(Ee,rt){return Qe.H.useLayoutEffect(Ee,rt)},gn.useMemo=function(Ee,rt){return Qe.H.useMemo(Ee,rt)},gn.useOptimistic=function(Ee,rt){return Qe.H.useOptimistic(Ee,rt)},gn.useReducer=function(Ee,rt,Tt){return Qe.H.useReducer(Ee,rt,Tt)},gn.useRef=function(Ee){return Qe.H.useRef(Ee)},gn.useState=function(Ee){return Qe.H.useState(Ee)},gn.useSyncExternalStore=function(Ee,rt,Tt){return Qe.H.useSyncExternalStore(Ee,rt,Tt)},gn.useTransition=function(){return Qe.H.useTransition()},gn.version="19.2.4",gn}var C0;function dv(){return C0||(C0=1,Iy.exports=B1()),Iy.exports}var Ly={exports:{}},ja={};var M0;function F1(){if(M0)return ja;M0=1;var p=dv();function b(N){var X="https://react.dev/errors/"+N;if(1<arguments.length){X+="?args[]="+encodeURIComponent(arguments[1]);for(var Q=2;Q<arguments.length;Q++)X+="&args[]="+encodeURIComponent(arguments[Q])}return"Minified React error #"+N+"; visit "+X+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function T(){}var S={d:{f:T,r:function(){throw Error(b(522))},D:T,C:T,L:T,m:T,X:T,S:T,M:T},p:0,findDOMNode:null},R=Symbol.for("react.portal");function I(N,X,Q){var ee=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:ee==null?null:""+ee,children:N,containerInfo:X,implementation:Q}}var E=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(N,X){if(N==="font")return"";if(typeof X=="string")return X==="use-credentials"?X:""}return ja.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,ja.createPortal=function(N,X){var Q=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!X||X.nodeType!==1&&X.nodeType!==9&&X.nodeType!==11)throw Error(b(299));return I(N,X,null,Q)},ja.flushSync=function(N){var X=E.T,Q=S.p;try{if(E.T=null,S.p=2,N)return N()}finally{E.T=X,S.p=Q,S.d.f()}},ja.preconnect=function(N,X){typeof N=="string"&&(X?(X=X.crossOrigin,X=typeof X=="string"?X==="use-credentials"?X:"":void 0):X=null,S.d.C(N,X))},ja.prefetchDNS=function(N){typeof N=="string"&&S.d.D(N)},ja.preinit=function(N,X){if(typeof N=="string"&&X&&typeof X.as=="string"){var Q=X.as,ee=l(Q,X.crossOrigin),le=typeof X.integrity=="string"?X.integrity:void 0,ce=typeof X.fetchPriority=="string"?X.fetchPriority:void 0;Q==="style"?S.d.S(N,typeof X.precedence=="string"?X.precedence:void 0,{crossOrigin:ee,integrity:le,fetchPriority:ce}):Q==="script"&&S.d.X(N,{crossOrigin:ee,integrity:le,fetchPriority:ce,nonce:typeof X.nonce=="string"?X.nonce:void 0})}},ja.preinitModule=function(N,X){if(typeof N=="string")if(typeof X=="object"&&X!==null){if(X.as==null||X.as==="script"){var Q=l(X.as,X.crossOrigin);S.d.M(N,{crossOrigin:Q,integrity:typeof X.integrity=="string"?X.integrity:void 0,nonce:typeof X.nonce=="string"?X.nonce:void 0})}}else X==null&&S.d.M(N)},ja.preload=function(N,X){if(typeof N=="string"&&typeof X=="object"&&X!==null&&typeof X.as=="string"){var Q=X.as,ee=l(Q,X.crossOrigin);S.d.L(N,Q,{crossOrigin:ee,integrity:typeof X.integrity=="string"?X.integrity:void 0,nonce:typeof X.nonce=="string"?X.nonce:void 0,type:typeof X.type=="string"?X.type:void 0,fetchPriority:typeof X.fetchPriority=="string"?X.fetchPriority:void 0,referrerPolicy:typeof X.referrerPolicy=="string"?X.referrerPolicy:void 0,imageSrcSet:typeof X.imageSrcSet=="string"?X.imageSrcSet:void 0,imageSizes:typeof X.imageSizes=="string"?X.imageSizes:void 0,media:typeof X.media=="string"?X.media:void 0})}},ja.preloadModule=function(N,X){if(typeof N=="string")if(X){var Q=l(X.as,X.crossOrigin);S.d.m(N,{as:typeof X.as=="string"&&X.as!=="script"?X.as:void 0,crossOrigin:Q,integrity:typeof X.integrity=="string"?X.integrity:void 0})}else S.d.m(N)},ja.requestFormReset=function(N){S.d.r(N)},ja.unstable_batchedUpdates=function(N,X){return N(X)},ja.useFormState=function(N,X,Q){return E.H.useFormState(N,X,Q)},ja.useFormStatus=function(){return E.H.useHostTransitionStatus()},ja.version="19.2.4",ja}var A0;function wx(){if(A0)return Ly.exports;A0=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(b){console.error(b)}}return p(),Ly.exports=F1(),Ly.exports}var z0;function N1(){if(z0)return sg;z0=1;var p=k1(),b=dv(),T=wx();function S(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function R(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function I(r){var o=r,h=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(h=o.return),r=o.return;while(r)}return o.tag===3?h:null}function E(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function l(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function N(r){if(I(r)!==r)throw Error(S(188))}function X(r){var o=r.alternate;if(!o){if(o=I(r),o===null)throw Error(S(188));return o!==r?null:r}for(var h=r,_=o;;){var M=h.return;if(M===null)break;var D=M.alternate;if(D===null){if(_=M.return,_!==null){h=_;continue}break}if(M.child===D.child){for(D=M.child;D;){if(D===h)return N(M),r;if(D===_)return N(M),o;D=D.sibling}throw Error(S(188))}if(h.return!==_.return)h=M,_=D;else{for(var U=!1,ne=M.child;ne;){if(ne===h){U=!0,h=M,_=D;break}if(ne===_){U=!0,_=M,h=D;break}ne=ne.sibling}if(!U){for(ne=D.child;ne;){if(ne===h){U=!0,h=D,_=M;break}if(ne===_){U=!0,_=D,h=M;break}ne=ne.sibling}if(!U)throw Error(S(189))}}if(h.alternate!==_)throw Error(S(190))}if(h.tag!==3)throw Error(S(188));return h.stateNode.current===h?r:o}function Q(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=Q(r),o!==null)return o;r=r.sibling}return null}var ee=Object.assign,le=Symbol.for("react.element"),ce=Symbol.for("react.transitional.element"),Ce=Symbol.for("react.portal"),xe=Symbol.for("react.fragment"),ie=Symbol.for("react.strict_mode"),Ue=Symbol.for("react.profiler"),$e=Symbol.for("react.consumer"),Le=Symbol.for("react.context"),Ye=Symbol.for("react.forward_ref"),it=Symbol.for("react.suspense"),pt=Symbol.for("react.suspense_list"),Qe=Symbol.for("react.memo"),_t=Symbol.for("react.lazy"),Pt=Symbol.for("react.activity"),Rt=Symbol.for("react.memo_cache_sentinel"),Zt=Symbol.iterator;function Ot(r){return r===null||typeof r!="object"?null:(r=Zt&&r[Zt]||r["@@iterator"],typeof r=="function"?r:null)}var Vt=Symbol.for("react.client.reference");function Ft(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Vt?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case xe:return"Fragment";case Ue:return"Profiler";case ie:return"StrictMode";case it:return"Suspense";case pt:return"SuspenseList";case Pt:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case Ce:return"Portal";case Le:return r.displayName||"Context";case $e:return(r._context.displayName||"Context")+".Consumer";case Ye:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Qe:return o=r.displayName||null,o!==null?o:Ft(r.type)||"Memo";case _t:o=r._payload,r=r._init;try{return Ft(r(o))}catch{}}return null}var Ht=Array.isArray,Pe=b.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Xe=T.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ft={pending:!1,data:null,method:null,action:null},yt=[],It=-1;function Ee(r){return{current:r}}function rt(r){0>It||(r.current=yt[It],yt[It]=null,It--)}function Tt(r,o){It++,yt[It]=r.current,r.current=o}var At=Ee(null),Ut=Ee(null),Nt=Ee(null),tn=Ee(null);function fn(r,o){switch(Tt(Nt,o),Tt(Ut,r),Tt(At,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?bc(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=bc(o),r=km(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}rt(At),Tt(At,r)}function _n(){rt(At),rt(Ut),rt(Nt)}function $i(r){r.memoizedState!==null&&Tt(tn,r);var o=At.current,h=km(o,r.type);o!==h&&(Tt(Ut,r),Tt(At,h))}function Fn(r){Ut.current===r&&(rt(At),rt(Ut)),tn.current===r&&(rt(tn),kh._currentValue=ft)}var vi,ya;function Pn(r){if(vi===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);vi=o&&o[1]||"",ya=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+vi+r+ya}var Zi=!1;function Nn(r,o){if(!r||Zi)return"";Zi=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(o){var dt=function(){throw Error()};if(Object.defineProperty(dt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(dt,[])}catch(tt){var We=tt}Reflect.construct(r,[],dt)}else{try{dt.call()}catch(tt){We=tt}r.call(dt.prototype)}}else{try{throw Error()}catch(tt){We=tt}(dt=r())&&typeof dt.catch=="function"&&dt.catch(function(){})}}catch(tt){if(tt&&We&&typeof tt.stack=="string")return[tt.stack,We.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=_.DetermineComponentFrameRoot(),U=D[0],ne=D[1];if(U&&ne){var Se=U.split(`
`),Ze=ne.split(`
`);for(M=_=0;_<Se.length&&!Se[_].includes("DetermineComponentFrameRoot");)_++;for(;M<Ze.length&&!Ze[M].includes("DetermineComponentFrameRoot");)M++;if(_===Se.length||M===Ze.length)for(_=Se.length-1,M=Ze.length-1;1<=_&&0<=M&&Se[_]!==Ze[M];)M--;for(;1<=_&&0<=M;_--,M--)if(Se[_]!==Ze[M]){if(_!==1||M!==1)do if(_--,M--,0>M||Se[_]!==Ze[M]){var at=`
`+Se[_].replace(" at new "," at ");return r.displayName&&at.includes("<anonymous>")&&(at=at.replace("<anonymous>",r.displayName)),at}while(1<=_&&0<=M);break}}}finally{Zi=!1,Error.prepareStackTrace=h}return(h=r?r.displayName||r.name:"")?Pn(h):""}function Zn(r,o){switch(r.tag){case 26:case 27:case 5:return Pn(r.type);case 16:return Pn("Lazy");case 13:return r.child!==o&&o!==null?Pn("Suspense Fallback"):Pn("Suspense");case 19:return Pn("SuspenseList");case 0:case 15:return Nn(r.type,!1);case 11:return Nn(r.type.render,!1);case 1:return Nn(r.type,!0);case 31:return Pn("Activity");default:return""}}function Ar(r){try{var o="",h=null;do o+=Zn(r,h),h=r,r=r.return;while(r);return o}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}var ea=Object.prototype.hasOwnProperty,va=p.unstable_scheduleCallback,zr=p.unstable_cancelCallback,Ga=p.unstable_shouldYield,jo=p.unstable_requestPaint,Hi=p.unstable_now,Dr=p.unstable_getCurrentPriorityLevel,xa=p.unstable_ImmediatePriority,xi=p.unstable_UserBlockingPriority,qa=p.unstable_NormalPriority,fs=p.unstable_LowPriority,De=p.unstable_IdlePriority,H=p.log,Y=p.unstable_setDisableYieldValue,K=null,me=null;function be(r){if(typeof H=="function"&&Y(r),me&&typeof me.setStrictMode=="function")try{me.setStrictMode(K,r)}catch{}}var Ie=Math.clz32?Math.clz32:ke,Be=Math.log,Re=Math.LN2;function ke(r){return r>>>=0,r===0?32:31-(Be(r)/Re|0)|0}var lt=256,Ke=262144,ht=4194304;function Me(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Wt(r,o,h){var _=r.pendingLanes;if(_===0)return 0;var M=0,D=r.suspendedLanes,U=r.pingedLanes;r=r.warmLanes;var ne=_&134217727;return ne!==0?(_=ne&~D,_!==0?M=Me(_):(U&=ne,U!==0?M=Me(U):h||(h=ne&~r,h!==0&&(M=Me(h))))):(ne=_&~D,ne!==0?M=Me(ne):U!==0?M=Me(U):h||(h=_&~r,h!==0&&(M=Me(h)))),M===0?0:o!==0&&o!==M&&(o&D)===0&&(D=M&-M,h=o&-o,D>=h||D===32&&(h&4194048)!==0)?o:M}function Rn(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function kt(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jt(){var r=ht;return ht<<=1,(ht&62914560)===0&&(ht=4194304),r}function an(r){for(var o=[],h=0;31>h;h++)o.push(r);return o}function ei(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function ti(r,o,h,_,M,D){var U=r.pendingLanes;r.pendingLanes=h,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=h,r.entangledLanes&=h,r.errorRecoveryDisabledLanes&=h,r.shellSuspendCounter=0;var ne=r.entanglements,Se=r.expirationTimes,Ze=r.hiddenUpdates;for(h=U&~h;0<h;){var at=31-Ie(h),dt=1<<at;ne[at]=0,Se[at]=-1;var We=Ze[at];if(We!==null)for(Ze[at]=null,at=0;at<We.length;at++){var tt=We[at];tt!==null&&(tt.lane&=-536870913)}h&=~dt}_!==0&&Xi(r,_,0),D!==0&&M===0&&r.tag!==0&&(r.suspendedLanes|=D&~(U&~o))}function Xi(r,o,h){r.pendingLanes|=o,r.suspendedLanes&=~o;var _=31-Ie(o);r.entangledLanes|=o,r.entanglements[_]=r.entanglements[_]|1073741824|h&261930}function Yi(r,o){var h=r.entangledLanes|=o;for(r=r.entanglements;h;){var _=31-Ie(h),M=1<<_;M&o|r[_]&o&&(r[_]|=o),h&=~M}}function pi(r,o){var h=o&-o;return h=(h&42)!==0?1:Fi(h),(h&(r.suspendedLanes|o))!==0?0:h}function Fi(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ot(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Pi(){var r=Xe.p;return r!==0?r:(r=window.event,r===void 0?32:Lu(r.type))}function Pr(r,o){var h=Xe.p;try{return Xe.p=r,o()}finally{Xe.p=h}}var jr=Math.random().toString(36).slice(2),vn="__reactFiber$"+jr,gt="__reactProps$"+jr,Qt="__reactContainer$"+jr,cn="__reactEvents$"+jr,ta="__reactListeners$"+jr,Vu="__reactHandles$"+jr,uo="__reactResources$"+jr,nn="__reactMarker$"+jr;function Hs(r){delete r[vn],delete r[gt],delete r[cn],delete r[ta],delete r[Vu]}function ho(r){var o=r[vn];if(o)return o;for(var h=r.parentNode;h;){if(o=h[Qt]||h[vn]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(r=Nd(r);r!==null;){if(h=r[vn])return h;r=Nd(r)}return o}r=h,h=r.parentNode}return null}function Vo(r){if(r=r[vn]||r[Qt]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function fo(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(S(33))}function po(r){var o=r[uo];return o||(o=r[uo]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function bi(r){r[nn]=!0}var Gl=new Set,br={};function bn(r,o){Uo(r,o),Uo(r+"Capture",o)}function Uo(r,o){for(br[r]=o,r=0;r<o.length;r++)Gl.add(o[r])}var ql=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$l={},ps={};function $a(r){return ea.call(ps,r)?!0:ea.call($l,r)?!1:ql.test(r)?ps[r]=!0:($l[r]=!0,!1)}function Nc(r,o,h){if($a(o))if(h===null)r.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var _=o.toLowerCase().slice(0,5);if(_!=="data-"&&_!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+h)}}function mo(r,o,h){if(h===null)r.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+h)}}function ba(r,o,h,_){if(_===null)r.removeAttribute(h);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(h);return}r.setAttributeNS(o,h,""+_)}}function Mn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Hh(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function pf(r,o,h){var _=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var M=_.get,D=_.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return M.call(this)},set:function(U){h=""+U,D.call(this,U)}}),Object.defineProperty(r,o,{enumerable:_.enumerable}),{getValue:function(){return h},setValue:function(U){h=""+U},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Xs(r){if(!r._valueTracker){var o=Hh(r)?"checked":"value";r._valueTracker=pf(r,o,""+r[o])}}function Xh(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var h=o.getValue(),_="";return r&&(_=Hh(r)?r.checked?"true":"false":r.value),r=_,r!==h?(o.setValue(r),!0):!1}function jc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var mf=/[\n"\\]/g;function Rr(r){return r.replace(mf,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Vc(r,o,h,_,M,D,U,ne){r.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?r.type=U:r.removeAttribute("type"),o!=null?U==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+Mn(o)):r.value!==""+Mn(o)&&(r.value=""+Mn(o)):U!=="submit"&&U!=="reset"||r.removeAttribute("value"),o!=null?Uc(r,U,Mn(o)):h!=null?Uc(r,U,Mn(h)):_!=null&&r.removeAttribute("value"),M==null&&D!=null&&(r.defaultChecked=!!D),M!=null&&(r.checked=M&&typeof M!="function"&&typeof M!="symbol"),ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"?r.name=""+Mn(ne):r.removeAttribute("name")}function Uu(r,o,h,_,M,D,U,ne){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(r.type=D),o!=null||h!=null){if(!(D!=="submit"&&D!=="reset"||o!=null)){Xs(r);return}h=h!=null?""+Mn(h):"",o=o!=null?""+Mn(o):h,ne||o===r.value||(r.value=o),r.defaultValue=o}_=_??M,_=typeof _!="function"&&typeof _!="symbol"&&!!_,r.checked=ne?r.checked:!!_,r.defaultChecked=!!_,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(r.name=U),Xs(r)}function Uc(r,o,h){o==="number"&&jc(r.ownerDocument)===r||r.defaultValue===""+h||(r.defaultValue=""+h)}function ms(r,o,h,_){if(r=r.options,o){o={};for(var M=0;M<h.length;M++)o["$"+h[M]]=!0;for(h=0;h<r.length;h++)M=o.hasOwnProperty("$"+r[h].value),r[h].selected!==M&&(r[h].selected=M),M&&_&&(r[h].defaultSelected=!0)}else{for(h=""+Mn(h),o=null,M=0;M<r.length;M++){if(r[M].value===h){r[M].selected=!0,_&&(r[M].defaultSelected=!0);return}o!==null||r[M].disabled||(o=r[M])}o!==null&&(o.selected=!0)}}function gf(r,o,h){if(o!=null&&(o=""+Mn(o),o!==r.value&&(r.value=o),h==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=h!=null?""+Mn(h):""}function Zl(r,o,h,_){if(o==null){if(_!=null){if(h!=null)throw Error(S(92));if(Ht(_)){if(1<_.length)throw Error(S(93));_=_[0]}h=_}h==null&&(h=""),o=h}h=Mn(o),r.defaultValue=h,_=r.textContent,_===h&&_!==""&&_!==null&&(r.value=_),Xs(r)}function Go(r,o){if(o){var h=r.firstChild;if(h&&h===r.lastChild&&h.nodeType===3){h.nodeValue=o;return}}r.textContent=o}var _f=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ys(r,o,h){var _=o.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?_?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":_?r.setProperty(o,h):typeof h!="number"||h===0||_f.has(o)?o==="float"?r.cssFloat=h:r[o]=(""+h).trim():r[o]=h+"px"}function Gu(r,o,h){if(o!=null&&typeof o!="object")throw Error(S(62));if(r=r.style,h!=null){for(var _ in h)!h.hasOwnProperty(_)||o!=null&&o.hasOwnProperty(_)||(_.indexOf("--")===0?r.setProperty(_,""):_==="float"?r.cssFloat="":r[_]="");for(var M in o)_=o[M],o.hasOwnProperty(M)&&h[M]!==_&&Ys(r,M,_)}else for(var D in o)o.hasOwnProperty(D)&&Ys(r,D,o[D])}function Ws(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gs=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function sn(r){return Hl.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Za(){}var Yh=null;function Gc(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var er=null,Ni=null;function si(r){var o=Vo(r);if(o&&(r=o.stateNode)){var h=r[gt]||null;e:switch(r=o.stateNode,o.type){case"input":if(Vc(r,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),o=h.name,h.type==="radio"&&o!=null){for(h=r;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Rr(""+o)+'"][type="radio"]'),o=0;o<h.length;o++){var _=h[o];if(_!==r&&_.form===r.form){var M=_[gt]||null;if(!M)throw Error(S(90));Vc(_,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(o=0;o<h.length;o++)_=h[o],_.form===r.form&&Xh(_)}break e;case"textarea":gf(r,h.value,h.defaultValue);break e;case"select":o=h.value,o!=null&&ms(r,!!h.multiple,o,!1)}}}var Yt=!1;function Hn(r,o,h){if(Yt)return r(o,h);Yt=!0;try{var _=r(o);return _}finally{if(Yt=!1,(er!==null||Ni!==null)&&(Pd(),er&&(o=er,r=Ni,Ni=er=null,si(o),r)))for(o=0;o<r.length;o++)si(r[o])}}function wa(r,o){var h=r.stateNode;if(h===null)return null;var _=h[gt]||null;if(_===null)return null;h=_[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(r=r.type,_=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!_;break e;default:r=!1}if(r)return null;if(h&&typeof h!="function")throw Error(S(231,o,typeof h));return h}var wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ir=!1;if(wi)try{var tr={};Object.defineProperty(tr,"passive",{get:function(){Ir=!0}}),window.addEventListener("test",tr,tr),window.removeEventListener("test",tr,tr)}catch{Ir=!1}var na=null,go=null,li=null;function _s(){if(li)return li;var r,o=go,h=o.length,_,M="value"in na?na.value:na.textContent,D=M.length;for(r=0;r<h&&o[r]===M[r];r++);var U=h-r;for(_=1;_<=U&&o[h-_]===M[D-_];_++);return li=M.slice(r,1<_?1-_:void 0)}function ia(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Ks(){return!0}function Lr(){return!1}function Wi(r){function o(h,_,M,D,U){this._reactName=h,this._targetInst=M,this.type=_,this.nativeEvent=D,this.target=U,this.currentTarget=null;for(var ne in r)r.hasOwnProperty(ne)&&(h=r[ne],this[ne]=h?h(D):D[ne]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Ks:Lr,this.isPropagationStopped=Lr,this}return ee(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Ks)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Ks)},persist:function(){},isPersistent:Ks}),o}var Or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qc=Wi(Or),Qs=ee({},Or,{view:0,detail:0}),Js=Wi(Qs),jn,ys,pn,rn=ee({},Qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hc,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==pn&&(pn&&r.type==="mousemove"?(jn=r.screenX-pn.screenX,ys=r.screenY-pn.screenY):ys=jn=0,pn=r),jn)},movementY:function(r){return"movementY"in r?r.movementY:ys}}),el=Wi(rn),wn=ee({},rn,{dataTransfer:0}),$c=Wi(wn),Sa=ee({},Qs,{relatedTarget:0}),vs=Wi(Sa),xs=ee({},Or,{animationName:0,elapsedTime:0,pseudoElement:0}),yf=Wi(xs),Zc=ee({},Or,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Wh=Wi(Zc),em=ee({},Or,{data:0}),Kh=Wi(em),kr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_o={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ci={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tl(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=ci[r])?!!o[r]:!1}function Hc(){return tl}var Xc=ee({},Qs,{key:function(r){if(r.key){var o=kr[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=ia(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?_o[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hc,charCode:function(r){return r.type==="keypress"?ia(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ia(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Si=Wi(Xc),vf=ee({},rn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qu=Wi(vf),xf=ee({},Qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hc}),tm=Wi(xf),Xl=ee({},Or,{propertyName:0,elapsedTime:0,pseudoElement:0}),$u=Wi(Xl),Yl=ee({},rn,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Qh=Wi(Yl),Yc=ee({},Or,{newState:0,oldState:0}),Wl=Wi(Yc),Kl=[9,13,27,32],Ri=wi&&"CompositionEvent"in window,Ql=null;wi&&"documentMode"in document&&(Ql=document.documentMode);var Jl=wi&&"TextEvent"in window&&!Ql,ec=wi&&(!Ri||Ql&&8<Ql&&11>=Ql),bs=" ",bf=!1;function Wc(r,o){switch(r){case"keyup":return Kl.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wf(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ha=!1;function Zu(r,o){switch(r){case"compositionend":return wf(o);case"keypress":return o.which!==32?null:(bf=!0,bs);case"textInput":return r=o.data,r===bs&&bf?null:r;default:return null}}function Sf(r,o){if(Ha)return r==="compositionend"||!Ri&&Wc(r,o)?(r=_s(),li=go=na=null,Ha=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return ec&&o.locale!=="ko"?null:o.data;default:return null}}var Tf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hu(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!Tf[r.type]:o==="textarea"}function Xu(r,o,h,_){er?Ni?Ni.push(_):Ni=[_]:er=_,o=Od(o,"onChange"),0<o.length&&(h=new qc("onChange","change",null,h,_),r.push({event:h,listeners:o}))}var nl=null,tc=null;function Ef(r){t_(r,0)}function Kc(r){var o=fo(r);if(Xh(o))return r}function ws(r,o){if(r==="change")return o}var Jh=!1;if(wi){var Qc;if(wi){var Ss="oninput"in document;if(!Ss){var ed=document.createElement("div");ed.setAttribute("oninput","return;"),Ss=typeof ed.oninput=="function"}Qc=Ss}else Qc=!1;Jh=Qc&&(!document.documentMode||9<document.documentMode)}function Jc(){nl&&(nl.detachEvent("onpropertychange",Cf),tc=nl=null)}function Cf(r){if(r.propertyName==="value"&&Kc(tc)){var o=[];Xu(o,tc,r,Gc(r)),Hn(Ef,o)}}function nm(r,o,h){r==="focusin"?(Jc(),nl=o,tc=h,nl.attachEvent("onpropertychange",Cf)):r==="focusout"&&Jc()}function Mf(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Kc(tc)}function eu(r,o){if(r==="click")return Kc(o)}function Af(r,o){if(r==="input"||r==="change")return Kc(o)}function td(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Vr=typeof Object.is=="function"?Object.is:td;function Ts(r,o){if(Vr(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var h=Object.keys(r),_=Object.keys(o);if(h.length!==_.length)return!1;for(_=0;_<h.length;_++){var M=h[_];if(!ea.call(o,M)||!Vr(r[M],o[M]))return!1}return!0}function Ta(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function tu(r,o){var h=Ta(r);r=0;for(var _;h;){if(h.nodeType===3){if(_=r+h.textContent.length,r<=o&&_>=o)return{node:h,offset:o-r};r=_}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Ta(h)}}function Yu(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Yu(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Wu(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=jc(r.document);o instanceof r.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)r=o.contentWindow;else break;o=jc(r.document)}return o}function nu(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var Ku=wi&&"documentMode"in document&&11>=document.documentMode,Ea=null,iu=null,ru=null,Qu=!1;function zf(r,o,h){var _=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Qu||Ea==null||Ea!==jc(_)||(_=Ea,"selectionStart"in _&&nu(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),ru&&Ts(ru,_)||(ru=_,_=Od(iu,"onSelect"),0<_.length&&(o=new qc("onSelect","select",null,o,h),r.push({event:o,listeners:_}),o.target=Ea)))}function il(r,o){var h={};return h[r.toLowerCase()]=o.toLowerCase(),h["Webkit"+r]="webkit"+o,h["Moz"+r]="moz"+o,h}var rl={animationend:il("Animation","AnimationEnd"),animationiteration:il("Animation","AnimationIteration"),animationstart:il("Animation","AnimationStart"),transitionrun:il("Transition","TransitionRun"),transitionstart:il("Transition","TransitionStart"),transitioncancel:il("Transition","TransitionCancel"),transitionend:il("Transition","TransitionEnd")},nd={},An={};wi&&(An=document.createElement("div").style,"AnimationEvent"in window||(delete rl.animationend.animation,delete rl.animationiteration.animation,delete rl.animationstart.animation),"TransitionEvent"in window||delete rl.transitionend.transition);function yo(r){if(nd[r])return nd[r];if(!rl[r])return r;var o=rl[r],h;for(h in o)if(o.hasOwnProperty(h)&&h in An)return nd[r]=o[h];return r}var au=yo("animationend"),ou=yo("animationiteration"),Ju=yo("animationstart"),al=yo("transitionrun"),su=yo("transitionstart"),nc=yo("transitioncancel"),ra=yo("transitionend"),id=new Map,eh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");eh.push("scrollEnd");function aa(r,o){id.set(r,o),bn(o,[r])}var vo=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Br=[],qo=0,ol=0;function sl(){for(var r=qo,o=ol=qo=0;o<r;){var h=Br[o];Br[o++]=null;var _=Br[o];Br[o++]=null;var M=Br[o];Br[o++]=null;var D=Br[o];if(Br[o++]=null,_!==null&&M!==null){var U=_.pending;U===null?M.next=M:(M.next=U.next,U.next=M),_.pending=M}D!==0&&rd(h,M,D)}}function lu(r,o,h,_){Br[qo++]=r,Br[qo++]=o,Br[qo++]=h,Br[qo++]=_,ol|=_,r.lanes|=_,r=r.alternate,r!==null&&(r.lanes|=_)}function Es(r,o,h,_){return lu(r,o,h,_),ic(r)}function Ca(r,o){return lu(r,null,null,o),ic(r)}function rd(r,o,h){r.lanes|=h;var _=r.alternate;_!==null&&(_.lanes|=h);for(var M=!1,D=r.return;D!==null;)D.childLanes|=h,_=D.alternate,_!==null&&(_.childLanes|=h),D.tag===22&&(r=D.stateNode,r===null||r._visibility&1||(M=!0)),r=D,D=D.return;return r.tag===3?(D=r.stateNode,M&&o!==null&&(M=31-Ie(h),r=D.hiddenUpdates,_=r[M],_===null?r[M]=[o]:_.push(o),o.lane=h|536870912),D):null}function ic(r){if(50<Dd)throw Dd=0,xm=null,Error(S(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var on={};function th(r,o,h,_){this.tag=r,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oa(r,o,h,_){return new th(r,o,h,_)}function nh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function sa(r,o){var h=r.alternate;return h===null?(h=oa(r.tag,o,r.key,r.mode),h.elementType=r.elementType,h.type=r.type,h.stateNode=r.stateNode,h.alternate=r,r.alternate=h):(h.pendingProps=o,h.type=r.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=r.flags&65011712,h.childLanes=r.childLanes,h.lanes=r.lanes,h.child=r.child,h.memoizedProps=r.memoizedProps,h.memoizedState=r.memoizedState,h.updateQueue=r.updateQueue,o=r.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=r.sibling,h.index=r.index,h.ref=r.ref,h.refCleanup=r.refCleanup,h}function Df(r,o){r.flags&=65011714;var h=r.alternate;return h===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=h.childLanes,r.lanes=h.lanes,r.child=h.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=h.memoizedProps,r.memoizedState=h.memoizedState,r.updateQueue=h.updateQueue,r.type=h.type,o=h.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function ih(r,o,h,_,M,D){var U=0;if(_=r,typeof r=="function")nh(r)&&(U=1);else if(typeof r=="string")U=Sp(r,h,At.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Pt:return r=oa(31,h,o,M),r.elementType=Pt,r.lanes=D,r;case xe:return Cs(h.children,M,D,o);case ie:U=8,M|=24;break;case Ue:return r=oa(12,h,o,M|2),r.elementType=Ue,r.lanes=D,r;case it:return r=oa(13,h,o,M),r.elementType=it,r.lanes=D,r;case pt:return r=oa(19,h,o,M),r.elementType=pt,r.lanes=D,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Le:U=10;break e;case $e:U=9;break e;case Ye:U=11;break e;case Qe:U=14;break e;case _t:U=16,_=null;break e}U=29,h=Error(S(130,r===null?"null":typeof r,"")),_=null}return o=oa(U,h,o,M),o.elementType=r,o.type=_,o.lanes=D,o}function Cs(r,o,h,_){return r=oa(7,r,_,o),r.lanes=h,r}function ad(r,o,h){return r=oa(6,r,null,o),r.lanes=h,r}function rh(r){var o=oa(18,null,null,0);return o.stateNode=r,o}function Ms(r,o,h){return o=oa(4,r.children!==null?r.children:[],r.key,o),o.lanes=h,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var rc=new WeakMap;function Fr(r,o){if(typeof r=="object"&&r!==null){var h=rc.get(r);return h!==void 0?h:(o={value:r,source:o,stack:Ar(o)},rc.set(r,o),o)}return{value:r,source:o,stack:Ar(o)}}var As=[],zs=0,ll=null,Ds=0,nr=[],ar=0,xo=null,bo=1,Ur="";function $o(r,o){As[zs++]=Ds,As[zs++]=ll,ll=r,Ds=o}function od(r,o,h){nr[ar++]=bo,nr[ar++]=Ur,nr[ar++]=xo,xo=r;var _=bo;r=Ur;var M=32-Ie(_)-1;_&=~(1<<M),h+=1;var D=32-Ie(o)+M;if(30<D){var U=M-M%5;D=(_&(1<<U)-1).toString(32),_>>=U,M-=U,bo=1<<32-Ie(o)+M|h<<M|_,Ur=D+r}else bo=1<<D|h<<M|_,Ur=r}function cl(r){r.return!==null&&($o(r,1),od(r,1,0))}function ac(r){for(;r===ll;)ll=As[--zs],As[zs]=null,Ds=As[--zs],As[zs]=null;for(;r===xo;)xo=nr[--ar],nr[ar]=null,Ur=nr[--ar],nr[ar]=null,bo=nr[--ar],nr[ar]=null}function sd(r,o){nr[ar++]=bo,nr[ar++]=Ur,nr[ar++]=xo,bo=o.id,Ur=o.overflow,xo=r}var or=null,Xn=null,xn=!1,Zo=null,la=!1,mi=Error(S(519));function Gr(r){var o=Error(S(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ho(Fr(o,r)),mi}function qr(r){var o=r.stateNode,h=r.type,_=r.memoizedProps;switch(o[vn]=r,o[gt]=_,h){case"dialog":Cn("cancel",o),Cn("close",o);break;case"iframe":case"object":case"embed":Cn("load",o);break;case"video":case"audio":for(h=0;h<xc.length;h++)Cn(xc[h],o);break;case"source":Cn("error",o);break;case"img":case"image":case"link":Cn("error",o),Cn("load",o);break;case"details":Cn("toggle",o);break;case"input":Cn("invalid",o),Uu(o,_.value,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name,!0);break;case"select":Cn("invalid",o);break;case"textarea":Cn("invalid",o),Zl(o,_.value,_.defaultValue,_.children)}h=_.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||o.textContent===""+h||_.suppressHydrationWarning===!0||Lm(o.textContent,h)?(_.popover!=null&&(Cn("beforetoggle",o),Cn("toggle",o)),_.onScroll!=null&&Cn("scroll",o),_.onScrollEnd!=null&&Cn("scrollend",o),_.onClick!=null&&(o.onclick=Za),o=!0):o=!1,o||Gr(r,!0)}function cu(r){for(or=r.return;or;)switch(or.tag){case 5:case 31:case 13:la=!1;return;case 27:case 3:la=!0;return;default:or=or.return}}function wo(r){if(r!==or)return!1;if(!xn)return cu(r),xn=!0,!1;var o=r.tag,h;if((h=o!==3&&o!==27)&&((h=o===5)&&(h=r.type,h=!(h!=="form"&&h!=="button")||gp(r.type,r.memoizedProps)),h=!h),h&&Xn&&Gr(r),cu(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(S(317));Xn=pr(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(S(317));Xn=pr(r)}else o===27?(o=Xn,Sc(r.type)?(r=ga,ga=null,Xn=r):Xn=o):Xn=or?ao(r.stateNode.nextSibling):null;return!0}function So(){Xn=or=null,xn=!1}function To(){var r=Zo;return r!==null&&(ka===null?ka=r:ka.push.apply(ka,r),Zo=null),r}function Ho(r){Zo===null?Zo=[r]:Zo.push(r)}var Xo=Ee(null),Ma=null,Eo=null;function Yo(r,o,h){Tt(Xo,o._currentValue),o._currentValue=h}function Co(r){r._currentValue=Xo.current,rt(Xo)}function ah(r,o,h){for(;r!==null;){var _=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,_!==null&&(_.childLanes|=o)):_!==null&&(_.childLanes&o)!==o&&(_.childLanes|=o),r===h)break;r=r.return}}function oh(r,o,h,_){var M=r.child;for(M!==null&&(M.return=r);M!==null;){var D=M.dependencies;if(D!==null){var U=M.child;D=D.firstContext;e:for(;D!==null;){var ne=D;D=M;for(var Se=0;Se<o.length;Se++)if(ne.context===o[Se]){D.lanes|=h,ne=D.alternate,ne!==null&&(ne.lanes|=h),ah(D.return,h,r),_||(U=null);break e}D=ne.next}}else if(M.tag===18){if(U=M.return,U===null)throw Error(S(341));U.lanes|=h,D=U.alternate,D!==null&&(D.lanes|=h),ah(U,h,r),U=null}else U=M.child;if(U!==null)U.return=M;else for(U=M;U!==null;){if(U===r){U=null;break}if(M=U.sibling,M!==null){M.return=U.return,U=M;break}U=U.return}M=U}}function ca(r,o,h,_){r=null;for(var M=o,D=!1;M!==null;){if(!D){if((M.flags&524288)!==0)D=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var U=M.alternate;if(U===null)throw Error(S(387));if(U=U.memoizedProps,U!==null){var ne=M.type;Vr(M.pendingProps.value,U.value)||(r!==null?r.push(ne):r=[ne])}}else if(M===tn.current){if(U=M.alternate,U===null)throw Error(S(387));U.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(r!==null?r.push(kh):r=[kh])}M=M.return}r!==null&&oh(o,r,h,_),o.flags|=262144}function oc(r){for(r=r.firstContext;r!==null;){if(!Vr(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Wo(r){Ma=r,Eo=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function ji(r){return sh(Ma,r)}function uu(r,o){return Ma===null&&Wo(r),sh(r,o)}function sh(r,o){var h=o._currentValue;if(o={context:o,memoizedValue:h,next:null},Eo===null){if(r===null)throw Error(S(308));Eo=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Eo=Eo.next=o;return h}var ld=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(h,_){r.push(_)}};this.abort=function(){o.aborted=!0,r.forEach(function(h){return h()})}},Pf=p.unstable_scheduleCallback,cd=p.unstable_NormalPriority,Ii={$$typeof:Le,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Mo(){return{controller:new ld,data:new Map,refCount:0}}function sc(r){r.refCount--,r.refCount===0&&Pf(cd,function(){r.controller.abort()})}var wr=null,ua=0,ul=0,Sr=null;function im(r,o){if(wr===null){var h=wr=[];ua=0,ul=zm(),Sr={status:"pending",value:void 0,then:function(_){h.push(_)}}}return ua++,o.then(lc,lc),o}function lc(){if(--ua===0&&wr!==null){Sr!==null&&(Sr.status="fulfilled");var r=wr;wr=null,ul=0,Sr=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function hu(r,o){var h=[],_={status:"pending",value:null,reason:null,then:function(M){h.push(M)}};return r.then(function(){_.status="fulfilled",_.value=o;for(var M=0;M<h.length;M++)(0,h[M])(o)},function(M){for(_.status="rejected",_.reason=M,M=0;M<h.length;M++)(0,h[M])(void 0)}),_}var ir=Pe.S;Pe.S=function(r,o){Fg=Hi(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&im(r,o),ir!==null&&ir(r,o)};var Xa=Ee(null);function lh(){var r=Xa.current;return r!==null?r:di.pooledCache}function ch(r,o){o===null?Tt(Xa,Xa.current):Tt(Xa,o.pool)}function Rf(){var r=lh();return r===null?null:{parent:Ii._currentValue,pool:r}}var Ya=Error(S(460)),Ps=Error(S(474)),$r=Error(S(542)),zt={then:function(){}};function du(r){return r=r.status,r==="fulfilled"||r==="rejected"}function uh(r,o,h){switch(h=r[h],h===void 0?r.push(o):h!==o&&(o.then(Za,Za),o=h),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,hh(r),r;default:if(typeof o.status=="string")o.then(Za,Za);else{if(r=di,r!==null&&100<r.shellSuspendCounter)throw Error(S(482));r=o,r.status="pending",r.then(function(_){if(o.status==="pending"){var M=o;M.status="fulfilled",M.value=_}},function(_){if(o.status==="pending"){var M=o;M.status="rejected",M.reason=_}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,hh(r),r}throw Wa=o,Ya}}function Aa(r){try{var o=r._init;return o(r._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Wa=h,Ya):h}}var Wa=null;function cc(){if(Wa===null)throw Error(S(459));var r=Wa;return Wa=null,r}function hh(r){if(r===Ya||r===$r)throw Error(S(483))}var Ao=null,hl=0;function fu(r){var o=hl;return hl+=1,Ao===null&&(Ao=[]),uh(Ao,r,o)}function zo(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function dh(r,o){throw o.$$typeof===le?Error(S(525)):(r=Object.prototype.toString.call(o),Error(S(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function pu(r){function o(Oe,ze){if(r){var qe=Oe.deletions;qe===null?(Oe.deletions=[ze],Oe.flags|=16):qe.push(ze)}}function h(Oe,ze){if(!r)return null;for(;ze!==null;)o(Oe,ze),ze=ze.sibling;return null}function _(Oe){for(var ze=new Map;Oe!==null;)Oe.key!==null?ze.set(Oe.key,Oe):ze.set(Oe.index,Oe),Oe=Oe.sibling;return ze}function M(Oe,ze){return Oe=sa(Oe,ze),Oe.index=0,Oe.sibling=null,Oe}function D(Oe,ze,qe){return Oe.index=qe,r?(qe=Oe.alternate,qe!==null?(qe=qe.index,qe<ze?(Oe.flags|=67108866,ze):qe):(Oe.flags|=67108866,ze)):(Oe.flags|=1048576,ze)}function U(Oe){return r&&Oe.alternate===null&&(Oe.flags|=67108866),Oe}function ne(Oe,ze,qe,ut){return ze===null||ze.tag!==6?(ze=ad(qe,Oe.mode,ut),ze.return=Oe,ze):(ze=M(ze,qe),ze.return=Oe,ze)}function Se(Oe,ze,qe,ut){var Kt=qe.type;return Kt===xe?at(Oe,ze,qe.props.children,ut,qe.key):ze!==null&&(ze.elementType===Kt||typeof Kt=="object"&&Kt!==null&&Kt.$$typeof===_t&&Aa(Kt)===ze.type)?(ze=M(ze,qe.props),zo(ze,qe),ze.return=Oe,ze):(ze=ih(qe.type,qe.key,qe.props,null,Oe.mode,ut),zo(ze,qe),ze.return=Oe,ze)}function Ze(Oe,ze,qe,ut){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==qe.containerInfo||ze.stateNode.implementation!==qe.implementation?(ze=Ms(qe,Oe.mode,ut),ze.return=Oe,ze):(ze=M(ze,qe.children||[]),ze.return=Oe,ze)}function at(Oe,ze,qe,ut,Kt){return ze===null||ze.tag!==7?(ze=Cs(qe,Oe.mode,ut,Kt),ze.return=Oe,ze):(ze=M(ze,qe),ze.return=Oe,ze)}function dt(Oe,ze,qe){if(typeof ze=="string"&&ze!==""||typeof ze=="number"||typeof ze=="bigint")return ze=ad(""+ze,Oe.mode,qe),ze.return=Oe,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case ce:return qe=ih(ze.type,ze.key,ze.props,null,Oe.mode,qe),zo(qe,ze),qe.return=Oe,qe;case Ce:return ze=Ms(ze,Oe.mode,qe),ze.return=Oe,ze;case _t:return ze=Aa(ze),dt(Oe,ze,qe)}if(Ht(ze)||Ot(ze))return ze=Cs(ze,Oe.mode,qe,null),ze.return=Oe,ze;if(typeof ze.then=="function")return dt(Oe,fu(ze),qe);if(ze.$$typeof===Le)return dt(Oe,uu(Oe,ze),qe);dh(Oe,ze)}return null}function We(Oe,ze,qe,ut){var Kt=ze!==null?ze.key:null;if(typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint")return Kt!==null?null:ne(Oe,ze,""+qe,ut);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case ce:return qe.key===Kt?Se(Oe,ze,qe,ut):null;case Ce:return qe.key===Kt?Ze(Oe,ze,qe,ut):null;case _t:return qe=Aa(qe),We(Oe,ze,qe,ut)}if(Ht(qe)||Ot(qe))return Kt!==null?null:at(Oe,ze,qe,ut,null);if(typeof qe.then=="function")return We(Oe,ze,fu(qe),ut);if(qe.$$typeof===Le)return We(Oe,ze,uu(Oe,qe),ut);dh(Oe,qe)}return null}function tt(Oe,ze,qe,ut,Kt){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Oe=Oe.get(qe)||null,ne(ze,Oe,""+ut,Kt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case ce:return Oe=Oe.get(ut.key===null?qe:ut.key)||null,Se(ze,Oe,ut,Kt);case Ce:return Oe=Oe.get(ut.key===null?qe:ut.key)||null,Ze(ze,Oe,ut,Kt);case _t:return ut=Aa(ut),tt(Oe,ze,qe,ut,Kt)}if(Ht(ut)||Ot(ut))return Oe=Oe.get(qe)||null,at(ze,Oe,ut,Kt,null);if(typeof ut.then=="function")return tt(Oe,ze,qe,fu(ut),Kt);if(ut.$$typeof===Le)return tt(Oe,ze,qe,uu(ze,ut),Kt);dh(ze,ut)}return null}function Gt(Oe,ze,qe,ut){for(var Kt=null,Gn=null,qt=ze,Xt=ze=0,Sn=null;qt!==null&&Xt<qe.length;Xt++){qt.index>Xt?(Sn=qt,qt=null):Sn=qt.sibling;var Bn=We(Oe,qt,qe[Xt],ut);if(Bn===null){qt===null&&(qt=Sn);break}r&&qt&&Bn.alternate===null&&o(Oe,qt),ze=D(Bn,ze,Xt),Gn===null?Kt=Bn:Gn.sibling=Bn,Gn=Bn,qt=Sn}if(Xt===qe.length)return h(Oe,qt),xn&&$o(Oe,Xt),Kt;if(qt===null){for(;Xt<qe.length;Xt++)qt=dt(Oe,qe[Xt],ut),qt!==null&&(ze=D(qt,ze,Xt),Gn===null?Kt=qt:Gn.sibling=qt,Gn=qt);return xn&&$o(Oe,Xt),Kt}for(qt=_(qt);Xt<qe.length;Xt++)Sn=tt(qt,Oe,Xt,qe[Xt],ut),Sn!==null&&(r&&Sn.alternate!==null&&qt.delete(Sn.key===null?Xt:Sn.key),ze=D(Sn,ze,Xt),Gn===null?Kt=Sn:Gn.sibling=Sn,Gn=Sn);return r&&qt.forEach(function(Rl){return o(Oe,Rl)}),xn&&$o(Oe,Xt),Kt}function Jt(Oe,ze,qe,ut){if(qe==null)throw Error(S(151));for(var Kt=null,Gn=null,qt=ze,Xt=ze=0,Sn=null,Bn=qe.next();qt!==null&&!Bn.done;Xt++,Bn=qe.next()){qt.index>Xt?(Sn=qt,qt=null):Sn=qt.sibling;var Rl=We(Oe,qt,Bn.value,ut);if(Rl===null){qt===null&&(qt=Sn);break}r&&qt&&Rl.alternate===null&&o(Oe,qt),ze=D(Rl,ze,Xt),Gn===null?Kt=Rl:Gn.sibling=Rl,Gn=Rl,qt=Sn}if(Bn.done)return h(Oe,qt),xn&&$o(Oe,Xt),Kt;if(qt===null){for(;!Bn.done;Xt++,Bn=qe.next())Bn=dt(Oe,Bn.value,ut),Bn!==null&&(ze=D(Bn,ze,Xt),Gn===null?Kt=Bn:Gn.sibling=Bn,Gn=Bn);return xn&&$o(Oe,Xt),Kt}for(qt=_(qt);!Bn.done;Xt++,Bn=qe.next())Bn=tt(qt,Oe,Xt,Bn.value,ut),Bn!==null&&(r&&Bn.alternate!==null&&qt.delete(Bn.key===null?Xt:Bn.key),ze=D(Bn,ze,Xt),Gn===null?Kt=Bn:Gn.sibling=Bn,Gn=Bn);return r&&qt.forEach(function(ng){return o(Oe,ng)}),xn&&$o(Oe,Xt),Kt}function ii(Oe,ze,qe,ut){if(typeof qe=="object"&&qe!==null&&qe.type===xe&&qe.key===null&&(qe=qe.props.children),typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case ce:e:{for(var Kt=qe.key;ze!==null;){if(ze.key===Kt){if(Kt=qe.type,Kt===xe){if(ze.tag===7){h(Oe,ze.sibling),ut=M(ze,qe.props.children),ut.return=Oe,Oe=ut;break e}}else if(ze.elementType===Kt||typeof Kt=="object"&&Kt!==null&&Kt.$$typeof===_t&&Aa(Kt)===ze.type){h(Oe,ze.sibling),ut=M(ze,qe.props),zo(ut,qe),ut.return=Oe,Oe=ut;break e}h(Oe,ze);break}else o(Oe,ze);ze=ze.sibling}qe.type===xe?(ut=Cs(qe.props.children,Oe.mode,ut,qe.key),ut.return=Oe,Oe=ut):(ut=ih(qe.type,qe.key,qe.props,null,Oe.mode,ut),zo(ut,qe),ut.return=Oe,Oe=ut)}return U(Oe);case Ce:e:{for(Kt=qe.key;ze!==null;){if(ze.key===Kt)if(ze.tag===4&&ze.stateNode.containerInfo===qe.containerInfo&&ze.stateNode.implementation===qe.implementation){h(Oe,ze.sibling),ut=M(ze,qe.children||[]),ut.return=Oe,Oe=ut;break e}else{h(Oe,ze);break}else o(Oe,ze);ze=ze.sibling}ut=Ms(qe,Oe.mode,ut),ut.return=Oe,Oe=ut}return U(Oe);case _t:return qe=Aa(qe),ii(Oe,ze,qe,ut)}if(Ht(qe))return Gt(Oe,ze,qe,ut);if(Ot(qe)){if(Kt=Ot(qe),typeof Kt!="function")throw Error(S(150));return qe=Kt.call(qe),Jt(Oe,ze,qe,ut)}if(typeof qe.then=="function")return ii(Oe,ze,fu(qe),ut);if(qe.$$typeof===Le)return ii(Oe,ze,uu(Oe,qe),ut);dh(Oe,qe)}return typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint"?(qe=""+qe,ze!==null&&ze.tag===6?(h(Oe,ze.sibling),ut=M(ze,qe),ut.return=Oe,Oe=ut):(h(Oe,ze),ut=ad(qe,Oe.mode,ut),ut.return=Oe,Oe=ut),U(Oe)):h(Oe,ze)}return function(Oe,ze,qe,ut){try{hl=0;var Kt=ii(Oe,ze,qe,ut);return Ao=null,Kt}catch(qt){if(qt===Ya||qt===$r)throw qt;var Gn=oa(29,qt,null,Oe.mode);return Gn.lanes=ut,Gn.return=Oe,Gn}}}var Do=pu(!0),ud=pu(!1),Po=!1;function fh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mu(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ro(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ko(r,o,h){var _=r.updateQueue;if(_===null)return null;if(_=_.shared,(Kn&2)!==0){var M=_.pending;return M===null?o.next=o:(o.next=M.next,M.next=o),_.pending=o,o=ic(r),rd(r,null,h),o}return lu(r,_,o,h),ic(r)}function za(r,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194048)!==0)){var _=o.lanes;_&=r.pendingLanes,h|=_,o.lanes=h,Yi(r,h)}}function On(r,o){var h=r.updateQueue,_=r.alternate;if(_!==null&&(_=_.updateQueue,h===_)){var M=null,D=null;if(h=h.firstBaseUpdate,h!==null){do{var U={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};D===null?M=D=U:D=D.next=U,h=h.next}while(h!==null);D===null?M=D=o:D=D.next=o}else M=D=o;h={baseState:_.baseState,firstBaseUpdate:M,lastBaseUpdate:D,shared:_.shared,callbacks:_.callbacks},r.updateQueue=h;return}r=h.lastBaseUpdate,r===null?h.firstBaseUpdate=o:r.next=o,h.lastBaseUpdate=o}var hd=!1;function Qo(){if(hd){var r=Sr;if(r!==null)throw r}}function Rs(r,o,h,_){hd=!1;var M=r.updateQueue;Po=!1;var D=M.firstBaseUpdate,U=M.lastBaseUpdate,ne=M.shared.pending;if(ne!==null){M.shared.pending=null;var Se=ne,Ze=Se.next;Se.next=null,U===null?D=Ze:U.next=Ze,U=Se;var at=r.alternate;at!==null&&(at=at.updateQueue,ne=at.lastBaseUpdate,ne!==U&&(ne===null?at.firstBaseUpdate=Ze:ne.next=Ze,at.lastBaseUpdate=Se))}if(D!==null){var dt=M.baseState;U=0,at=Ze=Se=null,ne=D;do{var We=ne.lane&-536870913,tt=We!==ne.lane;if(tt?(En&We)===We:(_&We)===We){We!==0&&We===ul&&(hd=!0),at!==null&&(at=at.next={lane:0,tag:ne.tag,payload:ne.payload,callback:null,next:null});e:{var Gt=r,Jt=ne;We=o;var ii=h;switch(Jt.tag){case 1:if(Gt=Jt.payload,typeof Gt=="function"){dt=Gt.call(ii,dt,We);break e}dt=Gt;break e;case 3:Gt.flags=Gt.flags&-65537|128;case 0:if(Gt=Jt.payload,We=typeof Gt=="function"?Gt.call(ii,dt,We):Gt,We==null)break e;dt=ee({},dt,We);break e;case 2:Po=!0}}We=ne.callback,We!==null&&(r.flags|=64,tt&&(r.flags|=8192),tt=M.callbacks,tt===null?M.callbacks=[We]:tt.push(We))}else tt={lane:We,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},at===null?(Ze=at=tt,Se=dt):at=at.next=tt,U|=We;if(ne=ne.next,ne===null){if(ne=M.shared.pending,ne===null)break;tt=ne,ne=tt.next,tt.next=null,M.lastBaseUpdate=tt,M.shared.pending=null}}while(!0);at===null&&(Se=dt),M.baseState=Se,M.firstBaseUpdate=Ze,M.lastBaseUpdate=at,D===null&&(M.shared.lanes=0),El|=U,r.lanes=U,r.memoizedState=dt}}function gu(r,o){if(typeof r!="function")throw Error(S(191,r));r.call(o)}function ph(r,o){var h=r.callbacks;if(h!==null)for(r.callbacks=null,r=0;r<h.length;r++)gu(h[r],o)}var dl=Ee(null),_u=Ee(0);function dd(r,o){r=Tl,Tt(_u,r),Tt(dl,o),Tl=r|o.baseLanes}function ha(){Tt(_u,Tl),Tt(dl,dl.current)}function fl(){Tl=_u.current,rt(dl),rt(_u)}var Dt=Ee(null),Bt=null;function Da(r){var o=r.alternate;Tt(Ti,Ti.current&1),Tt(Dt,r),Bt===null&&(o===null||dl.current!==null||o.memoizedState!==null)&&(Bt=r)}function uc(r){Tt(Ti,Ti.current),Tt(Dt,r),Bt===null&&(Bt=r)}function yu(r){r.tag===22?(Tt(Ti,Ti.current),Tt(Dt,r),Bt===null&&(Bt=r)):Li()}function Li(){Tt(Ti,Ti.current),Tt(Dt,Dt.current)}function gi(r){rt(Dt),Bt===r&&(Bt=null),rt(Ti)}var Ti=Ee(0);function vu(r){for(var o=r;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Yr(h)||Qi(h)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Jo=0,dn=null,In=null,hn=null,ui=!1,Pa=!1,Ka=!1,pl=0,ml=0,es=null,fd=0;function ri(){throw Error(S(321))}function Qa(r,o){if(o===null)return!1;for(var h=0;h<o.length&&h<r.length;h++)if(!Vr(r[h],o[h]))return!1;return!0}function hc(r,o,h,_,M,D){return Jo=D,dn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Pe.H=r===null||r.memoizedState===null?Wn:Vi,Ka=!1,D=h(_,M),Ka=!1,Pa&&(D=xu(o,h,_,M)),dc(r),D}function dc(r){Pe.H=kn;var o=In!==null&&In.next!==null;if(Jo=0,hn=In=dn=null,ui=!1,ml=0,es=null,o)throw Error(S(300));r===null||cr||(r=r.dependencies,r!==null&&oc(r)&&(cr=!0))}function xu(r,o,h,_){dn=r;var M=0;do{if(Pa&&(es=null),ml=0,Pa=!1,25<=M)throw Error(S(301));if(M+=1,hn=In=null,r.updateQueue!=null){var D=r.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Pe.H=Ki,D=o(h,_)}while(Pa);return D}function bu(){var r=Pe.H,o=r.useState()[0];return o=typeof o.then=="function"?gl(o):o,r=r.useState()[0],(In!==null?In.memoizedState:null)!==r&&(dn.flags|=1024),o}function wu(){var r=pl!==0;return pl=0,r}function Is(r,o,h){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~h}function ts(r){if(ui){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}ui=!1}Jo=0,hn=In=dn=null,Pa=!1,ml=pl=0,es=null}function _r(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?dn.memoizedState=hn=r:hn=hn.next=r,hn}function hi(){if(In===null){var r=dn.alternate;r=r!==null?r.memoizedState:null}else r=In.next;var o=hn===null?dn.memoizedState:hn.next;if(o!==null)hn=o,In=r;else{if(r===null)throw dn.alternate===null?Error(S(467)):Error(S(310));In=r,r={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},hn===null?dn.memoizedState=hn=r:hn=hn.next=r}return hn}function Io(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gl(r){var o=ml;return ml+=1,es===null&&(es=[]),r=uh(es,r,o),o=dn,(hn===null?o.memoizedState:hn.next)===null&&(o=o.alternate,Pe.H=o===null||o.memoizedState===null?Wn:Vi),r}function _l(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return gl(r);if(r.$$typeof===Le)return ji(r)}throw Error(S(438,String(r)))}function fc(r){var o=null,h=dn.updateQueue;if(h!==null&&(o=h.memoCache),o==null){var _=dn.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(o={data:_.data.map(function(M){return M.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),h===null&&(h=Io(),dn.updateQueue=h),h.memoCache=o,h=o.data[o.index],h===void 0)for(h=o.data[o.index]=Array(r),_=0;_<r;_++)h[_]=Rt;return o.index++,h}function Ja(r,o){return typeof o=="function"?o(r):o}function g(r){var o=hi();return t(o,In,r)}function t(r,o,h){var _=r.queue;if(_===null)throw Error(S(311));_.lastRenderedReducer=h;var M=r.baseQueue,D=_.pending;if(D!==null){if(M!==null){var U=M.next;M.next=D.next,D.next=U}o.baseQueue=M=D,_.pending=null}if(D=r.baseState,M===null)r.memoizedState=D;else{o=M.next;var ne=U=null,Se=null,Ze=o,at=!1;do{var dt=Ze.lane&-536870913;if(dt!==Ze.lane?(En&dt)===dt:(Jo&dt)===dt){var We=Ze.revertLane;if(We===0)Se!==null&&(Se=Se.next={lane:0,revertLane:0,gesture:null,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null}),dt===ul&&(at=!0);else if((Jo&We)===We){Ze=Ze.next,We===ul&&(at=!0);continue}else dt={lane:0,revertLane:Ze.revertLane,gesture:null,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},Se===null?(ne=Se=dt,U=D):Se=Se.next=dt,dn.lanes|=We,El|=We;dt=Ze.action,Ka&&h(D,dt),D=Ze.hasEagerState?Ze.eagerState:h(D,dt)}else We={lane:dt,revertLane:Ze.revertLane,gesture:Ze.gesture,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},Se===null?(ne=Se=We,U=D):Se=Se.next=We,dn.lanes|=dt,El|=dt;Ze=Ze.next}while(Ze!==null&&Ze!==o);if(Se===null?U=D:Se.next=ne,!Vr(D,r.memoizedState)&&(cr=!0,at&&(h=Sr,h!==null)))throw h;r.memoizedState=D,r.baseState=U,r.baseQueue=Se,_.lastRenderedState=D}return M===null&&(_.lanes=0),[r.memoizedState,_.dispatch]}function a(r){var o=hi(),h=o.queue;if(h===null)throw Error(S(311));h.lastRenderedReducer=r;var _=h.dispatch,M=h.pending,D=o.memoizedState;if(M!==null){h.pending=null;var U=M=M.next;do D=r(D,U.action),U=U.next;while(U!==M);Vr(D,o.memoizedState)||(cr=!0),o.memoizedState=D,o.baseQueue===null&&(o.baseState=D),h.lastRenderedState=D}return[D,_]}function c(r,o,h){var _=dn,M=hi(),D=xn;if(D){if(h===void 0)throw Error(S(407));h=h()}else h=o();var U=!Vr((In||M).memoizedState,h);if(U&&(M.memoizedState=h,cr=!0),M=M.queue,Ve(x.bind(null,_,M,r),[r]),M.getSnapshot!==o||U||hn!==null&&hn.memoizedState.tag&1){if(_.flags|=2048,ge(9,{destroy:void 0},y.bind(null,_,M,h,o),null),di===null)throw Error(S(349));D||(Jo&127)!==0||d(_,o,h)}return h}function d(r,o,h){r.flags|=16384,r={getSnapshot:o,value:h},o=dn.updateQueue,o===null?(o=Io(),dn.updateQueue=o,o.stores=[r]):(h=o.stores,h===null?o.stores=[r]:h.push(r))}function y(r,o,h,_){o.value=h,o.getSnapshot=_,C(o)&&z(r)}function x(r,o,h){return h(function(){C(o)&&z(r)})}function C(r){var o=r.getSnapshot;r=r.value;try{var h=o();return!Vr(r,h)}catch{return!0}}function z(r){var o=Ca(r,2);o!==null&&Fa(o,r,2)}function L(r){var o=_r();if(typeof r=="function"){var h=r;if(r=h(),Ka){be(!0);try{h()}finally{be(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:r},o}function k(r,o,h,_){return r.baseState=h,t(r,In,typeof _=="function"?_:Ja)}function V(r,o,h,_,M){if(da(r))throw Error(S(485));if(r=o.action,r!==null){var D={payload:M,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){D.listeners.push(U)}};Pe.T!==null?h(!0):D.isTransition=!1,_(D),h=o.pending,h===null?(D.next=o.pending=D,j(o,D)):(D.next=h.next,o.pending=h.next=D)}}function j(r,o){var h=o.action,_=o.payload,M=r.state;if(o.isTransition){var D=Pe.T,U={};Pe.T=U;try{var ne=h(M,_),Se=Pe.S;Se!==null&&Se(U,ne),$(r,o,ne)}catch(Ze){ae(r,o,Ze)}finally{D!==null&&U.types!==null&&(D.types=U.types),Pe.T=D}}else try{D=h(M,_),$(r,o,D)}catch(Ze){ae(r,o,Ze)}}function $(r,o,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(_){W(r,o,_)},function(_){return ae(r,o,_)}):W(r,o,h)}function W(r,o,h){o.status="fulfilled",o.value=h,se(o),r.state=h,o=r.pending,o!==null&&(h=o.next,h===o?r.pending=null:(h=h.next,o.next=h,j(r,h)))}function ae(r,o,h){var _=r.pending;if(r.pending=null,_!==null){_=_.next;do o.status="rejected",o.reason=h,se(o),o=o.next;while(o!==_)}r.action=null}function se(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function oe(r,o){return o}function fe(r,o){if(xn){var h=di.formState;if(h!==null){e:{var _=dn;if(xn){if(Xn){t:{for(var M=Xn,D=la;M.nodeType!==8;){if(!D){M=null;break t}if(M=ao(M.nextSibling),M===null){M=null;break t}}D=M.data,M=D==="F!"||D==="F"?M:null}if(M){Xn=ao(M.nextSibling),_=M.data==="F!";break e}}Gr(_)}_=!1}_&&(o=h[0])}}return h=_r(),h.memoizedState=h.baseState=o,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oe,lastRenderedState:o},h.queue=_,h=pc.bind(null,dn,_),_.dispatch=h,_=L(!1),D=Hr.bind(null,dn,!1,_.queue),_=_r(),M={state:o,dispatch:null,action:r,pending:null},_.queue=M,h=V.bind(null,dn,M,D,h),M.dispatch=h,_.memoizedState=r,[o,h,!1]}function ye(r){var o=hi();return he(o,In,r)}function he(r,o,h){if(o=t(r,o,oe)[0],r=g(Ja)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var _=gl(o)}catch(U){throw U===Ya?$r:U}else _=o;o=hi();var M=o.queue,D=M.dispatch;return h!==o.memoizedState&&(dn.flags|=2048,ge(9,{destroy:void 0},_e.bind(null,M,h),null)),[_,D,r]}function _e(r,o){r.action=o}function we(r){var o=hi(),h=In;if(h!==null)return he(o,h,r);hi(),o=o.memoizedState,h=hi();var _=h.queue.dispatch;return h.memoizedState=r,[o,_,!1]}function ge(r,o,h,_){return r={tag:r,create:h,deps:_,inst:o,next:null},o=dn.updateQueue,o===null&&(o=Io(),dn.updateQueue=o),h=o.lastEffect,h===null?o.lastEffect=r.next=r:(_=h.next,h.next=r,r.next=_,o.lastEffect=r),r}function Ae(){return hi().memoizedState}function Ge(r,o,h,_){var M=_r();dn.flags|=r,M.memoizedState=ge(1|o,{destroy:void 0},h,_===void 0?null:_)}function Fe(r,o,h,_){var M=hi();_=_===void 0?null:_;var D=M.memoizedState.inst;In!==null&&_!==null&&Qa(_,In.memoizedState.deps)?M.memoizedState=ge(o,D,h,_):(dn.flags|=r,M.memoizedState=ge(1|o,D,h,_))}function je(r,o){Ge(8390656,8,r,o)}function Ve(r,o){Fe(2048,8,r,o)}function vt(r){dn.flags|=4;var o=dn.updateQueue;if(o===null)o=Io(),dn.updateQueue=o,o.events=[r];else{var h=o.events;h===null?o.events=[r]:h.push(r)}}function xt(r){var o=hi().memoizedState;return vt({ref:o,nextImpl:r}),function(){if((Kn&2)!==0)throw Error(S(440));return o.impl.apply(void 0,arguments)}}function ct(r,o){return Fe(4,2,r,o)}function St(r,o){return Fe(4,4,r,o)}function en(r,o){if(typeof o=="function"){r=r();var h=o(r);return function(){typeof h=="function"?h():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Ln(r,o,h){h=h!=null?h.concat([r]):null,Fe(4,4,en.bind(null,o,r),h)}function Jn(){}function Yn(r,o){var h=hi();o=o===void 0?null:o;var _=h.memoizedState;return o!==null&&Qa(o,_[1])?_[0]:(h.memoizedState=[r,o],r)}function ai(r,o){var h=hi();o=o===void 0?null:o;var _=h.memoizedState;if(o!==null&&Qa(o,_[1]))return _[0];if(_=r(),Ka){be(!0);try{r()}finally{be(!1)}}return h.memoizedState=[_,o],_}function Vn(r,o,h){return h===void 0||(Jo&1073741824)!==0&&(En&261930)===0?r.memoizedState=o:(r.memoizedState=h,r=jg(),dn.lanes|=r,El|=r,h)}function _i(r,o,h,_){return Vr(h,o)?h:dl.current!==null?(r=Vn(r,h,_),Vr(r,o)||(cr=!0),r):(Jo&42)===0||(Jo&1073741824)!==0&&(En&261930)===0?(cr=!0,r.memoizedState=h):(r=jg(),dn.lanes|=r,El|=r,o)}function oi(r,o,h,_,M){var D=Xe.p;Xe.p=D!==0&&8>D?D:8;var U=Pe.T,ne={};Pe.T=ne,Hr(r,!1,o,h);try{var Se=M(),Ze=Pe.S;if(Ze!==null&&Ze(ne,Se),Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var at=hu(Se,_);to(r,o,at,Ba(r))}else to(r,o,_,Ba(r))}catch(dt){to(r,o,{then:function(){},status:"rejected",reason:dt},Ba())}finally{Xe.p=D,U!==null&&ne.types!==null&&(U.types=ne.types),Pe.T=U}}function sr(){}function Ei(r,o,h,_){if(r.tag!==5)throw Error(S(476));var M=Ci(r).queue;oi(r,M,o,ft,h===null?sr:function(){return lr(r),h(_)})}function Ci(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:ft,baseState:ft,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:ft},next:null};var h={};return o.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:h},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function lr(r){var o=Ci(r);o.next===null&&(o=r.alternate.memoizedState),to(r,o.next.queue,{},Ba())}function Lo(){return ji(kh)}function Oo(){return hi().memoizedState}function eo(){return hi().memoizedState}function Zr(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var h=Ba();r=Ro(h);var _=Ko(o,r,h);_!==null&&(Fa(_,o,h),za(_,o,h)),o={cache:Mo()},r.payload=o;return}o=o.return}}function yl(r,o,h){var _=Ba();h={lane:_,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},da(r)?Ra(o,h):(h=Es(r,o,h,_),h!==null&&(Fa(h,r,_),Ia(h,o,_)))}function pc(r,o,h){var _=Ba();to(r,o,h,_)}function to(r,o,h,_){var M={lane:_,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(da(r))Ra(o,M);else{var D=r.alternate;if(r.lanes===0&&(D===null||D.lanes===0)&&(D=o.lastRenderedReducer,D!==null))try{var U=o.lastRenderedState,ne=D(U,h);if(M.hasEagerState=!0,M.eagerState=ne,Vr(ne,U))return lu(r,o,M,0),di===null&&sl(),!1}catch{}if(h=Es(r,o,M,_),h!==null)return Fa(h,r,_),Ia(h,o,_),!0}return!1}function Hr(r,o,h,_){if(_={lane:2,revertLane:zm(),gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null},da(r)){if(o)throw Error(S(479))}else o=Es(r,h,_,2),o!==null&&Fa(o,r,2)}function da(r){var o=r.alternate;return r===dn||o!==null&&o===dn}function Ra(r,o){Pa=ui=!0;var h=r.pending;h===null?o.next=o:(o.next=h.next,h.next=o),r.pending=o}function Ia(r,o,h){if((h&4194048)!==0){var _=o.lanes;_&=r.pendingLanes,h|=_,o.lanes=h,Yi(r,h)}}var kn={readContext:ji,use:_l,useCallback:ri,useContext:ri,useEffect:ri,useImperativeHandle:ri,useLayoutEffect:ri,useInsertionEffect:ri,useMemo:ri,useReducer:ri,useRef:ri,useState:ri,useDebugValue:ri,useDeferredValue:ri,useTransition:ri,useSyncExternalStore:ri,useId:ri,useHostTransitionStatus:ri,useFormState:ri,useActionState:ri,useOptimistic:ri,useMemoCache:ri,useCacheRefresh:ri};kn.useEffectEvent=ri;var Wn={readContext:ji,use:_l,useCallback:function(r,o){return _r().memoizedState=[r,o===void 0?null:o],r},useContext:ji,useEffect:je,useImperativeHandle:function(r,o,h){h=h!=null?h.concat([r]):null,Ge(4194308,4,en.bind(null,o,r),h)},useLayoutEffect:function(r,o){return Ge(4194308,4,r,o)},useInsertionEffect:function(r,o){Ge(4,2,r,o)},useMemo:function(r,o){var h=_r();o=o===void 0?null:o;var _=r();if(Ka){be(!0);try{r()}finally{be(!1)}}return h.memoizedState=[_,o],_},useReducer:function(r,o,h){var _=_r();if(h!==void 0){var M=h(o);if(Ka){be(!0);try{h(o)}finally{be(!1)}}}else M=o;return _.memoizedState=_.baseState=M,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:M},_.queue=r,r=r.dispatch=yl.bind(null,dn,r),[_.memoizedState,r]},useRef:function(r){var o=_r();return r={current:r},o.memoizedState=r},useState:function(r){r=L(r);var o=r.queue,h=pc.bind(null,dn,o);return o.dispatch=h,[r.memoizedState,h]},useDebugValue:Jn,useDeferredValue:function(r,o){var h=_r();return Vn(h,r,o)},useTransition:function(){var r=L(!1);return r=oi.bind(null,dn,r.queue,!0,!1),_r().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,h){var _=dn,M=_r();if(xn){if(h===void 0)throw Error(S(407));h=h()}else{if(h=o(),di===null)throw Error(S(349));(En&127)!==0||d(_,o,h)}M.memoizedState=h;var D={value:h,getSnapshot:o};return M.queue=D,je(x.bind(null,_,D,r),[r]),_.flags|=2048,ge(9,{destroy:void 0},y.bind(null,_,D,h,o),null),h},useId:function(){var r=_r(),o=di.identifierPrefix;if(xn){var h=Ur,_=bo;h=(_&~(1<<32-Ie(_)-1)).toString(32)+h,o="_"+o+"R_"+h,h=pl++,0<h&&(o+="H"+h.toString(32)),o+="_"}else h=fd++,o="_"+o+"r_"+h.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:Lo,useFormState:fe,useActionState:fe,useOptimistic:function(r){var o=_r();o.memoizedState=o.baseState=r;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=h,o=Hr.bind(null,dn,!0,h),h.dispatch=o,[r,o]},useMemoCache:fc,useCacheRefresh:function(){return _r().memoizedState=Zr.bind(null,dn)},useEffectEvent:function(r){var o=_r(),h={impl:r};return o.memoizedState=h,function(){if((Kn&2)!==0)throw Error(S(440));return h.impl.apply(void 0,arguments)}}},Vi={readContext:ji,use:_l,useCallback:Yn,useContext:ji,useEffect:Ve,useImperativeHandle:Ln,useInsertionEffect:ct,useLayoutEffect:St,useMemo:ai,useReducer:g,useRef:Ae,useState:function(){return g(Ja)},useDebugValue:Jn,useDeferredValue:function(r,o){var h=hi();return _i(h,In.memoizedState,r,o)},useTransition:function(){var r=g(Ja)[0],o=hi().memoizedState;return[typeof r=="boolean"?r:gl(r),o]},useSyncExternalStore:c,useId:Oo,useHostTransitionStatus:Lo,useFormState:ye,useActionState:ye,useOptimistic:function(r,o){var h=hi();return k(h,In,r,o)},useMemoCache:fc,useCacheRefresh:eo};Vi.useEffectEvent=xt;var Ki={readContext:ji,use:_l,useCallback:Yn,useContext:ji,useEffect:Ve,useImperativeHandle:Ln,useInsertionEffect:ct,useLayoutEffect:St,useMemo:ai,useReducer:a,useRef:Ae,useState:function(){return a(Ja)},useDebugValue:Jn,useDeferredValue:function(r,o){var h=hi();return In===null?Vn(h,r,o):_i(h,In.memoizedState,r,o)},useTransition:function(){var r=a(Ja)[0],o=hi().memoizedState;return[typeof r=="boolean"?r:gl(r),o]},useSyncExternalStore:c,useId:Oo,useHostTransitionStatus:Lo,useFormState:we,useActionState:we,useOptimistic:function(r,o){var h=hi();return In!==null?k(h,In,r,o):(h.baseState=r,[r,h.queue.dispatch])},useMemoCache:fc,useCacheRefresh:eo};Ki.useEffectEvent=xt;function mh(r,o,h,_){o=r.memoizedState,h=h(_,o),h=h==null?o:ee({},o,h),r.memoizedState=h,r.lanes===0&&(r.updateQueue.baseState=h)}var gh={enqueueSetState:function(r,o,h){r=r._reactInternals;var _=Ba(),M=Ro(_);M.payload=o,h!=null&&(M.callback=h),o=Ko(r,M,_),o!==null&&(Fa(o,r,_),za(o,r,_))},enqueueReplaceState:function(r,o,h){r=r._reactInternals;var _=Ba(),M=Ro(_);M.tag=1,M.payload=o,h!=null&&(M.callback=h),o=Ko(r,M,_),o!==null&&(Fa(o,r,_),za(o,r,_))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var h=Ba(),_=Ro(h);_.tag=2,o!=null&&(_.callback=o),o=Ko(r,_,h),o!==null&&(Fa(o,r,h),za(o,r,h))}};function Ls(r,o,h,_,M,D,U){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(_,D,U):o.prototype&&o.prototype.isPureReactComponent?!Ts(h,_)||!Ts(M,D):!0}function If(r,o,h,_){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,_),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,_),o.state!==r&&gh.enqueueReplaceState(o,o.state,null)}function Os(r,o){var h=o;if("ref"in o){h={};for(var _ in o)_!=="ref"&&(h[_]=o[_])}if(r=r.defaultProps){h===o&&(h=ee({},h));for(var M in r)h[M]===void 0&&(h[M]=r[M])}return h}function _h(r){vo(r)}function ns(r){console.error(r)}function is(r){vo(r)}function no(r,o){try{var h=r.onUncaughtError;h(o.value,{componentStack:o.stack})}catch(_){setTimeout(function(){throw _})}}function yh(r,o,h){try{var _=r.onCaughtError;_(h.value,{componentStack:h.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function Su(r,o,h){return h=Ro(h),h.tag=3,h.payload={element:null},h.callback=function(){no(r,o)},h}function Tu(r){return r=Ro(r),r.tag=3,r}function Eu(r,o,h,_){var M=h.type.getDerivedStateFromError;if(typeof M=="function"){var D=_.value;r.payload=function(){return M(D)},r.callback=function(){yh(o,h,_)}}var U=h.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(r.callback=function(){yh(o,h,_),typeof M!="function"&&(Cl===null?Cl=new Set([this]):Cl.add(this));var ne=_.stack;this.componentDidCatch(_.value,{componentStack:ne!==null?ne:""})})}function Lf(r,o,h,_,M){if(h.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(o=h.alternate,o!==null&&ca(o,h,M,!0),h=Dt.current,h!==null){switch(h.tag){case 31:case 13:return Bt===null?Rd():h.alternate===null&&Ui===0&&(Ui=3),h.flags&=-257,h.flags|=65536,h.lanes=M,_===zt?h.flags|=16384:(o=h.updateQueue,o===null?h.updateQueue=new Set([_]):o.add(_),ap(r,_,M)),!1;case 22:return h.flags|=65536,_===zt?h.flags|=16384:(o=h.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([_])},h.updateQueue=o):(h=o.retryQueue,h===null?o.retryQueue=new Set([_]):h.add(_)),ap(r,_,M)),!1}throw Error(S(435,h.tag))}return ap(r,_,M),Rd(),!1}if(xn)return o=Dt.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=M,_!==mi&&(r=Error(S(422),{cause:_}),Ho(Fr(r,h)))):(_!==mi&&(o=Error(S(423),{cause:_}),Ho(Fr(o,h))),r=r.current.alternate,r.flags|=65536,M&=-M,r.lanes|=M,_=Fr(_,h),M=Su(r.stateNode,_,M),On(r,M),Ui!==4&&(Ui=2)),!1;var D=Error(S(520),{cause:_});if(D=Fr(D,h),Ad===null?Ad=[D]:Ad.push(D),Ui!==4&&(Ui=2),o===null)return!0;_=Fr(_,h),h=o;do{switch(h.tag){case 3:return h.flags|=65536,r=M&-M,h.lanes|=r,r=Su(h.stateNode,_,r),On(h,r),!1;case 1:if(o=h.type,D=h.stateNode,(h.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Cl===null||!Cl.has(D))))return h.flags|=65536,M&=-M,h.lanes|=M,M=Tu(M),Eu(M,r,h,_),On(h,M),!1}h=h.return}while(h!==null);return!1}var Of=Error(S(461)),cr=!1;function yr(r,o,h,_){o.child=r===null?ud(o,null,h,_):Do(o,r.child,h,_)}function Sg(r,o,h,_,M){h=h.render;var D=o.ref;if("ref"in _){var U={};for(var ne in _)ne!=="ref"&&(U[ne]=_[ne])}else U=_;return Wo(o),_=hc(r,o,h,U,D,M),ne=wu(),r!==null&&!cr?(Is(r,o,M),Bs(r,o,M)):(xn&&ne&&cl(o),o.flags|=1,yr(r,o,_,M),o.child)}function kf(r,o,h,_,M){if(r===null){var D=h.type;return typeof D=="function"&&!nh(D)&&D.defaultProps===void 0&&h.compare===null?(o.tag=15,o.type=D,rm(r,o,D,_,M)):(r=ih(h.type,null,_,o,o.mode,M),r.ref=o.ref,r.return=o,o.child=r)}if(D=r.child,!gd(r,M)){var U=D.memoizedProps;if(h=h.compare,h=h!==null?h:Ts,h(U,_)&&r.ref===o.ref)return Bs(r,o,M)}return o.flags|=1,r=sa(D,_),r.ref=o.ref,r.return=o,o.child=r}function rm(r,o,h,_,M){if(r!==null){var D=r.memoizedProps;if(Ts(D,_)&&r.ref===o.ref)if(cr=!1,o.pendingProps=_=D,gd(r,M))(r.flags&131072)!==0&&(cr=!0);else return o.lanes=r.lanes,Bs(r,o,M)}return om(r,o,h,_,M)}function am(r,o,h,_){var M=_.children,D=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),_.mode==="hidden"){if((o.flags&128)!==0){if(D=D!==null?D.baseLanes|h:h,r!==null){for(_=o.child=r.child,M=0;_!==null;)M=M|_.lanes|_.childLanes,_=_.sibling;_=M&~D}else _=0,o.child=null;return Tg(r,o,D,h,_)}if((h&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&ch(o,D!==null?D.cachePool:null),D!==null?dd(o,D):ha(),yu(o);else return _=o.lanes=536870912,Tg(r,o,D!==null?D.baseLanes|h:h,h,_)}else D!==null?(ch(o,D.cachePool),dd(o,D),Li(),o.memoizedState=null):(r!==null&&ch(o,null),ha(),Li());return yr(r,o,M,h),o.child}function ks(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function Tg(r,o,h,_,M){var D=lh();return D=D===null?null:{parent:Ii._currentValue,pool:D},o.memoizedState={baseLanes:h,cachePool:D},r!==null&&ch(o,null),ha(),yu(o),r!==null&&ca(r,o,_,!0),o.childLanes=M,null}function vl(r,o){return o=Vf({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function pd(r,o,h){return Do(o,r.child,null,h),r=vl(o,o.pendingProps),r.flags|=2,gi(o),o.memoizedState=null,r}function Bf(r,o,h){var _=o.pendingProps,M=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(xn){if(_.mode==="hidden")return r=vl(o,_),o.lanes=536870912,ks(null,r);if(uc(o),(r=Xn)?(r=Tc(r,la),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:xo!==null?{id:bo,overflow:Ur}:null,retryLane:536870912,hydrationErrors:null},h=rh(r),h.return=o,o.child=h,or=o,Xn=null)):r=null,r===null)throw Gr(o);return o.lanes=536870912,null}return vl(o,_)}var D=r.memoizedState;if(D!==null){var U=D.dehydrated;if(uc(o),M)if(o.flags&256)o.flags&=-257,o=pd(r,o,h);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(S(558));else if(cr||ca(r,o,h,!1),M=(h&r.childLanes)!==0,cr||M){if(_=di,_!==null&&(U=pi(_,h),U!==0&&U!==D.retryLane))throw D.retryLane=U,Ca(r,U),Fa(_,r,U),Of;Rd(),o=pd(r,o,h)}else r=D.treeContext,Xn=ao(U.nextSibling),or=o,xn=!0,Zo=null,la=!1,r!==null&&sd(o,r),o=vl(o,_),o.flags|=4096;return o}return r=sa(r.child,{mode:_.mode,children:_.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Ff(r,o){var h=o.ref;if(h===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(S(284));(r===null||r.ref!==h)&&(o.flags|=4194816)}}function om(r,o,h,_,M){return Wo(o),h=hc(r,o,h,_,void 0,M),_=wu(),r!==null&&!cr?(Is(r,o,M),Bs(r,o,M)):(xn&&_&&cl(o),o.flags|=1,yr(r,o,h,M),o.child)}function Eg(r,o,h,_,M,D){return Wo(o),o.updateQueue=null,h=xu(o,_,h,M),dc(r),_=wu(),r!==null&&!cr?(Is(r,o,D),Bs(r,o,D)):(xn&&_&&cl(o),o.flags|=1,yr(r,o,h,D),o.child)}function Cg(r,o,h,_,M){if(Wo(o),o.stateNode===null){var D=on,U=h.contextType;typeof U=="object"&&U!==null&&(D=ji(U)),D=new h(_,D),o.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=gh,o.stateNode=D,D._reactInternals=o,D=o.stateNode,D.props=_,D.state=o.memoizedState,D.refs={},fh(o),U=h.contextType,D.context=typeof U=="object"&&U!==null?ji(U):on,D.state=o.memoizedState,U=h.getDerivedStateFromProps,typeof U=="function"&&(mh(o,h,U,_),D.state=o.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(U=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),U!==D.state&&gh.enqueueReplaceState(D,D.state,null),Rs(o,_,D,M),Qo(),D.state=o.memoizedState),typeof D.componentDidMount=="function"&&(o.flags|=4194308),_=!0}else if(r===null){D=o.stateNode;var ne=o.memoizedProps,Se=Os(h,ne);D.props=Se;var Ze=D.context,at=h.contextType;U=on,typeof at=="object"&&at!==null&&(U=ji(at));var dt=h.getDerivedStateFromProps;at=typeof dt=="function"||typeof D.getSnapshotBeforeUpdate=="function",ne=o.pendingProps!==ne,at||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(ne||Ze!==U)&&If(o,D,_,U),Po=!1;var We=o.memoizedState;D.state=We,Rs(o,_,D,M),Qo(),Ze=o.memoizedState,ne||We!==Ze||Po?(typeof dt=="function"&&(mh(o,h,dt,_),Ze=o.memoizedState),(Se=Po||Ls(o,h,Se,_,We,Ze,U))?(at||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(o.flags|=4194308)):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=_,o.memoizedState=Ze),D.props=_,D.state=Ze,D.context=U,_=Se):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),_=!1)}else{D=o.stateNode,mu(r,o),U=o.memoizedProps,at=Os(h,U),D.props=at,dt=o.pendingProps,We=D.context,Ze=h.contextType,Se=on,typeof Ze=="object"&&Ze!==null&&(Se=ji(Ze)),ne=h.getDerivedStateFromProps,(Ze=typeof ne=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(U!==dt||We!==Se)&&If(o,D,_,Se),Po=!1,We=o.memoizedState,D.state=We,Rs(o,_,D,M),Qo();var tt=o.memoizedState;U!==dt||We!==tt||Po||r!==null&&r.dependencies!==null&&oc(r.dependencies)?(typeof ne=="function"&&(mh(o,h,ne,_),tt=o.memoizedState),(at=Po||Ls(o,h,at,_,We,tt,Se)||r!==null&&r.dependencies!==null&&oc(r.dependencies))?(Ze||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(_,tt,Se),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(_,tt,Se)),typeof D.componentDidUpdate=="function"&&(o.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof D.componentDidUpdate!="function"||U===r.memoizedProps&&We===r.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||U===r.memoizedProps&&We===r.memoizedState||(o.flags|=1024),o.memoizedProps=_,o.memoizedState=tt),D.props=_,D.state=tt,D.context=Se,_=at):(typeof D.componentDidUpdate!="function"||U===r.memoizedProps&&We===r.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||U===r.memoizedProps&&We===r.memoizedState||(o.flags|=1024),_=!1)}return D=_,Ff(r,o),_=(o.flags&128)!==0,D||_?(D=o.stateNode,h=_&&typeof h.getDerivedStateFromError!="function"?null:D.render(),o.flags|=1,r!==null&&_?(o.child=Do(o,r.child,null,M),o.child=Do(o,null,h,M)):yr(r,o,h,M),o.memoizedState=D.state,r=o.child):r=Bs(r,o,M),r}function Mg(r,o,h,_){return So(),o.flags|=256,yr(r,o,h,_),o.child}var Nf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function md(r){return{baseLanes:r,cachePool:Rf()}}function jf(r,o,h){return r=r!==null?r.childLanes&~h:0,o&&(r|=Nr),r}function sm(r,o,h){var _=o.pendingProps,M=!1,D=(o.flags&128)!==0,U;if((U=D)||(U=r!==null&&r.memoizedState===null?!1:(Ti.current&2)!==0),U&&(M=!0,o.flags&=-129),U=(o.flags&32)!==0,o.flags&=-33,r===null){if(xn){if(M?Da(o):Li(),(r=Xn)?(r=Tc(r,la),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:xo!==null?{id:bo,overflow:Ur}:null,retryLane:536870912,hydrationErrors:null},h=rh(r),h.return=o,o.child=h,or=o,Xn=null)):r=null,r===null)throw Gr(o);return Qi(r)?o.lanes=32:o.lanes=536870912,null}var ne=_.children;return _=_.fallback,M?(Li(),M=o.mode,ne=Vf({mode:"hidden",children:ne},M),_=Cs(_,M,h,null),ne.return=o,_.return=o,ne.sibling=_,o.child=ne,_=o.child,_.memoizedState=md(h),_.childLanes=jf(r,U,h),o.memoizedState=Nf,ks(null,_)):(Da(o),lm(o,ne))}var Se=r.memoizedState;if(Se!==null&&(ne=Se.dehydrated,ne!==null)){if(D)o.flags&256?(Da(o),o.flags&=-257,o=Uf(r,o,h)):o.memoizedState!==null?(Li(),o.child=r.child,o.flags|=128,o=null):(Li(),ne=_.fallback,M=o.mode,_=Vf({mode:"visible",children:_.children},M),ne=Cs(ne,M,h,null),ne.flags|=2,_.return=o,ne.return=o,_.sibling=ne,o.child=_,Do(o,r.child,null,h),_=o.child,_.memoizedState=md(h),_.childLanes=jf(r,U,h),o.memoizedState=Nf,o=ks(null,_));else if(Da(o),Qi(ne)){if(U=ne.nextSibling&&ne.nextSibling.dataset,U)var Ze=U.dgst;U=Ze,_=Error(S(419)),_.stack="",_.digest=U,Ho({value:_,source:null,stack:null}),o=Uf(r,o,h)}else if(cr||ca(r,o,h,!1),U=(h&r.childLanes)!==0,cr||U){if(U=di,U!==null&&(_=pi(U,h),_!==0&&_!==Se.retryLane))throw Se.retryLane=_,Ca(r,_),Fa(U,r,_),Of;Yr(ne)||Rd(),o=Uf(r,o,h)}else Yr(ne)?(o.flags|=192,o.child=r.child,o=null):(r=Se.treeContext,Xn=ao(ne.nextSibling),or=o,xn=!0,Zo=null,la=!1,r!==null&&sd(o,r),o=lm(o,_.children),o.flags|=4096);return o}return M?(Li(),ne=_.fallback,M=o.mode,Se=r.child,Ze=Se.sibling,_=sa(Se,{mode:"hidden",children:_.children}),_.subtreeFlags=Se.subtreeFlags&65011712,Ze!==null?ne=sa(Ze,ne):(ne=Cs(ne,M,h,null),ne.flags|=2),ne.return=o,_.return=o,_.sibling=ne,o.child=_,ks(null,_),_=o.child,ne=r.child.memoizedState,ne===null?ne=md(h):(M=ne.cachePool,M!==null?(Se=Ii._currentValue,M=M.parent!==Se?{parent:Se,pool:Se}:M):M=Rf(),ne={baseLanes:ne.baseLanes|h,cachePool:M}),_.memoizedState=ne,_.childLanes=jf(r,U,h),o.memoizedState=Nf,ks(r.child,_)):(Da(o),h=r.child,r=h.sibling,h=sa(h,{mode:"visible",children:_.children}),h.return=o,h.sibling=null,r!==null&&(U=o.deletions,U===null?(o.deletions=[r],o.flags|=16):U.push(r)),o.child=h,o.memoizedState=null,h)}function lm(r,o){return o=Vf({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Vf(r,o){return r=oa(22,r,null,o),r.lanes=0,r}function Uf(r,o,h){return Do(o,r.child,null,h),r=lm(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function cm(r,o,h){r.lanes|=o;var _=r.alternate;_!==null&&(_.lanes|=o),ah(r.return,o,h)}function um(r,o,h,_,M,D){var U=r.memoizedState;U===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:_,tail:h,tailMode:M,treeForkCount:D}:(U.isBackwards=o,U.rendering=null,U.renderingStartTime=0,U.last=_,U.tail=h,U.tailMode=M,U.treeForkCount=D)}function Gf(r,o,h){var _=o.pendingProps,M=_.revealOrder,D=_.tail;_=_.children;var U=Ti.current,ne=(U&2)!==0;if(ne?(U=U&1|2,o.flags|=128):U&=1,Tt(Ti,U),yr(r,o,_,h),_=xn?Ds:0,!ne&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&cm(r,h,o);else if(r.tag===19)cm(r,h,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(M){case"forwards":for(h=o.child,M=null;h!==null;)r=h.alternate,r!==null&&vu(r)===null&&(M=h),h=h.sibling;h=M,h===null?(M=o.child,o.child=null):(M=h.sibling,h.sibling=null),um(o,!1,M,h,D,_);break;case"backwards":case"unstable_legacy-backwards":for(h=null,M=o.child,o.child=null;M!==null;){if(r=M.alternate,r!==null&&vu(r)===null){o.child=M;break}r=M.sibling,M.sibling=h,h=M,M=r}um(o,!0,h,null,D,_);break;case"together":um(o,!1,null,null,void 0,_);break;default:o.memoizedState=null}return o.child}function Bs(r,o,h){if(r!==null&&(o.dependencies=r.dependencies),El|=o.lanes,(h&o.childLanes)===0)if(r!==null){if(ca(r,o,h,!1),(h&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(S(153));if(o.child!==null){for(r=o.child,h=sa(r,r.pendingProps),o.child=h,h.return=o;r.sibling!==null;)r=r.sibling,h=h.sibling=sa(r,r.pendingProps),h.return=o;h.sibling=null}return o.child}function gd(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&oc(r)))}function _d(r,o,h){switch(o.tag){case 3:fn(o,o.stateNode.containerInfo),Yo(o,Ii,r.memoizedState.cache),So();break;case 27:case 5:$i(o);break;case 4:fn(o,o.stateNode.containerInfo);break;case 10:Yo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,uc(o),null;break;case 13:var _=o.memoizedState;if(_!==null)return _.dehydrated!==null?(Da(o),o.flags|=128,null):(h&o.child.childLanes)!==0?sm(r,o,h):(Da(o),r=Bs(r,o,h),r!==null?r.sibling:null);Da(o);break;case 19:var M=(r.flags&128)!==0;if(_=(h&o.childLanes)!==0,_||(ca(r,o,h,!1),_=(h&o.childLanes)!==0),M){if(_)return Gf(r,o,h);o.flags|=128}if(M=o.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),Tt(Ti,Ti.current),_)break;return null;case 22:return o.lanes=0,am(r,o,h,o.pendingProps);case 24:Yo(o,Ii,r.memoizedState.cache)}return Bs(r,o,h)}function Xr(r,o,h){if(r!==null)if(r.memoizedProps!==o.pendingProps)cr=!0;else{if(!gd(r,h)&&(o.flags&128)===0)return cr=!1,_d(r,o,h);cr=(r.flags&131072)!==0}else cr=!1,xn&&(o.flags&1048576)!==0&&od(o,Ds,o.index);switch(o.lanes=0,o.tag){case 16:e:{var _=o.pendingProps;if(r=Aa(o.elementType),o.type=r,typeof r=="function")nh(r)?(_=Os(r,_),o.tag=1,o=Cg(null,o,r,_,h)):(o.tag=0,o=om(null,o,r,_,h));else{if(r!=null){var M=r.$$typeof;if(M===Ye){o.tag=11,o=Sg(null,o,r,_,h);break e}else if(M===Qe){o.tag=14,o=kf(null,o,r,_,h);break e}}throw o=Ft(r)||r,Error(S(306,o,""))}}return o;case 0:return om(r,o,o.type,o.pendingProps,h);case 1:return _=o.type,M=Os(_,o.pendingProps),Cg(r,o,_,M,h);case 3:e:{if(fn(o,o.stateNode.containerInfo),r===null)throw Error(S(387));_=o.pendingProps;var D=o.memoizedState;M=D.element,mu(r,o),Rs(o,_,null,h);var U=o.memoizedState;if(_=U.cache,Yo(o,Ii,_),_!==D.cache&&oh(o,[Ii],h,!0),Qo(),_=U.element,D.isDehydrated)if(D={element:_,isDehydrated:!1,cache:U.cache},o.updateQueue.baseState=D,o.memoizedState=D,o.flags&256){o=Mg(r,o,_,h);break e}else if(_!==M){M=Fr(Error(S(424)),o),Ho(M),o=Mg(r,o,_,h);break e}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Xn=ao(r.firstChild),or=o,xn=!0,Zo=null,la=!0,h=ud(o,null,_,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(So(),_===M){o=Bs(r,o,h);break e}yr(r,o,_,h)}o=o.child}return o;case 26:return Ff(r,o),r===null?(h=qm(o.type,null,o.pendingProps,null))?o.memoizedState=h:xn||(h=o.type,r=o.pendingProps,_=Fd(Nt.current).createElement(h),_[vn]=o,_[gt]=r,xr(_,h,r),bi(_),o.stateNode=_):o.memoizedState=qm(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return $i(o),r===null&&xn&&(_=o.stateNode=s_(o.type,o.pendingProps,Nt.current),or=o,la=!0,M=Xn,Sc(o.type)?(ga=M,Xn=ao(_.firstChild)):Xn=M),yr(r,o,o.pendingProps.children,h),Ff(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&xn&&((M=_=Xn)&&(_=Tr(_,o.type,o.pendingProps,la),_!==null?(o.stateNode=_,or=o,Xn=ao(_.firstChild),la=!1,M=!0):M=!1),M||Gr(o)),$i(o),M=o.type,D=o.pendingProps,U=r!==null?r.memoizedProps:null,_=D.children,gp(M,D)?_=null:U!==null&&gp(M,U)&&(o.flags|=32),o.memoizedState!==null&&(M=hc(r,o,bu,null,null,h),kh._currentValue=M),Ff(r,o),yr(r,o,_,h),o.child;case 6:return r===null&&xn&&((r=h=Xn)&&(h=ls(h,o.pendingProps,la),h!==null?(o.stateNode=h,or=o,Xn=null,r=!0):r=!1),r||Gr(o)),null;case 13:return sm(r,o,h);case 4:return fn(o,o.stateNode.containerInfo),_=o.pendingProps,r===null?o.child=Do(o,null,_,h):yr(r,o,_,h),o.child;case 11:return Sg(r,o,o.type,o.pendingProps,h);case 7:return yr(r,o,o.pendingProps,h),o.child;case 8:return yr(r,o,o.pendingProps.children,h),o.child;case 12:return yr(r,o,o.pendingProps.children,h),o.child;case 10:return _=o.pendingProps,Yo(o,o.type,_.value),yr(r,o,_.children,h),o.child;case 9:return M=o.type._context,_=o.pendingProps.children,Wo(o),M=ji(M),_=_(M),o.flags|=1,yr(r,o,_,h),o.child;case 14:return kf(r,o,o.type,o.pendingProps,h);case 15:return rm(r,o,o.type,o.pendingProps,h);case 19:return Gf(r,o,h);case 31:return Bf(r,o,h);case 22:return am(r,o,h,o.pendingProps);case 24:return Wo(o),_=ji(Ii),r===null?(M=lh(),M===null&&(M=di,D=Mo(),M.pooledCache=D,D.refCount++,D!==null&&(M.pooledCacheLanes|=h),M=D),o.memoizedState={parent:_,cache:M},fh(o),Yo(o,Ii,M)):((r.lanes&h)!==0&&(mu(r,o),Rs(o,null,null,h),Qo()),M=r.memoizedState,D=o.memoizedState,M.parent!==_?(M={parent:_,cache:_},o.memoizedState=M,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=M),Yo(o,Ii,_)):(_=D.cache,Yo(o,Ii,_),_!==M.cache&&oh(o,[Ii],h,!0))),yr(r,o,o.pendingProps.children,h),o.child;case 29:throw o.pendingProps}throw Error(S(156,o.tag))}function Fs(r){r.flags|=4}function yd(r,o,h,_,M){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(M&335544128)===M)if(r.stateNode.complete)r.flags|=8192;else if(wm())r.flags|=8192;else throw Wa=zt,Ps}else r.flags&=-16777217}function Ag(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Ud(o))if(wm())r.flags|=8192;else throw Wa=zt,Ps}function vd(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?jt():536870912,r.lanes|=o,Du|=o)}function xd(r,o){if(!xn)switch(r.tailMode){case"hidden":o=r.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?r.tail=null:h.sibling=null;break;case"collapsed":h=r.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:_.sibling=null}}function Mi(r){var o=r.alternate!==null&&r.alternate.child===r.child,h=0,_=0;if(o)for(var M=r.child;M!==null;)h|=M.lanes|M.childLanes,_|=M.subtreeFlags&65011712,_|=M.flags&65011712,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)h|=M.lanes|M.childLanes,_|=M.subtreeFlags,_|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=_,r.childLanes=h,o}function zg(r,o,h){var _=o.pendingProps;switch(ac(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mi(o),null;case 1:return Mi(o),null;case 3:return h=o.stateNode,_=null,r!==null&&(_=r.memoizedState.cache),o.memoizedState.cache!==_&&(o.flags|=2048),Co(Ii),_n(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(wo(o)?Fs(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,To())),Mi(o),null;case 26:var M=o.type,D=o.memoizedState;return r===null?(Fs(o),D!==null?(Mi(o),Ag(o,D)):(Mi(o),yd(o,M,null,_,h))):D?D!==r.memoizedState?(Fs(o),Mi(o),Ag(o,D)):(Mi(o),o.flags&=-16777217):(r=r.memoizedProps,r!==_&&Fs(o),Mi(o),yd(o,M,r,_,h)),null;case 27:if(Fn(o),h=Nt.current,M=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==_&&Fs(o);else{if(!_){if(o.stateNode===null)throw Error(S(166));return Mi(o),null}r=At.current,wo(o)?qr(o):(r=s_(M,_,h),o.stateNode=r,Fs(o))}return Mi(o),null;case 5:if(Fn(o),M=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==_&&Fs(o);else{if(!_){if(o.stateNode===null)throw Error(S(166));return Mi(o),null}if(D=At.current,wo(o))qr(o);else{var U=Fd(Nt.current);switch(D){case 1:D=U.createElementNS("http://www.w3.org/2000/svg",M);break;case 2:D=U.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;default:switch(M){case"svg":D=U.createElementNS("http://www.w3.org/2000/svg",M);break;case"math":D=U.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;case"script":D=U.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof _.is=="string"?U.createElement("select",{is:_.is}):U.createElement("select"),_.multiple?D.multiple=!0:_.size&&(D.size=_.size);break;default:D=typeof _.is=="string"?U.createElement(M,{is:_.is}):U.createElement(M)}}D[vn]=o,D[gt]=_;e:for(U=o.child;U!==null;){if(U.tag===5||U.tag===6)D.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===o)break e;for(;U.sibling===null;){if(U.return===null||U.return===o)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}o.stateNode=D;e:switch(xr(D,M,_),M){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}_&&Fs(o)}}return Mi(o),yd(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,h),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==_&&Fs(o);else{if(typeof _!="string"&&o.stateNode===null)throw Error(S(166));if(r=Nt.current,wo(o)){if(r=o.stateNode,h=o.memoizedProps,_=null,M=or,M!==null)switch(M.tag){case 27:case 5:_=M.memoizedProps}r[vn]=o,r=!!(r.nodeValue===h||_!==null&&_.suppressHydrationWarning===!0||Lm(r.nodeValue,h)),r||Gr(o,!0)}else r=Fd(r).createTextNode(_),r[vn]=o,o.stateNode=r}return Mi(o),null;case 31:if(h=o.memoizedState,r===null||r.memoizedState!==null){if(_=wo(o),h!==null){if(r===null){if(!_)throw Error(S(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(S(557));r[vn]=o}else So(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Mi(o),r=!1}else h=To(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=h),r=!0;if(!r)return o.flags&256?(gi(o),o):(gi(o),null);if((o.flags&128)!==0)throw Error(S(558))}return Mi(o),null;case 13:if(_=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(M=wo(o),_!==null&&_.dehydrated!==null){if(r===null){if(!M)throw Error(S(318));if(M=o.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(S(317));M[vn]=o}else So(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Mi(o),M=!1}else M=To(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=M),M=!0;if(!M)return o.flags&256?(gi(o),o):(gi(o),null)}return gi(o),(o.flags&128)!==0?(o.lanes=h,o):(h=_!==null,r=r!==null&&r.memoizedState!==null,h&&(_=o.child,M=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(M=_.alternate.memoizedState.cachePool.pool),D=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(D=_.memoizedState.cachePool.pool),D!==M&&(_.flags|=2048)),h!==r&&h&&(o.child.flags|=8192),vd(o,o.updateQueue),Mi(o),null);case 4:return _n(),r===null&&Rm(o.stateNode.containerInfo),Mi(o),null;case 10:return Co(o.type),Mi(o),null;case 19:if(rt(Ti),_=o.memoizedState,_===null)return Mi(o),null;if(M=(o.flags&128)!==0,D=_.rendering,D===null)if(M)xd(_,!1);else{if(Ui!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(D=vu(r),D!==null){for(o.flags|=128,xd(_,!1),r=D.updateQueue,o.updateQueue=r,vd(o,r),o.subtreeFlags=0,r=h,h=o.child;h!==null;)Df(h,r),h=h.sibling;return Tt(Ti,Ti.current&1|2),xn&&$o(o,_.treeForkCount),o.child}r=r.sibling}_.tail!==null&&Hi()>zd&&(o.flags|=128,M=!0,xd(_,!1),o.lanes=4194304)}else{if(!M)if(r=vu(D),r!==null){if(o.flags|=128,M=!0,r=r.updateQueue,o.updateQueue=r,vd(o,r),xd(_,!0),_.tail===null&&_.tailMode==="hidden"&&!D.alternate&&!xn)return Mi(o),null}else 2*Hi()-_.renderingStartTime>zd&&h!==536870912&&(o.flags|=128,M=!0,xd(_,!1),o.lanes=4194304);_.isBackwards?(D.sibling=o.child,o.child=D):(r=_.last,r!==null?r.sibling=D:o.child=D,_.last=D)}return _.tail!==null?(r=_.tail,_.rendering=r,_.tail=r.sibling,_.renderingStartTime=Hi(),r.sibling=null,h=Ti.current,Tt(Ti,M?h&1|2:h&1),xn&&$o(o,_.treeForkCount),r):(Mi(o),null);case 22:case 23:return gi(o),fl(),_=o.memoizedState!==null,r!==null?r.memoizedState!==null!==_&&(o.flags|=8192):_&&(o.flags|=8192),_?(h&536870912)!==0&&(o.flags&128)===0&&(Mi(o),o.subtreeFlags&6&&(o.flags|=8192)):Mi(o),h=o.updateQueue,h!==null&&vd(o,h.retryQueue),h=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),_=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(_=o.memoizedState.cachePool.pool),_!==h&&(o.flags|=2048),r!==null&&rt(Xa),null;case 24:return h=null,r!==null&&(h=r.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),Co(Ii),Mi(o),null;case 25:return null;case 30:return null}throw Error(S(156,o.tag))}function dy(r,o){switch(ac(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Co(Ii),_n(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Fn(o),null;case 31:if(o.memoizedState!==null){if(gi(o),o.alternate===null)throw Error(S(340));So()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(gi(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(S(340));So()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return rt(Ti),null;case 4:return _n(),null;case 10:return Co(o.type),null;case 22:case 23:return gi(o),fl(),r!==null&&rt(Xa),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Co(Ii),null;case 25:return null;default:return null}}function qf(r,o){switch(ac(o),o.tag){case 3:Co(Ii),_n();break;case 26:case 27:case 5:Fn(o);break;case 4:_n();break;case 31:o.memoizedState!==null&&gi(o);break;case 13:gi(o);break;case 19:rt(Ti);break;case 10:Co(o.type);break;case 22:case 23:gi(o),fl(),r!==null&&rt(Xa);break;case 24:Co(Ii)}}function vh(r,o){try{var h=o.updateQueue,_=h!==null?h.lastEffect:null;if(_!==null){var M=_.next;h=M;do{if((h.tag&r)===r){_=void 0;var D=h.create,U=h.inst;_=D(),U.destroy=_}h=h.next}while(h!==M)}}catch(ne){Qn(o,o.return,ne)}}function xl(r,o,h){try{var _=o.updateQueue,M=_!==null?_.lastEffect:null;if(M!==null){var D=M.next;_=D;do{if((_.tag&r)===r){var U=_.inst,ne=U.destroy;if(ne!==void 0){U.destroy=void 0,M=o;var Se=h,Ze=ne;try{Ze()}catch(at){Qn(M,Se,at)}}}_=_.next}while(_!==D)}}catch(at){Qn(o,o.return,at)}}function Dg(r){var o=r.updateQueue;if(o!==null){var h=r.stateNode;try{ph(o,h)}catch(_){Qn(r,r.return,_)}}}function Pg(r,o,h){h.props=Os(r.type,r.memoizedProps),h.state=r.memoizedState;try{h.componentWillUnmount()}catch(_){Qn(r,o,_)}}function bd(r,o){try{var h=r.ref;if(h!==null){switch(r.tag){case 26:case 27:case 5:var _=r.stateNode;break;case 30:_=r.stateNode;break;default:_=r.stateNode}typeof h=="function"?r.refCleanup=h(_):h.current=_}}catch(M){Qn(r,o,M)}}function io(r,o){var h=r.ref,_=r.refCleanup;if(h!==null)if(typeof _=="function")try{_()}catch(M){Qn(r,o,M)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(M){Qn(r,o,M)}else h.current=null}function $f(r){var o=r.type,h=r.memoizedProps,_=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":h.autoFocus&&_.focus();break e;case"img":h.src?_.src=h.src:h.srcSet&&(_.srcset=h.srcSet)}}catch(M){Qn(r,r.return,M)}}function Zf(r,o,h){try{var _=r.stateNode;a_(_,r.type,h,o),_[gt]=o}catch(M){Qn(r,r.return,M)}}function mc(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Sc(r.type)||r.tag===4}function Cu(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||mc(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Sc(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function hm(r,o,h){var _=r.tag;if(_===5||_===6)r=r.stateNode,o?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(r,o):(o=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,o.appendChild(r),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=Za));else if(_!==4&&(_===27&&Sc(r.type)&&(h=r.stateNode,o=null),r=r.child,r!==null))for(hm(r,o,h),r=r.sibling;r!==null;)hm(r,o,h),r=r.sibling}function Hf(r,o,h){var _=r.tag;if(_===5||_===6)r=r.stateNode,o?h.insertBefore(r,o):h.appendChild(r);else if(_!==4&&(_===27&&Sc(r.type)&&(h=r.stateNode),r=r.child,r!==null))for(Hf(r,o,h),r=r.sibling;r!==null;)Hf(r,o,h),r=r.sibling}function Rg(r){var o=r.stateNode,h=r.memoizedProps;try{for(var _=r.type,M=o.attributes;M.length;)o.removeAttributeNode(M[0]);xr(o,_,h),o[vn]=r,o[gt]=h}catch(D){Qn(r,r.return,D)}}var bl=!1,ur=!1,dm=!1,Ig=typeof WeakSet=="function"?WeakSet:Set,hr=null;function fy(r,o){if(r=r.containerInfo,Bd=Hd,r=Wu(r),nu(r)){if("selectionStart"in r)var h={start:r.selectionStart,end:r.selectionEnd};else e:{h=(h=r.ownerDocument)&&h.defaultView||window;var _=h.getSelection&&h.getSelection();if(_&&_.rangeCount!==0){h=_.anchorNode;var M=_.anchorOffset,D=_.focusNode;_=_.focusOffset;try{h.nodeType,D.nodeType}catch{h=null;break e}var U=0,ne=-1,Se=-1,Ze=0,at=0,dt=r,We=null;t:for(;;){for(var tt;dt!==h||M!==0&&dt.nodeType!==3||(ne=U+M),dt!==D||_!==0&&dt.nodeType!==3||(Se=U+_),dt.nodeType===3&&(U+=dt.nodeValue.length),(tt=dt.firstChild)!==null;)We=dt,dt=tt;for(;;){if(dt===r)break t;if(We===h&&++Ze===M&&(ne=U),We===D&&++at===_&&(Se=U),(tt=dt.nextSibling)!==null)break;dt=We,We=dt.parentNode}dt=tt}h=ne===-1||Se===-1?null:{start:ne,end:Se}}else h=null}h=h||{start:0,end:0}}else h=null;for(Om={focusedElem:r,selectionRange:h},Hd=!1,hr=o;hr!==null;)if(o=hr,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,hr=r;else for(;hr!==null;){switch(o=hr,D=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(h=0;h<r.length;h++)M=r[h],M.ref.impl=M.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&D!==null){r=void 0,h=o,M=D.memoizedProps,D=D.memoizedState,_=h.stateNode;try{var Gt=Os(h.type,M);r=_.getSnapshotBeforeUpdate(Gt,D),_.__reactInternalSnapshotBeforeUpdate=r}catch(Jt){Qn(h,h.return,Jt)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,h=r.nodeType,h===9)ss(r);else if(h===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":ss(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(S(163))}if(r=o.sibling,r!==null){r.return=o.return,hr=r;break}hr=o.return}}function fm(r,o,h){var _=h.flags;switch(h.tag){case 0:case 11:case 15:Oa(r,h),_&4&&vh(5,h);break;case 1:if(Oa(r,h),_&4)if(r=h.stateNode,o===null)try{r.componentDidMount()}catch(U){Qn(h,h.return,U)}else{var M=Os(h.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(M,o,r.__reactInternalSnapshotBeforeUpdate)}catch(U){Qn(h,h.return,U)}}_&64&&Dg(h),_&512&&bd(h,h.return);break;case 3:if(Oa(r,h),_&64&&(r=h.updateQueue,r!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{ph(r,o)}catch(U){Qn(h,h.return,U)}}break;case 27:o===null&&_&4&&Rg(h);case 26:case 5:Oa(r,h),o===null&&_&4&&$f(h),_&512&&bd(h,h.return);break;case 12:Oa(r,h);break;case 31:Oa(r,h),_&4&&wd(r,h);break;case 13:Oa(r,h),_&4&&Sd(r,h),_&64&&(r=h.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(h=Tm.bind(null,h),fr(r,h))));break;case 22:if(_=h.memoizedState!==null||bl,!_){o=o!==null&&o.memoizedState!==null||ur,M=bl;var D=ur;bl=_,(ur=o)&&!D?wl(r,h,(h.subtreeFlags&8772)!==0):Oa(r,h),bl=M,ur=D}break;case 30:break;default:Oa(r,h)}}function xh(r){var o=r.alternate;o!==null&&(r.alternate=null,xh(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&Hs(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Oi=null,zn=!1;function La(r,o,h){for(h=h.child;h!==null;)pm(r,o,h),h=h.sibling}function pm(r,o,h){if(me&&typeof me.onCommitFiberUnmount=="function")try{me.onCommitFiberUnmount(K,h)}catch{}switch(h.tag){case 26:ur||io(h,o),La(r,o,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:ur||io(h,o);var _=Oi,M=zn;Sc(h.type)&&(Oi=h.stateNode,zn=!1),La(r,o,h),Ih(h.stateNode),Oi=_,zn=M;break;case 5:ur||io(h,o);case 6:if(_=Oi,M=zn,Oi=null,La(r,o,h),Oi=_,zn=M,Oi!==null)if(zn)try{(Oi.nodeType===9?Oi.body:Oi.nodeName==="HTML"?Oi.ownerDocument.body:Oi).removeChild(h.stateNode)}catch(D){Qn(h,o,D)}else try{Oi.removeChild(h.stateNode)}catch(D){Qn(h,o,D)}break;case 18:Oi!==null&&(zn?(r=Oi,o_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,h.stateNode),zc(r)):o_(Oi,h.stateNode));break;case 4:_=Oi,M=zn,Oi=h.stateNode.containerInfo,zn=!0,La(r,o,h),Oi=_,zn=M;break;case 0:case 11:case 14:case 15:xl(2,h,o),ur||xl(4,h,o),La(r,o,h);break;case 1:ur||(io(h,o),_=h.stateNode,typeof _.componentWillUnmount=="function"&&Pg(h,o,_)),La(r,o,h);break;case 21:La(r,o,h);break;case 22:ur=(_=ur)||h.memoizedState!==null,La(r,o,h),ur=_;break;default:La(r,o,h)}}function wd(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{zc(r)}catch(h){Qn(o,o.return,h)}}}function Sd(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{zc(r)}catch(h){Qn(o,o.return,h)}}function Td(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new Ig),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new Ig),o;default:throw Error(S(435,r.tag))}}function Ed(r,o){var h=Td(r);o.forEach(function(_){if(!h.has(_)){h.add(_);var M=gy.bind(null,r,_);_.then(M,M)}})}function fa(r,o){var h=o.deletions;if(h!==null)for(var _=0;_<h.length;_++){var M=h[_],D=r,U=o,ne=U;e:for(;ne!==null;){switch(ne.tag){case 27:if(Sc(ne.type)){Oi=ne.stateNode,zn=!1;break e}break;case 5:Oi=ne.stateNode,zn=!1;break e;case 3:case 4:Oi=ne.stateNode.containerInfo,zn=!0;break e}ne=ne.return}if(Oi===null)throw Error(S(160));pm(D,U,M),Oi=null,zn=!1,D=M.alternate,D!==null&&(D.return=null),M.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Xf(o,r),o=o.sibling}var pa=null;function Xf(r,o){var h=r.alternate,_=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:fa(o,r),vr(r),_&4&&(xl(3,r,r.return),vh(3,r),xl(5,r,r.return));break;case 1:fa(o,r),vr(r),_&512&&(ur||h===null||io(h,h.return)),_&64&&bl&&(r=r.updateQueue,r!==null&&(_=r.callbacks,_!==null&&(h=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=h===null?_:h.concat(_))));break;case 26:var M=pa;if(fa(o,r),vr(r),_&512&&(ur||h===null||io(h,h.return)),_&4){var D=h!==null?h.memoizedState:null;if(_=r.memoizedState,h===null)if(_===null)if(r.stateNode===null){e:{_=r.type,h=r.memoizedProps,M=M.ownerDocument||M;t:switch(_){case"title":D=M.getElementsByTagName("title")[0],(!D||D[nn]||D[vn]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=M.createElement(_),M.head.insertBefore(D,M.querySelector("head > title"))),xr(D,_,h),D[vn]=r,bi(D),_=D;break e;case"link":var U=Xm("link","href",M).get(_+(h.href||""));if(U){for(var ne=0;ne<U.length;ne++)if(D=U[ne],D.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&D.getAttribute("rel")===(h.rel==null?null:h.rel)&&D.getAttribute("title")===(h.title==null?null:h.title)&&D.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){U.splice(ne,1);break t}}D=M.createElement(_),xr(D,_,h),M.head.appendChild(D);break;case"meta":if(U=Xm("meta","content",M).get(_+(h.content||""))){for(ne=0;ne<U.length;ne++)if(D=U[ne],D.getAttribute("content")===(h.content==null?null:""+h.content)&&D.getAttribute("name")===(h.name==null?null:h.name)&&D.getAttribute("property")===(h.property==null?null:h.property)&&D.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&D.getAttribute("charset")===(h.charSet==null?null:h.charSet)){U.splice(ne,1);break t}}D=M.createElement(_),xr(D,_,h),M.head.appendChild(D);break;default:throw Error(S(468,_))}D[vn]=r,bi(D),_=D}r.stateNode=_}else Vd(M,r.type,r.stateNode);else r.stateNode=Hm(M,_,r.memoizedProps);else D!==_?(D===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):D.count--,_===null?Vd(M,r.type,r.stateNode):Hm(M,_,r.memoizedProps)):_===null&&r.stateNode!==null&&Zf(r,r.memoizedProps,h.memoizedProps)}break;case 27:fa(o,r),vr(r),_&512&&(ur||h===null||io(h,h.return)),h!==null&&_&4&&Zf(r,r.memoizedProps,h.memoizedProps);break;case 5:if(fa(o,r),vr(r),_&512&&(ur||h===null||io(h,h.return)),r.flags&32){M=r.stateNode;try{Go(M,"")}catch(Gt){Qn(r,r.return,Gt)}}_&4&&r.stateNode!=null&&(M=r.memoizedProps,Zf(r,M,h!==null?h.memoizedProps:M)),_&1024&&(dm=!0);break;case 6:if(fa(o,r),vr(r),_&4){if(r.stateNode===null)throw Error(S(162));_=r.memoizedProps,h=r.stateNode;try{h.nodeValue=_}catch(Gt){Qn(r,r.return,Gt)}}break;case 3:if(wp=null,M=pa,pa=vp(o.containerInfo),fa(o,r),pa=M,vr(r),_&4&&h!==null&&h.memoizedState.isDehydrated)try{zc(o.containerInfo)}catch(Gt){Qn(r,r.return,Gt)}dm&&(dm=!1,Cd(r));break;case 4:_=pa,pa=vp(r.stateNode.containerInfo),fa(o,r),vr(r),pa=_;break;case 12:fa(o,r),vr(r);break;case 31:fa(o,r),vr(r),_&4&&(_=r.updateQueue,_!==null&&(r.updateQueue=null,Ed(r,_)));break;case 13:fa(o,r),vr(r),r.child.flags&8192&&r.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Kf=Hi()),_&4&&(_=r.updateQueue,_!==null&&(r.updateQueue=null,Ed(r,_)));break;case 22:M=r.memoizedState!==null;var Se=h!==null&&h.memoizedState!==null,Ze=bl,at=ur;if(bl=Ze||M,ur=at||Se,fa(o,r),ur=at,bl=Ze,vr(r),_&8192)e:for(o=r.stateNode,o._visibility=M?o._visibility&-2:o._visibility|1,M&&(h===null||Se||bl||ur||rs(r)),h=null,o=r;;){if(o.tag===5||o.tag===26){if(h===null){Se=h=o;try{if(D=Se.stateNode,M)U=D.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{ne=Se.stateNode;var dt=Se.memoizedProps.style,We=dt!=null&&dt.hasOwnProperty("display")?dt.display:null;ne.style.display=We==null||typeof We=="boolean"?"":(""+We).trim()}}catch(Gt){Qn(Se,Se.return,Gt)}}}else if(o.tag===6){if(h===null){Se=o;try{Se.stateNode.nodeValue=M?"":Se.memoizedProps}catch(Gt){Qn(Se,Se.return,Gt)}}}else if(o.tag===18){if(h===null){Se=o;try{var tt=Se.stateNode;M?mn(tt,!0):mn(Se.stateNode,!1)}catch(Gt){Qn(Se,Se.return,Gt)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;h===o&&(h=null),o=o.return}h===o&&(h=null),o.sibling.return=o.return,o=o.sibling}_&4&&(_=r.updateQueue,_!==null&&(h=_.retryQueue,h!==null&&(_.retryQueue=null,Ed(r,h))));break;case 19:fa(o,r),vr(r),_&4&&(_=r.updateQueue,_!==null&&(r.updateQueue=null,Ed(r,_)));break;case 30:break;case 21:break;default:fa(o,r),vr(r)}}function vr(r){var o=r.flags;if(o&2){try{for(var h,_=r.return;_!==null;){if(mc(_)){h=_;break}_=_.return}if(h==null)throw Error(S(160));switch(h.tag){case 27:var M=h.stateNode,D=Cu(r);Hf(r,D,M);break;case 5:var U=h.stateNode;h.flags&32&&(Go(U,""),h.flags&=-33);var ne=Cu(r);Hf(r,ne,U);break;case 3:case 4:var Se=h.stateNode.containerInfo,Ze=Cu(r);hm(r,Ze,Se);break;default:throw Error(S(161))}}catch(at){Qn(r,r.return,at)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function Cd(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;Cd(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Oa(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)fm(r,o.alternate,o),o=o.sibling}function rs(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:xl(4,o,o.return),rs(o);break;case 1:io(o,o.return);var h=o.stateNode;typeof h.componentWillUnmount=="function"&&Pg(o,o.return,h),rs(o);break;case 27:Ih(o.stateNode);case 26:case 5:io(o,o.return),rs(o);break;case 22:o.memoizedState===null&&rs(o);break;case 30:rs(o);break;default:rs(o)}r=r.sibling}}function wl(r,o,h){for(h=h&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var _=o.alternate,M=r,D=o,U=D.flags;switch(D.tag){case 0:case 11:case 15:wl(M,D,h),vh(4,D);break;case 1:if(wl(M,D,h),_=D,M=_.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Ze){Qn(_,_.return,Ze)}if(_=D,M=_.updateQueue,M!==null){var ne=_.stateNode;try{var Se=M.shared.hiddenCallbacks;if(Se!==null)for(M.shared.hiddenCallbacks=null,M=0;M<Se.length;M++)gu(Se[M],ne)}catch(Ze){Qn(_,_.return,Ze)}}h&&U&64&&Dg(D),bd(D,D.return);break;case 27:Rg(D);case 26:case 5:wl(M,D,h),h&&_===null&&U&4&&$f(D),bd(D,D.return);break;case 12:wl(M,D,h);break;case 31:wl(M,D,h),h&&U&4&&wd(M,D);break;case 13:wl(M,D,h),h&&U&4&&Sd(M,D);break;case 22:D.memoizedState===null&&wl(M,D,h),bd(D,D.return);break;case 30:break;default:wl(M,D,h)}o=o.sibling}}function Yf(r,o){var h=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==h&&(r!=null&&r.refCount++,h!=null&&sc(h))}function Sl(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&sc(r))}function as(r,o,h,_){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)mm(r,o,h,_),o=o.sibling}function mm(r,o,h,_){var M=o.flags;switch(o.tag){case 0:case 11:case 15:as(r,o,h,_),M&2048&&vh(9,o);break;case 1:as(r,o,h,_);break;case 3:as(r,o,h,_),M&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&sc(r)));break;case 12:if(M&2048){as(r,o,h,_),r=o.stateNode;try{var D=o.memoizedProps,U=D.id,ne=D.onPostCommit;typeof ne=="function"&&ne(U,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(Se){Qn(o,o.return,Se)}}else as(r,o,h,_);break;case 31:as(r,o,h,_);break;case 13:as(r,o,h,_);break;case 23:break;case 22:D=o.stateNode,U=o.alternate,o.memoizedState!==null?D._visibility&2?as(r,o,h,_):Mu(r,o):D._visibility&2?as(r,o,h,_):(D._visibility|=2,Ns(r,o,h,_,(o.subtreeFlags&10256)!==0||!1)),M&2048&&Yf(U,o);break;case 24:as(r,o,h,_),M&2048&&Sl(o.alternate,o);break;default:as(r,o,h,_)}}function Ns(r,o,h,_,M){for(M=M&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var D=r,U=o,ne=h,Se=_,Ze=U.flags;switch(U.tag){case 0:case 11:case 15:Ns(D,U,ne,Se,M),vh(8,U);break;case 23:break;case 22:var at=U.stateNode;U.memoizedState!==null?at._visibility&2?Ns(D,U,ne,Se,M):Mu(D,U):(at._visibility|=2,Ns(D,U,ne,Se,M)),M&&Ze&2048&&Yf(U.alternate,U);break;case 24:Ns(D,U,ne,Se,M),M&&Ze&2048&&Sl(U.alternate,U);break;default:Ns(D,U,ne,Se,M)}o=o.sibling}}function Mu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var h=r,_=o,M=_.flags;switch(_.tag){case 22:Mu(h,_),M&2048&&Yf(_.alternate,_);break;case 24:Mu(h,_),M&2048&&Sl(_.alternate,_);break;default:Mu(h,_)}o=o.sibling}}var bh=8192;function Au(r,o,h){if(r.subtreeFlags&bh)for(r=r.child;r!==null;)Lg(r,o,h),r=r.sibling}function Lg(r,o,h){switch(r.tag){case 26:Au(r,o,h),r.flags&bh&&r.memoizedState!==null&&Ym(h,pa,r.memoizedState,r.memoizedProps);break;case 5:Au(r,o,h);break;case 3:case 4:var _=pa;pa=vp(r.stateNode.containerInfo),Au(r,o,h),pa=_;break;case 22:r.memoizedState===null&&(_=r.alternate,_!==null&&_.memoizedState!==null?(_=bh,bh=16777216,Au(r,o,h),bh=_):Au(r,o,h));break;default:Au(r,o,h)}}function Og(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Md(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var _=o[h];hr=_,wh(_,r)}Og(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)kg(r),r=r.sibling}function kg(r){switch(r.tag){case 0:case 11:case 15:Md(r),r.flags&2048&&xl(9,r,r.return);break;case 3:Md(r);break;case 12:Md(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Wf(r)):Md(r);break;default:Md(r)}}function Wf(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var _=o[h];hr=_,wh(_,r)}Og(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:xl(8,o,o.return),Wf(o);break;case 22:h=o.stateNode,h._visibility&2&&(h._visibility&=-3,Wf(o));break;default:Wf(o)}r=r.sibling}}function wh(r,o){for(;hr!==null;){var h=hr;switch(h.tag){case 0:case 11:case 15:xl(8,h,o);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var _=h.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:sc(h.memoizedState.cache)}if(_=h.child,_!==null)_.return=h,hr=_;else e:for(h=r;hr!==null;){_=hr;var M=_.sibling,D=_.return;if(xh(_),_===h){hr=null;break e}if(M!==null){M.return=D,hr=M;break e}hr=D}}}var py={getCacheForType:function(r){var o=ji(Ii),h=o.data.get(r);return h===void 0&&(h=r(),o.data.set(r,h)),h},cacheSignal:function(){return ji(Ii).controller.signal}},Bg=typeof WeakMap=="function"?WeakMap:Map,Kn=0,di=null,Tn=null,En=0,ni=0,ma=null,ko=!1,gc=!1,gm=!1,Tl=0,Ui=0,El=0,zu=0,_m=0,Nr=0,Du=0,Ad=null,ka=null,ym=!1,Kf=0,Fg=0,zd=1/0,Sh=null,Cl=null,dr=0,Ml=null,Th=null,Bo=0,vm=0,Qf=null,Ng=null,Dd=0,xm=null;function Ba(){return(Kn&2)!==0&&En!==0?En&-En:Pe.T!==null?zm():Pi()}function jg(){if(Nr===0)if((En&536870912)===0||xn){var r=Ke;Ke<<=1,(Ke&3932160)===0&&(Ke=262144),Nr=r}else Nr=536870912;return r=Dt.current,r!==null&&(r.flags|=32),Nr}function Fa(r,o,h){(r===di&&(ni===2||ni===9)||r.cancelPendingCommit!==null)&&(Ch(r,0),_c(r,En,Nr,!1)),ei(r,h),((Kn&2)===0||r!==di)&&(r===di&&((Kn&2)===0&&(zu|=h),Ui===4&&_c(r,En,Nr,!1)),os(r))}function rr(r,o,h){if((Kn&6)!==0)throw Error(S(327));var _=!h&&(o&127)===0&&(o&r.expiredLanes)===0||Rn(r,o),M=_?Mh(r,o):tp(r,o,!0),D=_;do{if(M===0){gc&&!_&&_c(r,o,0,!1);break}else{if(h=r.current.alternate,D&&!my(h)){M=tp(r,o,!1),D=!1;continue}if(M===2){if(D=o,r.errorRecoveryDisabledLanes&D)var U=0;else U=r.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){o=U;e:{var ne=r;M=Ad;var Se=ne.current.memoizedState.isDehydrated;if(Se&&(Ch(ne,U).flags|=256),U=tp(ne,U,!1),U!==2){if(gm&&!Se){ne.errorRecoveryDisabledLanes|=D,zu|=D,M=4;break e}D=ka,ka=M,D!==null&&(ka===null?ka=D:ka.push.apply(ka,D))}M=U}if(D=!1,M!==2)continue}}if(M===1){Ch(r,0),_c(r,o,0,!0);break}e:{switch(_=r,D=M,D){case 0:case 1:throw Error(S(345));case 4:if((o&4194048)!==o)break;case 6:_c(_,o,Nr,!ko);break e;case 2:ka=null;break;case 3:case 5:break;default:throw Error(S(329))}if((o&62914560)===o&&(M=Kf+300-Hi(),10<M)){if(_c(_,o,Nr,!ko),Wt(_,0,!0)!==0)break e;Bo=o,_.timeoutHandle=yp(Eh.bind(null,_,h,ka,Sh,ym,o,Nr,zu,Du,ko,D,"Throttled",-0,0),M);break e}Eh(_,h,ka,Sh,ym,o,Nr,zu,Du,ko,D,null,-0,0)}}break}while(!0);os(r)}function Eh(r,o,h,_,M,D,U,ne,Se,Ze,at,dt,We,tt){if(r.timeoutHandle=-1,dt=o.subtreeFlags,dt&8192||(dt&16785408)===16785408){dt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Za},Lg(o,D,dt);var Gt=(D&62914560)===D?Kf-Hi():(D&4194048)===D?Fg-Hi():0;if(Gt=Wm(dt,Gt),Gt!==null){Bo=D,r.cancelPendingCommit=Gt($g.bind(null,r,o,D,h,_,M,U,ne,Se,at,dt,null,We,tt)),_c(r,D,U,!Ze);return}}$g(r,o,D,h,_,M,U,ne,Se)}function my(r){for(var o=r;;){var h=o.tag;if((h===0||h===11||h===15)&&o.flags&16384&&(h=o.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var _=0;_<h.length;_++){var M=h[_],D=M.getSnapshot;M=M.value;try{if(!Vr(D(),M))return!1}catch{return!1}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function _c(r,o,h,_){o&=~_m,o&=~zu,r.suspendedLanes|=o,r.pingedLanes&=~o,_&&(r.warmLanes|=o),_=r.expirationTimes;for(var M=o;0<M;){var D=31-Ie(M),U=1<<D;_[D]=-1,M&=~U}h!==0&&Xi(r,h,o)}function Pd(){return(Kn&6)===0?(ro(0),!1):!0}function Jf(){if(Tn!==null){if(ni===0)var r=Tn.return;else r=Tn,Eo=Ma=null,ts(r),Ao=null,hl=0,r=Tn;for(;r!==null;)qf(r.alternate,r),r=r.return;Tn=null}}function Ch(r,o){var h=r.timeoutHandle;h!==-1&&(r.timeoutHandle=-1,Bm(h)),h=r.cancelPendingCommit,h!==null&&(r.cancelPendingCommit=null,h()),Bo=0,Jf(),di=r,Tn=h=sa(r.current,null),En=o,ni=0,ma=null,ko=!1,gc=Rn(r,o),gm=!1,Du=Nr=_m=zu=El=Ui=0,ka=Ad=null,ym=!1,(o&8)!==0&&(o|=o&32);var _=r.entangledLanes;if(_!==0)for(r=r.entanglements,_&=o;0<_;){var M=31-Ie(_),D=1<<M;o|=r[M],_&=~D}return Tl=o,sl(),h}function bm(r,o){dn=null,Pe.H=kn,o===Ya||o===$r?(o=cc(),ni=3):o===Ps?(o=cc(),ni=4):ni=o===Of?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ma=o,Tn===null&&(Ui=1,no(r,Fr(o,r.current)))}function wm(){var r=Dt.current;return r===null?!0:(En&4194048)===En?Bt===null:(En&62914560)===En||(En&536870912)!==0?r===Bt:!1}function Pu(){var r=Pe.H;return Pe.H=kn,r===null?kn:r}function ep(){var r=Pe.A;return Pe.A=py,r}function Rd(){Ui=4,ko||(En&4194048)!==En&&Dt.current!==null||(gc=!0),(El&134217727)===0&&(zu&134217727)===0||di===null||_c(di,En,Nr,!1)}function tp(r,o,h){var _=Kn;Kn|=2;var M=Pu(),D=ep();(di!==r||En!==o)&&(Sh=null,Ch(r,o)),o=!1;var U=Ui;e:do try{if(ni!==0&&Tn!==null){var ne=Tn,Se=ma;switch(ni){case 8:Jf(),U=6;break e;case 3:case 2:case 9:case 6:Dt.current===null&&(o=!0);var Ze=ni;if(ni=0,ma=null,Ah(r,ne,Se,Ze),h&&gc){U=0;break e}break;default:Ze=ni,ni=0,ma=null,Ah(r,ne,Se,Ze)}}np(),U=Ui;break}catch(at){bm(r,at)}while(!0);return o&&r.shellSuspendCounter++,Eo=Ma=null,Kn=_,Pe.H=M,Pe.A=D,Tn===null&&(di=null,En=0,sl()),U}function np(){for(;Tn!==null;)Ug(Tn)}function Mh(r,o){var h=Kn;Kn|=2;var _=Pu(),M=ep();di!==r||En!==o?(Sh=null,zd=Hi()+500,Ch(r,o)):gc=Rn(r,o);e:do try{if(ni!==0&&Tn!==null){o=Tn;var D=ma;t:switch(ni){case 1:ni=0,ma=null,Ah(r,o,D,1);break;case 2:case 9:if(du(D)){ni=0,ma=null,Gg(o);break}o=function(){ni!==2&&ni!==9||di!==r||(ni=7),os(r)},D.then(o,o);break e;case 3:ni=7;break e;case 4:ni=5;break e;case 7:du(D)?(ni=0,ma=null,Gg(o)):(ni=0,ma=null,Ah(r,o,D,7));break;case 5:var U=null;switch(Tn.tag){case 26:U=Tn.memoizedState;case 5:case 27:var ne=Tn;if(U?Ud(U):ne.stateNode.complete){ni=0,ma=null;var Se=ne.sibling;if(Se!==null)Tn=Se;else{var Ze=ne.return;Ze!==null?(Tn=Ze,ip(Ze)):Tn=null}break t}}ni=0,ma=null,Ah(r,o,D,5);break;case 6:ni=0,ma=null,Ah(r,o,D,6);break;case 8:Jf(),Ui=6;break e;default:throw Error(S(462))}}Vg();break}catch(at){bm(r,at)}while(!0);return Eo=Ma=null,Pe.H=_,Pe.A=M,Kn=h,Tn!==null?0:(di=null,En=0,sl(),Ui)}function Vg(){for(;Tn!==null&&!Ga();)Ug(Tn)}function Ug(r){var o=Xr(r.alternate,r,Tl);r.memoizedProps=r.pendingProps,o===null?ip(r):Tn=o}function Gg(r){var o=r,h=o.alternate;switch(o.tag){case 15:case 0:o=Eg(h,o,o.pendingProps,o.type,void 0,En);break;case 11:o=Eg(h,o,o.pendingProps,o.type.render,o.ref,En);break;case 5:ts(o);default:qf(h,o),o=Tn=Df(o,Tl),o=Xr(h,o,Tl)}r.memoizedProps=r.pendingProps,o===null?ip(r):Tn=o}function Ah(r,o,h,_){Eo=Ma=null,ts(o),Ao=null,hl=0;var M=o.return;try{if(Lf(r,M,o,h,En)){Ui=1,no(r,Fr(h,r.current)),Tn=null;return}}catch(D){if(M!==null)throw Tn=M,D;Ui=1,no(r,Fr(h,r.current)),Tn=null;return}o.flags&32768?(xn||_===1?r=!0:gc||(En&536870912)!==0?r=!1:(ko=r=!0,(_===2||_===9||_===3||_===6)&&(_=Dt.current,_!==null&&_.tag===13&&(_.flags|=16384))),qg(o,r)):ip(o)}function ip(r){var o=r;do{if((o.flags&32768)!==0){qg(o,ko);return}r=o.return;var h=zg(o.alternate,o,Tl);if(h!==null){Tn=h;return}if(o=o.sibling,o!==null){Tn=o;return}Tn=o=r}while(o!==null);Ui===0&&(Ui=5)}function qg(r,o){do{var h=dy(r.alternate,r);if(h!==null){h.flags&=32767,Tn=h;return}if(h=r.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!o&&(r=r.sibling,r!==null)){Tn=r;return}Tn=r=h}while(r!==null);Ui=6,Tn=null}function $g(r,o,h,_,M,D,U,ne,Se){r.cancelPendingCommit=null;do rp();while(dr!==0);if((Kn&6)!==0)throw Error(S(327));if(o!==null){if(o===r.current)throw Error(S(177));if(D=o.lanes|o.childLanes,D|=ol,ti(r,h,D,U,ne,Se),r===di&&(Tn=di=null,En=0),Th=o,Ml=r,Bo=h,vm=D,Qf=M,Ng=_,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Kg(qa,function(){return Wg(),null})):(r.callbackNode=null,r.callbackPriority=0),_=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||_){_=Pe.T,Pe.T=null,M=Xe.p,Xe.p=2,U=Kn,Kn|=4;try{fy(r,o,h)}finally{Kn=U,Xe.p=M,Pe.T=_}}dr=1,Zg(),Hg(),Xg()}}function Zg(){if(dr===1){dr=0;var r=Ml,o=Th,h=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||h){h=Pe.T,Pe.T=null;var _=Xe.p;Xe.p=2;var M=Kn;Kn|=4;try{Xf(o,r);var D=Om,U=Wu(r.containerInfo),ne=D.focusedElem,Se=D.selectionRange;if(U!==ne&&ne&&ne.ownerDocument&&Yu(ne.ownerDocument.documentElement,ne)){if(Se!==null&&nu(ne)){var Ze=Se.start,at=Se.end;if(at===void 0&&(at=Ze),"selectionStart"in ne)ne.selectionStart=Ze,ne.selectionEnd=Math.min(at,ne.value.length);else{var dt=ne.ownerDocument||document,We=dt&&dt.defaultView||window;if(We.getSelection){var tt=We.getSelection(),Gt=ne.textContent.length,Jt=Math.min(Se.start,Gt),ii=Se.end===void 0?Jt:Math.min(Se.end,Gt);!tt.extend&&Jt>ii&&(U=ii,ii=Jt,Jt=U);var Oe=tu(ne,Jt),ze=tu(ne,ii);if(Oe&&ze&&(tt.rangeCount!==1||tt.anchorNode!==Oe.node||tt.anchorOffset!==Oe.offset||tt.focusNode!==ze.node||tt.focusOffset!==ze.offset)){var qe=dt.createRange();qe.setStart(Oe.node,Oe.offset),tt.removeAllRanges(),Jt>ii?(tt.addRange(qe),tt.extend(ze.node,ze.offset)):(qe.setEnd(ze.node,ze.offset),tt.addRange(qe))}}}}for(dt=[],tt=ne;tt=tt.parentNode;)tt.nodeType===1&&dt.push({element:tt,left:tt.scrollLeft,top:tt.scrollTop});for(typeof ne.focus=="function"&&ne.focus(),ne=0;ne<dt.length;ne++){var ut=dt[ne];ut.element.scrollLeft=ut.left,ut.element.scrollTop=ut.top}}Hd=!!Bd,Om=Bd=null}finally{Kn=M,Xe.p=_,Pe.T=h}}r.current=o,dr=2}}function Hg(){if(dr===2){dr=0;var r=Ml,o=Th,h=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||h){h=Pe.T,Pe.T=null;var _=Xe.p;Xe.p=2;var M=Kn;Kn|=4;try{fm(r,o.alternate,o)}finally{Kn=M,Xe.p=_,Pe.T=h}}dr=3}}function Xg(){if(dr===4||dr===3){dr=0,jo();var r=Ml,o=Th,h=Bo,_=Ng;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?dr=5:(dr=0,Th=Ml=null,Yg(r,r.pendingLanes));var M=r.pendingLanes;if(M===0&&(Cl=null),ot(h),o=o.stateNode,me&&typeof me.onCommitFiberRoot=="function")try{me.onCommitFiberRoot(K,o,void 0,(o.current.flags&128)===128)}catch{}if(_!==null){o=Pe.T,M=Xe.p,Xe.p=2,Pe.T=null;try{for(var D=r.onRecoverableError,U=0;U<_.length;U++){var ne=_[U];D(ne.value,{componentStack:ne.stack})}}finally{Pe.T=o,Xe.p=M}}(Bo&3)!==0&&rp(),os(r),M=r.pendingLanes,(h&261930)!==0&&(M&42)!==0?r===xm?Dd++:(Dd=0,xm=r):Dd=0,ro(0)}}function Yg(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,sc(o)))}function rp(){return Zg(),Hg(),Xg(),Wg()}function Wg(){if(dr!==5)return!1;var r=Ml,o=vm;vm=0;var h=ot(Bo),_=Pe.T,M=Xe.p;try{Xe.p=32>h?32:h,Pe.T=null,h=Qf,Qf=null;var D=Ml,U=Bo;if(dr=0,Th=Ml=null,Bo=0,(Kn&6)!==0)throw Error(S(331));var ne=Kn;if(Kn|=4,kg(D.current),mm(D,D.current,U,h),Kn=ne,ro(0,!1),me&&typeof me.onPostCommitFiberRoot=="function")try{me.onPostCommitFiberRoot(K,D)}catch{}return!0}finally{Xe.p=M,Pe.T=_,Yg(r,o)}}function Sm(r,o,h){o=Fr(h,o),o=Su(r.stateNode,o,2),r=Ko(r,o,2),r!==null&&(ei(r,2),os(r))}function Qn(r,o,h){if(r.tag===3)Sm(r,r,h);else for(;o!==null;){if(o.tag===3){Sm(o,r,h);break}else if(o.tag===1){var _=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Cl===null||!Cl.has(_))){r=Fr(h,r),h=Tu(2),_=Ko(o,h,2),_!==null&&(Eu(h,_,o,r),ei(_,2),os(_));break}}o=o.return}}function ap(r,o,h){var _=r.pingCache;if(_===null){_=r.pingCache=new Bg;var M=new Set;_.set(o,M)}else M=_.get(o),M===void 0&&(M=new Set,_.set(o,M));M.has(h)||(gm=!0,M.add(h),r=yc.bind(null,r,o,h),o.then(r,r))}function yc(r,o,h){var _=r.pingCache;_!==null&&_.delete(o),r.pingedLanes|=r.suspendedLanes&h,r.warmLanes&=~h,di===r&&(En&h)===h&&(Ui===4||Ui===3&&(En&62914560)===En&&300>Hi()-Kf?(Kn&2)===0&&Ch(r,0):_m|=h,Du===En&&(Du=0)),os(r)}function Id(r,o){o===0&&(o=jt()),r=Ca(r,o),r!==null&&(ei(r,o),os(r))}function Tm(r){var o=r.memoizedState,h=0;o!==null&&(h=o.retryLane),Id(r,h)}function gy(r,o){var h=0;switch(r.tag){case 31:case 13:var _=r.stateNode,M=r.memoizedState;M!==null&&(h=M.retryLane);break;case 19:_=r.stateNode;break;case 22:_=r.stateNode._retryCache;break;default:throw Error(S(314))}_!==null&&_.delete(o),Id(r,h)}function Kg(r,o){return va(r,o)}var op=null,zh=null,Em=!1,sp=!1,Cm=!1,Al=0;function os(r){r!==zh&&r.next===null&&(zh===null?op=zh=r:zh=zh.next=r),sp=!0,Em||(Em=!0,Am())}function ro(r,o){if(!Cm&&sp){Cm=!0;do for(var h=!1,_=op;_!==null;){if(r!==0){var M=_.pendingLanes;if(M===0)var D=0;else{var U=_.suspendedLanes,ne=_.pingedLanes;D=(1<<31-Ie(42|r)+1)-1,D&=M&~(U&~ne),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(h=!0,Ld(_,D))}else D=En,D=Wt(_,_===di?D:0,_.cancelPendingCommit!==null||_.timeoutHandle!==-1),(D&3)===0||Rn(_,D)||(h=!0,Ld(_,D));_=_.next}while(h);Cm=!1}}function vc(){Mm()}function Mm(){sp=Em=!1;var r=0;Al!==0&&_p()&&(r=Al);for(var o=Hi(),h=null,_=op;_!==null;){var M=_.next,D=lp(_,o);D===0?(_.next=null,h===null?op=M:h.next=M,M===null&&(zh=h)):(h=_,(r!==0||(D&3)!==0)&&(sp=!0)),_=M}dr!==0&&dr!==5||ro(r),Al!==0&&(Al=0)}function lp(r,o){for(var h=r.suspendedLanes,_=r.pingedLanes,M=r.expirationTimes,D=r.pendingLanes&-62914561;0<D;){var U=31-Ie(D),ne=1<<U,Se=M[U];Se===-1?((ne&h)===0||(ne&_)!==0)&&(M[U]=kt(ne,o)):Se<=o&&(r.expiredLanes|=ne),D&=~ne}if(o=di,h=En,h=Wt(r,r===o?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),_=r.callbackNode,h===0||r===o&&(ni===2||ni===9)||r.cancelPendingCommit!==null)return _!==null&&_!==null&&zr(_),r.callbackNode=null,r.callbackPriority=0;if((h&3)===0||Rn(r,h)){if(o=h&-h,o===r.callbackPriority)return o;switch(_!==null&&zr(_),ot(h)){case 2:case 8:h=xi;break;case 32:h=qa;break;case 268435456:h=De;break;default:h=qa}return _=Qg.bind(null,r),h=va(h,_),r.callbackPriority=o,r.callbackNode=h,o}return _!==null&&_!==null&&zr(_),r.callbackPriority=2,r.callbackNode=null,2}function Qg(r,o){if(dr!==0&&dr!==5)return r.callbackNode=null,r.callbackPriority=0,null;var h=r.callbackNode;if(rp()&&r.callbackNode!==h)return null;var _=En;return _=Wt(r,r===di?_:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),_===0?null:(rr(r,_,o),lp(r,Hi()),r.callbackNode!=null&&r.callbackNode===h?Qg.bind(null,r):null)}function Ld(r,o){if(rp())return null;rr(r,o,!0)}function Am(){Nm(function(){(Kn&6)!==0?va(xa,vc):Mm()})}function zm(){if(Al===0){var r=ul;r===0&&(r=lt,lt<<=1,(lt&261888)===0&&(lt=256)),Al=r}return Al}function cp(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:sn(""+r)}function up(r,o){var h=o.ownerDocument.createElement("input");return h.name=o.name,h.value=o.value,r.id&&h.setAttribute("form",r.id),o.parentNode.insertBefore(h,o),r=new FormData(r),h.parentNode.removeChild(h),r}function Dh(r,o,h,_,M){if(o==="submit"&&h&&h.stateNode===M){var D=cp((M[gt]||null).action),U=_.submitter;U&&(o=(o=U[gt]||null)?cp(o.formAction):U.getAttribute("formAction"),o!==null&&(D=o,U=null));var ne=new qc("action","action",null,_,M);r.push({event:ne,listeners:[{instance:null,listener:function(){if(_.defaultPrevented){if(Al!==0){var Se=U?up(M,U):new FormData(M);Ei(h,{pending:!0,data:Se,method:M.method,action:D},null,Se)}}else typeof D=="function"&&(ne.preventDefault(),Se=U?up(M,U):new FormData(M),Ei(h,{pending:!0,data:Se,method:M.method,action:D},D,Se))},currentTarget:M}]})}}for(var hp=0;hp<eh.length;hp++){var dp=eh[hp],Dm=dp.toLowerCase(),Jg=dp[0].toUpperCase()+dp.slice(1);aa(Dm,"on"+Jg)}aa(au,"onAnimationEnd"),aa(ou,"onAnimationIteration"),aa(Ju,"onAnimationStart"),aa("dblclick","onDoubleClick"),aa("focusin","onFocus"),aa("focusout","onBlur"),aa(al,"onTransitionRun"),aa(su,"onTransitionStart"),aa(nc,"onTransitionCancel"),aa(ra,"onTransitionEnd"),Uo("onMouseEnter",["mouseout","mouseover"]),Uo("onMouseLeave",["mouseout","mouseover"]),Uo("onPointerEnter",["pointerout","pointerover"]),Uo("onPointerLeave",["pointerout","pointerover"]),bn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bn("onBeforeInput",["compositionend","keypress","textInput","paste"]),bn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),e_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xc));function t_(r,o){o=(o&4)!==0;for(var h=0;h<r.length;h++){var _=r[h],M=_.event;_=_.listeners;e:{var D=void 0;if(o)for(var U=_.length-1;0<=U;U--){var ne=_[U],Se=ne.instance,Ze=ne.currentTarget;if(ne=ne.listener,Se!==D&&M.isPropagationStopped())break e;D=ne,M.currentTarget=Ze;try{D(M)}catch(at){vo(at)}M.currentTarget=null,D=Se}else for(U=0;U<_.length;U++){if(ne=_[U],Se=ne.instance,Ze=ne.currentTarget,ne=ne.listener,Se!==D&&M.isPropagationStopped())break e;D=ne,M.currentTarget=Ze;try{D(M)}catch(at){vo(at)}M.currentTarget=null,D=Se}}}}function Cn(r,o){var h=o[cn];h===void 0&&(h=o[cn]=new Set);var _=r+"__bubble";h.has(_)||(pp(o,r,2,!1),h.add(_))}function Pm(r,o,h){var _=0;o&&(_|=4),pp(h,r,_,o)}var fp="_reactListening"+Math.random().toString(36).slice(2);function Rm(r){if(!r[fp]){r[fp]=!0,Gl.forEach(function(h){h!=="selectionchange"&&(e_.has(h)||Pm(h,!1,r),Pm(h,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[fp]||(o[fp]=!0,Pm("selectionchange",!1,o))}}function pp(r,o,h,_){switch(Lu(o)){case 2:var M=Xd;break;case 8:M=m_;break;default:M=Qm}h=M.bind(null,o,h,r),M=void 0,!Ir||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(M=!0),_?M!==void 0?r.addEventListener(o,h,{capture:!0,passive:M}):r.addEventListener(o,h,!0):M!==void 0?r.addEventListener(o,h,{passive:M}):r.addEventListener(o,h,!1)}function js(r,o,h,_,M){var D=_;if((o&1)===0&&(o&2)===0&&_!==null)e:for(;;){if(_===null)return;var U=_.tag;if(U===3||U===4){var ne=_.stateNode.containerInfo;if(ne===M)break;if(U===4)for(U=_.return;U!==null;){var Se=U.tag;if((Se===3||Se===4)&&U.stateNode.containerInfo===M)return;U=U.return}for(;ne!==null;){if(U=ho(ne),U===null)return;if(Se=U.tag,Se===5||Se===6||Se===26||Se===27){_=D=U;continue e}ne=ne.parentNode}}_=_.return}Hn(function(){var Ze=D,at=Gc(h),dt=[];e:{var We=id.get(r);if(We!==void 0){var tt=qc,Gt=r;switch(r){case"keypress":if(ia(h)===0)break e;case"keydown":case"keyup":tt=Si;break;case"focusin":Gt="focus",tt=vs;break;case"focusout":Gt="blur",tt=vs;break;case"beforeblur":case"afterblur":tt=vs;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=el;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=$c;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=tm;break;case au:case ou:case Ju:tt=yf;break;case ra:tt=$u;break;case"scroll":case"scrollend":tt=Js;break;case"wheel":tt=Qh;break;case"copy":case"cut":case"paste":tt=Wh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=qu;break;case"toggle":case"beforetoggle":tt=Wl}var Jt=(o&4)!==0,ii=!Jt&&(r==="scroll"||r==="scrollend"),Oe=Jt?We!==null?We+"Capture":null:We;Jt=[];for(var ze=Ze,qe;ze!==null;){var ut=ze;if(qe=ut.stateNode,ut=ut.tag,ut!==5&&ut!==26&&ut!==27||qe===null||Oe===null||(ut=wa(ze,Oe),ut!=null&&Jt.push(Ph(ze,ut,qe))),ii)break;ze=ze.return}0<Jt.length&&(We=new tt(We,Gt,null,h,at),dt.push({event:We,listeners:Jt}))}}if((o&7)===0){e:{if(We=r==="mouseover"||r==="pointerover",tt=r==="mouseout"||r==="pointerout",We&&h!==Yh&&(Gt=h.relatedTarget||h.fromElement)&&(ho(Gt)||Gt[Qt]))break e;if((tt||We)&&(We=at.window===at?at:(We=at.ownerDocument)?We.defaultView||We.parentWindow:window,tt?(Gt=h.relatedTarget||h.toElement,tt=Ze,Gt=Gt?ho(Gt):null,Gt!==null&&(ii=I(Gt),Jt=Gt.tag,Gt!==ii||Jt!==5&&Jt!==27&&Jt!==6)&&(Gt=null)):(tt=null,Gt=Ze),tt!==Gt)){if(Jt=el,ut="onMouseLeave",Oe="onMouseEnter",ze="mouse",(r==="pointerout"||r==="pointerover")&&(Jt=qu,ut="onPointerLeave",Oe="onPointerEnter",ze="pointer"),ii=tt==null?We:fo(tt),qe=Gt==null?We:fo(Gt),We=new Jt(ut,ze+"leave",tt,h,at),We.target=ii,We.relatedTarget=qe,ut=null,ho(at)===Ze&&(Jt=new Jt(Oe,ze+"enter",Gt,h,at),Jt.target=qe,Jt.relatedTarget=ii,ut=Jt),ii=ut,tt&&Gt)t:{for(Jt=n_,Oe=tt,ze=Gt,qe=0,ut=Oe;ut;ut=Jt(ut))qe++;ut=0;for(var Kt=ze;Kt;Kt=Jt(Kt))ut++;for(;0<qe-ut;)Oe=Jt(Oe),qe--;for(;0<ut-qe;)ze=Jt(ze),ut--;for(;qe--;){if(Oe===ze||ze!==null&&Oe===ze.alternate){Jt=Oe;break t}Oe=Jt(Oe),ze=Jt(ze)}Jt=null}else Jt=null;tt!==null&&Im(dt,We,tt,Jt,!1),Gt!==null&&ii!==null&&Im(dt,ii,Gt,Jt,!0)}}e:{if(We=Ze?fo(Ze):window,tt=We.nodeName&&We.nodeName.toLowerCase(),tt==="select"||tt==="input"&&We.type==="file")var Gn=ws;else if(Hu(We))if(Jh)Gn=Af;else{Gn=Mf;var qt=nm}else tt=We.nodeName,!tt||tt.toLowerCase()!=="input"||We.type!=="checkbox"&&We.type!=="radio"?Ze&&Ws(Ze.elementType)&&(Gn=ws):Gn=eu;if(Gn&&(Gn=Gn(r,Ze))){Xu(dt,Gn,h,at);break e}qt&&qt(r,We,Ze),r==="focusout"&&Ze&&We.type==="number"&&Ze.memoizedProps.value!=null&&Uc(We,"number",We.value)}switch(qt=Ze?fo(Ze):window,r){case"focusin":(Hu(qt)||qt.contentEditable==="true")&&(Ea=qt,iu=Ze,ru=null);break;case"focusout":ru=iu=Ea=null;break;case"mousedown":Qu=!0;break;case"contextmenu":case"mouseup":case"dragend":Qu=!1,zf(dt,h,at);break;case"selectionchange":if(Ku)break;case"keydown":case"keyup":zf(dt,h,at)}var Xt;if(Ri)e:{switch(r){case"compositionstart":var Sn="onCompositionStart";break e;case"compositionend":Sn="onCompositionEnd";break e;case"compositionupdate":Sn="onCompositionUpdate";break e}Sn=void 0}else Ha?Wc(r,h)&&(Sn="onCompositionEnd"):r==="keydown"&&h.keyCode===229&&(Sn="onCompositionStart");Sn&&(ec&&h.locale!=="ko"&&(Ha||Sn!=="onCompositionStart"?Sn==="onCompositionEnd"&&Ha&&(Xt=_s()):(na=at,go="value"in na?na.value:na.textContent,Ha=!0)),qt=Od(Ze,Sn),0<qt.length&&(Sn=new Kh(Sn,r,null,h,at),dt.push({event:Sn,listeners:qt}),Xt?Sn.data=Xt:(Xt=wf(h),Xt!==null&&(Sn.data=Xt)))),(Xt=Jl?Zu(r,h):Sf(r,h))&&(Sn=Od(Ze,"onBeforeInput"),0<Sn.length&&(qt=new Kh("onBeforeInput","beforeinput",null,h,at),dt.push({event:qt,listeners:Sn}),qt.data=Xt)),Dh(dt,r,Ze,h,at)}t_(dt,o)})}function Ph(r,o,h){return{instance:r,listener:o,currentTarget:h}}function Od(r,o){for(var h=o+"Capture",_=[];r!==null;){var M=r,D=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||D===null||(M=wa(r,h),M!=null&&_.unshift(Ph(r,M,D)),M=wa(r,o),M!=null&&_.push(Ph(r,M,D))),r.tag===3)return _;r=r.return}return[]}function n_(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Im(r,o,h,_,M){for(var D=o._reactName,U=[];h!==null&&h!==_;){var ne=h,Se=ne.alternate,Ze=ne.stateNode;if(ne=ne.tag,Se!==null&&Se===_)break;ne!==5&&ne!==26&&ne!==27||Ze===null||(Se=Ze,M?(Ze=wa(h,D),Ze!=null&&U.unshift(Ph(h,Ze,Se))):M||(Ze=wa(h,D),Ze!=null&&U.push(Ph(h,Ze,Se)))),h=h.return}U.length!==0&&r.push({event:o,listeners:U})}var i_=/\r\n?/g,r_=/\u0000|\uFFFD/g;function kd(r){return(typeof r=="string"?r:""+r).replace(i_,`
`).replace(r_,"")}function Lm(r,o){return o=kd(o),kd(r)===o}function Un(r,o,h,_,M,D){switch(h){case"children":typeof _=="string"?o==="body"||o==="textarea"&&_===""||Go(r,_):(typeof _=="number"||typeof _=="bigint")&&o!=="body"&&Go(r,""+_);break;case"className":mo(r,"class",_);break;case"tabIndex":mo(r,"tabindex",_);break;case"dir":case"role":case"viewBox":case"width":case"height":mo(r,h,_);break;case"style":Gu(r,_,D);break;case"data":if(o!=="object"){mo(r,"data",_);break}case"src":case"href":if(_===""&&(o!=="a"||h!=="href")){r.removeAttribute(h);break}if(_==null||typeof _=="function"||typeof _=="symbol"||typeof _=="boolean"){r.removeAttribute(h);break}_=sn(""+_),r.setAttribute(h,_);break;case"action":case"formAction":if(typeof _=="function"){r.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(h==="formAction"?(o!=="input"&&Un(r,o,"name",M.name,M,null),Un(r,o,"formEncType",M.formEncType,M,null),Un(r,o,"formMethod",M.formMethod,M,null),Un(r,o,"formTarget",M.formTarget,M,null)):(Un(r,o,"encType",M.encType,M,null),Un(r,o,"method",M.method,M,null),Un(r,o,"target",M.target,M,null)));if(_==null||typeof _=="symbol"||typeof _=="boolean"){r.removeAttribute(h);break}_=sn(""+_),r.setAttribute(h,_);break;case"onClick":_!=null&&(r.onclick=Za);break;case"onScroll":_!=null&&Cn("scroll",r);break;case"onScrollEnd":_!=null&&Cn("scrollend",r);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(S(61));if(h=_.__html,h!=null){if(M.children!=null)throw Error(S(60));r.innerHTML=h}}break;case"multiple":r.multiple=_&&typeof _!="function"&&typeof _!="symbol";break;case"muted":r.muted=_&&typeof _!="function"&&typeof _!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(_==null||typeof _=="function"||typeof _=="boolean"||typeof _=="symbol"){r.removeAttribute("xlink:href");break}h=sn(""+_),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":_!=null&&typeof _!="function"&&typeof _!="symbol"?r.setAttribute(h,""+_):r.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":_&&typeof _!="function"&&typeof _!="symbol"?r.setAttribute(h,""):r.removeAttribute(h);break;case"capture":case"download":_===!0?r.setAttribute(h,""):_!==!1&&_!=null&&typeof _!="function"&&typeof _!="symbol"?r.setAttribute(h,_):r.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":_!=null&&typeof _!="function"&&typeof _!="symbol"&&!isNaN(_)&&1<=_?r.setAttribute(h,_):r.removeAttribute(h);break;case"rowSpan":case"start":_==null||typeof _=="function"||typeof _=="symbol"||isNaN(_)?r.removeAttribute(h):r.setAttribute(h,_);break;case"popover":Cn("beforetoggle",r),Cn("toggle",r),Nc(r,"popover",_);break;case"xlinkActuate":ba(r,"http://www.w3.org/1999/xlink","xlink:actuate",_);break;case"xlinkArcrole":ba(r,"http://www.w3.org/1999/xlink","xlink:arcrole",_);break;case"xlinkRole":ba(r,"http://www.w3.org/1999/xlink","xlink:role",_);break;case"xlinkShow":ba(r,"http://www.w3.org/1999/xlink","xlink:show",_);break;case"xlinkTitle":ba(r,"http://www.w3.org/1999/xlink","xlink:title",_);break;case"xlinkType":ba(r,"http://www.w3.org/1999/xlink","xlink:type",_);break;case"xmlBase":ba(r,"http://www.w3.org/XML/1998/namespace","xml:base",_);break;case"xmlLang":ba(r,"http://www.w3.org/XML/1998/namespace","xml:lang",_);break;case"xmlSpace":ba(r,"http://www.w3.org/XML/1998/namespace","xml:space",_);break;case"is":Nc(r,"is",_);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=gs.get(h)||h,Nc(r,h,_))}}function mp(r,o,h,_,M,D){switch(h){case"style":Gu(r,_,D);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(S(61));if(h=_.__html,h!=null){if(M.children!=null)throw Error(S(60));r.innerHTML=h}}break;case"children":typeof _=="string"?Go(r,_):(typeof _=="number"||typeof _=="bigint")&&Go(r,""+_);break;case"onScroll":_!=null&&Cn("scroll",r);break;case"onScrollEnd":_!=null&&Cn("scrollend",r);break;case"onClick":_!=null&&(r.onclick=Za);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!br.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(M=h.endsWith("Capture"),o=h.slice(2,M?h.length-7:void 0),D=r[gt]||null,D=D!=null?D[h]:null,typeof D=="function"&&r.removeEventListener(o,D,M),typeof _=="function")){typeof D!="function"&&D!==null&&(h in r?r[h]=null:r.hasAttribute(h)&&r.removeAttribute(h)),r.addEventListener(o,_,M);break e}h in r?r[h]=_:_===!0?r.setAttribute(h,""):Nc(r,h,_)}}}function xr(r,o,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Cn("error",r),Cn("load",r);var _=!1,M=!1,D;for(D in h)if(h.hasOwnProperty(D)){var U=h[D];if(U!=null)switch(D){case"src":_=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(S(137,o));default:Un(r,o,D,U,h,null)}}M&&Un(r,o,"srcSet",h.srcSet,h,null),_&&Un(r,o,"src",h.src,h,null);return;case"input":Cn("invalid",r);var ne=D=U=M=null,Se=null,Ze=null;for(_ in h)if(h.hasOwnProperty(_)){var at=h[_];if(at!=null)switch(_){case"name":M=at;break;case"type":U=at;break;case"checked":Se=at;break;case"defaultChecked":Ze=at;break;case"value":D=at;break;case"defaultValue":ne=at;break;case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(S(137,o));break;default:Un(r,o,_,at,h,null)}}Uu(r,D,ne,Se,Ze,U,M,!1);return;case"select":Cn("invalid",r),_=U=D=null;for(M in h)if(h.hasOwnProperty(M)&&(ne=h[M],ne!=null))switch(M){case"value":D=ne;break;case"defaultValue":U=ne;break;case"multiple":_=ne;default:Un(r,o,M,ne,h,null)}o=D,h=U,r.multiple=!!_,o!=null?ms(r,!!_,o,!1):h!=null&&ms(r,!!_,h,!0);return;case"textarea":Cn("invalid",r),D=M=_=null;for(U in h)if(h.hasOwnProperty(U)&&(ne=h[U],ne!=null))switch(U){case"value":_=ne;break;case"defaultValue":M=ne;break;case"children":D=ne;break;case"dangerouslySetInnerHTML":if(ne!=null)throw Error(S(91));break;default:Un(r,o,U,ne,h,null)}Zl(r,_,M,D);return;case"option":for(Se in h)h.hasOwnProperty(Se)&&(_=h[Se],_!=null)&&(Se==="selected"?r.selected=_&&typeof _!="function"&&typeof _!="symbol":Un(r,o,Se,_,h,null));return;case"dialog":Cn("beforetoggle",r),Cn("toggle",r),Cn("cancel",r),Cn("close",r);break;case"iframe":case"object":Cn("load",r);break;case"video":case"audio":for(_=0;_<xc.length;_++)Cn(xc[_],r);break;case"image":Cn("error",r),Cn("load",r);break;case"details":Cn("toggle",r);break;case"embed":case"source":case"link":Cn("error",r),Cn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ze in h)if(h.hasOwnProperty(Ze)&&(_=h[Ze],_!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":throw Error(S(137,o));default:Un(r,o,Ze,_,h,null)}return;default:if(Ws(o)){for(at in h)h.hasOwnProperty(at)&&(_=h[at],_!==void 0&&mp(r,o,at,_,h,void 0));return}}for(ne in h)h.hasOwnProperty(ne)&&(_=h[ne],_!=null&&Un(r,o,ne,_,h,null))}function a_(r,o,h,_){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,D=null,U=null,ne=null,Se=null,Ze=null,at=null;for(tt in h){var dt=h[tt];if(h.hasOwnProperty(tt)&&dt!=null)switch(tt){case"checked":break;case"value":break;case"defaultValue":Se=dt;default:_.hasOwnProperty(tt)||Un(r,o,tt,null,_,dt)}}for(var We in _){var tt=_[We];if(dt=h[We],_.hasOwnProperty(We)&&(tt!=null||dt!=null))switch(We){case"type":D=tt;break;case"name":M=tt;break;case"checked":Ze=tt;break;case"defaultChecked":at=tt;break;case"value":U=tt;break;case"defaultValue":ne=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(S(137,o));break;default:tt!==dt&&Un(r,o,We,tt,_,dt)}}Vc(r,U,ne,Se,Ze,at,D,M);return;case"select":tt=U=ne=We=null;for(D in h)if(Se=h[D],h.hasOwnProperty(D)&&Se!=null)switch(D){case"value":break;case"multiple":tt=Se;default:_.hasOwnProperty(D)||Un(r,o,D,null,_,Se)}for(M in _)if(D=_[M],Se=h[M],_.hasOwnProperty(M)&&(D!=null||Se!=null))switch(M){case"value":We=D;break;case"defaultValue":ne=D;break;case"multiple":U=D;default:D!==Se&&Un(r,o,M,D,_,Se)}o=ne,h=U,_=tt,We!=null?ms(r,!!h,We,!1):!!_!=!!h&&(o!=null?ms(r,!!h,o,!0):ms(r,!!h,h?[]:"",!1));return;case"textarea":tt=We=null;for(ne in h)if(M=h[ne],h.hasOwnProperty(ne)&&M!=null&&!_.hasOwnProperty(ne))switch(ne){case"value":break;case"children":break;default:Un(r,o,ne,null,_,M)}for(U in _)if(M=_[U],D=h[U],_.hasOwnProperty(U)&&(M!=null||D!=null))switch(U){case"value":We=M;break;case"defaultValue":tt=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(S(91));break;default:M!==D&&Un(r,o,U,M,_,D)}gf(r,We,tt);return;case"option":for(var Gt in h)We=h[Gt],h.hasOwnProperty(Gt)&&We!=null&&!_.hasOwnProperty(Gt)&&(Gt==="selected"?r.selected=!1:Un(r,o,Gt,null,_,We));for(Se in _)We=_[Se],tt=h[Se],_.hasOwnProperty(Se)&&We!==tt&&(We!=null||tt!=null)&&(Se==="selected"?r.selected=We&&typeof We!="function"&&typeof We!="symbol":Un(r,o,Se,We,_,tt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Jt in h)We=h[Jt],h.hasOwnProperty(Jt)&&We!=null&&!_.hasOwnProperty(Jt)&&Un(r,o,Jt,null,_,We);for(Ze in _)if(We=_[Ze],tt=h[Ze],_.hasOwnProperty(Ze)&&We!==tt&&(We!=null||tt!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(S(137,o));break;default:Un(r,o,Ze,We,_,tt)}return;default:if(Ws(o)){for(var ii in h)We=h[ii],h.hasOwnProperty(ii)&&We!==void 0&&!_.hasOwnProperty(ii)&&mp(r,o,ii,void 0,_,We);for(at in _)We=_[at],tt=h[at],!_.hasOwnProperty(at)||We===tt||We===void 0&&tt===void 0||mp(r,o,at,We,_,tt);return}}for(var Oe in h)We=h[Oe],h.hasOwnProperty(Oe)&&We!=null&&!_.hasOwnProperty(Oe)&&Un(r,o,Oe,null,_,We);for(dt in _)We=_[dt],tt=h[dt],!_.hasOwnProperty(dt)||We===tt||We==null&&tt==null||Un(r,o,dt,We,_,tt)}function Na(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Rh(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,h=performance.getEntriesByType("resource"),_=0;_<h.length;_++){var M=h[_],D=M.transferSize,U=M.initiatorType,ne=M.duration;if(D&&ne&&Na(U)){for(U=0,ne=M.responseEnd,_+=1;_<h.length;_++){var Se=h[_],Ze=Se.startTime;if(Ze>ne)break;var at=Se.transferSize,dt=Se.initiatorType;at&&Na(dt)&&(Se=Se.responseEnd,U+=at*(Se<ne?1:(ne-Ze)/(Se-Ze)))}if(--_,o+=8*(D+U)/(M.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Bd=null,Om=null;function Fd(r){return r.nodeType===9?r:r.ownerDocument}function bc(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function km(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function gp(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var wc=null;function _p(){var r=window.event;return r&&r.type==="popstate"?r===wc?!1:(wc=r,!0):(wc=null,!1)}var yp=typeof setTimeout=="function"?setTimeout:void 0,Bm=typeof clearTimeout=="function"?clearTimeout:void 0,Fm=typeof Promise=="function"?Promise:void 0,Nm=typeof queueMicrotask=="function"?queueMicrotask:typeof Fm<"u"?function(r){return Fm.resolve(null).then(r).catch(jm)}:yp;function jm(r){setTimeout(function(){throw r})}function Sc(r){return r==="head"}function o_(r,o){var h=o,_=0;do{var M=h.nextSibling;if(r.removeChild(h),M&&M.nodeType===8)if(h=M.data,h==="/$"||h==="/&"){if(_===0){r.removeChild(M),zc(o);return}_--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")_++;else if(h==="html")Ih(r.ownerDocument.documentElement);else if(h==="head"){h=r.ownerDocument.head,Ih(h);for(var D=h.firstChild;D;){var U=D.nextSibling,ne=D.nodeName;D[nn]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&D.rel.toLowerCase()==="stylesheet"||h.removeChild(D),D=U}}else h==="body"&&Ih(r.ownerDocument.body);h=M}while(h);zc(o)}function mn(r,o){var h=r;r=0;do{var _=h.nextSibling;if(h.nodeType===1?o?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(o?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(r===0)break;r--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||r++;h=_}while(h)}function ss(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var h=o;switch(o=o.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":ss(h),Hs(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}r.removeChild(h)}}function Tr(r,o,h,_){for(;r.nodeType===1;){var M=h;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!_&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(_){if(!r[nn])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(D=r.getAttribute("rel"),D==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(D!==M.rel||r.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||r.getAttribute("title")!==(M.title==null?null:M.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(D=r.getAttribute("src"),(D!==(M.src==null?null:M.src)||r.getAttribute("type")!==(M.type==null?null:M.type)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&D&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var D=M.name==null?null:""+M.name;if(M.type==="hidden"&&r.getAttribute("name")===D)return r}else return r;if(r=ao(r.nextSibling),r===null)break}return null}function ls(r,o,h){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!h||(r=ao(r.nextSibling),r===null))return null;return r}function Tc(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=ao(r.nextSibling),r===null))return null;return r}function Yr(r){return r.data==="$?"||r.data==="$~"}function Qi(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function fr(r,o){var h=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||h.readyState!=="loading")o();else{var _=function(){o(),h.removeEventListener("DOMContentLoaded",_)};h.addEventListener("DOMContentLoaded",_),r._reactRetry=_}}function ao(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var ga=null;function pr(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var h=r.data;if(h==="/$"||h==="/&"){if(o===0)return ao(r.nextSibling);o--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||o++}r=r.nextSibling}return null}function Nd(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var h=r.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(o===0)return r;o--}else h!=="/$"&&h!=="/&"||o++}r=r.previousSibling}return null}function s_(r,o,h){switch(o=Fd(h),r){case"html":if(r=o.documentElement,!r)throw Error(S(452));return r;case"head":if(r=o.head,!r)throw Error(S(453));return r;case"body":if(r=o.body,!r)throw Error(S(454));return r;default:throw Error(S(451))}}function Ih(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);Hs(r)}var Er=new Map,Ru=new Set;function vp(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Vs=Xe.d;Xe.d={f:l_,r:c_,D:Um,C:Wr,L:cs,m:Kr,X:xp,S:Cc,M:Gm};function l_(){var r=Vs.f(),o=Pd();return r||o}function c_(r){var o=Vo(r);o!==null&&o.tag===5&&o.type==="form"?lr(o):Vs.r(r)}var Ec=typeof document>"u"?null:document;function Vm(r,o,h){var _=Ec;if(_&&typeof o=="string"&&o){var M=Rr(o);M='link[rel="'+r+'"][href="'+M+'"]',typeof h=="string"&&(M+='[crossorigin="'+h+'"]'),Ru.has(M)||(Ru.add(M),r={rel:r,crossOrigin:h,href:o},_.querySelector(M)===null&&(o=_.createElement("link"),xr(o,"link",r),bi(o),_.head.appendChild(o)))}}function Um(r){Vs.D(r),Vm("dns-prefetch",r,null)}function Wr(r,o){Vs.C(r,o),Vm("preconnect",r,o)}function cs(r,o,h){Vs.L(r,o,h);var _=Ec;if(_&&r&&o){var M='link[rel="preload"][as="'+Rr(o)+'"]';o==="image"&&h&&h.imageSrcSet?(M+='[imagesrcset="'+Rr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(M+='[imagesizes="'+Rr(h.imageSizes)+'"]')):M+='[href="'+Rr(r)+'"]';var D=M;switch(o){case"style":D=Iu(r);break;case"script":D=zl(r)}Er.has(D)||(r=ee({rel:"preload",href:o==="image"&&h&&h.imageSrcSet?void 0:r,as:o},h),Er.set(D,r),_.querySelector(M)!==null||o==="style"&&_.querySelector(Lh(D))||o==="script"&&_.querySelector(Oh(D))||(o=_.createElement("link"),xr(o,"link",r),bi(o),_.head.appendChild(o)))}}function Kr(r,o){Vs.m(r,o);var h=Ec;if(h&&r){var _=o&&typeof o.as=="string"?o.as:"script",M='link[rel="modulepreload"][as="'+Rr(_)+'"][href="'+Rr(r)+'"]',D=M;switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=zl(r)}if(!Er.has(D)&&(r=ee({rel:"modulepreload",href:r},o),Er.set(D,r),h.querySelector(M)===null)){switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Oh(D)))return}_=h.createElement("link"),xr(_,"link",r),bi(_),h.head.appendChild(_)}}}function Cc(r,o,h){Vs.S(r,o,h);var _=Ec;if(_&&r){var M=po(_).hoistableStyles,D=Iu(r);o=o||"default";var U=M.get(D);if(!U){var ne={loading:0,preload:null};if(U=_.querySelector(Lh(D)))ne.loading=5;else{r=ee({rel:"stylesheet",href:r,"data-precedence":o},h),(h=Er.get(D))&&jd(r,h);var Se=U=_.createElement("link");bi(Se),xr(Se,"link",r),Se._p=new Promise(function(Ze,at){Se.onload=Ze,Se.onerror=at}),Se.addEventListener("load",function(){ne.loading|=1}),Se.addEventListener("error",function(){ne.loading|=2}),ne.loading|=4,Dl(U,o,_)}U={type:"stylesheet",instance:U,count:1,state:ne},M.set(D,U)}}}function xp(r,o){Vs.X(r,o);var h=Ec;if(h&&r){var _=po(h).hoistableScripts,M=zl(r),D=_.get(M);D||(D=h.querySelector(Oh(M)),D||(r=ee({src:r,async:!0},o),(o=Er.get(M))&&bp(r,o),D=h.createElement("script"),bi(D),xr(D,"link",r),h.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},_.set(M,D))}}function Gm(r,o){Vs.M(r,o);var h=Ec;if(h&&r){var _=po(h).hoistableScripts,M=zl(r),D=_.get(M);D||(D=h.querySelector(Oh(M)),D||(r=ee({src:r,async:!0,type:"module"},o),(o=Er.get(M))&&bp(r,o),D=h.createElement("script"),bi(D),xr(D,"link",r),h.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},_.set(M,D))}}function qm(r,o,h,_){var M=(M=Nt.current)?vp(M):null;if(!M)throw Error(S(446));switch(r){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(o=Iu(h.href),h=po(M).hoistableStyles,_=h.get(o),_||(_={type:"style",instance:null,count:0,state:null},h.set(o,_)),_):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){r=Iu(h.href);var D=po(M).hoistableStyles,U=D.get(r);if(U||(M=M.ownerDocument||M,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(r,U),(D=M.querySelector(Lh(r)))&&!D._p&&(U.instance=D,U.state.loading=5),Er.has(r)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Er.set(r,h),D||Zm(M,r,h,U.state))),o&&_===null)throw Error(S(528,""));return U}if(o&&_!==null)throw Error(S(529,""));return null;case"script":return o=h.async,h=h.src,typeof h=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=zl(h),h=po(M).hoistableScripts,_=h.get(o),_||(_={type:"script",instance:null,count:0,state:null},h.set(o,_)),_):{type:"void",instance:null,count:0,state:null};default:throw Error(S(444,r))}}function Iu(r){return'href="'+Rr(r)+'"'}function Lh(r){return'link[rel="stylesheet"]['+r+"]"}function $m(r){return ee({},r,{"data-precedence":r.precedence,precedence:null})}function Zm(r,o,h,_){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?_.loading=1:(o=r.createElement("link"),_.preload=o,o.addEventListener("load",function(){return _.loading|=1}),o.addEventListener("error",function(){return _.loading|=2}),xr(o,"link",h),bi(o),r.head.appendChild(o))}function zl(r){return'[src="'+Rr(r)+'"]'}function Oh(r){return"script[async]"+r}function Hm(r,o,h){if(o.count++,o.instance===null)switch(o.type){case"style":var _=r.querySelector('style[data-href~="'+Rr(h.href)+'"]');if(_)return o.instance=_,bi(_),_;var M=ee({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return _=(r.ownerDocument||r).createElement("style"),bi(_),xr(_,"style",M),Dl(_,h.precedence,r),o.instance=_;case"stylesheet":M=Iu(h.href);var D=r.querySelector(Lh(M));if(D)return o.state.loading|=4,o.instance=D,bi(D),D;_=$m(h),(M=Er.get(M))&&jd(_,M),D=(r.ownerDocument||r).createElement("link"),bi(D);var U=D;return U._p=new Promise(function(ne,Se){U.onload=ne,U.onerror=Se}),xr(D,"link",_),o.state.loading|=4,Dl(D,h.precedence,r),o.instance=D;case"script":return D=zl(h.src),(M=r.querySelector(Oh(D)))?(o.instance=M,bi(M),M):(_=h,(M=Er.get(D))&&(_=ee({},h),bp(_,M)),r=r.ownerDocument||r,M=r.createElement("script"),bi(M),xr(M,"link",_),r.head.appendChild(M),o.instance=M);case"void":return null;default:throw Error(S(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(_=o.instance,o.state.loading|=4,Dl(_,h.precedence,r));return o.instance}function Dl(r,o,h){for(var _=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=_.length?_[_.length-1]:null,D=M,U=0;U<_.length;U++){var ne=_[U];if(ne.dataset.precedence===o)D=ne;else if(D!==M)break}D?D.parentNode.insertBefore(r,D.nextSibling):(o=h.nodeType===9?h.head:h,o.insertBefore(r,o.firstChild))}function jd(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function bp(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var wp=null;function Xm(r,o,h){if(wp===null){var _=new Map,M=wp=new Map;M.set(h,_)}else M=wp,_=M.get(h),_||(_=new Map,M.set(h,_));if(_.has(r))return _;for(_.set(r,null),h=h.getElementsByTagName(r),M=0;M<h.length;M++){var D=h[M];if(!(D[nn]||D[vn]||r==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var U=D.getAttribute(o)||"";U=r+U;var ne=_.get(U);ne?ne.push(D):_.set(U,[D])}}return _}function Vd(r,o,h){r=r.ownerDocument||r,r.head.insertBefore(h,o==="title"?r.querySelector("head > title"):null)}function Sp(r,o,h){if(h===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Ud(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function Ym(r,o,h,_){if(h.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var M=Iu(_.href),D=o.querySelector(Lh(M));if(D){o=D._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=qd.bind(r),o.then(r,r)),h.state.loading|=4,h.instance=D,bi(D);return}D=o.ownerDocument||o,_=$m(_),(M=Er.get(M))&&jd(_,M),D=D.createElement("link"),bi(D);var U=D;U._p=new Promise(function(ne,Se){U.onload=ne,U.onerror=Se}),xr(D,"link",_),h.instance=D}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(h,o),(o=h.state.preload)&&(h.state.loading&3)===0&&(r.count++,h=qd.bind(r),o.addEventListener("load",h),o.addEventListener("error",h))}}var Gd=0;function Wm(r,o){return r.stylesheets&&r.count===0&&Zd(r,r.stylesheets),0<r.count||0<r.imgCount?function(h){var _=setTimeout(function(){if(r.stylesheets&&Zd(r,r.stylesheets),r.unsuspend){var D=r.unsuspend;r.unsuspend=null,D()}},6e4+o);0<r.imgBytes&&Gd===0&&(Gd=62500*Rh());var M=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Zd(r,r.stylesheets),r.unsuspend)){var D=r.unsuspend;r.unsuspend=null,D()}},(r.imgBytes>Gd?50:800)+o);return r.unsuspend=h,function(){r.unsuspend=null,clearTimeout(_),clearTimeout(M)}}:null}function qd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Zd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var $d=null;function Zd(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,$d=new Map,o.forEach(u_,r),$d=null,qd.call(r))}function u_(r,o){if(!(o.state.loading&4)){var h=$d.get(r);if(h)var _=h.get(null);else{h=new Map,$d.set(r,h);for(var M=r.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<M.length;D++){var U=M[D];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(h.set(U.dataset.precedence,U),_=U)}_&&h.set(null,_)}M=o.instance,U=M.getAttribute("data-precedence"),D=h.get(U)||_,D===_&&h.set(null,M),h.set(U,M),this.count++,_=qd.bind(this),M.addEventListener("load",_),M.addEventListener("error",_),D?D.parentNode.insertBefore(M,D.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(M,r.firstChild)),o.state.loading|=4}}var kh={$$typeof:Le,Provider:null,Consumer:null,_currentValue:ft,_currentValue2:ft,_threadCount:0};function _y(r,o,h,_,M,D,U,ne,Se){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=an(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=an(0),this.hiddenUpdates=an(null),this.identifierPrefix=_,this.onUncaughtError=M,this.onCaughtError=D,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Se,this.incompleteTransitions=new Map}function Km(r,o,h,_,M,D,U,ne,Se,Ze,at,dt){return r=new _y(r,o,h,U,Se,Ze,at,dt,ne),o=1,D===!0&&(o|=24),D=oa(3,null,null,o),r.current=D,D.stateNode=r,o=Mo(),o.refCount++,r.pooledCache=o,o.refCount++,D.memoizedState={element:_,isDehydrated:h,cache:o},fh(D),r}function h_(r){return r?(r=on,r):on}function d_(r,o,h,_,M,D){M=h_(M),_.context===null?_.context=M:_.pendingContext=M,_=Ro(o),_.payload={element:h},D=D===void 0?null:D,D!==null&&(_.callback=D),h=Ko(r,_,o),h!==null&&(Fa(h,r,o),za(h,r,o))}function Tp(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var h=r.retryLane;r.retryLane=h!==0&&h<o?h:o}}function Ep(r,o){Tp(r,o),(r=r.alternate)&&Tp(r,o)}function f_(r){if(r.tag===13||r.tag===31){var o=Ca(r,67108864);o!==null&&Fa(o,r,67108864),Ep(r,67108864)}}function p_(r){if(r.tag===13||r.tag===31){var o=Ba();o=Fi(o);var h=Ca(r,o);h!==null&&Fa(h,r,o),Ep(r,o)}}var Hd=!0;function Xd(r,o,h,_){var M=Pe.T;Pe.T=null;var D=Xe.p;try{Xe.p=2,Qm(r,o,h,_)}finally{Xe.p=D,Pe.T=M}}function m_(r,o,h,_){var M=Pe.T;Pe.T=null;var D=Xe.p;try{Xe.p=8,Qm(r,o,h,_)}finally{Xe.p=D,Pe.T=M}}function Qm(r,o,h,_){if(Hd){var M=Yd(_);if(M===null)js(r,o,_,Bh,h),g_(r,_);else if(vy(M,r,o,h,_))_.stopPropagation();else if(g_(r,_),o&4&&-1<yy.indexOf(r)){for(;M!==null;){var D=Vo(M);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var U=Me(D.pendingLanes);if(U!==0){var ne=D;for(ne.pendingLanes|=2,ne.entangledLanes|=2;U;){var Se=1<<31-Ie(U);ne.entanglements[1]|=Se,U&=~Se}os(D),(Kn&6)===0&&(zd=Hi()+500,ro(0))}}break;case 31:case 13:ne=Ca(D,2),ne!==null&&Fa(ne,D,2),Pd(),Ep(D,2)}if(D=Yd(_),D===null&&js(r,o,_,Bh,h),D===M)break;M=D}M!==null&&_.stopPropagation()}else js(r,o,_,null,h)}}function Yd(r){return r=Gc(r),Cp(r)}var Bh=null;function Cp(r){if(Bh=null,r=ho(r),r!==null){var o=I(r);if(o===null)r=null;else{var h=o.tag;if(h===13){if(r=E(o),r!==null)return r;r=null}else if(h===31){if(r=l(o),r!==null)return r;r=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Bh=r,null}function Lu(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dr()){case xa:return 2;case xi:return 8;case qa:case fs:return 32;case De:return 268435456;default:return 32}default:return 32}}var Mp=!1,Mc=null,Fo=null,Ac=null,Wd=new Map,Fh=new Map,Pl=[],yy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function g_(r,o){switch(r){case"focusin":case"focusout":Mc=null;break;case"dragenter":case"dragleave":Fo=null;break;case"mouseover":case"mouseout":Ac=null;break;case"pointerover":case"pointerout":Wd.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fh.delete(o.pointerId)}}function Kd(r,o,h,_,M,D){return r===null||r.nativeEvent!==D?(r={blockedOn:o,domEventName:h,eventSystemFlags:_,nativeEvent:D,targetContainers:[M]},o!==null&&(o=Vo(o),o!==null&&f_(o)),r):(r.eventSystemFlags|=_,o=r.targetContainers,M!==null&&o.indexOf(M)===-1&&o.push(M),r)}function vy(r,o,h,_,M){switch(o){case"focusin":return Mc=Kd(Mc,r,o,h,_,M),!0;case"dragenter":return Fo=Kd(Fo,r,o,h,_,M),!0;case"mouseover":return Ac=Kd(Ac,r,o,h,_,M),!0;case"pointerover":var D=M.pointerId;return Wd.set(D,Kd(Wd.get(D)||null,r,o,h,_,M)),!0;case"gotpointercapture":return D=M.pointerId,Fh.set(D,Kd(Fh.get(D)||null,r,o,h,_,M)),!0}return!1}function __(r){var o=ho(r.target);if(o!==null){var h=I(o);if(h!==null){if(o=h.tag,o===13){if(o=E(h),o!==null){r.blockedOn=o,Pr(r.priority,function(){p_(h)});return}}else if(o===31){if(o=l(h),o!==null){r.blockedOn=o,Pr(r.priority,function(){p_(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){r.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Qd(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var h=Yd(r.nativeEvent);if(h===null){h=r.nativeEvent;var _=new h.constructor(h.type,h);Yh=_,h.target.dispatchEvent(_),Yh=null}else return o=Vo(h),o!==null&&f_(o),r.blockedOn=h,!1;o.shift()}return!0}function y_(r,o,h){Qd(r)&&h.delete(o)}function Jd(){Mp=!1,Mc!==null&&Qd(Mc)&&(Mc=null),Fo!==null&&Qd(Fo)&&(Fo=null),Ac!==null&&Qd(Ac)&&(Ac=null),Wd.forEach(y_),Fh.forEach(y_)}function Ap(r,o){r.blockedOn===o&&(r.blockedOn=null,Mp||(Mp=!0,p.unstable_scheduleCallback(p.unstable_NormalPriority,Jd)))}var zp=null;function v_(r){zp!==r&&(zp=r,p.unstable_scheduleCallback(p.unstable_NormalPriority,function(){zp===r&&(zp=null);for(var o=0;o<r.length;o+=3){var h=r[o],_=r[o+1],M=r[o+2];if(typeof _!="function"){if(Cp(_||h)===null)continue;break}var D=Vo(h);D!==null&&(r.splice(o,3),o-=3,Ei(D,{pending:!0,data:M,method:h.method,action:_},_,M))}}))}function zc(r){function o(Se){return Ap(Se,r)}Mc!==null&&Ap(Mc,r),Fo!==null&&Ap(Fo,r),Ac!==null&&Ap(Ac,r),Wd.forEach(o),Fh.forEach(o);for(var h=0;h<Pl.length;h++){var _=Pl[h];_.blockedOn===r&&(_.blockedOn=null)}for(;0<Pl.length&&(h=Pl[0],h.blockedOn===null);)__(h),h.blockedOn===null&&Pl.shift();if(h=(r.ownerDocument||r).$$reactFormReplay,h!=null)for(_=0;_<h.length;_+=3){var M=h[_],D=h[_+1],U=M[gt]||null;if(typeof D=="function")U||v_(h);else if(U){var ne=null;if(D&&D.hasAttribute("formAction")){if(M=D,U=D[gt]||null)ne=U.formAction;else if(Cp(M)!==null)continue}else ne=U.action;typeof ne=="function"?h[_+1]=ne:(h.splice(_,3),_-=3),v_(h)}}}function Jm(){function r(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(U){return M=U})},focusReset:"manual",scroll:"manual"})}function o(){M!==null&&(M(),M=null),_||setTimeout(h,20)}function h(){if(!_&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var _=!1,M=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(h,100),function(){_=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),M!==null&&(M(),M=null)}}}function eg(r){this._internalRoot=r}Dp.prototype.render=eg.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(S(409));var h=o.current,_=Ba();d_(h,_,r,o,null,null)},Dp.prototype.unmount=eg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;d_(r.current,2,null,r,null,null),Pd(),o[Qt]=null}};function Dp(r){this._internalRoot=r}Dp.prototype.unstable_scheduleHydration=function(r){if(r){var o=Pi();r={blockedOn:null,target:r,priority:o};for(var h=0;h<Pl.length&&o!==0&&o<Pl[h].priority;h++);Pl.splice(h,0,r),h===0&&__(r)}};var tg=b.version;if(tg!=="19.2.4")throw Error(S(527,tg,"19.2.4"));Xe.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(S(188)):(r=Object.keys(r).join(","),Error(S(268,r)));return r=X(o),r=r!==null?Q(r):null,r=r===null?null:r.stateNode,r};var x_={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Pe,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pp.isDisabled&&Pp.supportsFiber)try{K=Pp.inject(x_),me=Pp}catch{}}return sg.createRoot=function(r,o){if(!R(r))throw Error(S(299));var h=!1,_="",M=_h,D=ns,U=is;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(_=o.identifierPrefix),o.onUncaughtError!==void 0&&(M=o.onUncaughtError),o.onCaughtError!==void 0&&(D=o.onCaughtError),o.onRecoverableError!==void 0&&(U=o.onRecoverableError)),o=Km(r,1,!1,null,null,h,_,null,M,D,U,Jm),r[Qt]=o.current,Rm(r),new eg(o)},sg.hydrateRoot=function(r,o,h){if(!R(r))throw Error(S(299));var _=!1,M="",D=_h,U=ns,ne=is,Se=null;return h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(M=h.identifierPrefix),h.onUncaughtError!==void 0&&(D=h.onUncaughtError),h.onCaughtError!==void 0&&(U=h.onCaughtError),h.onRecoverableError!==void 0&&(ne=h.onRecoverableError),h.formState!==void 0&&(Se=h.formState)),o=Km(r,1,!0,o,h??null,_,M,Se,D,U,ne,Jm),o.context=h_(null),h=o.current,_=Ba(),_=Fi(_),M=Ro(_),M.callback=null,Ko(h,M,_),h=_,o.current.lanes=h,ei(o,h),os(o),r[Qt]=o.current,Rm(r),new Dp(o)},sg.version="19.2.4",sg}var D0;function j1(){if(D0)return Dy.exports;D0=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(b){console.error(b)}}return p(),Dy.exports=N1(),Dy.exports}var V1=j1();const U1=j_(V1);var Rc=function(){return Rc=Object.assign||function(b){for(var T,S=1,R=arguments.length;S<R;S++){T=arguments[S];for(var I in T)Object.prototype.hasOwnProperty.call(T,I)&&(b[I]=T[I])}return b},Rc.apply(this,arguments)};function Sx(p,b){var T={};for(var S in p)Object.prototype.hasOwnProperty.call(p,S)&&b.indexOf(S)<0&&(T[S]=p[S]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var R=0,S=Object.getOwnPropertySymbols(p);R<S.length;R++)b.indexOf(S[R])<0&&Object.prototype.propertyIsEnumerable.call(p,S[R])&&(T[S[R]]=p[S[R]]);return T}function G1(p,b,T){if(T||arguments.length===2)for(var S=0,R=b.length,I;S<R;S++)(I||!(S in b))&&(I||(I=Array.prototype.slice.call(b,0,S)),I[S]=b[S]);return p.concat(I||Array.prototype.slice.call(b))}var ue=dv();const hs=j_(ue),Tx=R1({__proto__:null,default:hs},[ue]);var z_="right-scroll-bar-position",D_="width-before-scroll-bar",q1="with-scroll-bars-hidden",$1="--removed-body-scroll-bar-size";function Oy(p,b){return typeof p=="function"?p(b):p&&(p.current=b),p}function Z1(p,b){var T=ue.useState(function(){return{value:p,callback:b,facade:{get current(){return T.value},set current(S){var R=T.value;R!==S&&(T.value=S,T.callback(S,R))}}}})[0];return T.callback=b,T.facade}var H1=typeof window<"u"?ue.useLayoutEffect:ue.useEffect,P0=new WeakMap;function X1(p,b){var T=Z1(null,function(S){return p.forEach(function(R){return Oy(R,S)})});return H1(function(){var S=P0.get(T);if(S){var R=new Set(S),I=new Set(p),E=T.current;R.forEach(function(l){I.has(l)||Oy(l,null)}),I.forEach(function(l){R.has(l)||Oy(l,E)})}P0.set(T,p)},[p]),T}function Y1(p){return p}function W1(p,b){b===void 0&&(b=Y1);var T=[],S=!1,R={read:function(){if(S)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return T.length?T[T.length-1]:p},useMedium:function(I){var E=b(I,S);return T.push(E),function(){T=T.filter(function(l){return l!==E})}},assignSyncMedium:function(I){for(S=!0;T.length;){var E=T;T=[],E.forEach(I)}T={push:function(l){return I(l)},filter:function(){return T}}},assignMedium:function(I){S=!0;var E=[];if(T.length){var l=T;T=[],l.forEach(I),E=T}var N=function(){var Q=E;E=[],Q.forEach(I)},X=function(){return Promise.resolve().then(N)};X(),T={push:function(Q){E.push(Q),X()},filter:function(Q){return E=E.filter(Q),T}}}};return R}function K1(p){p===void 0&&(p={});var b=W1(null);return b.options=Rc({async:!0,ssr:!1},p),b}var Ex=function(p){var b=p.sideCar,T=Sx(p,["sideCar"]);if(!b)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var S=b.read();if(!S)throw new Error("Sidecar medium not found");return ue.createElement(S,Rc({},T))};Ex.isSideCarExport=!0;function Q1(p,b){return p.useMedium(b),Ex}var Cx=K1(),ky=function(){},V_=ue.forwardRef(function(p,b){var T=ue.useRef(null),S=ue.useState({onScrollCapture:ky,onWheelCapture:ky,onTouchMoveCapture:ky}),R=S[0],I=S[1],E=p.forwardProps,l=p.children,N=p.className,X=p.removeScrollBar,Q=p.enabled,ee=p.shards,le=p.sideCar,ce=p.noRelative,Ce=p.noIsolation,xe=p.inert,ie=p.allowPinchZoom,Ue=p.as,$e=Ue===void 0?"div":Ue,Le=p.gapMode,Ye=Sx(p,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),it=le,pt=X1([T,b]),Qe=Rc(Rc({},Ye),R);return ue.createElement(ue.Fragment,null,Q&&ue.createElement(it,{sideCar:Cx,removeScrollBar:X,shards:ee,noRelative:ce,noIsolation:Ce,inert:xe,setCallbacks:I,allowPinchZoom:!!ie,lockRef:T,gapMode:Le}),E?ue.cloneElement(ue.Children.only(l),Rc(Rc({},Qe),{ref:pt})):ue.createElement($e,Rc({},Qe,{className:N,ref:pt}),l))});V_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};V_.classNames={fullWidth:D_,zeroRight:z_};var J1=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function ew(){if(!document)return null;var p=document.createElement("style");p.type="text/css";var b=J1();return b&&p.setAttribute("nonce",b),p}function tw(p,b){p.styleSheet?p.styleSheet.cssText=b:p.appendChild(document.createTextNode(b))}function nw(p){var b=document.head||document.getElementsByTagName("head")[0];b.appendChild(p)}var iw=function(){var p=0,b=null;return{add:function(T){p==0&&(b=ew())&&(tw(b,T),nw(b)),p++},remove:function(){p--,!p&&b&&(b.parentNode&&b.parentNode.removeChild(b),b=null)}}},rw=function(){var p=iw();return function(b,T){ue.useEffect(function(){return p.add(b),function(){p.remove()}},[b&&T])}},Mx=function(){var p=rw(),b=function(T){var S=T.styles,R=T.dynamic;return p(S,R),null};return b},aw={left:0,top:0,right:0,gap:0},By=function(p){return parseInt(p||"",10)||0},ow=function(p){var b=window.getComputedStyle(document.body),T=b[p==="padding"?"paddingLeft":"marginLeft"],S=b[p==="padding"?"paddingTop":"marginTop"],R=b[p==="padding"?"paddingRight":"marginRight"];return[By(T),By(S),By(R)]},sw=function(p){if(p===void 0&&(p="margin"),typeof window>"u")return aw;var b=ow(p),T=document.documentElement.clientWidth,S=window.innerWidth;return{left:b[0],top:b[1],right:b[2],gap:Math.max(0,S-T+b[2]-b[0])}},lw=Mx(),Gp="data-scroll-locked",cw=function(p,b,T,S){var R=p.left,I=p.top,E=p.right,l=p.gap;return T===void 0&&(T="margin"),`
  .`.concat(q1,` {
   overflow: hidden `).concat(S,`;
   padding-right: `).concat(l,"px ").concat(S,`;
  }
  body[`).concat(Gp,`] {
    overflow: hidden `).concat(S,`;
    overscroll-behavior: contain;
    `).concat([b&&"position: relative ".concat(S,";"),T==="margin"&&`
    padding-left: `.concat(R,`px;
    padding-top: `).concat(I,`px;
    padding-right: `).concat(E,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(S,`;
    `),T==="padding"&&"padding-right: ".concat(l,"px ").concat(S,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(z_,` {
    right: `).concat(l,"px ").concat(S,`;
  }
  
  .`).concat(D_,` {
    margin-right: `).concat(l,"px ").concat(S,`;
  }
  
  .`).concat(z_," .").concat(z_,` {
    right: 0 `).concat(S,`;
  }
  
  .`).concat(D_," .").concat(D_,` {
    margin-right: 0 `).concat(S,`;
  }
  
  body[`).concat(Gp,`] {
    `).concat($1,": ").concat(l,`px;
  }
`)},R0=function(){var p=parseInt(document.body.getAttribute(Gp)||"0",10);return isFinite(p)?p:0},uw=function(){ue.useEffect(function(){return document.body.setAttribute(Gp,(R0()+1).toString()),function(){var p=R0()-1;p<=0?document.body.removeAttribute(Gp):document.body.setAttribute(Gp,p.toString())}},[])},hw=function(p){var b=p.noRelative,T=p.noImportant,S=p.gapMode,R=S===void 0?"margin":S;uw();var I=ue.useMemo(function(){return sw(R)},[R]);return ue.createElement(lw,{styles:cw(I,!b,R,T?"":"!important")})},Wy=!1;if(typeof window<"u")try{var S_=Object.defineProperty({},"passive",{get:function(){return Wy=!0,!0}});window.addEventListener("test",S_,S_),window.removeEventListener("test",S_,S_)}catch{Wy=!1}var Op=Wy?{passive:!1}:!1,dw=function(p){return p.tagName==="TEXTAREA"},Ax=function(p,b){if(!(p instanceof Element))return!1;var T=window.getComputedStyle(p);return T[b]!=="hidden"&&!(T.overflowY===T.overflowX&&!dw(p)&&T[b]==="visible")},fw=function(p){return Ax(p,"overflowY")},pw=function(p){return Ax(p,"overflowX")},I0=function(p,b){var T=b.ownerDocument,S=b;do{typeof ShadowRoot<"u"&&S instanceof ShadowRoot&&(S=S.host);var R=zx(p,S);if(R){var I=Dx(p,S),E=I[1],l=I[2];if(E>l)return!0}S=S.parentNode}while(S&&S!==T.body);return!1},mw=function(p){var b=p.scrollTop,T=p.scrollHeight,S=p.clientHeight;return[b,T,S]},gw=function(p){var b=p.scrollLeft,T=p.scrollWidth,S=p.clientWidth;return[b,T,S]},zx=function(p,b){return p==="v"?fw(b):pw(b)},Dx=function(p,b){return p==="v"?mw(b):gw(b)},_w=function(p,b){return p==="h"&&b==="rtl"?-1:1},yw=function(p,b,T,S,R){var I=_w(p,window.getComputedStyle(b).direction),E=I*S,l=T.target,N=b.contains(l),X=!1,Q=E>0,ee=0,le=0;do{if(!l)break;var ce=Dx(p,l),Ce=ce[0],xe=ce[1],ie=ce[2],Ue=xe-ie-I*Ce;(Ce||Ue)&&zx(p,l)&&(ee+=Ue,le+=Ce);var $e=l.parentNode;l=$e&&$e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?$e.host:$e}while(!N&&l!==document.body||N&&(b.contains(l)||b===l));return(Q&&Math.abs(ee)<1||!Q&&Math.abs(le)<1)&&(X=!0),X},T_=function(p){return"changedTouches"in p?[p.changedTouches[0].clientX,p.changedTouches[0].clientY]:[0,0]},L0=function(p){return[p.deltaX,p.deltaY]},O0=function(p){return p&&"current"in p?p.current:p},vw=function(p,b){return p[0]===b[0]&&p[1]===b[1]},xw=function(p){return`
  .block-interactivity-`.concat(p,` {pointer-events: none;}
  .allow-interactivity-`).concat(p,` {pointer-events: all;}
`)},bw=0,kp=[];function ww(p){var b=ue.useRef([]),T=ue.useRef([0,0]),S=ue.useRef(),R=ue.useState(bw++)[0],I=ue.useState(Mx)[0],E=ue.useRef(p);ue.useEffect(function(){E.current=p},[p]),ue.useEffect(function(){if(p.inert){document.body.classList.add("block-interactivity-".concat(R));var xe=G1([p.lockRef.current],(p.shards||[]).map(O0),!0).filter(Boolean);return xe.forEach(function(ie){return ie.classList.add("allow-interactivity-".concat(R))}),function(){document.body.classList.remove("block-interactivity-".concat(R)),xe.forEach(function(ie){return ie.classList.remove("allow-interactivity-".concat(R))})}}},[p.inert,p.lockRef.current,p.shards]);var l=ue.useCallback(function(xe,ie){if("touches"in xe&&xe.touches.length===2||xe.type==="wheel"&&xe.ctrlKey)return!E.current.allowPinchZoom;var Ue=T_(xe),$e=T.current,Le="deltaX"in xe?xe.deltaX:$e[0]-Ue[0],Ye="deltaY"in xe?xe.deltaY:$e[1]-Ue[1],it,pt=xe.target,Qe=Math.abs(Le)>Math.abs(Ye)?"h":"v";if("touches"in xe&&Qe==="h"&&pt.type==="range")return!1;var _t=window.getSelection(),Pt=_t&&_t.anchorNode,Rt=Pt?Pt===pt||Pt.contains(pt):!1;if(Rt)return!1;var Zt=I0(Qe,pt);if(!Zt)return!0;if(Zt?it=Qe:(it=Qe==="v"?"h":"v",Zt=I0(Qe,pt)),!Zt)return!1;if(!S.current&&"changedTouches"in xe&&(Le||Ye)&&(S.current=it),!it)return!0;var Ot=S.current||it;return yw(Ot,ie,xe,Ot==="h"?Le:Ye)},[]),N=ue.useCallback(function(xe){var ie=xe;if(!(!kp.length||kp[kp.length-1]!==I)){var Ue="deltaY"in ie?L0(ie):T_(ie),$e=b.current.filter(function(it){return it.name===ie.type&&(it.target===ie.target||ie.target===it.shadowParent)&&vw(it.delta,Ue)})[0];if($e&&$e.should){ie.cancelable&&ie.preventDefault();return}if(!$e){var Le=(E.current.shards||[]).map(O0).filter(Boolean).filter(function(it){return it.contains(ie.target)}),Ye=Le.length>0?l(ie,Le[0]):!E.current.noIsolation;Ye&&ie.cancelable&&ie.preventDefault()}}},[]),X=ue.useCallback(function(xe,ie,Ue,$e){var Le={name:xe,delta:ie,target:Ue,should:$e,shadowParent:Sw(Ue)};b.current.push(Le),setTimeout(function(){b.current=b.current.filter(function(Ye){return Ye!==Le})},1)},[]),Q=ue.useCallback(function(xe){T.current=T_(xe),S.current=void 0},[]),ee=ue.useCallback(function(xe){X(xe.type,L0(xe),xe.target,l(xe,p.lockRef.current))},[]),le=ue.useCallback(function(xe){X(xe.type,T_(xe),xe.target,l(xe,p.lockRef.current))},[]);ue.useEffect(function(){return kp.push(I),p.setCallbacks({onScrollCapture:ee,onWheelCapture:ee,onTouchMoveCapture:le}),document.addEventListener("wheel",N,Op),document.addEventListener("touchmove",N,Op),document.addEventListener("touchstart",Q,Op),function(){kp=kp.filter(function(xe){return xe!==I}),document.removeEventListener("wheel",N,Op),document.removeEventListener("touchmove",N,Op),document.removeEventListener("touchstart",Q,Op)}},[]);var ce=p.removeScrollBar,Ce=p.inert;return ue.createElement(ue.Fragment,null,Ce?ue.createElement(I,{styles:xw(R)}):null,ce?ue.createElement(hw,{noRelative:p.noRelative,gapMode:p.gapMode}):null)}function Sw(p){for(var b=null;p!==null;)p instanceof ShadowRoot&&(b=p.host,p=p.host),p=p.parentNode;return b}const Tw=Q1(Cx,ww);var Ky=ue.forwardRef(function(p,b){return ue.createElement(V_,Rc({},p,{ref:b,sideCar:Tw}))});Ky.classNames=V_.classNames;function Ic(p){return Object.keys(p)}function Fy(p){return p&&typeof p=="object"&&!Array.isArray(p)}function fv(p,b){const T={...p},S=b;return Fy(p)&&Fy(b)&&Object.keys(b).forEach(R=>{Fy(S[R])&&R in p?T[R]=fv(T[R],S[R]):T[R]=S[R]}),T}function Ew(p){return p.replace(/[A-Z]/g,b=>`-${b.toLowerCase()}`)}function Cw(p){return typeof p!="string"||!p.includes("var(--mantine-scale)")?p:p.match(/^calc\((.*?)\)$/)?.[1].split("*")[0].trim()}function Mw(p){const b=Cw(p);return typeof b=="number"?b:typeof b=="string"?b.includes("calc")||b.includes("var")?b:b.includes("px")?Number(b.replace("px","")):b.includes("rem")?Number(b.replace("rem",""))*16:b.includes("em")?Number(b.replace("em",""))*16:Number(b):NaN}function k0(p){return p==="0rem"?"0rem":`calc(${p} * var(--mantine-scale))`}function Px(p,{shouldScale:b=!1}={}){function T(S){if(S===0||S==="0")return`0${p}`;if(typeof S=="number"){const R=`${S/16}${p}`;return b?k0(R):R}if(typeof S=="string"){if(S===""||S.startsWith("calc(")||S.startsWith("clamp(")||S.includes("rgba("))return S;if(S.includes(","))return S.split(",").map(I=>T(I)).join(",");if(S.includes(" "))return S.split(" ").map(I=>T(I)).join(" ");const R=S.replace("px","");if(!Number.isNaN(Number(R))){const I=`${Number(R)/16}${p}`;return b?k0(I):I}}return S}return T}const bt=Px("rem",{shouldScale:!0}),B0=Px("em");function U_(p){return Object.keys(p).reduce((b,T)=>(p[T]!==void 0&&(b[T]=p[T]),b),{})}function Rx(p){if(typeof p=="number")return!0;if(typeof p=="string"){if(p.startsWith("calc(")||p.startsWith("var(")||p.includes(" ")&&p.trim()!=="")return!0;const b=/^[+-]?[0-9]+(\.[0-9]+)?(px|em|rem|ex|ch|lh|rlh|vw|vh|vmin|vmax|vb|vi|svw|svh|lvw|lvh|dvw|dvh|cm|mm|in|pt|pc|q|cqw|cqh|cqi|cqb|cqmin|cqmax|%)?$/;return p.trim().split(/\s+/).every(S=>b.test(S))}return!1}function Ix(p){return Array.isArray(p)||p===null?!1:typeof p=="object"?p.type!==ue.Fragment:!1}function _g(p){const b=ue.createContext(null);return[({children:R,value:I})=>Te.jsx(b.Provider,{value:I,children:R}),()=>{const R=ue.useContext(b);if(R===null)throw new Error(p);return R}]}function Lx(p=null){const b=ue.createContext(p);return[({children:R,value:I})=>Te.jsx(b.Provider,{value:I,children:R}),()=>ue.useContext(b)]}const Aw={app:100,modal:200,popover:300,overlay:400,max:9999};function pv(p){return Aw[p]}const Ox=()=>{};function zw(p,b={active:!0}){return typeof p!="function"||!b.active?b.onKeyDown||Ox:T=>{T.key==="Escape"&&(p(T),b.onTrigger?.())}}function Ua(p,b="size",T=!0){if(p!==void 0)return Rx(p)?T?bt(p):p:`var(--${b}-${p})`}function mv(p){return Ua(p,"mantine-spacing")}function Bu(p){return p===void 0?"var(--mantine-radius-default)":Ua(p,"mantine-radius")}function Fl(p){return Ua(p,"mantine-font-size")}function Dw(p){return Ua(p,"mantine-line-height",!1)}function kx(p){if(p)return Ua(p,"mantine-shadow",!1)}function Bx(p="mantine-"){return`${p}${Math.random().toString(36).slice(2,11)}`}function of(p){const b=ue.useRef(p);return ue.useEffect(()=>{b.current=p}),ue.useMemo(()=>((...T)=>b.current?.(...T)),[])}function G_(p,b){const{delay:T,flushOnUnmount:S,leading:R}=typeof b=="number"?{delay:b,flushOnUnmount:!1,leading:!1}:b,I=of(p),E=ue.useRef(0),l=ue.useMemo(()=>{const N=Object.assign((...X)=>{window.clearTimeout(E.current);const Q=N._isFirstCall;N._isFirstCall=!1;function ee(){window.clearTimeout(E.current),E.current=0,N._isFirstCall=!0}if(R&&Q){I(...X);const Ce=()=>{ee()},xe=()=>{E.current!==0&&(ee(),I(...X))},ie=()=>{ee()};N.flush=xe,N.cancel=ie,E.current=window.setTimeout(Ce,T);return}if(R&&!Q){const Ce=()=>{E.current!==0&&(ee(),I(...X))},xe=()=>{ee()};N.flush=Ce,N.cancel=xe;const ie=()=>{ee()};E.current=window.setTimeout(ie,T);return}const le=()=>{E.current!==0&&(ee(),I(...X))},ce=()=>{ee()};N.flush=le,N.cancel=ce,E.current=window.setTimeout(le,T)},{flush:()=>{},cancel:()=>{},_isFirstCall:!0});return N},[I,T,R]);return ue.useEffect(()=>()=>{S?l.flush():l.cancel()},[l,S]),l}const Pw=["mousedown","touchstart"];function Rw(p,b,T){const S=ue.useRef(null),R=b||Pw;return ue.useEffect(()=>{const I=E=>{const{target:l}=E??{};if(Array.isArray(T)){const N=!document.body.contains(l)&&l?.tagName!=="HTML";T.every(Q=>!!Q&&!E.composedPath().includes(Q))&&!N&&p(E)}else S.current&&!S.current.contains(l)&&p(E)};return R.forEach(E=>document.addEventListener(E,I)),()=>{R.forEach(E=>document.removeEventListener(E,I))}},[S,p,T]),S}function Iw(p,b){try{return p.addEventListener("change",b),()=>p.removeEventListener("change",b)}catch{return p.addListener(b),()=>p.removeListener(b)}}function Lw(p,b){return typeof window<"u"&&"matchMedia"in window?window.matchMedia(p).matches:!1}function Fx(p,b,{getInitialValueInEffect:T}={getInitialValueInEffect:!0}){const[S,R]=ue.useState(T?b:Lw(p));return ue.useEffect(()=>{try{const I=window.matchMedia(p);return R(I.matches),Iw(I,E=>R(E.matches))}catch{return}},[p]),S||!1}function Nx(p,b){return Fx("(prefers-color-scheme: dark)",p==="dark",b)?"dark":"light"}const Yp=typeof document<"u"?ue.useLayoutEffect:ue.useEffect;function fg(p,b){const T=ue.useRef(!1);ue.useEffect(()=>()=>{T.current=!1},[]),ue.useEffect(()=>{if(T.current)return p();T.current=!0},b)}function Ow({opened:p,shouldReturnFocus:b=!0}){const T=ue.useRef(null),S=()=>{T.current&&"focus"in T.current&&typeof T.current.focus=="function"&&T.current?.focus({preventScroll:!0})};return fg(()=>{let R=-1;const I=E=>{E.key==="Tab"&&window.clearTimeout(R)};return document.addEventListener("keydown",I),p?T.current=document.activeElement:b&&(R=window.setTimeout(S,10)),()=>{window.clearTimeout(R),document.removeEventListener("keydown",I)}},[p,b]),S}const kw=/input|select|textarea|button|object/,jx="a, input, select, textarea, button, object, [tabindex]";function Bw(p){return p.style.display==="none"}function Fw(p){if(p.getAttribute("aria-hidden")||p.getAttribute("hidden")||p.getAttribute("type")==="hidden")return!1;let T=p;for(;T&&!(T===document.body||T.nodeType===11);){if(Bw(T))return!1;T=T.parentNode}return!0}function Vx(p){let b=p.getAttribute("tabindex");return b===null&&(b=void 0),parseInt(b,10)}function Qy(p){const b=p.nodeName.toLowerCase(),T=!Number.isNaN(Vx(p));return(kw.test(b)&&!p.disabled||p instanceof HTMLAnchorElement&&p.href||T)&&Fw(p)}function Ux(p){const b=Vx(p);return(Number.isNaN(b)||b>=0)&&Qy(p)}function Nw(p){return Array.from(p.querySelectorAll(jx)).filter(Ux)}function jw(p,b){const T=Nw(p);if(!T.length){b.preventDefault();return}const S=T[b.shiftKey?0:T.length-1],R=p.getRootNode();let I=S===R.activeElement||p===R.activeElement;const E=R.activeElement;if(E.tagName==="INPUT"&&E.getAttribute("type")==="radio"&&(I=T.filter(Q=>Q.getAttribute("type")==="radio"&&Q.getAttribute("name")===E.getAttribute("name")).includes(S)),!I)return;b.preventDefault();const N=T[b.shiftKey?T.length-1:0];N&&N.focus()}function Vw(p=!0){const b=ue.useRef(null),T=R=>{let I=R.querySelector("[data-autofocus]");if(!I){const E=Array.from(R.querySelectorAll(jx));I=E.find(Ux)||E.find(Qy)||null,!I&&Qy(R)&&(I=R)}I&&I.focus({preventScroll:!0})},S=ue.useCallback(R=>{p&&R!==null&&b.current!==R&&(R?(setTimeout(()=>{R.getRootNode()&&T(R)}),b.current=R):b.current=null)},[p]);return ue.useEffect(()=>{if(!p)return;b.current&&setTimeout(()=>T(b.current));const R=I=>{I.key==="Tab"&&b.current&&jw(b.current,I)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[p]),S}const Uw=p=>(p+1)%1e6;function Gw(){const[,p]=ue.useReducer(Uw,0);return p}const qw=hs.useId||(()=>{});function $w(){const p=qw();return p?`mantine-${p.replace(/:/g,"")}`:""}function yg(p){const b=$w(),[T,S]=ue.useState(b);return Yp(()=>{S(Bx())},[]),typeof p=="string"?p:typeof window>"u"?b:T}function Jy(p,b){if(typeof p=="function")return p(b);typeof p=="object"&&p!==null&&"current"in p&&(p.current=b)}function Zw(...p){const b=new Map;return T=>{if(p.forEach(S=>{const R=Jy(S,T);R&&b.set(S,R)}),b.size>0)return()=>{p.forEach(S=>{const R=b.get(S);R&&typeof R=="function"?R():Jy(S,null)}),b.clear()}}}function Gs(...p){return ue.useCallback(Zw(...p),p)}function gv({value:p,defaultValue:b,finalValue:T,onChange:S=()=>{}}){const[R,I]=ue.useState(b!==void 0?b:T),E=(l,...N)=>{I(l),S?.(l,...N)};return p!==void 0?[p,S,!0]:[R,E,!1]}function Gx(p,b){return Fx("(prefers-reduced-motion: reduce)",p,b)}function qx(p){const b=hs.version;return typeof hs.version!="string"||b.startsWith("18.")?p?.ref:p?.props?.ref}function P_(p,b=document){const T=b.querySelector(p);if(T)return T;const S=b.querySelectorAll("*");for(let R=0;R<S.length;R+=1){const I=S[R];if(I.shadowRoot){const E=P_(p,I.shadowRoot);if(E)return E}}return null}function Vh(p,b=document){const T=[],S=b.querySelectorAll(p);T.push(...Array.from(S));const R=b.querySelectorAll("*");for(let I=0;I<R.length;I+=1){const E=R[I];if(E.shadowRoot){const l=Vh(p,E.shadowRoot);T.push(...l)}}return T}function jh(p){if(!p)return document;const b=p.getRootNode();return b instanceof ShadowRoot||b instanceof Document?b:document}function q_(p){const b=ue.Children.toArray(p);return b.length!==1||!Ix(b[0])?null:b[0]}function $x(p){var b,T,S="";if(typeof p=="string"||typeof p=="number")S+=p;else if(typeof p=="object")if(Array.isArray(p)){var R=p.length;for(b=0;b<R;b++)p[b]&&(T=$x(p[b]))&&(S&&(S+=" "),S+=T)}else for(T in p)p[T]&&(S&&(S+=" "),S+=T);return S}function Fu(){for(var p,b,T=0,S="",R=arguments.length;T<R;T++)(p=arguments[T])&&(b=$x(p))&&(S&&(S+=" "),S+=b);return S}const Hw={};function Xw(p){const b={};return p.forEach(T=>{Object.entries(T).forEach(([S,R])=>{b[S]?b[S]=Fu(b[S],R):b[S]=R})}),b}function $_({theme:p,classNames:b,props:T,stylesCtx:S}){const I=(Array.isArray(b)?b:[b]).map(E=>typeof E=="function"?E(p,T,S):E||Hw);return Xw(I)}function L_({theme:p,styles:b,props:T,stylesCtx:S}){return(Array.isArray(b)?b:[b]).reduce((I,E)=>typeof E=="function"?{...I,...E(p,T,S)}:{...I,...E},{})}const _v=ue.createContext(null);function $h(){const p=ue.useContext(_v);if(!p)throw new Error("[@mantine/core] MantineProvider was not found in tree");return p}function Yw(){return $h().cssVariablesResolver}function Ww(){return $h().classNamesPrefix}function Z_(){return $h().getStyleNonce}function Kw(){return $h().withStaticClasses}function Qw(){return $h().headless}function Jw(){return $h().stylesTransform?.sx}function e2(){return $h().stylesTransform?.styles}function H_(){return $h().env||"default"}function t2(p){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(p)}function n2(p){let b=p.replace("#","");if(b.length===3){const E=b.split("");b=[E[0],E[0],E[1],E[1],E[2],E[2]].join("")}if(b.length===8){const E=parseInt(b.slice(6,8),16)/255;return{r:parseInt(b.slice(0,2),16),g:parseInt(b.slice(2,4),16),b:parseInt(b.slice(4,6),16),a:E}}const T=parseInt(b,16),S=T>>16&255,R=T>>8&255,I=T&255;return{r:S,g:R,b:I,a:1}}function i2(p){const[b,T,S,R]=p.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:b,g:T,b:S,a:R===void 0?1:R}}function r2(p){const b=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,T=p.match(b);if(!T)return{r:0,g:0,b:0,a:1};const S=parseInt(T[1],10),R=parseInt(T[2],10)/100,I=parseInt(T[3],10)/100,E=T[5]?parseFloat(T[5]):void 0,l=(1-Math.abs(2*I-1))*R,N=S/60,X=l*(1-Math.abs(N%2-1)),Q=I-l/2;let ee,le,ce;return N>=0&&N<1?(ee=l,le=X,ce=0):N>=1&&N<2?(ee=X,le=l,ce=0):N>=2&&N<3?(ee=0,le=l,ce=X):N>=3&&N<4?(ee=0,le=X,ce=l):N>=4&&N<5?(ee=X,le=0,ce=l):(ee=l,le=0,ce=X),{r:Math.round((ee+Q)*255),g:Math.round((le+Q)*255),b:Math.round((ce+Q)*255),a:E||1}}function yv(p){return t2(p)?n2(p):p.startsWith("rgb")?i2(p):p.startsWith("hsl")?r2(p):{r:0,g:0,b:0,a:1}}function E_(p,b){if(p.startsWith("var("))return`color-mix(in srgb, ${p}, black ${b*100}%)`;const{r:T,g:S,b:R,a:I}=yv(p),E=1-b,l=N=>Math.round(N*E);return`rgba(${l(T)}, ${l(S)}, ${l(R)}, ${I})`}function pg(p,b){return typeof p.primaryShade=="number"?p.primaryShade:b==="dark"?p.primaryShade.dark:p.primaryShade.light}function Ny(p){return p<=.03928?p/12.92:((p+.055)/1.055)**2.4}function a2(p){const b=p.match(/oklch\((.*?)%\s/);return b?parseFloat(b[1]):null}function o2(p){if(p.startsWith("oklch("))return(a2(p)||0)/100;const{r:b,g:T,b:S}=yv(p),R=b/255,I=T/255,E=S/255,l=Ny(R),N=Ny(I),X=Ny(E);return .2126*l+.7152*N+.0722*X}function lg(p,b=.179){return p.startsWith("var(")?!1:o2(p)>b}function vg({color:p,theme:b,colorScheme:T}){if(typeof p!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof p}`);if(p==="bright")return{color:p,value:T==="dark"?b.white:b.black,shade:void 0,isThemeColor:!1,isLight:lg(T==="dark"?b.white:b.black,b.luminanceThreshold),variable:"--mantine-color-bright"};if(p==="dimmed")return{color:p,value:T==="dark"?b.colors.dark[2]:b.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:lg(T==="dark"?b.colors.dark[2]:b.colors.gray[6],b.luminanceThreshold),variable:"--mantine-color-dimmed"};if(p==="white"||p==="black")return{color:p,value:p==="white"?b.white:b.black,shade:void 0,isThemeColor:!1,isLight:lg(p==="white"?b.white:b.black,b.luminanceThreshold),variable:`--mantine-color-${p}`};const[S,R]=p.split("."),I=R?Number(R):void 0,E=S in b.colors;if(E){const l=I!==void 0?b.colors[S][I]:b.colors[S][pg(b,T||"light")];return{color:S,value:l,shade:I,isThemeColor:E,isLight:lg(l,b.luminanceThreshold),variable:R?`--mantine-color-${S}-${I}`:`--mantine-color-${S}-filled`}}return{color:p,value:p,isThemeColor:E,isLight:lg(p,b.luminanceThreshold),shade:I,variable:void 0}}function $p(p,b){const T=vg({color:p||b.primaryColor,theme:b});return T.variable?`var(${T.variable})`:p}function ev(p,b){const T={from:p?.from||b.defaultGradient.from,to:p?.to||b.defaultGradient.to,deg:p?.deg??b.defaultGradient.deg??0},S=$p(T.from,b),R=$p(T.to,b);return`linear-gradient(${T.deg}deg, ${S} 0%, ${R} 100%)`}function Pc(p,b){if(typeof p!="string"||b>1||b<0)return"rgba(0, 0, 0, 1)";if(p.startsWith("var(")){const I=(1-b)*100;return`color-mix(in srgb, ${p}, transparent ${I}%)`}if(p.startsWith("oklch"))return p.includes("/")?p.replace(/\/\s*[\d.]+\s*\)/,`/ ${b})`):p.replace(")",` / ${b})`);const{r:T,g:S,b:R}=yv(p);return`rgba(${T}, ${S}, ${R}, ${b})`}const Bp=Pc,s2=({color:p,theme:b,variant:T,gradient:S,autoContrast:R})=>{const I=vg({color:p,theme:b}),E=typeof R=="boolean"?R:b.autoContrast;if(T==="none")return{background:"transparent",hover:"transparent",color:"inherit",border:"none"};if(T==="filled"){const l=E&&I.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return I.isThemeColor?I.shade===void 0?{background:`var(--mantine-color-${p}-filled)`,hover:`var(--mantine-color-${p}-filled-hover)`,color:l,border:`${bt(1)} solid transparent`}:{background:`var(--mantine-color-${I.color}-${I.shade})`,hover:`var(--mantine-color-${I.color}-${I.shade===9?8:I.shade+1})`,color:l,border:`${bt(1)} solid transparent`}:{background:p,hover:E_(p,.1),color:l,border:`${bt(1)} solid transparent`}}if(T==="light"){if(I.isThemeColor){if(I.shade===void 0)return{background:`var(--mantine-color-${p}-light)`,hover:`var(--mantine-color-${p}-light-hover)`,color:`var(--mantine-color-${p}-light-color)`,border:`${bt(1)} solid transparent`};const l=b.colors[I.color][I.shade];return{background:Pc(l,.1),hover:Pc(l,.12),color:`var(--mantine-color-${I.color}-${Math.min(I.shade,6)})`,border:`${bt(1)} solid transparent`}}return{background:Pc(p,.1),hover:Pc(p,.12),color:p,border:`${bt(1)} solid transparent`}}if(T==="outline")return I.isThemeColor?I.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${p}-outline-hover)`,color:`var(--mantine-color-${p}-outline)`,border:`${bt(1)} solid var(--mantine-color-${p}-outline)`}:{background:"transparent",hover:Pc(b.colors[I.color][I.shade],.05),color:`var(--mantine-color-${I.color}-${I.shade})`,border:`${bt(1)} solid var(--mantine-color-${I.color}-${I.shade})`}:{background:"transparent",hover:Pc(p,.05),color:p,border:`${bt(1)} solid ${p}`};if(T==="subtle"){if(I.isThemeColor){if(I.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${p}-light-hover)`,color:`var(--mantine-color-${p}-light-color)`,border:`${bt(1)} solid transparent`};const l=b.colors[I.color][I.shade];return{background:"transparent",hover:Pc(l,.12),color:`var(--mantine-color-${I.color}-${Math.min(I.shade,6)})`,border:`${bt(1)} solid transparent`}}return{background:"transparent",hover:Pc(p,.12),color:p,border:`${bt(1)} solid transparent`}}return T==="transparent"?I.isThemeColor?I.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${p}-light-color)`,border:`${bt(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${I.color}-${Math.min(I.shade,6)})`,border:`${bt(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:p,border:`${bt(1)} solid transparent`}:T==="white"?I.isThemeColor?I.shade===void 0?{background:"var(--mantine-color-white)",hover:E_(b.white,.01),color:`var(--mantine-color-${p}-filled)`,border:`${bt(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:E_(b.white,.01),color:`var(--mantine-color-${I.color}-${I.shade})`,border:`${bt(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:E_(b.white,.01),color:p,border:`${bt(1)} solid transparent`}:T==="gradient"?{background:ev(S,b),hover:ev(S,b),color:"var(--mantine-color-white)",border:"none"}:T==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${bt(1)} solid var(--mantine-color-default-border)`}:{}},l2={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},F0="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",vv={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:l2,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:s2,autoContrast:!1,luminanceThreshold:.3,fontFamily:F0,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:F0,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:bt(34),lineHeight:"1.3"},h2:{fontSize:bt(26),lineHeight:"1.35"},h3:{fontSize:bt(22),lineHeight:"1.4"},h4:{fontSize:bt(18),lineHeight:"1.45"},h5:{fontSize:bt(16),lineHeight:"1.5"},h6:{fontSize:bt(14),lineHeight:"1.5"}}},fontSizes:{xs:bt(12),sm:bt(14),md:bt(16),lg:bt(18),xl:bt(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:bt(2),sm:bt(4),md:bt(8),lg:bt(16),xl:bt(32)},spacing:{xs:bt(10),sm:bt(12),md:bt(16),lg:bt(20),xl:bt(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${bt(1)} ${bt(3)} rgba(0, 0, 0, 0.05), 0 ${bt(1)} ${bt(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${bt(1)} ${bt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${bt(10)} ${bt(15)} ${bt(-5)}, rgba(0, 0, 0, 0.04) 0 ${bt(7)} ${bt(7)} ${bt(-5)}`,md:`0 ${bt(1)} ${bt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${bt(20)} ${bt(25)} ${bt(-5)}, rgba(0, 0, 0, 0.04) 0 ${bt(10)} ${bt(10)} ${bt(-5)}`,lg:`0 ${bt(1)} ${bt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${bt(28)} ${bt(23)} ${bt(-7)}, rgba(0, 0, 0, 0.04) 0 ${bt(12)} ${bt(12)} ${bt(-7)}`,xl:`0 ${bt(1)} ${bt(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${bt(36)} ${bt(28)} ${bt(-7)}, rgba(0, 0, 0, 0.04) 0 ${bt(17)} ${bt(17)} ${bt(-7)}`},other:{},components:{}};function N0(p){return p==="auto"||p==="dark"||p==="light"}function c2({key:p="mantine-color-scheme-value"}={}){let b;return{get:T=>{if(typeof window>"u")return T;try{const S=window.localStorage.getItem(p);return N0(S)?S:T}catch{return T}},set:T=>{try{window.localStorage.setItem(p,T)}catch(S){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",S)}},subscribe:T=>{b=S=>{S.storageArea===window.localStorage&&S.key===p&&N0(S.newValue)&&T(S.newValue)},window.addEventListener("storage",b)},unsubscribe:()=>{window.removeEventListener("storage",b)},clear:()=>{window.localStorage.removeItem(p)}}}const u2="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more  https://mantine.dev/theming/colors/#primary-color",j0="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function jy(p){return p<0||p>9?!1:parseInt(p.toString(),10)===p}function V0(p){if(!(p.primaryColor in p.colors))throw new Error(u2);if(typeof p.primaryShade=="object"&&(!jy(p.primaryShade.dark)||!jy(p.primaryShade.light)))throw new Error(j0);if(typeof p.primaryShade=="number"&&!jy(p.primaryShade))throw new Error(j0)}function h2(p,b){if(!b)return V0(p),p;const T=fv(p,b);return b.fontFamily&&!b.headings?.fontFamily&&(T.headings.fontFamily=b.fontFamily),V0(T),T}const xv=ue.createContext(null),d2=()=>ue.useContext(xv)||vv;function Bc(){const p=ue.useContext(xv);if(!p)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return p}function Zx({theme:p,children:b,inherit:T=!0}){const S=d2(),R=ue.useMemo(()=>h2(T?S:vv,p),[p,S,T]);return Te.jsx(xv.Provider,{value:R,children:b})}Zx.displayName="@mantine/core/MantineThemeProvider";function f2(){const p=Bc(),b=Z_(),T=Ic(p.breakpoints).reduce((S,R)=>{const I=p.breakpoints[R].includes("px"),E=Mw(p.breakpoints[R]),l=I?`${E-.1}px`:B0(E-.1),N=I?`${E}px`:B0(E);return`${S}@media (max-width: ${l}) {.mantine-visible-from-${R} {display: none !important;}}@media (min-width: ${N}) {.mantine-hidden-from-${R} {display: none !important;}}`},"");return Te.jsx("style",{"data-mantine-styles":"classes",nonce:b?.(),dangerouslySetInnerHTML:{__html:T}})}function Vy(p){return Object.entries(p).map(([b,T])=>`${b}: ${T};`).join("")}function Hx(p,b){const T=b?[b]:[":root",":host"],S=Vy(p.variables),R=S?`${T.join(", ")}{${S}}`:"",I=Vy(p.dark),E=Vy(p.light),l=Q=>T.map(ee=>ee===":host"?`${ee}([data-mantine-color-scheme="${Q}"])`:`${ee}[data-mantine-color-scheme="${Q}"]`).join(", "),N=I?`${l("dark")}{${I}}`:"",X=E?`${l("light")}{${E}}`:"";return`${R}

${N}

${X}`}function p2({color:p,theme:b,autoContrast:T}){return b.autoContrast&&vg({color:p||b.primaryColor,theme:b}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function U0(p,b){return p2({color:p.colors[p.primaryColor][pg(p,b)],theme:p,autoContrast:null})}function C_({theme:p,color:b,colorScheme:T,name:S=b,withColorValues:R=!0}){if(!p.colors[b])return{};if(T==="light"){const l=pg(p,"light"),N={[`--mantine-color-${S}-text`]:`var(--mantine-color-${S}-filled)`,[`--mantine-color-${S}-filled`]:`var(--mantine-color-${S}-${l})`,[`--mantine-color-${S}-filled-hover`]:`var(--mantine-color-${S}-${l===9?8:l+1})`,[`--mantine-color-${S}-light`]:Bp(p.colors[b][l],.1),[`--mantine-color-${S}-light-hover`]:Bp(p.colors[b][l],.12),[`--mantine-color-${S}-light-color`]:`var(--mantine-color-${S}-${l})`,[`--mantine-color-${S}-outline`]:`var(--mantine-color-${S}-${l})`,[`--mantine-color-${S}-outline-hover`]:Bp(p.colors[b][l],.05)};return R?{[`--mantine-color-${S}-0`]:p.colors[b][0],[`--mantine-color-${S}-1`]:p.colors[b][1],[`--mantine-color-${S}-2`]:p.colors[b][2],[`--mantine-color-${S}-3`]:p.colors[b][3],[`--mantine-color-${S}-4`]:p.colors[b][4],[`--mantine-color-${S}-5`]:p.colors[b][5],[`--mantine-color-${S}-6`]:p.colors[b][6],[`--mantine-color-${S}-7`]:p.colors[b][7],[`--mantine-color-${S}-8`]:p.colors[b][8],[`--mantine-color-${S}-9`]:p.colors[b][9],...N}:N}const I=pg(p,"dark"),E={[`--mantine-color-${S}-text`]:`var(--mantine-color-${S}-4)`,[`--mantine-color-${S}-filled`]:`var(--mantine-color-${S}-${I})`,[`--mantine-color-${S}-filled-hover`]:`var(--mantine-color-${S}-${I===9?8:I+1})`,[`--mantine-color-${S}-light`]:Bp(p.colors[b][Math.max(0,I-2)],.15),[`--mantine-color-${S}-light-hover`]:Bp(p.colors[b][Math.max(0,I-2)],.2),[`--mantine-color-${S}-light-color`]:`var(--mantine-color-${S}-${Math.max(I-5,0)})`,[`--mantine-color-${S}-outline`]:`var(--mantine-color-${S}-${Math.max(I-4,0)})`,[`--mantine-color-${S}-outline-hover`]:Bp(p.colors[b][Math.max(I-4,0)],.05)};return R?{[`--mantine-color-${S}-0`]:p.colors[b][0],[`--mantine-color-${S}-1`]:p.colors[b][1],[`--mantine-color-${S}-2`]:p.colors[b][2],[`--mantine-color-${S}-3`]:p.colors[b][3],[`--mantine-color-${S}-4`]:p.colors[b][4],[`--mantine-color-${S}-5`]:p.colors[b][5],[`--mantine-color-${S}-6`]:p.colors[b][6],[`--mantine-color-${S}-7`]:p.colors[b][7],[`--mantine-color-${S}-8`]:p.colors[b][8],[`--mantine-color-${S}-9`]:p.colors[b][9],...E}:E}function m2(p){return!!p&&typeof p=="object"&&"mantine-virtual-color"in p}function Fp(p,b,T){Ic(b).forEach(S=>Object.assign(p,{[`--mantine-${T}-${S}`]:b[S]}))}const Xx=p=>{const b=pg(p,"light"),T=p.defaultRadius in p.radius?p.radius[p.defaultRadius]:bt(p.defaultRadius),S={variables:{"--mantine-z-index-app":"100","--mantine-z-index-modal":"200","--mantine-z-index-popover":"300","--mantine-z-index-overlay":"400","--mantine-z-index-max":"9999","--mantine-scale":p.scale.toString(),"--mantine-cursor-type":p.cursorType,"--mantine-webkit-font-smoothing":p.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":p.fontSmoothing?"grayscale":"unset","--mantine-color-white":p.white,"--mantine-color-black":p.black,"--mantine-line-height":p.lineHeights.md,"--mantine-font-family":p.fontFamily,"--mantine-font-family-monospace":p.fontFamilyMonospace,"--mantine-font-family-headings":p.headings.fontFamily,"--mantine-heading-font-weight":p.headings.fontWeight,"--mantine-heading-text-wrap":p.headings.textWrap,"--mantine-radius-default":T,"--mantine-primary-color-filled":`var(--mantine-color-${p.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${p.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${p.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${p.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${p.primaryColor}-light-color)`},light:{"--mantine-color-scheme":"light","--mantine-primary-color-contrast":U0(p,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":p.black,"--mantine-color-body":p.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${p.primaryColor}-${b})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)","--mantine-color-disabled":"var(--mantine-color-gray-2)","--mantine-color-disabled-color":"var(--mantine-color-gray-5)","--mantine-color-disabled-border":"var(--mantine-color-gray-3)"},dark:{"--mantine-color-scheme":"dark","--mantine-primary-color-contrast":U0(p,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${p.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)","--mantine-color-disabled":"var(--mantine-color-dark-6)","--mantine-color-disabled-color":"var(--mantine-color-dark-3)","--mantine-color-disabled-border":"var(--mantine-color-dark-4)"}};Fp(S.variables,p.breakpoints,"breakpoint"),Fp(S.variables,p.spacing,"spacing"),Fp(S.variables,p.fontSizes,"font-size"),Fp(S.variables,p.lineHeights,"line-height"),Fp(S.variables,p.shadows,"shadow"),Fp(S.variables,p.radius,"radius"),p.colors[p.primaryColor].forEach((I,E)=>{S.variables[`--mantine-primary-color-${E}`]=`var(--mantine-color-${p.primaryColor}-${E})`}),Ic(p.colors).forEach(I=>{const E=p.colors[I];if(m2(E)){Object.assign(S.light,C_({theme:p,name:E.name,color:E.light,colorScheme:"light",withColorValues:!0})),Object.assign(S.dark,C_({theme:p,name:E.name,color:E.dark,colorScheme:"dark",withColorValues:!0}));return}E.forEach((l,N)=>{S.variables[`--mantine-color-${I}-${N}`]=l}),Object.assign(S.light,C_({theme:p,color:I,colorScheme:"light",withColorValues:!1})),Object.assign(S.dark,C_({theme:p,color:I,colorScheme:"dark",withColorValues:!1}))});const R=p.headings.sizes;return Ic(R).forEach(I=>{S.variables[`--mantine-${I}-font-size`]=R[I].fontSize,S.variables[`--mantine-${I}-line-height`]=R[I].lineHeight,S.variables[`--mantine-${I}-font-weight`]=R[I].fontWeight||p.headings.fontWeight}),S};function g2({theme:p,generator:b}){const T=Xx(p),S=b?.(p);return S?fv(T,S):T}const Uy=Xx(vv);function _2(p){const b={variables:{},light:{},dark:{}};return Ic(p.variables).forEach(T=>{Uy.variables[T]!==p.variables[T]&&(b.variables[T]=p.variables[T])}),Ic(p.light).forEach(T=>{Uy.light[T]!==p.light[T]&&(b.light[T]=p.light[T])}),Ic(p.dark).forEach(T=>{Uy.dark[T]!==p.dark[T]&&(b.dark[T]=p.dark[T])}),b}function y2(p){return Hx({variables:{},dark:{"--mantine-color-scheme":"dark"},light:{"--mantine-color-scheme":"light"}},p)}function Yx({cssVariablesSelector:p,deduplicateCssVariables:b}){const T=Bc(),S=Z_(),R=Yw(),I=g2({theme:T,generator:R}),E=(p===void 0||p===":root"||p===":host")&&b,l=E?_2(I):I,N=Hx(l,p);return N?Te.jsx("style",{"data-mantine-styles":!0,nonce:S?.(),dangerouslySetInnerHTML:{__html:`${N}${E?"":y2(p)}`}}):null}Yx.displayName="@mantine/CssVariables";function Np(p,b){const T=typeof window<"u"&&"matchMedia"in window&&window.matchMedia("(prefers-color-scheme: dark)")?.matches,S=p!=="auto"?p:T?"dark":"light";b()?.setAttribute("data-mantine-color-scheme",S)}function v2({manager:p,defaultColorScheme:b,getRootElement:T,forceColorScheme:S}){const R=ue.useRef(null),[I,E]=ue.useState(()=>p.get(b)),l=S||I,N=ue.useCallback(Q=>{S||(Np(Q,T),E(Q),p.set(Q))},[p.set,l,S]),X=ue.useCallback(()=>{E(b),Np(b,T),p.clear()},[p.clear,b]);return ue.useEffect(()=>(p.subscribe(N),p.unsubscribe),[p.subscribe,p.unsubscribe]),Yp(()=>{Np(p.get(b),T)},[]),ue.useEffect(()=>{if(S)return Np(S,T),()=>{};S===void 0&&Np(I,T),typeof window<"u"&&"matchMedia"in window&&(R.current=window.matchMedia("(prefers-color-scheme: dark)"));const Q=ee=>{I==="auto"&&Np(ee.matches?"dark":"light",T)};return R.current?.addEventListener("change",Q),()=>R.current?.removeEventListener("change",Q)},[I,S]),{colorScheme:l,setColorScheme:N,clearColorScheme:X}}function x2({respectReducedMotion:p,getRootElement:b}){Yp(()=>{p&&b()?.setAttribute("data-respect-reduced-motion","true")},[p])}function Wx({theme:p,children:b,getStyleNonce:T,withStaticClasses:S=!0,withGlobalClasses:R=!0,deduplicateCssVariables:I=!0,withCssVariables:E=!0,cssVariablesSelector:l,classNamesPrefix:N="mantine",colorSchemeManager:X=c2(),defaultColorScheme:Q="light",getRootElement:ee=()=>document.documentElement,cssVariablesResolver:le,forceColorScheme:ce,stylesTransform:Ce,env:xe}){const{colorScheme:ie,setColorScheme:Ue,clearColorScheme:$e}=v2({defaultColorScheme:Q,forceColorScheme:ce,manager:X,getRootElement:ee});return x2({respectReducedMotion:p?.respectReducedMotion||!1,getRootElement:ee}),Te.jsx(_v.Provider,{value:{colorScheme:ie,setColorScheme:Ue,clearColorScheme:$e,getRootElement:ee,classNamesPrefix:N,getStyleNonce:T,cssVariablesResolver:le,cssVariablesSelector:l??":root",withStaticClasses:S,stylesTransform:Ce,env:xe},children:Te.jsxs(Zx,{theme:p,children:[E&&Te.jsx(Yx,{cssVariablesSelector:l,deduplicateCssVariables:I}),R&&Te.jsx(f2,{}),b]})})}Wx.displayName="@mantine/core/MantineProvider";function bv({classNames:p,styles:b,props:T,stylesCtx:S}){const R=Bc();return{resolvedClassNames:$_({theme:R,classNames:p,props:T,stylesCtx:S||void 0}),resolvedStyles:L_({theme:R,styles:b,props:T,stylesCtx:S||void 0})}}const b2={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function w2({theme:p,options:b,unstyled:T}){return Fu(b?.focusable&&!T&&(p.focusClassName||b2[p.focusRing]),b?.active&&!T&&p.activeClassName)}function S2({selector:p,stylesCtx:b,options:T,props:S,theme:R}){return $_({theme:R,classNames:T?.classNames,props:T?.props||S,stylesCtx:b})[p]}function G0({selector:p,stylesCtx:b,theme:T,classNames:S,props:R}){return $_({theme:T,classNames:S,props:R,stylesCtx:b})[p]}function T2({rootSelector:p,selector:b,className:T}){return p===b?T:void 0}function E2({selector:p,classes:b,unstyled:T}){return T?void 0:b[p]}function C2({themeName:p,classNamesPrefix:b,selector:T,withStaticClass:S}){return S===!1?[]:p.map(R=>`${b}-${R}-${T}`)}function M2({themeName:p,theme:b,selector:T,props:S,stylesCtx:R}){return p.map(I=>$_({theme:b,classNames:b.components[I]?.classNames,props:S,stylesCtx:R})?.[T])}function A2({options:p,classes:b,selector:T,unstyled:S}){return p?.variant&&!S?b[`${T}--${p.variant}`]:void 0}function z2({theme:p,options:b,themeName:T,selector:S,classNamesPrefix:R,classNames:I,classes:E,unstyled:l,className:N,rootSelector:X,props:Q,stylesCtx:ee,withStaticClasses:le,headless:ce,transformedStyles:Ce}){return Fu(w2({theme:p,options:b,unstyled:l||ce}),M2({theme:p,themeName:T,selector:S,props:Q,stylesCtx:ee}),A2({options:b,classes:E,selector:S,unstyled:l}),G0({selector:S,stylesCtx:ee,theme:p,classNames:I,props:Q}),G0({selector:S,stylesCtx:ee,theme:p,classNames:Ce,props:Q}),S2({selector:S,stylesCtx:ee,options:b,props:Q,theme:p}),T2({rootSelector:X,selector:S,className:N}),E2({selector:S,classes:E,unstyled:l||ce}),le&&!ce&&C2({themeName:T,classNamesPrefix:R,selector:S,withStaticClass:b?.withStaticClass}),b?.className)}function D2({theme:p,themeName:b,props:T,stylesCtx:S,selector:R}){return b.map(I=>L_({theme:p,styles:p.components[I]?.styles,props:T,stylesCtx:S})[R]).reduce((I,E)=>({...I,...E}),{})}function tv({style:p,theme:b}){return Array.isArray(p)?[...p].reduce((T,S)=>({...T,...tv({style:S,theme:b})}),{}):typeof p=="function"?p(b):p??{}}function P2(p){return p.reduce((b,T)=>(T&&Object.keys(T).forEach(S=>{b[S]={...b[S],...U_(T[S])}}),b),{})}function R2({vars:p,varsResolver:b,theme:T,props:S,stylesCtx:R,selector:I,themeName:E,headless:l}){return P2([l?{}:b?.(T,S,R),...E.map(N=>T.components?.[N]?.vars?.(T,S,R)),p?.(T,S,R)])?.[I]}function I2({theme:p,themeName:b,selector:T,options:S,props:R,stylesCtx:I,rootSelector:E,styles:l,style:N,vars:X,varsResolver:Q,headless:ee,withStylesTransform:le}){return{...!le&&D2({theme:p,themeName:b,props:R,stylesCtx:I,selector:T}),...!le&&L_({theme:p,styles:l,props:R,stylesCtx:I})[T],...!le&&L_({theme:p,styles:S?.styles,props:S?.props||R,stylesCtx:I})[T],...R2({theme:p,props:R,stylesCtx:I,vars:X,varsResolver:Q,selector:T,themeName:b,headless:ee}),...E===T?tv({style:N,theme:p}):null,...tv({style:S?.style,theme:p})}}function L2({props:p,stylesCtx:b,themeName:T}){const S=Bc(),R=e2()?.();return{getTransformedStyles:E=>R?[...E.map(N=>R(N,{props:p,theme:S,ctx:b})),...T.map(N=>R(S.components[N]?.styles,{props:p,theme:S,ctx:b}))].filter(Boolean):[],withStylesTransform:!!R}}function Di({name:p,classes:b,props:T,stylesCtx:S,className:R,style:I,rootSelector:E="root",unstyled:l,classNames:N,styles:X,vars:Q,varsResolver:ee,attributes:le}){const ce=Bc(),Ce=Ww(),xe=Kw(),ie=Qw(),Ue=(Array.isArray(p)?p:[p]).filter(Ye=>Ye),{withStylesTransform:$e,getTransformedStyles:Le}=L2({props:T,stylesCtx:S,themeName:Ue});return(Ye,it)=>({className:z2({theme:ce,options:it,themeName:Ue,selector:Ye,classNamesPrefix:Ce,classNames:N,classes:b,unstyled:l,className:R,rootSelector:E,props:T,stylesCtx:S,withStaticClasses:xe,headless:ie,transformedStyles:Le([it?.styles,X])}),style:I2({theme:ce,themeName:Ue,selector:Ye,options:it,props:T,stylesCtx:S,rootSelector:E,styles:X,style:I,vars:Q,varsResolver:ee,headless:ie,withStylesTransform:$e}),...le?.[Ye]})}function q0(p){const b=document.createElement("style");return b.setAttribute("data-mantine-styles","inline"),b.innerHTML="*, *::before, *::after {transition: none !important;}",b.setAttribute("data-mantine-disable-transition","true"),p&&b.setAttribute("nonce",p),document.head.appendChild(b),()=>document.querySelectorAll("[data-mantine-disable-transition]").forEach(S=>S.remove())}function Kx({keepTransitions:p}={}){const b=ue.useRef(Ox),T=ue.useRef(-1),S=ue.useContext(_v),R=Z_(),I=ue.useRef(R?.());if(!S)throw new Error("[@mantine/core] MantineProvider was not found in tree");const E=ee=>{S.setColorScheme(ee),b.current=p?()=>{}:q0(I.current),window.clearTimeout(T.current),T.current=window.setTimeout(()=>{b.current?.()},10)},l=()=>{S.clearColorScheme(),b.current=p?()=>{}:q0(I.current),window.clearTimeout(T.current),T.current=window.setTimeout(()=>{b.current?.()},10)},N=Nx("light",{getInitialValueInEffect:!1}),X=S.colorScheme==="auto"?N:S.colorScheme,Q=ue.useCallback(()=>E(X==="light"?"dark":"light"),[E,X]);return ue.useEffect(()=>()=>{b.current?.(),window.clearTimeout(T.current)},[]),{colorScheme:S.colorScheme,setColorScheme:E,clearColorScheme:l,toggleColorScheme:Q}}function O2(p,b={getInitialValueInEffect:!0}){const T=Nx(p,b),{colorScheme:S}=Kx();return S==="auto"?T:S}function ln(p,b,T){const S=Bc(),R=S.components[p]?.defaultProps,I=typeof R=="function"?R(S):R;return{...b,...I,...U_(T)}}function Gy(p){return Ic(p).reduce((b,T)=>p[T]!==void 0?`${b}${Ew(T)}:${p[T]};`:b,"").trim()}function k2({selector:p,styles:b,media:T,container:S}){const R=b?Gy(b):"",I=Array.isArray(T)?T.map(l=>`@media${l.query}{${p}{${Gy(l.styles)}}}`):[],E=Array.isArray(S)?S.map(l=>`@container ${l.query}{${p}{${Gy(l.styles)}}}`):[];return`${R?`${p}{${R}}`:""}${I.join("")}${E.join("")}`.trim()}function Qx(p){const b=Z_();return Te.jsx("style",{"data-mantine-styles":"inline",nonce:b?.(),dangerouslySetInnerHTML:{__html:k2(p)}})}function wv(p){const{m:b,mx:T,my:S,mt:R,mb:I,ml:E,mr:l,me:N,ms:X,p:Q,px:ee,py:le,pt:ce,pb:Ce,pl:xe,pr:ie,pe:Ue,ps:$e,bd:Le,bdrs:Ye,bg:it,c:pt,opacity:Qe,ff:_t,fz:Pt,fw:Rt,lts:Zt,ta:Ot,lh:Vt,fs:Ft,tt:Ht,td:Pe,w:Xe,miw:ft,maw:yt,h:It,mih:Ee,mah:rt,bgsz:Tt,bgp:At,bgr:Ut,bga:Nt,pos:tn,top:fn,left:_n,bottom:$i,right:Fn,inset:vi,display:ya,flex:Pn,hiddenFrom:Zi,visibleFrom:Nn,lightHidden:Zn,darkHidden:Ar,sx:ea,...va}=p;return{styleProps:U_({m:b,mx:T,my:S,mt:R,mb:I,ml:E,mr:l,me:N,ms:X,p:Q,px:ee,py:le,pt:ce,pb:Ce,pl:xe,pr:ie,pe:Ue,ps:$e,bd:Le,bg:it,c:pt,opacity:Qe,ff:_t,fz:Pt,fw:Rt,lts:Zt,ta:Ot,lh:Vt,fs:Ft,tt:Ht,td:Pe,w:Xe,miw:ft,maw:yt,h:It,mih:Ee,mah:rt,bgsz:Tt,bgp:At,bgr:Ut,bga:Nt,pos:tn,top:fn,left:_n,bottom:$i,right:Fn,inset:vi,display:ya,flex:Pn,bdrs:Ye,hiddenFrom:Zi,visibleFrom:Nn,lightHidden:Zn,darkHidden:Ar,sx:ea}),rest:va}}const B2={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bdrs:{type:"radius",property:"borderRadius"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"size",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function Sv(p,b){const T=vg({color:p,theme:b});return T.color==="dimmed"?"var(--mantine-color-dimmed)":T.color==="bright"?"var(--mantine-color-bright)":T.variable?`var(${T.variable})`:T.color}function F2(p,b){const T=vg({color:p,theme:b});return T.isThemeColor&&T.shade===void 0?`var(--mantine-color-${T.color}-text)`:Sv(p,b)}function N2(p,b){if(typeof p=="number")return bt(p);if(typeof p=="string"){const[T,S,...R]=p.split(" ").filter(E=>E.trim()!=="");let I=`${bt(T)}`;return S&&(I+=` ${S}`),R.length>0&&(I+=` ${Sv(R.join(" "),b)}`),I.trim()}return p}const $0={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function j2(p){return typeof p=="string"&&p in $0?$0[p]:p}const V2=["h1","h2","h3","h4","h5","h6"];function U2(p,b){return typeof p=="string"&&p in b.fontSizes?`var(--mantine-font-size-${p})`:typeof p=="string"&&V2.includes(p)?`var(--mantine-${p}-font-size)`:typeof p=="number"||typeof p=="string"?bt(p):p}function G2(p){return p}const q2=["h1","h2","h3","h4","h5","h6"];function $2(p,b){return typeof p=="string"&&p in b.lineHeights?`var(--mantine-line-height-${p})`:typeof p=="string"&&q2.includes(p)?`var(--mantine-${p}-line-height)`:p}function Z2(p,b){return typeof p=="string"&&p in b.radius?`var(--mantine-radius-${p})`:typeof p=="number"||typeof p=="string"?bt(p):p}function H2(p){return typeof p=="number"?bt(p):p}function X2(p,b){if(typeof p=="number")return bt(p);if(typeof p=="string"){const T=p.replace("-","");if(!(T in b.spacing))return bt(p);const S=`--mantine-spacing-${T}`;return p.startsWith("-")?`calc(var(${S}) * -1)`:`var(${S})`}return p}const qy={color:Sv,textColor:F2,fontSize:U2,spacing:X2,radius:Z2,identity:G2,size:H2,lineHeight:$2,fontFamily:j2,border:N2};function Z0(p){return p.replace("(min-width: ","").replace("em)","")}function Y2({media:p,...b}){const S=Object.keys(p).sort((R,I)=>Number(Z0(R))-Number(Z0(I))).map(R=>({query:R,styles:p[R]}));return{...b,media:S}}function W2(p){if(typeof p!="object"||p===null)return!1;const b=Object.keys(p);return!(b.length===1&&b[0]==="base")}function K2(p){return typeof p=="object"&&p!==null?"base"in p?p.base:void 0:p}function Q2(p){return typeof p=="object"&&p!==null?Ic(p).filter(b=>b!=="base"):[]}function J2(p,b){return typeof p=="object"&&p!==null&&b in p?p[b]:p}function Jx({styleProps:p,data:b,theme:T}){return Y2(Ic(p).reduce((S,R)=>{if(R==="hiddenFrom"||R==="visibleFrom"||R==="sx")return S;const I=b[R],E=Array.isArray(I.property)?I.property:[I.property],l=K2(p[R]);if(!W2(p[R]))return E.forEach(X=>{S.inlineStyles[X]=qy[I.type](l,T)}),S;S.hasResponsiveStyles=!0;const N=Q2(p[R]);return E.forEach(X=>{l!=null&&(S.styles[X]=qy[I.type](l,T)),N.forEach(Q=>{const ee=`(min-width: ${T.breakpoints[Q]})`;S.media[ee]={...S.media[ee],[X]:qy[I.type](J2(p[R],Q),T)}})}),S},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function eb(){return`__m__-${ue.useId().replace(/[:]/g,"")}`}function tb(p){return p.startsWith("data-")?p:`data-${p}`}function eS(p){return Object.keys(p).reduce((b,T)=>{const S=p[T];return S===void 0||S===""||S===!1||S===null||(b[tb(T)]=p[T]),b},{})}function nb(p){return p?typeof p=="string"?{[tb(p)]:!0}:Array.isArray(p)?[...p].reduce((b,T)=>({...b,...nb(T)}),{}):eS(p):null}function nv(p,b){return Array.isArray(p)?[...p].reduce((T,S)=>({...T,...nv(S,b)}),{}):typeof p=="function"?p(b):p??{}}function tS({theme:p,style:b,vars:T,styleProps:S}){const R=nv(b,p),I=nv(T,p);return{...R,...I,...S}}const ib=ue.forwardRef(({component:p,style:b,__vars:T,className:S,variant:R,mod:I,size:E,hiddenFrom:l,visibleFrom:N,lightHidden:X,darkHidden:Q,renderRoot:ee,__size:le,...ce},Ce)=>{const xe=Bc(),ie=p||"div",{styleProps:Ue,rest:$e}=wv(ce),Ye=Jw()?.()?.(Ue.sx),it=eb(),pt=Jx({styleProps:Ue,theme:xe,data:B2}),Qe={ref:Ce,style:tS({theme:xe,style:b,vars:T,styleProps:pt.inlineStyles}),className:Fu(S,Ye,{[it]:pt.hasResponsiveStyles,"mantine-light-hidden":X,"mantine-dark-hidden":Q,[`mantine-hidden-from-${l}`]:l,[`mantine-visible-from-${N}`]:N}),"data-variant":R,"data-size":Rx(E)?void 0:E||void 0,size:le,...nb(I),...$e};return Te.jsxs(Te.Fragment,{children:[pt.hasResponsiveStyles&&Te.jsx(Qx,{selector:`.${it}`,styles:pt.styles,media:pt.media}),typeof ee=="function"?ee(Qe):Te.jsx(ie,{...Qe})]})});ib.displayName="@mantine/core/Box";const un=ib;function rb(p){return p}function $n(p){const b=ue.forwardRef(p);return b.extend=rb,b.withProps=T=>{const S=ue.forwardRef((R,I)=>Te.jsx(b,{...T,...R,ref:I}));return S.extend=b.extend,S.displayName=`WithProps(${b.displayName})`,S},b}function Ul(p){const b=ue.forwardRef(p);return b.withProps=T=>{const S=ue.forwardRef((R,I)=>Te.jsx(b,{...T,...R,ref:I}));return S.extend=b.extend,S.displayName=`WithProps(${b.displayName})`,S},b.extend=rb,b}const nS=ue.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function Tv(){return ue.useContext(nS)}var Ev=wx();const hg=j_(Ev);function X_(){return typeof window<"u"}function Wp(p){return ab(p)?(p.nodeName||"").toLowerCase():"#document"}function ds(p){var b;return(p==null||(b=p.ownerDocument)==null?void 0:b.defaultView)||window}function Fc(p){var b;return(b=(ab(p)?p.ownerDocument:p.document)||window.document)==null?void 0:b.documentElement}function ab(p){return X_()?p instanceof Node||p instanceof ds(p).Node:!1}function lo(p){return X_()?p instanceof Element||p instanceof ds(p).Element:!1}function Oc(p){return X_()?p instanceof HTMLElement||p instanceof ds(p).HTMLElement:!1}function H0(p){return!X_()||typeof ShadowRoot>"u"?!1:p instanceof ShadowRoot||p instanceof ds(p).ShadowRoot}const iS=new Set(["inline","contents"]);function xg(p){const{overflow:b,overflowX:T,overflowY:S,display:R}=Nl(p);return/auto|scroll|overlay|hidden|clip/.test(b+S+T)&&!iS.has(R)}const rS=new Set(["table","td","th"]);function aS(p){return rS.has(Wp(p))}const oS=[":popover-open",":modal"];function Y_(p){return oS.some(b=>{try{return p.matches(b)}catch{return!1}})}const sS=["transform","translate","scale","rotate","perspective"],lS=["transform","translate","scale","rotate","perspective","filter"],cS=["paint","layout","strict","content"];function Cv(p){const b=Mv(),T=lo(p)?Nl(p):p;return sS.some(S=>T[S]?T[S]!=="none":!1)||(T.containerType?T.containerType!=="normal":!1)||!b&&(T.backdropFilter?T.backdropFilter!=="none":!1)||!b&&(T.filter?T.filter!=="none":!1)||lS.some(S=>(T.willChange||"").includes(S))||cS.some(S=>(T.contain||"").includes(S))}function uS(p){let b=Gh(p);for(;Oc(b)&&!Zp(b);){if(Cv(b))return b;if(Y_(b))return null;b=Gh(b)}return null}function Mv(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const hS=new Set(["html","body","#document"]);function Zp(p){return hS.has(Wp(p))}function Nl(p){return ds(p).getComputedStyle(p)}function W_(p){return lo(p)?{scrollLeft:p.scrollLeft,scrollTop:p.scrollTop}:{scrollLeft:p.scrollX,scrollTop:p.scrollY}}function Gh(p){if(Wp(p)==="html")return p;const b=p.assignedSlot||p.parentNode||H0(p)&&p.host||Fc(p);return H0(b)?b.host:b}function ob(p){const b=Gh(p);return Zp(b)?p.ownerDocument?p.ownerDocument.body:p.body:Oc(b)&&xg(b)?b:ob(b)}function mg(p,b,T){var S;b===void 0&&(b=[]),T===void 0&&(T=!0);const R=ob(p),I=R===((S=p.ownerDocument)==null?void 0:S.body),E=ds(R);if(I){const l=iv(E);return b.concat(E,E.visualViewport||[],xg(R)?R:[],l&&T?mg(l):[])}return b.concat(R,mg(R,[],T))}function iv(p){return p.parent&&Object.getPrototypeOf(p.parent)?p.frameElement:null}const dS=["top","right","bottom","left"],jl=Math.min,Va=Math.max,O_=Math.round,M_=Math.floor,Lc=p=>({x:p,y:p}),fS={left:"right",right:"left",bottom:"top",top:"bottom"},pS={start:"end",end:"start"};function rv(p,b,T){return Va(p,jl(b,T))}function kc(p,b){return typeof p=="function"?p(b):p}function Vl(p){return p.split("-")[0]}function Kp(p){return p.split("-")[1]}function Av(p){return p==="x"?"y":"x"}function zv(p){return p==="y"?"height":"width"}const mS=new Set(["top","bottom"]);function kl(p){return mS.has(Vl(p))?"y":"x"}function Dv(p){return Av(kl(p))}function gS(p,b,T){T===void 0&&(T=!1);const S=Kp(p),R=Dv(p),I=zv(R);let E=R==="x"?S===(T?"end":"start")?"right":"left":S==="start"?"bottom":"top";return b.reference[I]>b.floating[I]&&(E=k_(E)),[E,k_(E)]}function _S(p){const b=k_(p);return[av(p),b,av(b)]}function av(p){return p.replace(/start|end/g,b=>pS[b])}const X0=["left","right"],Y0=["right","left"],yS=["top","bottom"],vS=["bottom","top"];function xS(p,b,T){switch(p){case"top":case"bottom":return T?b?Y0:X0:b?X0:Y0;case"left":case"right":return b?yS:vS;default:return[]}}function bS(p,b,T,S){const R=Kp(p);let I=xS(Vl(p),T==="start",S);return R&&(I=I.map(E=>E+"-"+R),b&&(I=I.concat(I.map(av)))),I}function k_(p){return p.replace(/left|right|bottom|top/g,b=>fS[b])}function wS(p){return{top:0,right:0,bottom:0,left:0,...p}}function Pv(p){return typeof p!="number"?wS(p):{top:p,right:p,bottom:p,left:p}}function Hp(p){const{x:b,y:T,width:S,height:R}=p;return{width:S,height:R,top:T,left:b,right:b+S,bottom:T+R,x:b,y:T}}var SS=typeof document<"u",TS=function(){},ov=SS?ue.useLayoutEffect:TS;const ES={...Tx},CS=ES.useInsertionEffect,MS=CS||(p=>p());function AS(p){const b=ue.useRef(()=>{});return MS(()=>{b.current=p}),ue.useCallback(function(){for(var T=arguments.length,S=new Array(T),R=0;R<T;R++)S[R]=arguments[R];return b.current==null?void 0:b.current(...S)},[])}function W0(p,b,T){let{reference:S,floating:R}=p;const I=kl(b),E=Dv(b),l=zv(E),N=Vl(b),X=I==="y",Q=S.x+S.width/2-R.width/2,ee=S.y+S.height/2-R.height/2,le=S[l]/2-R[l]/2;let ce;switch(N){case"top":ce={x:Q,y:S.y-R.height};break;case"bottom":ce={x:Q,y:S.y+S.height};break;case"right":ce={x:S.x+S.width,y:ee};break;case"left":ce={x:S.x-R.width,y:ee};break;default:ce={x:S.x,y:S.y}}switch(Kp(b)){case"start":ce[E]-=le*(T&&X?-1:1);break;case"end":ce[E]+=le*(T&&X?-1:1);break}return ce}async function zS(p,b){var T;b===void 0&&(b={});const{x:S,y:R,platform:I,rects:E,elements:l,strategy:N}=p,{boundary:X="clippingAncestors",rootBoundary:Q="viewport",elementContext:ee="floating",altBoundary:le=!1,padding:ce=0}=kc(b,p),Ce=Pv(ce),ie=l[le?ee==="floating"?"reference":"floating":ee],Ue=Hp(await I.getClippingRect({element:(T=await(I.isElement==null?void 0:I.isElement(ie)))==null||T?ie:ie.contextElement||await(I.getDocumentElement==null?void 0:I.getDocumentElement(l.floating)),boundary:X,rootBoundary:Q,strategy:N})),$e=ee==="floating"?{x:S,y:R,width:E.floating.width,height:E.floating.height}:E.reference,Le=await(I.getOffsetParent==null?void 0:I.getOffsetParent(l.floating)),Ye=await(I.isElement==null?void 0:I.isElement(Le))?await(I.getScale==null?void 0:I.getScale(Le))||{x:1,y:1}:{x:1,y:1},it=Hp(I.convertOffsetParentRelativeRectToViewportRelativeRect?await I.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:$e,offsetParent:Le,strategy:N}):$e);return{top:(Ue.top-it.top+Ce.top)/Ye.y,bottom:(it.bottom-Ue.bottom+Ce.bottom)/Ye.y,left:(Ue.left-it.left+Ce.left)/Ye.x,right:(it.right-Ue.right+Ce.right)/Ye.x}}const DS=async(p,b,T)=>{const{placement:S="bottom",strategy:R="absolute",middleware:I=[],platform:E}=T,l=I.filter(Boolean),N=await(E.isRTL==null?void 0:E.isRTL(b));let X=await E.getElementRects({reference:p,floating:b,strategy:R}),{x:Q,y:ee}=W0(X,S,N),le=S,ce={},Ce=0;for(let ie=0;ie<l.length;ie++){var xe;const{name:Ue,fn:$e}=l[ie],{x:Le,y:Ye,data:it,reset:pt}=await $e({x:Q,y:ee,initialPlacement:S,placement:le,strategy:R,middlewareData:ce,rects:X,platform:{...E,detectOverflow:(xe=E.detectOverflow)!=null?xe:zS},elements:{reference:p,floating:b}});Q=Le??Q,ee=Ye??ee,ce={...ce,[Ue]:{...ce[Ue],...it}},pt&&Ce<=50&&(Ce++,typeof pt=="object"&&(pt.placement&&(le=pt.placement),pt.rects&&(X=pt.rects===!0?await E.getElementRects({reference:p,floating:b,strategy:R}):pt.rects),{x:Q,y:ee}=W0(X,le,N)),ie=-1)}return{x:Q,y:ee,placement:le,strategy:R,middlewareData:ce}},PS=p=>({name:"arrow",options:p,async fn(b){const{x:T,y:S,placement:R,rects:I,platform:E,elements:l,middlewareData:N}=b,{element:X,padding:Q=0}=kc(p,b)||{};if(X==null)return{};const ee=Pv(Q),le={x:T,y:S},ce=Dv(R),Ce=zv(ce),xe=await E.getDimensions(X),ie=ce==="y",Ue=ie?"top":"left",$e=ie?"bottom":"right",Le=ie?"clientHeight":"clientWidth",Ye=I.reference[Ce]+I.reference[ce]-le[ce]-I.floating[Ce],it=le[ce]-I.reference[ce],pt=await(E.getOffsetParent==null?void 0:E.getOffsetParent(X));let Qe=pt?pt[Le]:0;(!Qe||!await(E.isElement==null?void 0:E.isElement(pt)))&&(Qe=l.floating[Le]||I.floating[Ce]);const _t=Ye/2-it/2,Pt=Qe/2-xe[Ce]/2-1,Rt=jl(ee[Ue],Pt),Zt=jl(ee[$e],Pt),Ot=Rt,Vt=Qe-xe[Ce]-Zt,Ft=Qe/2-xe[Ce]/2+_t,Ht=rv(Ot,Ft,Vt),Pe=!N.arrow&&Kp(R)!=null&&Ft!==Ht&&I.reference[Ce]/2-(Ft<Ot?Rt:Zt)-xe[Ce]/2<0,Xe=Pe?Ft<Ot?Ft-Ot:Ft-Vt:0;return{[ce]:le[ce]+Xe,data:{[ce]:Ht,centerOffset:Ft-Ht-Xe,...Pe&&{alignmentOffset:Xe}},reset:Pe}}}),RS=function(p){return p===void 0&&(p={}),{name:"flip",options:p,async fn(b){var T,S;const{placement:R,middlewareData:I,rects:E,initialPlacement:l,platform:N,elements:X}=b,{mainAxis:Q=!0,crossAxis:ee=!0,fallbackPlacements:le,fallbackStrategy:ce="bestFit",fallbackAxisSideDirection:Ce="none",flipAlignment:xe=!0,...ie}=kc(p,b);if((T=I.arrow)!=null&&T.alignmentOffset)return{};const Ue=Vl(R),$e=kl(l),Le=Vl(l)===l,Ye=await(N.isRTL==null?void 0:N.isRTL(X.floating)),it=le||(Le||!xe?[k_(l)]:_S(l)),pt=Ce!=="none";!le&&pt&&it.push(...bS(l,xe,Ce,Ye));const Qe=[l,...it],_t=await N.detectOverflow(b,ie),Pt=[];let Rt=((S=I.flip)==null?void 0:S.overflows)||[];if(Q&&Pt.push(_t[Ue]),ee){const Ft=gS(R,E,Ye);Pt.push(_t[Ft[0]],_t[Ft[1]])}if(Rt=[...Rt,{placement:R,overflows:Pt}],!Pt.every(Ft=>Ft<=0)){var Zt,Ot;const Ft=(((Zt=I.flip)==null?void 0:Zt.index)||0)+1,Ht=Qe[Ft];if(Ht&&(!(ee==="alignment"?$e!==kl(Ht):!1)||Rt.every(ft=>kl(ft.placement)===$e?ft.overflows[0]>0:!0)))return{data:{index:Ft,overflows:Rt},reset:{placement:Ht}};let Pe=(Ot=Rt.filter(Xe=>Xe.overflows[0]<=0).sort((Xe,ft)=>Xe.overflows[1]-ft.overflows[1])[0])==null?void 0:Ot.placement;if(!Pe)switch(ce){case"bestFit":{var Vt;const Xe=(Vt=Rt.filter(ft=>{if(pt){const yt=kl(ft.placement);return yt===$e||yt==="y"}return!0}).map(ft=>[ft.placement,ft.overflows.filter(yt=>yt>0).reduce((yt,It)=>yt+It,0)]).sort((ft,yt)=>ft[1]-yt[1])[0])==null?void 0:Vt[0];Xe&&(Pe=Xe);break}case"initialPlacement":Pe=l;break}if(R!==Pe)return{reset:{placement:Pe}}}return{}}}};function K0(p,b){return{top:p.top-b.height,right:p.right-b.width,bottom:p.bottom-b.height,left:p.left-b.width}}function Q0(p){return dS.some(b=>p[b]>=0)}const IS=function(p){return p===void 0&&(p={}),{name:"hide",options:p,async fn(b){const{rects:T,platform:S}=b,{strategy:R="referenceHidden",...I}=kc(p,b);switch(R){case"referenceHidden":{const E=await S.detectOverflow(b,{...I,elementContext:"reference"}),l=K0(E,T.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:Q0(l)}}}case"escaped":{const E=await S.detectOverflow(b,{...I,altBoundary:!0}),l=K0(E,T.floating);return{data:{escapedOffsets:l,escaped:Q0(l)}}}default:return{}}}}};function sb(p){const b=jl(...p.map(I=>I.left)),T=jl(...p.map(I=>I.top)),S=Va(...p.map(I=>I.right)),R=Va(...p.map(I=>I.bottom));return{x:b,y:T,width:S-b,height:R-T}}function LS(p){const b=p.slice().sort((R,I)=>R.y-I.y),T=[];let S=null;for(let R=0;R<b.length;R++){const I=b[R];!S||I.y-S.y>S.height/2?T.push([I]):T[T.length-1].push(I),S=I}return T.map(R=>Hp(sb(R)))}const OS=function(p){return p===void 0&&(p={}),{name:"inline",options:p,async fn(b){const{placement:T,elements:S,rects:R,platform:I,strategy:E}=b,{padding:l=2,x:N,y:X}=kc(p,b),Q=Array.from(await(I.getClientRects==null?void 0:I.getClientRects(S.reference))||[]),ee=LS(Q),le=Hp(sb(Q)),ce=Pv(l);function Ce(){if(ee.length===2&&ee[0].left>ee[1].right&&N!=null&&X!=null)return ee.find(ie=>N>ie.left-ce.left&&N<ie.right+ce.right&&X>ie.top-ce.top&&X<ie.bottom+ce.bottom)||le;if(ee.length>=2){if(kl(T)==="y"){const Rt=ee[0],Zt=ee[ee.length-1],Ot=Vl(T)==="top",Vt=Rt.top,Ft=Zt.bottom,Ht=Ot?Rt.left:Zt.left,Pe=Ot?Rt.right:Zt.right,Xe=Pe-Ht,ft=Ft-Vt;return{top:Vt,bottom:Ft,left:Ht,right:Pe,width:Xe,height:ft,x:Ht,y:Vt}}const ie=Vl(T)==="left",Ue=Va(...ee.map(Rt=>Rt.right)),$e=jl(...ee.map(Rt=>Rt.left)),Le=ee.filter(Rt=>ie?Rt.left===$e:Rt.right===Ue),Ye=Le[0].top,it=Le[Le.length-1].bottom,pt=$e,Qe=Ue,_t=Qe-pt,Pt=it-Ye;return{top:Ye,bottom:it,left:pt,right:Qe,width:_t,height:Pt,x:pt,y:Ye}}return le}const xe=await I.getElementRects({reference:{getBoundingClientRect:Ce},floating:S.floating,strategy:E});return R.reference.x!==xe.reference.x||R.reference.y!==xe.reference.y||R.reference.width!==xe.reference.width||R.reference.height!==xe.reference.height?{reset:{rects:xe}}:{}}}},lb=new Set(["left","top"]);async function kS(p,b){const{placement:T,platform:S,elements:R}=p,I=await(S.isRTL==null?void 0:S.isRTL(R.floating)),E=Vl(T),l=Kp(T),N=kl(T)==="y",X=lb.has(E)?-1:1,Q=I&&N?-1:1,ee=kc(b,p);let{mainAxis:le,crossAxis:ce,alignmentAxis:Ce}=typeof ee=="number"?{mainAxis:ee,crossAxis:0,alignmentAxis:null}:{mainAxis:ee.mainAxis||0,crossAxis:ee.crossAxis||0,alignmentAxis:ee.alignmentAxis};return l&&typeof Ce=="number"&&(ce=l==="end"?Ce*-1:Ce),N?{x:ce*Q,y:le*X}:{x:le*X,y:ce*Q}}const BS=function(p){return p===void 0&&(p=0),{name:"offset",options:p,async fn(b){var T,S;const{x:R,y:I,placement:E,middlewareData:l}=b,N=await kS(b,p);return E===((T=l.offset)==null?void 0:T.placement)&&(S=l.arrow)!=null&&S.alignmentOffset?{}:{x:R+N.x,y:I+N.y,data:{...N,placement:E}}}}},FS=function(p){return p===void 0&&(p={}),{name:"shift",options:p,async fn(b){const{x:T,y:S,placement:R,platform:I}=b,{mainAxis:E=!0,crossAxis:l=!1,limiter:N={fn:Ue=>{let{x:$e,y:Le}=Ue;return{x:$e,y:Le}}},...X}=kc(p,b),Q={x:T,y:S},ee=await I.detectOverflow(b,X),le=kl(Vl(R)),ce=Av(le);let Ce=Q[ce],xe=Q[le];if(E){const Ue=ce==="y"?"top":"left",$e=ce==="y"?"bottom":"right",Le=Ce+ee[Ue],Ye=Ce-ee[$e];Ce=rv(Le,Ce,Ye)}if(l){const Ue=le==="y"?"top":"left",$e=le==="y"?"bottom":"right",Le=xe+ee[Ue],Ye=xe-ee[$e];xe=rv(Le,xe,Ye)}const ie=N.fn({...b,[ce]:Ce,[le]:xe});return{...ie,data:{x:ie.x-T,y:ie.y-S,enabled:{[ce]:E,[le]:l}}}}}},NS=function(p){return p===void 0&&(p={}),{options:p,fn(b){const{x:T,y:S,placement:R,rects:I,middlewareData:E}=b,{offset:l=0,mainAxis:N=!0,crossAxis:X=!0}=kc(p,b),Q={x:T,y:S},ee=kl(R),le=Av(ee);let ce=Q[le],Ce=Q[ee];const xe=kc(l,b),ie=typeof xe=="number"?{mainAxis:xe,crossAxis:0}:{mainAxis:0,crossAxis:0,...xe};if(N){const Le=le==="y"?"height":"width",Ye=I.reference[le]-I.floating[Le]+ie.mainAxis,it=I.reference[le]+I.reference[Le]-ie.mainAxis;ce<Ye?ce=Ye:ce>it&&(ce=it)}if(X){var Ue,$e;const Le=le==="y"?"width":"height",Ye=lb.has(Vl(R)),it=I.reference[ee]-I.floating[Le]+(Ye&&((Ue=E.offset)==null?void 0:Ue[ee])||0)+(Ye?0:ie.crossAxis),pt=I.reference[ee]+I.reference[Le]+(Ye?0:(($e=E.offset)==null?void 0:$e[ee])||0)-(Ye?ie.crossAxis:0);Ce<it?Ce=it:Ce>pt&&(Ce=pt)}return{[le]:ce,[ee]:Ce}}}},jS=function(p){return p===void 0&&(p={}),{name:"size",options:p,async fn(b){var T,S;const{placement:R,rects:I,platform:E,elements:l}=b,{apply:N=()=>{},...X}=kc(p,b),Q=await E.detectOverflow(b,X),ee=Vl(R),le=Kp(R),ce=kl(R)==="y",{width:Ce,height:xe}=I.floating;let ie,Ue;ee==="top"||ee==="bottom"?(ie=ee,Ue=le===(await(E.isRTL==null?void 0:E.isRTL(l.floating))?"start":"end")?"left":"right"):(Ue=ee,ie=le==="end"?"top":"bottom");const $e=xe-Q.top-Q.bottom,Le=Ce-Q.left-Q.right,Ye=jl(xe-Q[ie],$e),it=jl(Ce-Q[Ue],Le),pt=!b.middlewareData.shift;let Qe=Ye,_t=it;if((T=b.middlewareData.shift)!=null&&T.enabled.x&&(_t=Le),(S=b.middlewareData.shift)!=null&&S.enabled.y&&(Qe=$e),pt&&!le){const Rt=Va(Q.left,0),Zt=Va(Q.right,0),Ot=Va(Q.top,0),Vt=Va(Q.bottom,0);ce?_t=Ce-2*(Rt!==0||Zt!==0?Rt+Zt:Va(Q.left,Q.right)):Qe=xe-2*(Ot!==0||Vt!==0?Ot+Vt:Va(Q.top,Q.bottom))}await N({...b,availableWidth:_t,availableHeight:Qe});const Pt=await E.getDimensions(l.floating);return Ce!==Pt.width||xe!==Pt.height?{reset:{rects:!0}}:{}}}};function cb(p){const b=Nl(p);let T=parseFloat(b.width)||0,S=parseFloat(b.height)||0;const R=Oc(p),I=R?p.offsetWidth:T,E=R?p.offsetHeight:S,l=O_(T)!==I||O_(S)!==E;return l&&(T=I,S=E),{width:T,height:S,$:l}}function Rv(p){return lo(p)?p:p.contextElement}function qp(p){const b=Rv(p);if(!Oc(b))return Lc(1);const T=b.getBoundingClientRect(),{width:S,height:R,$:I}=cb(b);let E=(I?O_(T.width):T.width)/S,l=(I?O_(T.height):T.height)/R;return(!E||!Number.isFinite(E))&&(E=1),(!l||!Number.isFinite(l))&&(l=1),{x:E,y:l}}const VS=Lc(0);function ub(p){const b=ds(p);return!Mv()||!b.visualViewport?VS:{x:b.visualViewport.offsetLeft,y:b.visualViewport.offsetTop}}function US(p,b,T){return b===void 0&&(b=!1),!T||b&&T!==ds(p)?!1:b}function cf(p,b,T,S){b===void 0&&(b=!1),T===void 0&&(T=!1);const R=p.getBoundingClientRect(),I=Rv(p);let E=Lc(1);b&&(S?lo(S)&&(E=qp(S)):E=qp(p));const l=US(I,T,S)?ub(I):Lc(0);let N=(R.left+l.x)/E.x,X=(R.top+l.y)/E.y,Q=R.width/E.x,ee=R.height/E.y;if(I){const le=ds(I),ce=S&&lo(S)?ds(S):S;let Ce=le,xe=iv(Ce);for(;xe&&S&&ce!==Ce;){const ie=qp(xe),Ue=xe.getBoundingClientRect(),$e=Nl(xe),Le=Ue.left+(xe.clientLeft+parseFloat($e.paddingLeft))*ie.x,Ye=Ue.top+(xe.clientTop+parseFloat($e.paddingTop))*ie.y;N*=ie.x,X*=ie.y,Q*=ie.x,ee*=ie.y,N+=Le,X+=Ye,Ce=ds(xe),xe=iv(Ce)}}return Hp({width:Q,height:ee,x:N,y:X})}function K_(p,b){const T=W_(p).scrollLeft;return b?b.left+T:cf(Fc(p)).left+T}function hb(p,b){const T=p.getBoundingClientRect(),S=T.left+b.scrollLeft-K_(p,T),R=T.top+b.scrollTop;return{x:S,y:R}}function GS(p){let{elements:b,rect:T,offsetParent:S,strategy:R}=p;const I=R==="fixed",E=Fc(S),l=b?Y_(b.floating):!1;if(S===E||l&&I)return T;let N={scrollLeft:0,scrollTop:0},X=Lc(1);const Q=Lc(0),ee=Oc(S);if((ee||!ee&&!I)&&((Wp(S)!=="body"||xg(E))&&(N=W_(S)),Oc(S))){const ce=cf(S);X=qp(S),Q.x=ce.x+S.clientLeft,Q.y=ce.y+S.clientTop}const le=E&&!ee&&!I?hb(E,N):Lc(0);return{width:T.width*X.x,height:T.height*X.y,x:T.x*X.x-N.scrollLeft*X.x+Q.x+le.x,y:T.y*X.y-N.scrollTop*X.y+Q.y+le.y}}function qS(p){return Array.from(p.getClientRects())}function $S(p){const b=Fc(p),T=W_(p),S=p.ownerDocument.body,R=Va(b.scrollWidth,b.clientWidth,S.scrollWidth,S.clientWidth),I=Va(b.scrollHeight,b.clientHeight,S.scrollHeight,S.clientHeight);let E=-T.scrollLeft+K_(p);const l=-T.scrollTop;return Nl(S).direction==="rtl"&&(E+=Va(b.clientWidth,S.clientWidth)-R),{width:R,height:I,x:E,y:l}}const J0=25;function ZS(p,b){const T=ds(p),S=Fc(p),R=T.visualViewport;let I=S.clientWidth,E=S.clientHeight,l=0,N=0;if(R){I=R.width,E=R.height;const Q=Mv();(!Q||Q&&b==="fixed")&&(l=R.offsetLeft,N=R.offsetTop)}const X=K_(S);if(X<=0){const Q=S.ownerDocument,ee=Q.body,le=getComputedStyle(ee),ce=Q.compatMode==="CSS1Compat"&&parseFloat(le.marginLeft)+parseFloat(le.marginRight)||0,Ce=Math.abs(S.clientWidth-ee.clientWidth-ce);Ce<=J0&&(I-=Ce)}else X<=J0&&(I+=X);return{width:I,height:E,x:l,y:N}}const HS=new Set(["absolute","fixed"]);function XS(p,b){const T=cf(p,!0,b==="fixed"),S=T.top+p.clientTop,R=T.left+p.clientLeft,I=Oc(p)?qp(p):Lc(1),E=p.clientWidth*I.x,l=p.clientHeight*I.y,N=R*I.x,X=S*I.y;return{width:E,height:l,x:N,y:X}}function ex(p,b,T){let S;if(b==="viewport")S=ZS(p,T);else if(b==="document")S=$S(Fc(p));else if(lo(b))S=XS(b,T);else{const R=ub(p);S={x:b.x-R.x,y:b.y-R.y,width:b.width,height:b.height}}return Hp(S)}function db(p,b){const T=Gh(p);return T===b||!lo(T)||Zp(T)?!1:Nl(T).position==="fixed"||db(T,b)}function YS(p,b){const T=b.get(p);if(T)return T;let S=mg(p,[],!1).filter(l=>lo(l)&&Wp(l)!=="body"),R=null;const I=Nl(p).position==="fixed";let E=I?Gh(p):p;for(;lo(E)&&!Zp(E);){const l=Nl(E),N=Cv(E);!N&&l.position==="fixed"&&(R=null),(I?!N&&!R:!N&&l.position==="static"&&!!R&&HS.has(R.position)||xg(E)&&!N&&db(p,E))?S=S.filter(Q=>Q!==E):R=l,E=Gh(E)}return b.set(p,S),S}function WS(p){let{element:b,boundary:T,rootBoundary:S,strategy:R}=p;const E=[...T==="clippingAncestors"?Y_(b)?[]:YS(b,this._c):[].concat(T),S],l=E[0],N=E.reduce((X,Q)=>{const ee=ex(b,Q,R);return X.top=Va(ee.top,X.top),X.right=jl(ee.right,X.right),X.bottom=jl(ee.bottom,X.bottom),X.left=Va(ee.left,X.left),X},ex(b,l,R));return{width:N.right-N.left,height:N.bottom-N.top,x:N.left,y:N.top}}function KS(p){const{width:b,height:T}=cb(p);return{width:b,height:T}}function QS(p,b,T){const S=Oc(b),R=Fc(b),I=T==="fixed",E=cf(p,!0,I,b);let l={scrollLeft:0,scrollTop:0};const N=Lc(0);function X(){N.x=K_(R)}if(S||!S&&!I)if((Wp(b)!=="body"||xg(R))&&(l=W_(b)),S){const ce=cf(b,!0,I,b);N.x=ce.x+b.clientLeft,N.y=ce.y+b.clientTop}else R&&X();I&&!S&&R&&X();const Q=R&&!S&&!I?hb(R,l):Lc(0),ee=E.left+l.scrollLeft-N.x-Q.x,le=E.top+l.scrollTop-N.y-Q.y;return{x:ee,y:le,width:E.width,height:E.height}}function $y(p){return Nl(p).position==="static"}function tx(p,b){if(!Oc(p)||Nl(p).position==="fixed")return null;if(b)return b(p);let T=p.offsetParent;return Fc(p)===T&&(T=T.ownerDocument.body),T}function fb(p,b){const T=ds(p);if(Y_(p))return T;if(!Oc(p)){let R=Gh(p);for(;R&&!Zp(R);){if(lo(R)&&!$y(R))return R;R=Gh(R)}return T}let S=tx(p,b);for(;S&&aS(S)&&$y(S);)S=tx(S,b);return S&&Zp(S)&&$y(S)&&!Cv(S)?T:S||uS(p)||T}const JS=async function(p){const b=this.getOffsetParent||fb,T=this.getDimensions,S=await T(p.floating);return{reference:QS(p.reference,await b(p.floating),p.strategy),floating:{x:0,y:0,width:S.width,height:S.height}}};function eT(p){return Nl(p).direction==="rtl"}const tT={convertOffsetParentRelativeRectToViewportRelativeRect:GS,getDocumentElement:Fc,getClippingRect:WS,getOffsetParent:fb,getElementRects:JS,getClientRects:qS,getDimensions:KS,getScale:qp,isElement:lo,isRTL:eT};function pb(p,b){return p.x===b.x&&p.y===b.y&&p.width===b.width&&p.height===b.height}function nT(p,b){let T=null,S;const R=Fc(p);function I(){var l;clearTimeout(S),(l=T)==null||l.disconnect(),T=null}function E(l,N){l===void 0&&(l=!1),N===void 0&&(N=1),I();const X=p.getBoundingClientRect(),{left:Q,top:ee,width:le,height:ce}=X;if(l||b(),!le||!ce)return;const Ce=M_(ee),xe=M_(R.clientWidth-(Q+le)),ie=M_(R.clientHeight-(ee+ce)),Ue=M_(Q),Le={rootMargin:-Ce+"px "+-xe+"px "+-ie+"px "+-Ue+"px",threshold:Va(0,jl(1,N))||1};let Ye=!0;function it(pt){const Qe=pt[0].intersectionRatio;if(Qe!==N){if(!Ye)return E();Qe?E(!1,Qe):S=setTimeout(()=>{E(!1,1e-7)},1e3)}Qe===1&&!pb(X,p.getBoundingClientRect())&&E(),Ye=!1}try{T=new IntersectionObserver(it,{...Le,root:R.ownerDocument})}catch{T=new IntersectionObserver(it,Le)}T.observe(p)}return E(!0),I}function nx(p,b,T,S){S===void 0&&(S={});const{ancestorScroll:R=!0,ancestorResize:I=!0,elementResize:E=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:N=!1}=S,X=Rv(p),Q=R||I?[...X?mg(X):[],...mg(b)]:[];Q.forEach(Ue=>{R&&Ue.addEventListener("scroll",T,{passive:!0}),I&&Ue.addEventListener("resize",T)});const ee=X&&l?nT(X,T):null;let le=-1,ce=null;E&&(ce=new ResizeObserver(Ue=>{let[$e]=Ue;$e&&$e.target===X&&ce&&(ce.unobserve(b),cancelAnimationFrame(le),le=requestAnimationFrame(()=>{var Le;(Le=ce)==null||Le.observe(b)})),T()}),X&&!N&&ce.observe(X),ce.observe(b));let Ce,xe=N?cf(p):null;N&&ie();function ie(){const Ue=cf(p);xe&&!pb(xe,Ue)&&T(),xe=Ue,Ce=requestAnimationFrame(ie)}return T(),()=>{var Ue;Q.forEach($e=>{R&&$e.removeEventListener("scroll",T),I&&$e.removeEventListener("resize",T)}),ee?.(),(Ue=ce)==null||Ue.disconnect(),ce=null,N&&cancelAnimationFrame(Ce)}}const iT=BS,rT=FS,aT=RS,oT=jS,sT=IS,ix=PS,lT=OS,cT=NS,uT=(p,b,T)=>{const S=new Map,R={platform:tT,...T},I={...R.platform,_c:S};return DS(p,b,{...R,platform:I})};var hT=typeof document<"u",dT=function(){},R_=hT?ue.useLayoutEffect:dT;function B_(p,b){if(p===b)return!0;if(typeof p!=typeof b)return!1;if(typeof p=="function"&&p.toString()===b.toString())return!0;let T,S,R;if(p&&b&&typeof p=="object"){if(Array.isArray(p)){if(T=p.length,T!==b.length)return!1;for(S=T;S--!==0;)if(!B_(p[S],b[S]))return!1;return!0}if(R=Object.keys(p),T=R.length,T!==Object.keys(b).length)return!1;for(S=T;S--!==0;)if(!{}.hasOwnProperty.call(b,R[S]))return!1;for(S=T;S--!==0;){const I=R[S];if(!(I==="_owner"&&p.$$typeof)&&!B_(p[I],b[I]))return!1}return!0}return p!==p&&b!==b}function mb(p){return typeof window>"u"?1:(p.ownerDocument.defaultView||window).devicePixelRatio||1}function rx(p,b){const T=mb(p);return Math.round(b*T)/T}function Zy(p){const b=ue.useRef(p);return R_(()=>{b.current=p}),b}function fT(p){p===void 0&&(p={});const{placement:b="bottom",strategy:T="absolute",middleware:S=[],platform:R,elements:{reference:I,floating:E}={},transform:l=!0,whileElementsMounted:N,open:X}=p,[Q,ee]=ue.useState({x:0,y:0,strategy:T,placement:b,middlewareData:{},isPositioned:!1}),[le,ce]=ue.useState(S);B_(le,S)||ce(S);const[Ce,xe]=ue.useState(null),[ie,Ue]=ue.useState(null),$e=ue.useCallback(ft=>{ft!==pt.current&&(pt.current=ft,xe(ft))},[]),Le=ue.useCallback(ft=>{ft!==Qe.current&&(Qe.current=ft,Ue(ft))},[]),Ye=I||Ce,it=E||ie,pt=ue.useRef(null),Qe=ue.useRef(null),_t=ue.useRef(Q),Pt=N!=null,Rt=Zy(N),Zt=Zy(R),Ot=Zy(X),Vt=ue.useCallback(()=>{if(!pt.current||!Qe.current)return;const ft={placement:b,strategy:T,middleware:le};Zt.current&&(ft.platform=Zt.current),uT(pt.current,Qe.current,ft).then(yt=>{const It={...yt,isPositioned:Ot.current!==!1};Ft.current&&!B_(_t.current,It)&&(_t.current=It,Ev.flushSync(()=>{ee(It)}))})},[le,b,T,Zt,Ot]);R_(()=>{X===!1&&_t.current.isPositioned&&(_t.current.isPositioned=!1,ee(ft=>({...ft,isPositioned:!1})))},[X]);const Ft=ue.useRef(!1);R_(()=>(Ft.current=!0,()=>{Ft.current=!1}),[]),R_(()=>{if(Ye&&(pt.current=Ye),it&&(Qe.current=it),Ye&&it){if(Rt.current)return Rt.current(Ye,it,Vt);Vt()}},[Ye,it,Vt,Rt,Pt]);const Ht=ue.useMemo(()=>({reference:pt,floating:Qe,setReference:$e,setFloating:Le}),[$e,Le]),Pe=ue.useMemo(()=>({reference:Ye,floating:it}),[Ye,it]),Xe=ue.useMemo(()=>{const ft={position:T,left:0,top:0};if(!Pe.floating)return ft;const yt=rx(Pe.floating,Q.x),It=rx(Pe.floating,Q.y);return l?{...ft,transform:"translate("+yt+"px, "+It+"px)",...mb(Pe.floating)>=1.5&&{willChange:"transform"}}:{position:T,left:yt,top:It}},[T,l,Pe.floating,Q.x,Q.y]);return ue.useMemo(()=>({...Q,update:Vt,refs:Ht,elements:Pe,floatingStyles:Xe}),[Q,Vt,Ht,Pe,Xe])}const pT=p=>{function b(T){return{}.hasOwnProperty.call(T,"current")}return{name:"arrow",options:p,fn(T){const{element:S,padding:R}=typeof p=="function"?p(T):p;return S&&b(S)?S.current!=null?ix({element:S.current,padding:R}).fn(T):{}:S?ix({element:S,padding:R}).fn(T):{}}}},mT=(p,b)=>({...iT(p),options:[p,b]}),gT=(p,b)=>({...rT(p),options:[p,b]}),ax=(p,b)=>({...cT(p),options:[p,b]}),ox=(p,b)=>({...aT(p),options:[p,b]}),_T=(p,b)=>({...oT(p),options:[p,b]}),yT=(p,b)=>({...sT(p),options:[p,b]}),sx=(p,b)=>({...lT(p),options:[p,b]}),vT=(p,b)=>({...pT(p),options:[p,b]});function gb(p){const b=ue.useRef(void 0),T=ue.useCallback(S=>{const R=p.map(I=>{if(I!=null){if(typeof I=="function"){const E=I,l=E(S);return typeof l=="function"?l:()=>{E(null)}}return I.current=S,()=>{I.current=null}}});return()=>{R.forEach(I=>I?.())}},p);return ue.useMemo(()=>p.every(S=>S==null)?null:S=>{b.current&&(b.current(),b.current=void 0),S!=null&&(b.current=T(S))},p)}const xT={...Tx};let lx=!1,bT=0;const cx=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+bT++;function wT(){const[p,b]=ue.useState(()=>lx?cx():void 0);return ov(()=>{p==null&&b(cx())},[]),ue.useEffect(()=>{lx=!0},[]),p}const ST=xT.useId,TT=ST||wT;function ET(){const p=new Map;return{emit(b,T){var S;(S=p.get(b))==null||S.forEach(R=>R(T))},on(b,T){p.has(b)||p.set(b,new Set),p.get(b).add(T)},off(b,T){var S;(S=p.get(b))==null||S.delete(T)}}}const CT=ue.createContext(null),MT=ue.createContext(null),AT=()=>{var p;return((p=ue.useContext(CT))==null?void 0:p.id)||null},zT=()=>ue.useContext(MT);function DT(p){const{open:b=!1,onOpenChange:T,elements:S}=p,R=TT(),I=ue.useRef({}),[E]=ue.useState(()=>ET()),l=AT()!=null,[N,X]=ue.useState(S.reference),Q=AS((ce,Ce,xe)=>{I.current.openEvent=ce?Ce:void 0,E.emit("openchange",{open:ce,event:Ce,reason:xe,nested:l}),T?.(ce,Ce,xe)}),ee=ue.useMemo(()=>({setPositionReference:X}),[]),le=ue.useMemo(()=>({reference:N||S.reference||null,floating:S.floating||null,domReference:S.reference}),[N,S.reference,S.floating]);return ue.useMemo(()=>({dataRef:I,open:b,onOpenChange:Q,elements:le,events:E,floatingId:R,refs:ee}),[b,Q,le,E,R,ee])}function PT(p){p===void 0&&(p={});const{nodeId:b}=p,T=DT({...p,elements:{reference:null,floating:null,...p.elements}}),S=p.rootContext||T,R=S.elements,[I,E]=ue.useState(null),[l,N]=ue.useState(null),Q=R?.domReference||I,ee=ue.useRef(null),le=zT();ov(()=>{Q&&(ee.current=Q)},[Q]);const ce=fT({...p,elements:{...R,...l&&{reference:l}}}),Ce=ue.useCallback(Le=>{const Ye=lo(Le)?{getBoundingClientRect:()=>Le.getBoundingClientRect(),getClientRects:()=>Le.getClientRects(),contextElement:Le}:Le;N(Ye),ce.refs.setReference(Ye)},[ce.refs]),xe=ue.useCallback(Le=>{(lo(Le)||Le===null)&&(ee.current=Le,E(Le)),(lo(ce.refs.reference.current)||ce.refs.reference.current===null||Le!==null&&!lo(Le))&&ce.refs.setReference(Le)},[ce.refs]),ie=ue.useMemo(()=>({...ce.refs,setReference:xe,setPositionReference:Ce,domReference:ee}),[ce.refs,xe,Ce]),Ue=ue.useMemo(()=>({...ce.elements,domReference:Q}),[ce.elements,Q]),$e=ue.useMemo(()=>({...ce,...S,refs:ie,elements:Ue,nodeId:b}),[ce,ie,Ue,b,S]);return ov(()=>{S.dataRef.current.floatingContext=$e;const Le=le?.nodesRef.current.find(Ye=>Ye.id===b);Le&&(Le.context=$e)}),ue.useMemo(()=>({...ce,context:$e,refs:ie,elements:Ue}),[ce,ie,Ue,$e])}var Iv={root:"m_d57069b5",content:"m_b1336c6",viewport:"m_c0783ff9",viewportInner:"m_f8f631dd",scrollbar:"m_c44ba933",thumb:"m_d8b5e363",corner:"m_21657268"};const[RT,qs]=_g("ScrollArea.Root component was not found in tree");function Xp(p,b){const T=of(b);Yp(()=>{let S=0;if(p){const R=new ResizeObserver(()=>{cancelAnimationFrame(S),S=window.requestAnimationFrame(T)});return R.observe(p),()=>{window.cancelAnimationFrame(S),R.unobserve(p)}}},[p,T])}const IT=ue.forwardRef((p,b)=>{const{style:T,...S}=p,R=qs(),[I,E]=ue.useState(0),[l,N]=ue.useState(0),X=!!(I&&l);return Xp(R.scrollbarX,()=>{const Q=R.scrollbarX?.offsetHeight||0;R.onCornerHeightChange(Q),N(Q)}),Xp(R.scrollbarY,()=>{const Q=R.scrollbarY?.offsetWidth||0;R.onCornerWidthChange(Q),E(Q)}),X?Te.jsx("div",{...S,ref:b,style:{...T,width:I,height:l}}):null}),LT=ue.forwardRef((p,b)=>{const T=qs(),S=!!(T.scrollbarX&&T.scrollbarY);return T.type!=="scroll"&&S?Te.jsx(IT,{...p,ref:b}):null}),OT={scrollHideDelay:1e3,type:"hover"},_b=ue.forwardRef((p,b)=>{const{type:T,scrollHideDelay:S,scrollbars:R,getStyles:I,...E}=ln("ScrollAreaRoot",OT,p),[l,N]=ue.useState(null),[X,Q]=ue.useState(null),[ee,le]=ue.useState(null),[ce,Ce]=ue.useState(null),[xe,ie]=ue.useState(null),[Ue,$e]=ue.useState(0),[Le,Ye]=ue.useState(0),[it,pt]=ue.useState(!1),[Qe,_t]=ue.useState(!1),Pt=Gs(b,Rt=>N(Rt));return Te.jsx(RT,{value:{type:T,scrollHideDelay:S,scrollArea:l,viewport:X,onViewportChange:Q,content:ee,onContentChange:le,scrollbarX:ce,onScrollbarXChange:Ce,scrollbarXEnabled:it,onScrollbarXEnabledChange:pt,scrollbarY:xe,onScrollbarYChange:ie,scrollbarYEnabled:Qe,onScrollbarYEnabledChange:_t,onCornerWidthChange:$e,onCornerHeightChange:Ye,getStyles:I},children:Te.jsx(un,{...E,ref:Pt,__vars:{"--sa-corner-width":R!=="xy"?"0px":`${Ue}px`,"--sa-corner-height":R!=="xy"?"0px":`${Le}px`}})})});_b.displayName="@mantine/core/ScrollAreaRoot";function yb(p,b){const T=p/b;return Number.isNaN(T)?0:T}function Q_(p){const b=yb(p.viewport,p.content),T=p.scrollbar.paddingStart+p.scrollbar.paddingEnd,S=(p.scrollbar.size-T)*b;return Math.max(S,18)}function vb(p,b){return T=>{if(p[0]===p[1]||b[0]===b[1])return b[0];const S=(b[1]-b[0])/(p[1]-p[0]);return b[0]+S*(T-p[0])}}function kT(p,[b,T]){return Math.min(T,Math.max(b,p))}function ux(p,b,T="ltr"){const S=Q_(b),R=b.scrollbar.paddingStart+b.scrollbar.paddingEnd,I=b.scrollbar.size-R,E=b.content-b.viewport,l=I-S,N=T==="ltr"?[0,E]:[E*-1,0],X=kT(p,N);return vb([0,E],[0,l])(X)}function BT(p,b,T,S="ltr"){const R=Q_(T),I=R/2,E=b||I,l=R-E,N=T.scrollbar.paddingStart+E,X=T.scrollbar.size-T.scrollbar.paddingEnd-l,Q=T.content-T.viewport,ee=S==="ltr"?[0,Q]:[Q*-1,0];return vb([N,X],ee)(p)}function xb(p,b){return p>0&&p<b}function F_(p){return p?parseInt(p,10):0}function lf(p,b,{checkForDefaultPrevented:T=!0}={}){return S=>{p?.(S),(T===!1||!S.defaultPrevented)&&b?.(S)}}const[FT,bb]=_g("ScrollAreaScrollbar was not found in tree"),wb=ue.forwardRef((p,b)=>{const{sizes:T,hasThumb:S,onThumbChange:R,onThumbPointerUp:I,onThumbPointerDown:E,onThumbPositionChange:l,onDragScroll:N,onWheelScroll:X,onResize:Q,...ee}=p,le=qs(),[ce,Ce]=ue.useState(null),xe=Gs(b,_t=>Ce(_t)),ie=ue.useRef(null),Ue=ue.useRef(""),{viewport:$e}=le,Le=T.content-T.viewport,Ye=of(X),it=of(l),pt=G_(Q,10),Qe=_t=>{if(ie.current){const Pt=_t.clientX-ie.current.left,Rt=_t.clientY-ie.current.top;N({x:Pt,y:Rt})}};return ue.useEffect(()=>{const _t=Pt=>{const Rt=Pt.target;ce?.contains(Rt)&&Ye(Pt,Le)};return document.addEventListener("wheel",_t,{passive:!1}),()=>document.removeEventListener("wheel",_t,{passive:!1})},[$e,ce,Le,Ye]),ue.useEffect(it,[T,it]),Xp(ce,pt),Xp(le.content,pt),Te.jsx(FT,{value:{scrollbar:ce,hasThumb:S,onThumbChange:of(R),onThumbPointerUp:of(I),onThumbPositionChange:it,onThumbPointerDown:of(E)},children:Te.jsx("div",{...ee,ref:xe,"data-mantine-scrollbar":!0,style:{position:"absolute",...ee.style},onPointerDown:lf(p.onPointerDown,_t=>{_t.preventDefault(),_t.button===0&&(_t.target.setPointerCapture(_t.pointerId),ie.current=ce.getBoundingClientRect(),Ue.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",Qe(_t))}),onPointerMove:lf(p.onPointerMove,Qe),onPointerUp:lf(p.onPointerUp,_t=>{const Pt=_t.target;Pt.hasPointerCapture(_t.pointerId)&&(_t.preventDefault(),Pt.releasePointerCapture(_t.pointerId))}),onLostPointerCapture:()=>{document.body.style.webkitUserSelect=Ue.current,ie.current=null}})})}),Sb=ue.forwardRef((p,b)=>{const{sizes:T,onSizesChange:S,style:R,...I}=p,E=qs(),[l,N]=ue.useState(),X=ue.useRef(null),Q=Gs(b,X,E.onScrollbarXChange);return ue.useEffect(()=>{X.current&&N(getComputedStyle(X.current))},[X]),Te.jsx(wb,{"data-orientation":"horizontal",...I,ref:Q,sizes:T,style:{...R,"--sa-thumb-width":`${Q_(T)}px`},onThumbPointerDown:ee=>p.onThumbPointerDown(ee.x),onDragScroll:ee=>p.onDragScroll(ee.x),onWheelScroll:(ee,le)=>{if(E.viewport){const ce=E.viewport.scrollLeft+ee.deltaX;p.onWheelScroll(ce),xb(ce,le)&&ee.preventDefault()}},onResize:()=>{X.current&&E.viewport&&l&&S({content:E.viewport.scrollWidth,viewport:E.viewport.offsetWidth,scrollbar:{size:X.current.clientWidth,paddingStart:F_(l.paddingLeft),paddingEnd:F_(l.paddingRight)}})}})});Sb.displayName="@mantine/core/ScrollAreaScrollbarX";const Tb=ue.forwardRef((p,b)=>{const{sizes:T,onSizesChange:S,style:R,...I}=p,E=qs(),[l,N]=ue.useState(),X=ue.useRef(null),Q=Gs(b,X,E.onScrollbarYChange);return ue.useEffect(()=>{X.current&&N(window.getComputedStyle(X.current))},[]),Te.jsx(wb,{...I,"data-orientation":"vertical",ref:Q,sizes:T,style:{"--sa-thumb-height":`${Q_(T)}px`,...R},onThumbPointerDown:ee=>p.onThumbPointerDown(ee.y),onDragScroll:ee=>p.onDragScroll(ee.y),onWheelScroll:(ee,le)=>{if(E.viewport){const ce=E.viewport.scrollTop+ee.deltaY;p.onWheelScroll(ce),xb(ce,le)&&ee.preventDefault()}},onResize:()=>{X.current&&E.viewport&&l&&S({content:E.viewport.scrollHeight,viewport:E.viewport.offsetHeight,scrollbar:{size:X.current.clientHeight,paddingStart:F_(l.paddingTop),paddingEnd:F_(l.paddingBottom)}})}})});Tb.displayName="@mantine/core/ScrollAreaScrollbarY";const J_=ue.forwardRef((p,b)=>{const{orientation:T="vertical",...S}=p,{dir:R}=Tv(),I=qs(),E=ue.useRef(null),l=ue.useRef(0),[N,X]=ue.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),Q=yb(N.viewport,N.content),ee={...S,sizes:N,onSizesChange:X,hasThumb:Q>0&&Q<1,onThumbChange:ce=>{E.current=ce},onThumbPointerUp:()=>{l.current=0},onThumbPointerDown:ce=>{l.current=ce}},le=(ce,Ce)=>BT(ce,l.current,N,Ce);return T==="horizontal"?Te.jsx(Sb,{...ee,ref:b,onThumbPositionChange:()=>{if(I.viewport&&E.current){const ce=I.viewport.scrollLeft,Ce=ux(ce,N,R);E.current.style.transform=`translate3d(${Ce}px, 0, 0)`}},onWheelScroll:ce=>{I.viewport&&(I.viewport.scrollLeft=ce)},onDragScroll:ce=>{I.viewport&&(I.viewport.scrollLeft=le(ce,R))}}):T==="vertical"?Te.jsx(Tb,{...ee,ref:b,onThumbPositionChange:()=>{if(I.viewport&&E.current){const ce=I.viewport.scrollTop,Ce=ux(ce,N);N.scrollbar.size===0?E.current.style.setProperty("--thumb-opacity","0"):E.current.style.setProperty("--thumb-opacity","1"),E.current.style.transform=`translate3d(0, ${Ce}px, 0)`}},onWheelScroll:ce=>{I.viewport&&(I.viewport.scrollTop=ce)},onDragScroll:ce=>{I.viewport&&(I.viewport.scrollTop=le(ce))}}):null});J_.displayName="@mantine/core/ScrollAreaScrollbarVisible";const Lv=ue.forwardRef((p,b)=>{const T=qs(),{forceMount:S,...R}=p,[I,E]=ue.useState(!1),l=p.orientation==="horizontal",N=G_(()=>{if(T.viewport){const X=T.viewport.offsetWidth<T.viewport.scrollWidth,Q=T.viewport.offsetHeight<T.viewport.scrollHeight;E(l?X:Q)}},10);return Xp(T.viewport,N),Xp(T.content,N),S||I?Te.jsx(J_,{"data-state":I?"visible":"hidden",...R,ref:b}):null});Lv.displayName="@mantine/core/ScrollAreaScrollbarAuto";const Eb=ue.forwardRef((p,b)=>{const{forceMount:T,...S}=p,R=qs(),[I,E]=ue.useState(!1);return ue.useEffect(()=>{const{scrollArea:l}=R;let N=0;if(l){const X=()=>{window.clearTimeout(N),E(!0)},Q=()=>{N=window.setTimeout(()=>E(!1),R.scrollHideDelay)};return l.addEventListener("pointerenter",X),l.addEventListener("pointerleave",Q),()=>{window.clearTimeout(N),l.removeEventListener("pointerenter",X),l.removeEventListener("pointerleave",Q)}}},[R.scrollArea,R.scrollHideDelay]),T||I?Te.jsx(Lv,{"data-state":I?"visible":"hidden",...S,ref:b}):null});Eb.displayName="@mantine/core/ScrollAreaScrollbarHover";const NT=ue.forwardRef((p,b)=>{const{forceMount:T,...S}=p,R=qs(),I=p.orientation==="horizontal",[E,l]=ue.useState("hidden"),N=G_(()=>l("idle"),100);return ue.useEffect(()=>{if(E==="idle"){const X=window.setTimeout(()=>l("hidden"),R.scrollHideDelay);return()=>window.clearTimeout(X)}},[E,R.scrollHideDelay]),ue.useEffect(()=>{const{viewport:X}=R,Q=I?"scrollLeft":"scrollTop";if(X){let ee=X[Q];const le=()=>{const ce=X[Q];ee!==ce&&(l("scrolling"),N()),ee=ce};return X.addEventListener("scroll",le),()=>X.removeEventListener("scroll",le)}},[R.viewport,I,N]),T||E!=="hidden"?Te.jsx(J_,{"data-state":E==="hidden"?"hidden":"visible",...S,ref:b,onPointerEnter:lf(p.onPointerEnter,()=>l("interacting")),onPointerLeave:lf(p.onPointerLeave,()=>l("idle"))}):null}),sv=ue.forwardRef((p,b)=>{const{forceMount:T,...S}=p,R=qs(),{onScrollbarXEnabledChange:I,onScrollbarYEnabledChange:E}=R,l=p.orientation==="horizontal";return ue.useEffect(()=>(l?I(!0):E(!0),()=>{l?I(!1):E(!1)}),[l,I,E]),R.type==="hover"?Te.jsx(Eb,{...S,ref:b,forceMount:T}):R.type==="scroll"?Te.jsx(NT,{...S,ref:b,forceMount:T}):R.type==="auto"?Te.jsx(Lv,{...S,ref:b,forceMount:T}):R.type==="always"?Te.jsx(J_,{...S,ref:b}):null});sv.displayName="@mantine/core/ScrollAreaScrollbar";function jT(p,b=()=>{}){let T={left:p.scrollLeft,top:p.scrollTop},S=0;return(function R(){const I={left:p.scrollLeft,top:p.scrollTop},E=T.left!==I.left,l=T.top!==I.top;(E||l)&&b(),T=I,S=window.requestAnimationFrame(R)})(),()=>window.cancelAnimationFrame(S)}const Cb=ue.forwardRef((p,b)=>{const{style:T,...S}=p,R=qs(),I=bb(),{onThumbPositionChange:E}=I,l=Gs(b,Q=>I.onThumbChange(Q)),N=ue.useRef(void 0),X=G_(()=>{N.current&&(N.current(),N.current=void 0)},100);return ue.useEffect(()=>{const{viewport:Q}=R;if(Q){const ee=()=>{if(X(),!N.current){const le=jT(Q,E);N.current=le,E()}};return E(),Q.addEventListener("scroll",ee),()=>Q.removeEventListener("scroll",ee)}},[R.viewport,X,E]),Te.jsx("div",{"data-state":I.hasThumb?"visible":"hidden",...S,ref:l,style:{width:"var(--sa-thumb-width)",height:"var(--sa-thumb-height)",...T},onPointerDownCapture:lf(p.onPointerDownCapture,Q=>{const le=Q.target.getBoundingClientRect(),ce=Q.clientX-le.left,Ce=Q.clientY-le.top;I.onThumbPointerDown({x:ce,y:Ce})}),onPointerUp:lf(p.onPointerUp,I.onThumbPointerUp)})});Cb.displayName="@mantine/core/ScrollAreaThumb";const lv=ue.forwardRef((p,b)=>{const{forceMount:T,...S}=p,R=bb();return T||R.hasThumb?Te.jsx(Cb,{ref:b,...S}):null});lv.displayName="@mantine/core/ScrollAreaThumb";const Mb=ue.forwardRef(({children:p,style:b,onWheel:T,...S},R)=>{const I=qs(),E=Gs(R,I.onViewportChange),l=N=>{if(T?.(N),I.scrollbarXEnabled&&I.viewport&&N.shiftKey){const{scrollTop:X,scrollHeight:Q,clientHeight:ee,scrollWidth:le,clientWidth:ce}=I.viewport,Ce=X<1,xe=X>=Q-ee-1;le>ce&&(Ce||xe)&&N.stopPropagation()}};return Te.jsx(un,{...S,ref:E,onWheel:l,style:{overflowX:I.scrollbarXEnabled?"scroll":"hidden",overflowY:I.scrollbarYEnabled?"scroll":"hidden",...b},children:Te.jsx("div",{...I.getStyles("content"),ref:I.onContentChange,children:p})})});Mb.displayName="@mantine/core/ScrollAreaViewport";const Ab={scrollHideDelay:1e3,type:"hover",scrollbars:"xy"},VT=(p,{scrollbarSize:b,overscrollBehavior:T,scrollbars:S})=>{let R=T;return T&&S&&(S==="x"?R=`${T} auto`:S==="y"&&(R=`auto ${T}`)),{root:{"--scrollarea-scrollbar-size":bt(b),"--scrollarea-over-scroll-behavior":R}}},bg=$n((p,b)=>{const T=ln("ScrollArea",Ab,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,scrollbarSize:N,vars:X,type:Q,scrollHideDelay:ee,viewportProps:le,viewportRef:ce,onScrollPositionChange:Ce,children:xe,offsetScrollbars:ie,scrollbars:Ue,onBottomReached:$e,onTopReached:Le,overscrollBehavior:Ye,attributes:it,...pt}=T,[Qe,_t]=ue.useState(!1),[Pt,Rt]=ue.useState(!1),[Zt,Ot]=ue.useState(!1),Vt=Di({name:"ScrollArea",props:T,classes:Iv,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:it,vars:X,varsResolver:VT}),Ft=ue.useRef(null),Ht=gb([ce,Ft]);return ue.useEffect(()=>{if(!Ft.current||ie!=="present")return;const Pe=Ft.current,Xe=new ResizeObserver(()=>{const{scrollHeight:ft,clientHeight:yt,scrollWidth:It,clientWidth:Ee}=Pe;Rt(ft>yt),Ot(It>Ee)});return Xe.observe(Pe),()=>Xe.disconnect()},[Ft,ie]),Te.jsxs(_b,{getStyles:Vt,type:Q==="never"?"always":Q,scrollHideDelay:ee,ref:b,scrollbars:Ue,...Vt("root"),...pt,children:[Te.jsx(Mb,{...le,...Vt("viewport",{style:le?.style}),ref:Ht,"data-offset-scrollbars":ie===!0?"xy":ie||void 0,"data-scrollbars":Ue||void 0,"data-horizontal-hidden":ie==="present"&&!Zt?"true":void 0,"data-vertical-hidden":ie==="present"&&!Pt?"true":void 0,onScroll:Pe=>{le?.onScroll?.(Pe),Ce?.({x:Pe.currentTarget.scrollLeft,y:Pe.currentTarget.scrollTop});const{scrollTop:Xe,scrollHeight:ft,clientHeight:yt}=Pe.currentTarget;Xe-(ft-yt)>=-.8&&$e?.(),Xe===0&&Le?.()},children:xe}),(Ue==="xy"||Ue==="x")&&Te.jsx(sv,{...Vt("scrollbar"),orientation:"horizontal","data-hidden":Q==="never"||ie==="present"&&!Zt?!0:void 0,forceMount:!0,onMouseEnter:()=>_t(!0),onMouseLeave:()=>_t(!1),children:Te.jsx(lv,{...Vt("thumb")})}),(Ue==="xy"||Ue==="y")&&Te.jsx(sv,{...Vt("scrollbar"),orientation:"vertical","data-hidden":Q==="never"||ie==="present"&&!Pt?!0:void 0,forceMount:!0,onMouseEnter:()=>_t(!0),onMouseLeave:()=>_t(!1),children:Te.jsx(lv,{...Vt("thumb")})}),Te.jsx(LT,{...Vt("corner"),"data-hovered":Qe||void 0,"data-hidden":Q==="never"||void 0})]})});bg.displayName="@mantine/core/ScrollArea";const Ov=$n((p,b)=>{const{children:T,classNames:S,styles:R,scrollbarSize:I,scrollHideDelay:E,type:l,dir:N,offsetScrollbars:X,overscrollBehavior:Q,viewportRef:ee,onScrollPositionChange:le,unstyled:ce,variant:Ce,viewportProps:xe,scrollbars:ie,style:Ue,vars:$e,onBottomReached:Le,onTopReached:Ye,onOverflowChange:it,...pt}=ln("ScrollAreaAutosize",Ab,p),Qe=ue.useRef(null),_t=gb([ee,Qe]),[Pt,Rt]=ue.useState(!1),Zt=ue.useRef(!1);return ue.useEffect(()=>{if(!it)return;const Ot=Qe.current;if(!Ot)return;const Vt=()=>{const Ht=Ot.scrollHeight>Ot.clientHeight;Ht!==Pt&&(Zt.current?it?.(Ht):(Zt.current=!0,Ht&&it?.(!0)),Rt(Ht))};Vt();const Ft=new ResizeObserver(Vt);return Ft.observe(Ot),()=>Ft.disconnect()},[it,Pt]),Te.jsx(un,{...pt,ref:b,style:[{display:"flex",overflow:"hidden"},Ue],children:Te.jsx(un,{style:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden",...ie==="y"&&{minWidth:0},...ie==="x"&&{minHeight:0},...ie==="xy"&&{minWidth:0,minHeight:0},...ie===!1&&{minWidth:0,minHeight:0}},children:Te.jsx(bg,{classNames:S,styles:R,scrollHideDelay:E,scrollbarSize:I,type:l,dir:N,offsetScrollbars:X,overscrollBehavior:Q,viewportRef:_t,onScrollPositionChange:le,unstyled:ce,variant:Ce,viewportProps:xe,vars:$e,scrollbars:ie,onBottomReached:Le,onTopReached:Ye,"data-autosize":"true",children:T})})})});bg.classes=Iv;Ov.displayName="@mantine/core/ScrollAreaAutosize";Ov.classes=Iv;bg.Autosize=Ov;var zb={root:"m_87cf2631"};const UT={__staticSelector:"UnstyledButton"},ey=Ul((p,b)=>{const T=ln("UnstyledButton",UT,p),{className:S,component:R="button",__staticSelector:I,unstyled:E,classNames:l,styles:N,style:X,attributes:Q,...ee}=T,le=Di({name:I,props:T,classes:zb,className:S,style:X,classNames:l,styles:N,unstyled:E,attributes:Q});return Te.jsx(un,{...le("root",{focusable:!0}),component:R,ref:b,type:R==="button"?"button":void 0,...ee})});ey.classes=zb;ey.displayName="@mantine/core/UnstyledButton";var Db={root:"m_515a97f8"};const kv=$n((p,b)=>{const T=ln("VisuallyHidden",null,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,attributes:X,...Q}=T,ee=Di({name:"VisuallyHidden",classes:Db,props:T,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:X});return Te.jsx(un,{component:"span",ref:b,...ee("root"),...Q})});kv.classes=Db;kv.displayName="@mantine/core/VisuallyHidden";var Pb={root:"m_1b7284a3"};const GT=(p,{radius:b,shadow:T})=>({root:{"--paper-radius":b===void 0?void 0:Bu(b),"--paper-shadow":kx(T)}}),Bv=Ul((p,b)=>{const T=ln("Paper",null,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,withBorder:N,vars:X,radius:Q,shadow:ee,variant:le,mod:ce,attributes:Ce,...xe}=T,ie=Di({name:"Paper",props:T,classes:Pb,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:Ce,vars:X,varsResolver:GT});return Te.jsx(un,{ref:b,mod:[{"data-with-border":N},ce],...ie("root"),variant:le,...xe})});Bv.classes=Pb;Bv.displayName="@mantine/core/Paper";function hx(p,b,T,S){return p==="center"||S==="center"?{top:b}:p==="end"?{bottom:T}:p==="start"?{top:T}:{}}function dx(p,b,T,S,R){return p==="center"||S==="center"?{left:b}:p==="end"?{[R==="ltr"?"right":"left"]:T}:p==="start"?{[R==="ltr"?"left":"right"]:T}:{}}const qT={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function $T({position:p,arrowSize:b,arrowOffset:T,arrowRadius:S,arrowPosition:R,arrowX:I,arrowY:E,dir:l}){const[N,X="center"]=p.split("-"),Q={width:b,height:b,transform:"rotate(45deg)",position:"absolute",[qT[N]]:S},ee=-b/2;return N==="left"?{...Q,...hx(X,E,T,R),right:ee,borderLeftColor:"transparent",borderBottomColor:"transparent",clipPath:"polygon(100% 0, 0 0, 100% 100%)"}:N==="right"?{...Q,...hx(X,E,T,R),left:ee,borderRightColor:"transparent",borderTopColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 100%)"}:N==="top"?{...Q,...dx(X,I,T,R,l),bottom:ee,borderTopColor:"transparent",borderLeftColor:"transparent",clipPath:"polygon(0 100%, 100% 100%, 100% 0)"}:N==="bottom"?{...Q,...dx(X,I,T,R,l),top:ee,borderBottomColor:"transparent",borderRightColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 0)"}:{}}const Rb=ue.forwardRef(({position:p,arrowSize:b,arrowOffset:T,arrowRadius:S,arrowPosition:R,visible:I,arrowX:E,arrowY:l,style:N,...X},Q)=>{const{dir:ee}=Tv();return I?Te.jsx("div",{...X,ref:Q,style:{...N,...$T({position:p,arrowSize:b,arrowOffset:T,arrowRadius:S,arrowPosition:R,dir:ee,arrowX:E,arrowY:l})}}):null});Rb.displayName="@mantine/core/FloatingArrow";function ZT(p,b){if(p==="rtl"&&(b.includes("right")||b.includes("left"))){const[T,S]=b.split("-"),R=T==="right"?"left":"right";return S===void 0?R:`${R}-${S}`}return b}var Ib={root:"m_9814e45f"};const HT={zIndex:pv("modal")},XT=(p,{gradient:b,color:T,backgroundOpacity:S,blur:R,radius:I,zIndex:E})=>({root:{"--overlay-bg":b||(T!==void 0||S!==void 0)&&Pc(T||"#000",S??.6)||void 0,"--overlay-filter":R?`blur(${bt(R)})`:void 0,"--overlay-radius":I===void 0?void 0:Bu(I),"--overlay-z-index":E?.toString()}}),Fv=Ul((p,b)=>{const T=ln("Overlay",HT,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,fixed:X,center:Q,children:ee,radius:le,zIndex:ce,gradient:Ce,blur:xe,color:ie,backgroundOpacity:Ue,mod:$e,attributes:Le,...Ye}=T,it=Di({name:"Overlay",props:T,classes:Ib,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:Le,vars:N,varsResolver:XT});return Te.jsx(un,{ref:b,...it("root"),mod:[{center:Q,fixed:X},$e],...Ye,children:ee})});Fv.classes=Ib;Fv.displayName="@mantine/core/Overlay";function Hy(p){const b=document.createElement("div");return b.setAttribute("data-portal","true"),typeof p.className=="string"&&b.classList.add(...p.className.split(" ").filter(Boolean)),typeof p.style=="object"&&Object.assign(b.style,p.style),typeof p.id=="string"&&b.setAttribute("id",p.id),b}function YT({target:p,reuseTargetNode:b,...T}){if(p)return typeof p=="string"?document.querySelector(p)||Hy(T):p;if(b){const S=document.querySelector("[data-mantine-shared-portal-node]");if(S)return S;const R=Hy(T);return R.setAttribute("data-mantine-shared-portal-node","true"),document.body.appendChild(R),R}return Hy(T)}const WT={reuseTargetNode:!0},Lb=$n((p,b)=>{const{children:T,target:S,reuseTargetNode:R,...I}=ln("Portal",WT,p),[E,l]=ue.useState(!1),N=ue.useRef(null);return Yp(()=>(l(!0),N.current=YT({target:S,reuseTargetNode:R,...I}),Jy(b,N.current),!S&&!R&&N.current&&document.body.appendChild(N.current),()=>{!S&&!R&&N.current&&document.body.removeChild(N.current)}),[S]),!E||!N.current?null:Ev.createPortal(Te.jsx(Te.Fragment,{children:T}),N.current)});Lb.displayName="@mantine/core/Portal";const ty=$n(({withinPortal:p=!0,children:b,...T},S)=>H_()==="test"||!p?Te.jsx(Te.Fragment,{children:b}):Te.jsx(Lb,{ref:S,...T,children:b}));ty.displayName="@mantine/core/OptionalPortal";const cg=p=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${p==="bottom"?10:-10}px)`},transitionProperty:"transform, opacity"}),A_={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(30px)"},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-30px)"},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(30px)"},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-30px)"},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(-20px) skew(-10deg, -5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(20px) skew(-10deg, -5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(-5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...cg("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...cg("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...cg("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...cg("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...cg("top"),common:{transformOrigin:"top right"}}},fx={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function KT({transition:p,state:b,duration:T,timingFunction:S}){const R={WebkitBackfaceVisibility:"hidden",transitionDuration:`${T}ms`,transitionTimingFunction:S};return typeof p=="string"?p in A_?{transitionProperty:A_[p].transitionProperty,...R,...A_[p].common,...A_[p][fx[b]]}:{}:{transitionProperty:p.transitionProperty,...R,...p.common,...p[fx[b]]}}function QT({duration:p,exitDuration:b,timingFunction:T,mounted:S,onEnter:R,onExit:I,onEntered:E,onExited:l,enterDelay:N,exitDelay:X}){const Q=Bc(),ee=Gx(),le=Q.respectReducedMotion?ee:!1,[ce,Ce]=ue.useState(le?0:p),[xe,ie]=ue.useState(S?"entered":"exited"),Ue=ue.useRef(-1),$e=ue.useRef(-1),Le=ue.useRef(-1);function Ye(){window.clearTimeout(Ue.current),window.clearTimeout($e.current),cancelAnimationFrame(Le.current)}const it=Qe=>{Ye();const _t=Qe?R:I,Pt=Qe?E:l,Rt=le?0:Qe?p:b;Ce(Rt),Rt===0?(typeof _t=="function"&&_t(),typeof Pt=="function"&&Pt(),ie(Qe?"entered":"exited")):Le.current=requestAnimationFrame(()=>{hg.flushSync(()=>{ie(Qe?"pre-entering":"pre-exiting")}),Le.current=requestAnimationFrame(()=>{typeof _t=="function"&&_t(),ie(Qe?"entering":"exiting"),Ue.current=window.setTimeout(()=>{typeof Pt=="function"&&Pt(),ie(Qe?"entered":"exited")},Rt)})})},pt=Qe=>{if(Ye(),typeof(Qe?N:X)!="number"){it(Qe);return}$e.current=window.setTimeout(()=>{it(Qe)},Qe?N:X)};return fg(()=>{pt(S)},[S]),ue.useEffect(()=>()=>{Ye()},[]),{transitionDuration:ce,transitionStatus:xe,transitionTimingFunction:T||"ease"}}function ny({keepMounted:p,transition:b="fade",duration:T=250,exitDuration:S=T,mounted:R,children:I,timingFunction:E="ease",onExit:l,onEntered:N,onEnter:X,onExited:Q,enterDelay:ee,exitDelay:le}){const ce=H_(),{transitionDuration:Ce,transitionStatus:xe,transitionTimingFunction:ie}=QT({mounted:R,exitDuration:S,duration:T,timingFunction:E,onExit:l,onEntered:N,onEnter:X,onExited:Q,enterDelay:ee,exitDelay:le});return Ce===0||ce==="test"?R?Te.jsx(Te.Fragment,{children:I({})}):p?I({display:"none"}):null:xe==="exited"?p?I({display:"none"}):null:Te.jsx(Te.Fragment,{children:I(KT({transition:b,duration:Ce,state:xe,timingFunction:ie}))})}ny.displayName="@mantine/core/Transition";const[JT,Ob]=_g("Popover component was not found in the tree");var kb={dropdown:"m_38a85659",arrow:"m_a31dc6c1",overlay:"m_3d7bc908"};function Nv({children:p,active:b=!0,refProp:T="ref",innerRef:S}){const R=Vw(b),I=Gs(R,S),E=q_(p);return E?ue.cloneElement(E,{[T]:I}):p}function Bb(p){return Te.jsx(kv,{tabIndex:-1,"data-autofocus":!0,...p})}Nv.displayName="@mantine/core/FocusTrap";Bb.displayName="@mantine/core/FocusTrapInitialFocus";Nv.InitialFocus=Bb;const jv=$n((p,b)=>{const T=ln("PopoverDropdown",null,p),{className:S,style:R,vars:I,children:E,onKeyDownCapture:l,variant:N,classNames:X,styles:Q,...ee}=T,le=Ob(),ce=Ow({opened:le.opened,shouldReturnFocus:le.returnFocus}),Ce=le.withRoles?{"aria-labelledby":le.getTargetId(),id:le.getDropdownId(),role:"dialog",tabIndex:-1}:{},xe=Gs(b,le.floating);return le.disabled?null:Te.jsx(ty,{...le.portalProps,withinPortal:le.withinPortal,children:Te.jsx(ny,{mounted:le.opened,...le.transitionProps,transition:le.transitionProps?.transition||"fade",duration:le.transitionProps?.duration??150,keepMounted:le.keepMounted,exitDuration:typeof le.transitionProps?.exitDuration=="number"?le.transitionProps.exitDuration:le.transitionProps?.duration,children:ie=>Te.jsx(Nv,{active:le.trapFocus&&le.opened,innerRef:xe,children:Te.jsxs(un,{...Ce,...ee,variant:N,onKeyDownCapture:zw(()=>{le.onClose?.(),le.onDismiss?.()},{active:le.closeOnEscape,onTrigger:ce,onKeyDown:l}),"data-position":le.placement,"data-fixed":le.floatingStrategy==="fixed"||void 0,...le.getStyles("dropdown",{className:S,props:T,classNames:X,styles:Q,style:[{...ie,zIndex:le.zIndex,top:le.y??0,left:le.x??0,width:le.width==="target"?void 0:bt(le.width),...le.referenceHidden?{display:"none"}:null},le.resolvedStyles.dropdown,Q?.dropdown,R]}),children:[E,Te.jsx(Rb,{ref:le.arrowRef,arrowX:le.arrowX,arrowY:le.arrowY,visible:le.withArrow,position:le.placement,arrowSize:le.arrowSize,arrowRadius:le.arrowRadius,arrowOffset:le.arrowOffset,arrowPosition:le.arrowPosition,...le.getStyles("arrow",{props:T,classNames:X,styles:Q})})]})})})})});jv.classes=kb;jv.displayName="@mantine/core/PopoverDropdown";const eE={refProp:"ref",popupType:"dialog"},Fb=$n((p,b)=>{const{children:T,refProp:S,popupType:R,...I}=ln("PopoverTarget",eE,p),E=q_(T);if(!E)throw new Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const l=I,N=Ob(),X=Gs(N.reference,qx(E),b),Q=N.withRoles?{"aria-haspopup":R,"aria-expanded":N.opened,"aria-controls":N.opened?N.getDropdownId():void 0,id:N.getTargetId()}:{},ee=E.props;return ue.cloneElement(E,{...l,...Q,...N.targetProps,className:Fu(N.targetProps.className,l.className,ee.className),[S]:X,...N.controlled?null:{onClick:()=>{N.onToggle(),ee.onClick?.()}}})});Fb.displayName="@mantine/core/PopoverTarget";function tE(p){if(p===void 0)return{shift:!0,flip:!0};const b={...p};return p.shift===void 0&&(b.shift=!0),p.flip===void 0&&(b.flip=!0),b}function nE(p,b,T){const S=tE(p.middlewares),R=[mT(p.offset),yT()];return p.dropdownVisible&&T!=="test"&&p.preventPositionChangeWhenVisible&&(S.flip=!1),S.flip&&R.push(typeof S.flip=="boolean"?ox():ox(S.flip)),S.shift&&R.push(gT(typeof S.shift=="boolean"?{limiter:ax(),padding:5}:{limiter:ax(),padding:5,...S.shift})),S.inline&&R.push(typeof S.inline=="boolean"?sx():sx(S.inline)),R.push(vT({element:p.arrowRef,padding:p.arrowOffset})),(S.size||p.width==="target")&&R.push(_T({...typeof S.size=="boolean"?{}:S.size,apply({rects:I,availableWidth:E,availableHeight:l,...N}){const Q=b().refs.floating.current?.style??{};S.size&&(typeof S.size=="object"&&S.size.apply?S.size.apply({rects:I,availableWidth:E,availableHeight:l,...N}):Object.assign(Q,{maxWidth:`${E}px`,maxHeight:`${l}px`})),p.width==="target"&&Object.assign(Q,{width:`${I.reference.width}px`})}})),R}function iE(p){const b=H_(),[T,S]=gv({value:p.opened,defaultValue:p.defaultOpened,finalValue:!1,onChange:p.onChange}),R=ue.useRef(T),I=()=>{T&&!p.disabled&&S(!1)},E=()=>{p.disabled||S(!T)},l=PT({strategy:p.strategy,placement:p.preventPositionChangeWhenVisible?p.positionRef.current:p.position,middleware:nE(p,()=>l,b),whileElementsMounted:p.keepMounted?void 0:nx});return ue.useEffect(()=>{if(!(!l.refs.reference.current||!l.refs.floating.current)&&T)return nx(l.refs.reference.current,l.refs.floating.current,l.update)},[T,l.update]),fg(()=>{p.onPositionChange?.(l.placement),p.positionRef.current=l.placement},[l.placement,p.preventPositionChangeWhenVisible]),fg(()=>{T!==R.current&&(T?p.onOpen?.():p.onClose?.()),R.current=T},[T,p.onClose,p.onOpen]),Yp(()=>{let N=-1;return T&&(N=window.setTimeout(()=>p.setDropdownVisible(!0),4)),()=>{window.clearTimeout(N)}},[T,p.position]),{floating:l,controlled:typeof p.opened=="boolean",opened:T,onClose:I,onToggle:E}}const rE={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,withOverlay:!1,hideDetached:!0,clickOutsideEvents:["mousedown","touchstart"],zIndex:pv("popover"),__staticSelector:"Popover",width:"max-content"},aE=(p,{radius:b,shadow:T})=>({dropdown:{"--popover-radius":b===void 0?void 0:Bu(b),"--popover-shadow":kx(T)}});function Zh(p){const b=ln("Popover",rE,p),{children:T,position:S,offset:R,onPositionChange:I,positionDependencies:E,opened:l,transitionProps:N,onExitTransitionEnd:X,onEnterTransitionEnd:Q,width:ee,middlewares:le,withArrow:ce,arrowSize:Ce,arrowOffset:xe,arrowRadius:ie,arrowPosition:Ue,unstyled:$e,classNames:Le,styles:Ye,closeOnClickOutside:it,withinPortal:pt,portalProps:Qe,closeOnEscape:_t,clickOutsideEvents:Pt,trapFocus:Rt,onClose:Zt,onDismiss:Ot,onOpen:Vt,onChange:Ft,zIndex:Ht,radius:Pe,shadow:Xe,id:ft,defaultOpened:yt,__staticSelector:It,withRoles:Ee,disabled:rt,returnFocus:Tt,variant:At,keepMounted:Ut,vars:Nt,floatingStrategy:tn,withOverlay:fn,overlayProps:_n,hideDetached:$i,attributes:Fn,preventPositionChangeWhenVisible:vi,...ya}=b,Pn=Di({name:It,props:b,classes:kb,classNames:Le,styles:Ye,unstyled:$e,attributes:Fn,rootSelector:"dropdown",vars:Nt,varsResolver:aE}),{resolvedStyles:Zi}=bv({classNames:Le,styles:Ye,props:b}),[Nn,Zn]=ue.useState(l??yt??!1),Ar=ue.useRef(S),ea=ue.useRef(null),[va,zr]=ue.useState(null),[Ga,jo]=ue.useState(null),{dir:Hi}=Tv(),Dr=H_(),xa=yg(ft),xi=iE({middlewares:le,width:ee,position:ZT(Hi,S),offset:typeof R=="number"?R+(ce?Ce/2:0):R,arrowRef:ea,arrowOffset:xe,onPositionChange:I,positionDependencies:E,opened:l,defaultOpened:yt,onChange:Ft,onOpen:Vt,onClose:Zt,onDismiss:Ot,strategy:tn,dropdownVisible:Nn,setDropdownVisible:Zn,positionRef:Ar,disabled:rt,preventPositionChangeWhenVisible:vi,keepMounted:Ut});Rw(()=>{it&&(xi.onClose(),Ot?.())},Pt,[va,Ga]);const qa=ue.useCallback(Y=>{zr(Y),xi.floating.refs.setReference(Y)},[xi.floating.refs.setReference]),fs=ue.useCallback(Y=>{jo(Y),xi.floating.refs.setFloating(Y)},[xi.floating.refs.setFloating]),De=ue.useCallback(()=>{N?.onExited?.(),X?.(),Zn(!1),vi||(Ar.current=S)},[N?.onExited,X,vi,S]),H=ue.useCallback(()=>{N?.onEntered?.(),Q?.()},[N?.onEntered,Q]);return Te.jsxs(JT,{value:{returnFocus:Tt,disabled:rt,controlled:xi.controlled,reference:qa,floating:fs,x:xi.floating.x,y:xi.floating.y,arrowX:xi.floating?.middlewareData?.arrow?.x,arrowY:xi.floating?.middlewareData?.arrow?.y,opened:xi.opened,arrowRef:ea,transitionProps:{...N,onExited:De,onEntered:H},width:ee,withArrow:ce,arrowSize:Ce,arrowOffset:xe,arrowRadius:ie,arrowPosition:Ue,placement:xi.floating.placement,trapFocus:Rt,withinPortal:pt,portalProps:Qe,zIndex:Ht,radius:Pe,shadow:Xe,closeOnEscape:_t,onDismiss:Ot,onClose:xi.onClose,onToggle:xi.onToggle,getTargetId:()=>`${xa}-target`,getDropdownId:()=>`${xa}-dropdown`,withRoles:Ee,targetProps:ya,__staticSelector:It,classNames:Le,styles:Ye,unstyled:$e,variant:At,keepMounted:Ut,getStyles:Pn,resolvedStyles:Zi,floatingStrategy:tn,referenceHidden:$i&&Dr!=="test"?xi.floating.middlewareData.hide?.referenceHidden:!1},children:[T,fn&&Te.jsx(ny,{transition:"fade",mounted:xi.opened,duration:N?.duration||250,exitDuration:N?.exitDuration||250,children:Y=>Te.jsx(ty,{withinPortal:pt,children:Te.jsx(Fv,{..._n,...Pn("overlay",{className:_n?.className,style:[Y,_n?.style]})})})})]})}Zh.Target=Fb;Zh.Dropdown=jv;Zh.displayName="@mantine/core/Popover";Zh.extend=p=>p;var Bl={root:"m_5ae2e3c",barsLoader:"m_7a2bd4cd",bar:"m_870bb79","bars-loader-animation":"m_5d2b3b9d",dotsLoader:"m_4e3f22d7",dot:"m_870c4af","loader-dots-animation":"m_aac34a1",ovalLoader:"m_b34414df","oval-loader-animation":"m_f8e89c4b"};const Nb=ue.forwardRef(({className:p,...b},T)=>Te.jsxs(un,{component:"span",className:Fu(Bl.barsLoader,p),...b,ref:T,children:[Te.jsx("span",{className:Bl.bar}),Te.jsx("span",{className:Bl.bar}),Te.jsx("span",{className:Bl.bar})]}));Nb.displayName="@mantine/core/Bars";const jb=ue.forwardRef(({className:p,...b},T)=>Te.jsxs(un,{component:"span",className:Fu(Bl.dotsLoader,p),...b,ref:T,children:[Te.jsx("span",{className:Bl.dot}),Te.jsx("span",{className:Bl.dot}),Te.jsx("span",{className:Bl.dot})]}));jb.displayName="@mantine/core/Dots";const Vb=ue.forwardRef(({className:p,...b},T)=>Te.jsx(un,{component:"span",className:Fu(Bl.ovalLoader,p),...b,ref:T}));Vb.displayName="@mantine/core/Oval";const Ub={bars:Nb,oval:Vb,dots:jb},oE={loaders:Ub,type:"oval"},sE=(p,{size:b,color:T})=>({root:{"--loader-size":Ua(b,"loader-size"),"--loader-color":T?$p(T,p):void 0}}),wg=$n((p,b)=>{const T=ln("Loader",oE,p),{size:S,color:R,type:I,vars:E,className:l,style:N,classNames:X,styles:Q,unstyled:ee,loaders:le,variant:ce,children:Ce,attributes:xe,...ie}=T,Ue=Di({name:"Loader",props:T,classes:Bl,className:l,style:N,classNames:X,styles:Q,unstyled:ee,attributes:xe,vars:E,varsResolver:sE});return Ce?Te.jsx(un,{...Ue("root"),ref:b,...ie,children:Ce}):Te.jsx(un,{...Ue("root"),ref:b,component:le[I],variant:ce,size:S,...ie})});wg.defaultLoaders=Ub;wg.classes=Bl;wg.displayName="@mantine/core/Loader";var Qp={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21",groupSection:"m_437b6484"};const px={orientation:"horizontal"},lE=(p,{borderWidth:b})=>({group:{"--ai-border-width":bt(b)}}),Vv=$n((p,b)=>{const T=ln("ActionIconGroup",px,p),{className:S,style:R,classNames:I,styles:E,unstyled:l,orientation:N,vars:X,borderWidth:Q,variant:ee,mod:le,attributes:ce,...Ce}=ln("ActionIconGroup",px,p),xe=Di({name:"ActionIconGroup",props:T,classes:Qp,className:S,style:R,classNames:I,styles:E,unstyled:l,attributes:ce,vars:X,varsResolver:lE,rootSelector:"group"});return Te.jsx(un,{...xe("group"),ref:b,variant:ee,mod:[{"data-orientation":N},le],role:"group",...Ce})});Vv.classes=Qp;Vv.displayName="@mantine/core/ActionIconGroup";const cE=(p,{radius:b,color:T,gradient:S,variant:R,autoContrast:I,size:E})=>{const l=p.variantColorResolver({color:T||p.primaryColor,theme:p,gradient:S,variant:R||"filled",autoContrast:I});return{groupSection:{"--section-height":Ua(E,"section-height"),"--section-padding-x":Ua(E,"section-padding-x"),"--section-fz":Fl(E),"--section-radius":b===void 0?void 0:Bu(b),"--section-bg":T||R?l.background:void 0,"--section-color":l.color,"--section-bd":T||R?l.border:void 0}}},Uv=$n((p,b)=>{const T=ln("ActionIconGroupSection",null,p),{className:S,style:R,classNames:I,styles:E,unstyled:l,vars:N,variant:X,gradient:Q,radius:ee,autoContrast:le,attributes:ce,...Ce}=T,xe=Di({name:"ActionIconGroupSection",props:T,classes:Qp,className:S,style:R,classNames:I,styles:E,unstyled:l,attributes:ce,vars:N,varsResolver:cE,rootSelector:"groupSection"});return Te.jsx(un,{...xe("groupSection"),ref:b,variant:X,...Ce})});Uv.classes=Qp;Uv.displayName="@mantine/core/ActionIconGroupSection";const uE=(p,{size:b,radius:T,variant:S,gradient:R,color:I,autoContrast:E})=>{const l=p.variantColorResolver({color:I||p.primaryColor,theme:p,gradient:R,variant:S||"filled",autoContrast:E});return{root:{"--ai-size":Ua(b,"ai-size"),"--ai-radius":T===void 0?void 0:Bu(T),"--ai-bg":I||S?l.background:void 0,"--ai-hover":I||S?l.hover:void 0,"--ai-hover-color":I||S?l.hoverColor:void 0,"--ai-color":l.color,"--ai-bd":I||S?l.border:void 0}}},qh=Ul((p,b)=>{const T=ln("ActionIcon",null,p),{className:S,unstyled:R,variant:I,classNames:E,styles:l,style:N,loading:X,loaderProps:Q,size:ee,color:le,radius:ce,__staticSelector:Ce,gradient:xe,vars:ie,children:Ue,disabled:$e,"data-disabled":Le,autoContrast:Ye,mod:it,attributes:pt,...Qe}=T,_t=Di({name:["ActionIcon",Ce],props:T,className:S,style:N,classes:Qp,classNames:E,styles:l,unstyled:R,attributes:pt,vars:ie,varsResolver:uE});return Te.jsxs(ey,{..._t("root",{active:!$e&&!X&&!Le}),...Qe,unstyled:R,variant:I,size:ee,disabled:$e||X,ref:b,mod:[{loading:X,disabled:$e||Le},it],children:[typeof X=="boolean"&&Te.jsx(ny,{mounted:X,transition:"slide-down",duration:150,children:Pt=>Te.jsx(un,{component:"span",..._t("loader",{style:Pt}),"aria-hidden":!0,children:Te.jsx(wg,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...Q})})}),Te.jsx(un,{component:"span",mod:{loading:X},..._t("icon"),children:Ue})]})});qh.classes=Qp;qh.displayName="@mantine/core/ActionIcon";qh.Group=Vv;qh.GroupSection=Uv;const Gb=ue.forwardRef(({size:p="var(--cb-icon-size, 70%)",style:b,...T},S)=>Te.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...b,width:p,height:p},ref:S,...T,children:Te.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));Gb.displayName="@mantine/core/CloseIcon";var qb={root:"m_86a44da5","root--subtle":"m_220c80f2"};const hE={variant:"subtle"},dE=(p,{size:b,radius:T,iconSize:S})=>({root:{"--cb-size":Ua(b,"cb-size"),"--cb-radius":T===void 0?void 0:Bu(T),"--cb-icon-size":bt(S)}}),iy=Ul((p,b)=>{const T=ln("CloseButton",hE,p),{iconSize:S,children:R,vars:I,radius:E,className:l,classNames:N,style:X,styles:Q,unstyled:ee,"data-disabled":le,disabled:ce,variant:Ce,icon:xe,mod:ie,attributes:Ue,__staticSelector:$e,...Le}=T,Ye=Di({name:$e||"CloseButton",props:T,className:l,style:X,classes:qb,classNames:N,styles:Q,unstyled:ee,attributes:Ue,vars:I,varsResolver:dE});return Te.jsxs(ey,{ref:b,...Le,unstyled:ee,variant:Ce,disabled:ce,mod:[{disabled:ce||le},ie],...Ye("root",{variant:Ce,active:!ce&&!le}),children:[xe||Te.jsx(Gb,{}),R]})});iy.classes=qb;iy.displayName="@mantine/core/CloseButton";function fE(p){return ue.Children.toArray(p).filter(Boolean)}var $b={root:"m_4081bf90"};const pE={preventGrowOverflow:!0,gap:"md",align:"center",justify:"flex-start",wrap:"wrap"},mE=(p,{grow:b,preventGrowOverflow:T,gap:S,align:R,justify:I,wrap:E},{childWidth:l})=>({root:{"--group-child-width":b&&T?l:void 0,"--group-gap":mv(S),"--group-align":R,"--group-justify":I,"--group-wrap":E}}),ry=$n((p,b)=>{const T=ln("Group",pE,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,children:N,gap:X,align:Q,justify:ee,wrap:le,grow:ce,preventGrowOverflow:Ce,vars:xe,variant:ie,__size:Ue,mod:$e,attributes:Le,...Ye}=T,it=fE(N),pt=it.length,Qe=mv(X??"md"),Pt={childWidth:`calc(${100/pt}% - (${Qe} - ${Qe} / ${pt}))`},Rt=Di({name:"Group",props:T,stylesCtx:Pt,className:R,style:I,classes:$b,classNames:S,styles:E,unstyled:l,attributes:Le,vars:xe,varsResolver:mE});return Te.jsx(un,{...Rt("root"),ref:b,variant:ie,mod:[{grow:ce},$e],size:Ue,...Ye,children:it})});ry.classes=$b;ry.displayName="@mantine/core/Group";const[gE,_E]=Lx({size:"sm"});var $s={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};const Zb=$n((p,b)=>{const T=ln("InputClearButton",null,p),{size:S,variant:R,vars:I,classNames:E,styles:l,...N}=T,X=_E(),{resolvedClassNames:Q,resolvedStyles:ee}=bv({classNames:E,styles:l,props:T});return Te.jsx(iy,{variant:R||"transparent",ref:b,size:S||X?.size||"sm",classNames:Q,styles:ee,__staticSelector:"InputClearButton",style:{pointerEvents:"all",background:"var(--input-bg)",...N.style},...N})});Zb.displayName="@mantine/core/InputClearButton";const yE={xs:7,sm:8,md:10,lg:12,xl:15};function vE({__clearable:p,__clearSection:b,rightSection:T,__defaultRightSection:S,size:R="sm"}){const I=p&&b;return I&&(T||S)?Te.jsxs("div",{"data-combined-clear-section":!0,style:{display:"flex",gap:2,alignItems:"center",paddingInlineEnd:yE[R]},children:[I,T||S]}):T===null?null:T||I||S}const[xE,ay]=Lx({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0}),bE=(p,{size:b})=>({description:{"--input-description-size":b===void 0?void 0:`calc(${Fl(b)} - ${bt(2)})`}}),oy=$n((p,b)=>{const T=ln("InputDescription",null,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,size:X,__staticSelector:Q,__inheritStyles:ee=!0,attributes:le,variant:ce,...Ce}=ln("InputDescription",null,T),xe=ay(),ie=Di({name:["InputWrapper",Q],props:T,classes:$s,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:le,rootSelector:"description",vars:N,varsResolver:bE}),Ue=ee&&xe?.getStyles||ie;return Te.jsx(un,{component:"p",ref:b,variant:ce,size:X,...Ue("description",xe?.getStyles?{className:R,style:I}:void 0),...Ce})});oy.classes=$s;oy.displayName="@mantine/core/InputDescription";const wE=(p,{size:b})=>({error:{"--input-error-size":b===void 0?void 0:`calc(${Fl(b)} - ${bt(2)})`}}),sy=$n((p,b)=>{const T=ln("InputError",null,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,size:X,attributes:Q,__staticSelector:ee,__inheritStyles:le=!0,variant:ce,...Ce}=T,xe=Di({name:["InputWrapper",ee],props:T,classes:$s,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:Q,rootSelector:"error",vars:N,varsResolver:wE}),ie=ay(),Ue=le&&ie?.getStyles||xe;return Te.jsx(un,{component:"p",ref:b,variant:ce,size:X,...Ue("error",ie?.getStyles?{className:R,style:I}:void 0),...Ce})});sy.classes=$s;sy.displayName="@mantine/core/InputError";const mx={labelElement:"label"},SE=(p,{size:b})=>({label:{"--input-label-size":Fl(b),"--input-asterisk-color":void 0}}),ly=$n((p,b)=>{const T=ln("InputLabel",mx,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,labelElement:X,size:Q,required:ee,htmlFor:le,onMouseDown:ce,children:Ce,__staticSelector:xe,variant:ie,mod:Ue,attributes:$e,...Le}=ln("InputLabel",mx,T),Ye=Di({name:["InputWrapper",xe],props:T,classes:$s,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:$e,rootSelector:"label",vars:N,varsResolver:SE}),it=ay(),pt=it?.getStyles||Ye;return Te.jsxs(un,{...pt("label",it?.getStyles?{className:R,style:I}:void 0),component:X,variant:ie,size:Q,ref:b,htmlFor:X==="label"?le:void 0,mod:[{required:ee},Ue],onMouseDown:Qe=>{ce?.(Qe),!Qe.defaultPrevented&&Qe.detail>1&&Qe.preventDefault()},...Le,children:[Ce,ee&&Te.jsx("span",{...pt("required"),"aria-hidden":!0,children:" *"})]})});ly.classes=$s;ly.displayName="@mantine/core/InputLabel";const Gv=$n((p,b)=>{const T=ln("InputPlaceholder",null,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,__staticSelector:X,variant:Q,error:ee,mod:le,attributes:ce,...Ce}=T,xe=Di({name:["InputPlaceholder",X],props:T,classes:$s,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:ce,rootSelector:"placeholder"});return Te.jsx(un,{...xe("placeholder"),mod:[{error:!!ee},le],component:"span",variant:Q,ref:b,...Ce})});Gv.classes=$s;Gv.displayName="@mantine/core/InputPlaceholder";function TE(p,{hasDescription:b,hasError:T}){const S=p.findIndex(N=>N==="input"),R=p.slice(0,S),I=p.slice(S+1),E=b&&R.includes("description")||T&&R.includes("error");return{offsetBottom:b&&I.includes("description")||T&&I.includes("error"),offsetTop:E}}const EE={labelElement:"label",inputContainer:p=>p,inputWrapperOrder:["label","description","input","error"]},CE=(p,{size:b})=>({label:{"--input-label-size":Fl(b),"--input-asterisk-color":void 0},error:{"--input-error-size":b===void 0?void 0:`calc(${Fl(b)} - ${bt(2)})`},description:{"--input-description-size":b===void 0?void 0:`calc(${Fl(b)} - ${bt(2)})`}}),qv=$n((p,b)=>{const T=ln("InputWrapper",EE,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,size:X,variant:Q,__staticSelector:ee,inputContainer:le,inputWrapperOrder:ce,label:Ce,error:xe,description:ie,labelProps:Ue,descriptionProps:$e,errorProps:Le,labelElement:Ye,children:it,withAsterisk:pt,id:Qe,required:_t,__stylesApiProps:Pt,mod:Rt,attributes:Zt,...Ot}=T,Vt=Di({name:["InputWrapper",ee],props:Pt||T,classes:$s,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:Zt,vars:N,varsResolver:CE}),Ft={size:X,variant:Q,__staticSelector:ee},Ht=yg(Qe),Pe=typeof pt=="boolean"?pt:_t,Xe=Le?.id||`${Ht}-error`,ft=$e?.id||`${Ht}-description`,yt=Ht,It=!!xe&&typeof xe!="boolean",Ee=!!ie,rt=`${It?Xe:""} ${Ee?ft:""}`,Tt=rt.trim().length>0?rt.trim():void 0,At=Ue?.id||`${Ht}-label`,Ut=Ce&&Te.jsx(ly,{labelElement:Ye,id:At,htmlFor:yt,required:Pe,...Ft,...Ue,children:Ce},"label"),Nt=Ee&&Te.jsx(oy,{...$e,...Ft,size:$e?.size||Ft.size,id:$e?.id||ft,children:ie},"description"),tn=Te.jsx(ue.Fragment,{children:le(it)},"input"),fn=It&&ue.createElement(sy,{...Le,...Ft,size:Le?.size||Ft.size,key:"error",id:Le?.id||Xe},xe),_n=ce.map($i=>{switch($i){case"label":return Ut;case"input":return tn;case"description":return Nt;case"error":return fn;default:return null}});return Te.jsx(xE,{value:{getStyles:Vt,describedBy:Tt,inputId:yt,labelId:At,...TE(ce,{hasDescription:Ee,hasError:It})},children:Te.jsx(un,{ref:b,variant:Q,size:X,mod:[{error:!!xe},Rt],...Vt("root"),...Ot,children:_n})})});qv.classes=$s;qv.displayName="@mantine/core/InputWrapper";const ME={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0,size:"sm"},AE=(p,b,T)=>({wrapper:{"--input-margin-top":T.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":T.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":Ua(b.size,"input-height"),"--input-fz":Fl(b.size),"--input-radius":b.radius===void 0?void 0:Bu(b.radius),"--input-left-section-width":b.leftSectionWidth!==void 0?bt(b.leftSectionWidth):void 0,"--input-right-section-width":b.rightSectionWidth!==void 0?bt(b.rightSectionWidth):void 0,"--input-padding-y":b.multiline?Ua(b.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":b.leftSectionPointerEvents,"--input-right-section-pointer-events":b.rightSectionPointerEvents}}),No=Ul((p,b)=>{const T=ln("Input",ME,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,required:N,__staticSelector:X,__stylesApiProps:Q,size:ee,wrapperProps:le,error:ce,disabled:Ce,leftSection:xe,leftSectionProps:ie,leftSectionWidth:Ue,rightSection:$e,rightSectionProps:Le,rightSectionWidth:Ye,rightSectionPointerEvents:it,leftSectionPointerEvents:pt,variant:Qe,vars:_t,pointer:Pt,multiline:Rt,radius:Zt,id:Ot,withAria:Vt,withErrorStyles:Ft,mod:Ht,inputSize:Pe,attributes:Xe,__clearSection:ft,__clearable:yt,__defaultRightSection:It,...Ee}=T,{styleProps:rt,rest:Tt}=wv(Ee),At=ay(),Ut={offsetBottom:At?.offsetBottom,offsetTop:At?.offsetTop},Nt=Di({name:["Input",X],props:Q||T,classes:$s,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:Xe,stylesCtx:Ut,rootSelector:"wrapper",vars:_t,varsResolver:AE}),tn=Vt?{required:N,disabled:Ce,"aria-invalid":!!ce,"aria-describedby":At?.describedBy,id:At?.inputId||Ot}:{},fn=vE({__clearable:yt,__clearSection:ft,rightSection:$e,__defaultRightSection:It,size:ee});return Te.jsx(gE,{value:{size:ee||"sm"},children:Te.jsxs(un,{...Nt("wrapper"),...rt,...le,mod:[{error:!!ce&&Ft,pointer:Pt,disabled:Ce,multiline:Rt,"data-with-right-section":!!fn,"data-with-left-section":!!xe},Ht],variant:Qe,size:ee,children:[xe&&Te.jsx("div",{...ie,"data-position":"left",...Nt("section",{className:ie?.className,style:ie?.style}),children:xe}),Te.jsx(un,{component:"input",...Tt,...tn,ref:b,required:N,mod:{disabled:Ce,error:!!ce&&Ft},variant:Qe,__size:Pe,...Nt("input")}),fn&&Te.jsx("div",{...Le,"data-position":"right",...Nt("section",{className:Le?.className,style:Le?.style}),children:fn})]})})});No.classes=$s;No.Wrapper=qv;No.Label=ly;No.Error=sy;No.Description=oy;No.Placeholder=Gv;No.ClearButton=Zb;No.displayName="@mantine/core/Input";function zE(p,b,T){const S=ln(p,b,T),{label:R,description:I,error:E,required:l,classNames:N,styles:X,className:Q,unstyled:ee,__staticSelector:le,__stylesApiProps:ce,errorProps:Ce,labelProps:xe,descriptionProps:ie,wrapperProps:Ue,id:$e,size:Le,style:Ye,inputContainer:it,inputWrapperOrder:pt,withAsterisk:Qe,variant:_t,vars:Pt,mod:Rt,attributes:Zt,...Ot}=S,{styleProps:Vt,rest:Ft}=wv(Ot),Ht={label:R,description:I,error:E,required:l,classNames:N,className:Q,__staticSelector:le,__stylesApiProps:ce||S,errorProps:Ce,labelProps:xe,descriptionProps:ie,unstyled:ee,styles:X,size:Le,style:Ye,inputContainer:it,inputWrapperOrder:pt,withAsterisk:Qe,variant:_t,id:$e,mod:Rt,attributes:Zt,...Ue};return{...Ft,classNames:N,styles:X,unstyled:ee,wrapperProps:{...Ht,...Vt},inputProps:{required:l,classNames:N,styles:X,unstyled:ee,size:Le,__staticSelector:le,__stylesApiProps:ce||S,error:E,variant:_t,id:$e,attributes:Zt}}}const DE={__staticSelector:"InputBase",withAria:!0,size:"sm"},cy=Ul((p,b)=>{const{inputProps:T,wrapperProps:S,...R}=zE("InputBase",DE,p);return Te.jsx(No.Wrapper,{...S,children:Te.jsx(No,{...T,...R,ref:b})})});cy.classes={...No.classes,...No.Wrapper.classes};cy.displayName="@mantine/core/InputBase";const PE={gap:{type:"spacing",property:"gap"},rowGap:{type:"spacing",property:"rowGap"},columnGap:{type:"spacing",property:"columnGap"},align:{type:"identity",property:"alignItems"},justify:{type:"identity",property:"justifyContent"},wrap:{type:"identity",property:"flexWrap"},direction:{type:"identity",property:"flexDirection"}};var Hb={root:"m_8bffd616"};const uf=Ul((p,b)=>{const T=ln("Flex",null,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,gap:X,rowGap:Q,columnGap:ee,align:le,justify:ce,wrap:Ce,direction:xe,attributes:ie,...Ue}=T,$e=Di({name:"Flex",classes:Hb,props:T,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:ie,vars:N}),Le=Bc(),Ye=eb(),it=Jx({styleProps:{gap:X,rowGap:Q,columnGap:ee,align:le,justify:ce,wrap:Ce,direction:xe},theme:Le,data:PE});return Te.jsxs(Te.Fragment,{children:[it.hasResponsiveStyles&&Te.jsx(Qx,{selector:`.${Ye}`,styles:it.styles,media:it.media}),Te.jsx(un,{ref:b,...$e("root",{className:Ye,style:U_(it.inlineStyles)}),...Ue})]})});uf.classes=Hb;uf.displayName="@mantine/core/Flex";var Xb={root:"m_b6d8b162"};function RE(p){if(p==="start")return"start";if(p==="end"||p)return"end"}const IE={inherit:!1},LE=(p,{variant:b,lineClamp:T,gradient:S,size:R,color:I})=>({root:{"--text-fz":Fl(R),"--text-lh":Dw(R),"--text-gradient":b==="gradient"?ev(S,p):void 0,"--text-line-clamp":typeof T=="number"?T.toString():void 0,"--text-color":I?$p(I,p):void 0}}),$v=Ul((p,b)=>{const T=ln("Text",IE,p),{lineClamp:S,truncate:R,inline:I,inherit:E,gradient:l,span:N,__staticSelector:X,vars:Q,className:ee,style:le,classNames:ce,styles:Ce,unstyled:xe,variant:ie,mod:Ue,size:$e,attributes:Le,...Ye}=T,it=Di({name:["Text",X],props:T,classes:Xb,className:ee,style:le,classNames:ce,styles:Ce,unstyled:xe,attributes:Le,vars:Q,varsResolver:LE});return Te.jsx(un,{...it("root",{focusable:!0}),ref:b,component:N?"span":"p",variant:ie,mod:[{"data-truncate":RE(R),"data-line-clamp":typeof S=="number","data-inline":I,"data-inherit":E},Ue],size:$e,...Ye})});$v.classes=Xb;$v.displayName="@mantine/core/Text";function Yb(p){return typeof p=="string"?{value:p,label:p}:"value"in p&&!("label"in p)?{value:p.value,label:p.value,disabled:p.disabled}:typeof p=="number"?{value:p.toString(),label:p.toString()}:"group"in p?{group:p.group,items:p.items.map(b=>Yb(b))}:p}function OE(p){return p?p.map(b=>Yb(b)):[]}function Wb(p){return p.reduce((b,T)=>"group"in T?{...b,...Wb(T.items)}:(b[T.value]=T,b),{})}var co={dropdown:"m_88b62a41",search:"m_985517d8",options:"m_b2821a6e",option:"m_92253aa5",empty:"m_2530cd1d",header:"m_858f94bd",footer:"m_82b967cb",group:"m_254f3e4f",groupLabel:"m_2bb2e9e5",chevron:"m_2943220b",optionsDropdownOption:"m_390b5f4",optionsDropdownCheckIcon:"m_8ee53fc2",optionsDropdownCheckPlaceholder:"m_a530ee0a"};const kE={error:null},BE=(p,{size:b,color:T})=>({chevron:{"--combobox-chevron-size":Ua(b,"combobox-chevron-size"),"--combobox-chevron-color":T?$p(T,p):void 0}}),Zv=$n((p,b)=>{const T=ln("ComboboxChevron",kE,p),{size:S,error:R,style:I,className:E,classNames:l,styles:N,unstyled:X,vars:Q,mod:ee,...le}=T,ce=Di({name:"ComboboxChevron",classes:co,props:T,style:I,className:E,classNames:l,styles:N,unstyled:X,vars:Q,varsResolver:BE,rootSelector:"chevron"});return Te.jsx(un,{component:"svg",...le,...ce("chevron"),size:S,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",mod:["combobox-chevron",{error:R},ee],ref:b,children:Te.jsx("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})});Zv.classes=co;Zv.displayName="@mantine/core/ComboboxChevron";const[FE,Zs]=_g("Combobox component was not found in tree"),Kb=ue.forwardRef(({size:p,onMouseDown:b,onClick:T,onClear:S,...R},I)=>Te.jsx(No.ClearButton,{ref:I,tabIndex:-1,"aria-hidden":!0,...R,onMouseDown:E=>{E.preventDefault(),b?.(E)},onClick:E=>{S(),T?.(E)}}));Kb.displayName="@mantine/core/ComboboxClearButton";const Hv=$n((p,b)=>{const{classNames:T,styles:S,className:R,style:I,hidden:E,...l}=ln("ComboboxDropdown",null,p),N=Zs();return Te.jsx(Zh.Dropdown,{...l,ref:b,role:"presentation","data-hidden":E||void 0,...N.getStyles("dropdown",{className:R,style:I,classNames:T,styles:S})})});Hv.classes=co;Hv.displayName="@mantine/core/ComboboxDropdown";const NE={refProp:"ref"},Qb=$n((p,b)=>{const{children:T,refProp:S}=ln("ComboboxDropdownTarget",NE,p);if(Zs(),!Ix(T))throw new Error("Combobox.DropdownTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");return Te.jsx(Zh.Target,{ref:b,refProp:S,children:T})});Qb.displayName="@mantine/core/ComboboxDropdownTarget";const Xv=$n((p,b)=>{const{classNames:T,className:S,style:R,styles:I,vars:E,...l}=ln("ComboboxEmpty",null,p),N=Zs();return Te.jsx(un,{ref:b,...N.getStyles("empty",{className:S,classNames:T,styles:I,style:R}),...l})});Xv.classes=co;Xv.displayName="@mantine/core/ComboboxEmpty";function Yv({onKeyDown:p,withKeyboardNavigation:b,withAriaAttributes:T,withExpandedAttribute:S,targetType:R,autoComplete:I}){const E=Zs(),[l,N]=ue.useState(null),X=ee=>{if(p?.(ee),!E.readOnly&&b){if(ee.nativeEvent.isComposing)return;if(ee.nativeEvent.code==="ArrowDown"&&(ee.preventDefault(),E.store.dropdownOpened?N(E.store.selectNextOption()):(E.store.openDropdown("keyboard"),N(E.store.selectActiveOption()),E.store.updateSelectedOptionIndex("selected",{scrollIntoView:!0}))),ee.nativeEvent.code==="ArrowUp"&&(ee.preventDefault(),E.store.dropdownOpened?N(E.store.selectPreviousOption()):(E.store.openDropdown("keyboard"),N(E.store.selectActiveOption()),E.store.updateSelectedOptionIndex("selected",{scrollIntoView:!0}))),ee.nativeEvent.code==="Enter"||ee.nativeEvent.code==="NumpadEnter"){if(ee.nativeEvent.keyCode===229)return;const le=E.store.getSelectedOptionIndex();E.store.dropdownOpened&&le!==-1?(ee.preventDefault(),E.store.clickSelectedOption()):R==="button"&&(ee.preventDefault(),E.store.openDropdown("keyboard"))}ee.key==="Escape"&&E.store.closeDropdown("keyboard"),ee.nativeEvent.code==="Space"&&R==="button"&&(ee.preventDefault(),E.store.toggleDropdown("keyboard"))}};return{...T?{"aria-haspopup":"listbox","aria-expanded":S?!!(E.store.listId&&E.store.dropdownOpened):void 0,"aria-controls":E.store.dropdownOpened&&E.store.listId?E.store.listId:void 0,"aria-activedescendant":E.store.dropdownOpened&&l||void 0,autoComplete:I,"data-expanded":E.store.dropdownOpened||void 0,"data-mantine-stop-propagation":E.store.dropdownOpened||void 0}:{},onKeyDown:X}}const jE={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},Jb=$n((p,b)=>{const{children:T,refProp:S,withKeyboardNavigation:R,withAriaAttributes:I,withExpandedAttribute:E,targetType:l,autoComplete:N,...X}=ln("ComboboxEventsTarget",jE,p),Q=q_(T);if(!Q)throw new Error("Combobox.EventsTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const ee=Zs(),le=Yv({targetType:l,withAriaAttributes:I,withKeyboardNavigation:R,withExpandedAttribute:E,onKeyDown:Q.props.onKeyDown,autoComplete:N});return ue.cloneElement(Q,{...le,...X,[S]:Gs(b,ee.store.targetRef,qx(Q))})});Jb.displayName="@mantine/core/ComboboxEventsTarget";const Wv=$n((p,b)=>{const{classNames:T,className:S,style:R,styles:I,vars:E,...l}=ln("ComboboxFooter",null,p),N=Zs();return Te.jsx(un,{ref:b,...N.getStyles("footer",{className:S,classNames:T,style:R,styles:I}),...l,onMouseDown:X=>{X.preventDefault()}})});Wv.classes=co;Wv.displayName="@mantine/core/ComboboxFooter";const Kv=$n((p,b)=>{const{classNames:T,className:S,style:R,styles:I,vars:E,children:l,label:N,id:X,...Q}=ln("ComboboxGroup",null,p),ee=Zs(),le=yg(X);return Te.jsxs(un,{ref:b,role:"group","aria-labelledby":N?le:void 0,...ee.getStyles("group",{className:S,classNames:T,style:R,styles:I}),...Q,children:[N&&Te.jsx("div",{id:le,...ee.getStyles("groupLabel",{classNames:T,styles:I}),children:N}),l]})});Kv.classes=co;Kv.displayName="@mantine/core/ComboboxGroup";const Qv=$n((p,b)=>{const{classNames:T,className:S,style:R,styles:I,vars:E,...l}=ln("ComboboxHeader",null,p),N=Zs();return Te.jsx(un,{ref:b,...N.getStyles("header",{className:S,classNames:T,style:R,styles:I}),...l,onMouseDown:X=>{X.preventDefault()}})});Qv.classes=co;Qv.displayName="@mantine/core/ComboboxHeader";function e1({value:p,valuesDivider:b=",",...T}){return Te.jsx("input",{type:"hidden",value:Array.isArray(p)?p.join(b):p||"",...T})}e1.displayName="@mantine/core/ComboboxHiddenInput";const Jv=$n((p,b)=>{const T=ln("ComboboxOption",null,p),{classNames:S,className:R,style:I,styles:E,vars:l,onClick:N,id:X,active:Q,onMouseDown:ee,onMouseOver:le,disabled:ce,selected:Ce,mod:xe,...ie}=T,Ue=Zs(),$e=ue.useId(),Le=X||$e;return Te.jsx(un,{...Ue.getStyles("option",{className:R,classNames:S,styles:E,style:I}),...ie,ref:b,id:Le,mod:["combobox-option",{"combobox-active":Q,"combobox-disabled":ce,"combobox-selected":Ce},xe],role:"option",onClick:Ye=>{ce?Ye.preventDefault():(Ue.onOptionSubmit?.(T.value,T),N?.(Ye))},onMouseDown:Ye=>{Ye.preventDefault(),ee?.(Ye)},onMouseOver:Ye=>{Ue.resetSelectionOnOptionHover&&Ue.store.resetSelectedOption(),le?.(Ye)}})});Jv.classes=co;Jv.displayName="@mantine/core/ComboboxOption";const e0=$n((p,b)=>{const T=ln("ComboboxOptions",null,p),{classNames:S,className:R,style:I,styles:E,id:l,onMouseDown:N,labelledBy:X,...Q}=T,ee=Zs(),le=yg(l);return ue.useEffect(()=>{ee.store.setListId(le)},[le]),Te.jsx(un,{ref:b,...ee.getStyles("options",{className:R,style:I,classNames:S,styles:E}),...Q,id:le,role:"listbox","aria-labelledby":X,onMouseDown:ce=>{ce.preventDefault(),N?.(ce)}})});e0.classes=co;e0.displayName="@mantine/core/ComboboxOptions";const VE={withAriaAttributes:!0,withKeyboardNavigation:!0},t0=$n((p,b)=>{const T=ln("ComboboxSearch",VE,p),{classNames:S,styles:R,unstyled:I,vars:E,withAriaAttributes:l,onKeyDown:N,withKeyboardNavigation:X,size:Q,...ee}=T,le=Zs(),ce=le.getStyles("search"),Ce=Yv({targetType:"input",withAriaAttributes:l,withKeyboardNavigation:X,withExpandedAttribute:!1,onKeyDown:N,autoComplete:"off"});return Te.jsx(No,{ref:Gs(b,le.store.searchRef),classNames:[{input:ce.className},S],styles:[{input:ce.style},R],size:Q||le.size,...Ce,...ee,__staticSelector:"Combobox"})});t0.classes=co;t0.displayName="@mantine/core/ComboboxSearch";const UE={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},t1=$n((p,b)=>{const{children:T,refProp:S,withKeyboardNavigation:R,withAriaAttributes:I,withExpandedAttribute:E,targetType:l,autoComplete:N,...X}=ln("ComboboxTarget",UE,p),Q=q_(T);if(!Q)throw new Error("Combobox.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const ee=Zs(),le=Yv({targetType:l,withAriaAttributes:I,withKeyboardNavigation:R,withExpandedAttribute:E,onKeyDown:Q.props.onKeyDown,autoComplete:N}),ce=ue.cloneElement(Q,{...le,...X});return Te.jsx(Zh.Target,{ref:Gs(b,ee.store.targetRef),children:ce})});t1.displayName="@mantine/core/ComboboxTarget";function GE(p,b,T){for(let S=p-1;S>=0;S-=1)if(!b[S].hasAttribute("data-combobox-disabled"))return S;if(T){for(let S=b.length-1;S>-1;S-=1)if(!b[S].hasAttribute("data-combobox-disabled"))return S}return p}function qE(p,b,T){for(let S=p+1;S<b.length;S+=1)if(!b[S].hasAttribute("data-combobox-disabled"))return S;if(T){for(let S=0;S<b.length;S+=1)if(!b[S].hasAttribute("data-combobox-disabled"))return S}return p}function $E(p){for(let b=0;b<p.length;b+=1)if(!p[b].hasAttribute("data-combobox-disabled"))return b;return-1}function n1({defaultOpened:p,opened:b,onOpenedChange:T,onDropdownClose:S,onDropdownOpen:R,loop:I=!0,scrollBehavior:E="instant"}={}){const[l,N]=gv({value:b,defaultValue:p,finalValue:!1,onChange:T}),X=ue.useRef(null),Q=ue.useRef(-1),ee=ue.useRef(null),le=ue.useRef(null),ce=ue.useRef(-1),Ce=ue.useRef(-1),xe=ue.useRef(-1),ie=ue.useCallback((Pe="unknown")=>{l||(N(!0),R?.(Pe))},[N,R,l]),Ue=ue.useCallback((Pe="unknown")=>{l&&(N(!1),S?.(Pe))},[N,S,l]),$e=ue.useCallback((Pe="unknown")=>{l?Ue(Pe):ie(Pe)},[Ue,ie,l]),Le=ue.useCallback(()=>{const Pe=jh(le.current),Xe=P_(`#${X.current} [data-combobox-selected]`,Pe);Xe?.removeAttribute("data-combobox-selected"),Xe?.removeAttribute("aria-selected")},[]),Ye=ue.useCallback(Pe=>{const Xe=jh(le.current),ft=P_(`#${X.current}`,Xe),yt=ft?Vh("[data-combobox-option]",ft):null;if(!yt)return null;const It=Pe>=yt.length?0:Pe<0?yt.length-1:Pe;return Q.current=It,yt?.[It]&&!yt[It].hasAttribute("data-combobox-disabled")?(Le(),yt[It].setAttribute("data-combobox-selected","true"),yt[It].setAttribute("aria-selected","true"),yt[It].scrollIntoView({block:"nearest",behavior:E}),yt[It].id):null},[E,Le]),it=ue.useCallback(()=>{const Pe=jh(le.current),Xe=P_(`#${X.current} [data-combobox-active]`,Pe);if(Xe){const yt=Vh(`#${X.current} [data-combobox-option]`,Pe).findIndex(It=>It===Xe);return Ye(yt)}return Ye(0)},[Ye]),pt=ue.useCallback(()=>{const Pe=jh(le.current),Xe=Vh(`#${X.current} [data-combobox-option]`,Pe);return Ye(qE(Q.current,Xe,I))},[Ye,I]),Qe=ue.useCallback(()=>{const Pe=jh(le.current),Xe=Vh(`#${X.current} [data-combobox-option]`,Pe);return Ye(GE(Q.current,Xe,I))},[Ye,I]),_t=ue.useCallback(()=>{const Pe=jh(le.current),Xe=Vh(`#${X.current} [data-combobox-option]`,Pe);return Ye($E(Xe))},[Ye]),Pt=ue.useCallback((Pe="selected",Xe)=>{xe.current=window.setTimeout(()=>{const ft=jh(le.current),yt=Vh(`#${X.current} [data-combobox-option]`,ft),It=yt.findIndex(Ee=>Ee.hasAttribute(`data-combobox-${Pe}`));Q.current=It,Xe?.scrollIntoView&&yt[It]?.scrollIntoView({block:"nearest",behavior:E})},0)},[]),Rt=ue.useCallback(()=>{Q.current=-1,Le()},[Le]),Zt=ue.useCallback(()=>{const Pe=jh(le.current);Vh(`#${X.current} [data-combobox-option]`,Pe)?.[Q.current]?.click()},[]),Ot=ue.useCallback(Pe=>{X.current=Pe},[]),Vt=ue.useCallback(()=>{ce.current=window.setTimeout(()=>ee.current?.focus(),0)},[]),Ft=ue.useCallback(()=>{Ce.current=window.setTimeout(()=>le.current?.focus(),0)},[]),Ht=ue.useCallback(()=>Q.current,[]);return ue.useEffect(()=>()=>{window.clearTimeout(ce.current),window.clearTimeout(Ce.current),window.clearTimeout(xe.current)},[]),{dropdownOpened:l,openDropdown:ie,closeDropdown:Ue,toggleDropdown:$e,selectedOptionIndex:Q.current,getSelectedOptionIndex:Ht,selectOption:Ye,selectFirstOption:_t,selectActiveOption:it,selectNextOption:pt,selectPreviousOption:Qe,resetSelectedOption:Rt,updateSelectedOptionIndex:Pt,listId:X.current,setListId:Ot,clickSelectedOption:Zt,searchRef:ee,focusSearchInput:Vt,targetRef:le,focusTarget:Ft}}const ZE={keepMounted:!0,withinPortal:!0,resetSelectionOnOptionHover:!1,width:"target",transitionProps:{transition:"fade",duration:0},size:"sm"},HE=(p,{size:b,dropdownPadding:T})=>({options:{"--combobox-option-fz":Fl(b),"--combobox-option-padding":Ua(b,"combobox-option-padding")},dropdown:{"--combobox-padding":T===void 0?void 0:bt(T),"--combobox-option-fz":Fl(b),"--combobox-option-padding":Ua(b,"combobox-option-padding")}});function Bi(p){const b=ln("Combobox",ZE,p),{classNames:T,styles:S,unstyled:R,children:I,store:E,vars:l,onOptionSubmit:N,onClose:X,size:Q,dropdownPadding:ee,resetSelectionOnOptionHover:le,__staticSelector:ce,readOnly:Ce,attributes:xe,...ie}=b,Ue=n1(),$e=E||Ue,Le=Di({name:ce||"Combobox",classes:co,props:b,classNames:T,styles:S,unstyled:R,attributes:xe,vars:l,varsResolver:HE}),Ye=()=>{X?.(),$e.closeDropdown()};return Te.jsx(FE,{value:{getStyles:Le,store:$e,onOptionSubmit:N,size:Q,resetSelectionOnOptionHover:le,readOnly:Ce},children:Te.jsx(Zh,{opened:$e.dropdownOpened,preventPositionChangeWhenVisible:!1,...ie,onChange:it=>!it&&Ye(),withRoles:!1,unstyled:R,children:I})})}const XE=p=>p;Bi.extend=XE;Bi.classes=co;Bi.displayName="@mantine/core/Combobox";Bi.Target=t1;Bi.Dropdown=Hv;Bi.Options=e0;Bi.Option=Jv;Bi.Search=t0;Bi.Empty=Xv;Bi.Chevron=Zv;Bi.Footer=Wv;Bi.Header=Qv;Bi.EventsTarget=Jb;Bi.DropdownTarget=Qb;Bi.Group=Kv;Bi.ClearButton=Kb;Bi.HiddenInput=e1;function YE({size:p,style:b,...T}){const S=p!==void 0?{width:bt(p),height:bt(p),...b}:b;return Te.jsx("svg",{viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:S,"aria-hidden":!0,...T,children:Te.jsx("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function gg(p){return"group"in p}function i1({options:p,search:b,limit:T}){const S=b.trim().toLowerCase(),R=[];for(let I=0;I<p.length;I+=1){const E=p[I];if(R.length===T)return R;gg(E)&&R.push({group:E.group,items:i1({options:E.items,search:b,limit:T-R.length})}),gg(E)||E.label.toLowerCase().includes(S)&&R.push(E)}return R}function WE(p){if(p.length===0)return!0;for(const b of p)if(!("group"in b)||b.items.length>0)return!1;return!0}function r1(p,b=new Set){if(Array.isArray(p))for(const T of p)if(gg(T))r1(T.items,b);else{if(typeof T.value>"u")throw new Error("[@mantine/core] Each option must have value property");if(typeof T.value!="string")throw new Error(`[@mantine/core] Option value must be a string, other data formats are not supported, got ${typeof T.value}`);if(b.has(T.value))throw new Error(`[@mantine/core] Duplicate options are not supported. Option with value "${T.value}" was provided more than once`);b.add(T.value)}}function KE(p,b){return Array.isArray(p)?p.includes(b):p===b}function a1({data:p,withCheckIcon:b,withAlignedLabels:T,value:S,checkIconPosition:R,unstyled:I,renderOption:E}){if(!gg(p)){const N=KE(S,p.value),X=b&&(N?Te.jsx(YE,{className:co.optionsDropdownCheckIcon}):T?Te.jsx("div",{className:co.optionsDropdownCheckPlaceholder}):null),Q=Te.jsxs(Te.Fragment,{children:[R==="left"&&X,Te.jsx("span",{children:p.label}),R==="right"&&X]});return Te.jsx(Bi.Option,{value:p.value,disabled:p.disabled,className:Fu({[co.optionsDropdownOption]:!I}),"data-reverse":R==="right"||void 0,"data-checked":N||void 0,"aria-selected":N,active:N,children:typeof E=="function"?E({option:p,checked:N}):Q})}const l=p.items.map(N=>Te.jsx(a1,{data:N,value:S,unstyled:I,withCheckIcon:b,withAlignedLabels:T,checkIconPosition:R,renderOption:E},N.value));return Te.jsx(Bi.Group,{label:p.group,children:l})}function QE({data:p,hidden:b,hiddenWhenEmpty:T,filter:S,search:R,limit:I,maxDropdownHeight:E,withScrollArea:l=!0,filterOptions:N=!0,withCheckIcon:X=!1,withAlignedLabels:Q=!1,value:ee,checkIconPosition:le,nothingFoundMessage:ce,unstyled:Ce,labelId:xe,renderOption:ie,scrollAreaProps:Ue,"aria-label":$e}){r1(p);const Ye=typeof R=="string"?(S||i1)({options:p,search:N?R:"",limit:I??1/0}):p,it=WE(Ye),pt=Ye.map(Qe=>Te.jsx(a1,{data:Qe,withCheckIcon:X,withAlignedLabels:Q,value:ee,checkIconPosition:le,unstyled:Ce,renderOption:ie},gg(Qe)?Qe.group:Qe.value));return Te.jsx(Bi.Dropdown,{hidden:b||T&&it,"data-composed":!0,children:Te.jsxs(Bi.Options,{labelledBy:xe,"aria-label":$e,children:[l?Te.jsx(bg.Autosize,{mah:E??220,type:"scroll",scrollbarSize:"var(--combobox-padding)",offsetScrollbars:"y",...Ue,children:pt}):pt,it&&ce&&Te.jsx(Bi.Empty,{children:ce})]})})}const n0=$n((p,b)=>{const T=ln("Autocomplete",null,p),{classNames:S,styles:R,unstyled:I,vars:E,dropdownOpened:l,defaultDropdownOpened:N,onDropdownClose:X,onDropdownOpen:Q,onFocus:ee,onBlur:le,onClick:ce,onChange:Ce,data:xe,value:ie,defaultValue:Ue,selectFirstOptionOnChange:$e,selectFirstOptionOnDropdownOpen:Le,onOptionSubmit:Ye,comboboxProps:it,readOnly:pt,disabled:Qe,filter:_t,limit:Pt,withScrollArea:Rt,maxDropdownHeight:Zt,size:Ot,id:Vt,renderOption:Ft,autoComplete:Ht,scrollAreaProps:Pe,onClear:Xe,clearButtonProps:ft,error:yt,clearable:It,rightSection:Ee,autoSelectOnBlur:rt,openOnFocus:Tt=!0,attributes:At,...Ut}=T,Nt=yg(Vt),tn=OE(xe),fn=Wb(tn),[_n,$i]=gv({value:ie,defaultValue:Ue,finalValue:"",onChange:Ce}),Fn=n1({opened:l,defaultOpened:N,onDropdownOpen:()=>{Q?.(),Le&&Fn.selectFirstOption()},onDropdownClose:()=>{X?.(),setTimeout(Fn.resetSelectedOption,0)}}),vi=Nn=>{$i(Nn),Fn.resetSelectedOption()},{resolvedClassNames:ya,resolvedStyles:Pn}=bv({props:T,styles:R,classNames:S});ue.useEffect(()=>{$e&&Fn.selectFirstOption()},[$e,_n]);const Zi=Te.jsx(Bi.ClearButton,{...ft,onClear:()=>{vi(""),Xe?.()}});return Te.jsxs(Bi,{store:Fn,__staticSelector:"Autocomplete",classNames:ya,styles:Pn,unstyled:I,readOnly:pt,size:Ot,attributes:At,keepMounted:rt,onOptionSubmit:Nn=>{Ye?.(Nn),vi(fn[Nn].label),Fn.closeDropdown()},...it,children:[Te.jsx(Bi.Target,{autoComplete:Ht,children:Te.jsx(cy,{ref:b,...Ut,size:Ot,__staticSelector:"Autocomplete",__clearSection:Zi,__clearable:It&&!!_n&&!Qe&&!pt,rightSection:Ee,disabled:Qe,readOnly:pt,value:_n,error:yt,onChange:Nn=>{vi(Nn.currentTarget.value),Fn.openDropdown(),$e&&Fn.selectFirstOption()},onFocus:Nn=>{Tt&&Fn.openDropdown(),ee?.(Nn)},onBlur:Nn=>{rt&&Fn.clickSelectedOption(),Fn.closeDropdown(),le?.(Nn)},onClick:Nn=>{Fn.openDropdown(),ce?.(Nn)},classNames:ya,styles:Pn,unstyled:I,attributes:At,id:Nt})}),Te.jsx(QE,{data:tn,hidden:pt||Qe,filter:_t,search:_n,limit:Pt,hiddenWhenEmpty:!0,withScrollArea:Rt,maxDropdownHeight:Zt,unstyled:I,labelId:Ut.label?`${Nt}-label`:void 0,"aria-label":Ut.label?void 0:Ut["aria-label"],renderOption:Ft,scrollAreaProps:Pe})]})});n0.classes={...cy.classes,...Bi.classes};n0.displayName="@mantine/core/Autocomplete";const[JE,eC]=_g("Card component was not found in tree");var i0={root:"m_e615b15f",section:"m_599a2148"};const uy=Ul((p,b)=>{const T=ln("CardSection",null,p),{classNames:S,className:R,style:I,styles:E,vars:l,withBorder:N,inheritPadding:X,mod:Q,...ee}=T,le=eC();return Te.jsx(un,{ref:b,mod:[{"with-border":N,"inherit-padding":X},Q],...le.getStyles("section",{className:R,style:I,styles:E,classNames:S}),...ee})});uy.classes=i0;uy.displayName="@mantine/core/CardSection";const tC=(p,{padding:b})=>({root:{"--card-padding":mv(b)}}),hy=Ul((p,b)=>{const T=ln("Card",null,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,children:X,padding:Q,attributes:ee,...le}=T,ce=Di({name:"Card",props:T,classes:i0,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:ee,vars:N,varsResolver:tC}),Ce=ue.Children.toArray(X),xe=Ce.map((ie,Ue)=>typeof ie=="object"&&ie&&"type"in ie&&ie.type===uy?ue.cloneElement(ie,{"data-first-section":Ue===0||void 0,"data-last-section":Ue===Ce.length-1||void 0}):ie);return Te.jsx(JE,{value:{getStyles:ce},children:Te.jsx(Bv,{ref:b,unstyled:l,...ce("root"),...le,children:xe})})});hy.classes=i0;hy.displayName="@mantine/core/Card";hy.Section=uy;function cv(){return cv=Object.assign?Object.assign.bind():function(p){for(var b=1;b<arguments.length;b++){var T=arguments[b];for(var S in T)({}).hasOwnProperty.call(T,S)&&(p[S]=T[S])}return p},cv.apply(null,arguments)}function o1(p,b){if(p==null)return{};var T={};for(var S in p)if({}.hasOwnProperty.call(p,S)){if(b.indexOf(S)!==-1)continue;T[S]=p[S]}return T}var s1={root:"m_a513464",icon:"m_a4ceffb",loader:"m_b0920b15",body:"m_a49ed24",title:"m_3feedf16",description:"m_3d733a3a",closeButton:"m_919a4d88"};const nC={withCloseButton:!0},iC=(p,{radius:b,color:T})=>({root:{"--notification-radius":b===void 0?void 0:Bu(b),"--notification-color":T?$p(T,p):void 0}}),r0=$n((p,b)=>{const T=ln("Notification",nC,p),{className:S,color:R,radius:I,loading:E,withCloseButton:l,withBorder:N,title:X,icon:Q,children:ee,onClose:le,closeButtonProps:ce,classNames:Ce,style:xe,styles:ie,unstyled:Ue,vars:$e,mod:Le,loaderProps:Ye,role:it,attributes:pt,...Qe}=T,_t=Di({name:"Notification",classes:s1,props:T,className:S,style:xe,classNames:Ce,styles:ie,unstyled:Ue,attributes:pt,vars:$e,varsResolver:iC});return Te.jsxs(un,{..._t("root"),mod:[{"data-with-icon":!!Q||E,"data-with-border":N},Le],ref:b,role:it||"alert",...Qe,children:[Q&&!E&&Te.jsx("div",{..._t("icon"),children:Q}),E&&Te.jsx(wg,{size:28,color:R,...Ye,..._t("loader")}),Te.jsxs("div",{..._t("body"),children:[X&&Te.jsx("div",{..._t("title"),children:X}),Te.jsx(un,{..._t("description"),mod:{"data-with-title":!!X},children:ee})]}),l&&Te.jsx(iy,{iconSize:16,color:"gray",...ce,unstyled:Ue,onClick:le,..._t("closeButton")})]})});r0.classes=s1;r0.displayName="@mantine/core/Notification";var l1={root:"m_7341320d"};const rC=(p,{size:b,radius:T,variant:S,gradient:R,color:I,autoContrast:E})=>{const l=p.variantColorResolver({color:I||p.primaryColor,theme:p,gradient:R,variant:S||"filled",autoContrast:E});return{root:{"--ti-size":Ua(b,"ti-size"),"--ti-radius":T===void 0?void 0:Bu(T),"--ti-bg":I||S?l.background:void 0,"--ti-color":I||S?l.color:void 0,"--ti-bd":I||S?l.border:void 0}}},a0=$n((p,b)=>{const T=ln("ThemeIcon",null,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,autoContrast:X,attributes:Q,...ee}=T,le=Di({name:"ThemeIcon",classes:l1,props:T,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:Q,vars:N,varsResolver:rC});return Te.jsx(un,{ref:b,...le("root"),...ee})});a0.classes=l1;a0.displayName="@mantine/core/ThemeIcon";const aC=["h1","h2","h3","h4","h5","h6"],oC=["xs","sm","md","lg","xl"];function sC(p,b){const T=b!==void 0?b:`h${p}`;return aC.includes(T)?{fontSize:`var(--mantine-${T}-font-size)`,fontWeight:`var(--mantine-${T}-font-weight)`,lineHeight:`var(--mantine-${T}-line-height)`}:oC.includes(T)?{fontSize:`var(--mantine-font-size-${T})`,fontWeight:`var(--mantine-h${p}-font-weight)`,lineHeight:`var(--mantine-h${p}-line-height)`}:{fontSize:bt(T),fontWeight:`var(--mantine-h${p}-font-weight)`,lineHeight:`var(--mantine-h${p}-line-height)`}}var c1={root:"m_8a5d1357"};const lC={order:1},cC=(p,{order:b,size:T,lineClamp:S,textWrap:R})=>{const I=sC(b||1,T);return{root:{"--title-fw":I.fontWeight,"--title-lh":I.lineHeight,"--title-fz":I.fontSize,"--title-line-clamp":typeof S=="number"?S.toString():void 0,"--title-text-wrap":R}}},o0=$n((p,b)=>{const T=ln("Title",lC,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,order:N,vars:X,size:Q,variant:ee,lineClamp:le,textWrap:ce,mod:Ce,attributes:xe,...ie}=T,Ue=Di({name:"Title",props:T,classes:c1,className:R,style:I,classNames:S,styles:E,unstyled:l,attributes:xe,vars:X,varsResolver:cC});return[1,2,3,4,5,6].includes(N)?Te.jsx(un,{...Ue("root"),component:`h${N}`,variant:ee,ref:b,mod:[{order:N,"data-line-clamp":typeof le=="number"},Ce],size:Q,...ie}):null});o0.classes=c1;o0.displayName="@mantine/core/Title";const uC={};function hC(p){let b=p,T=!1;const S=new Set;return{getState(){return b},updateState(R){b=typeof R=="function"?R(b):R},setState(R){this.updateState(R),S.forEach(I=>I(b))},initialize(R){T||(b=R,T=!0)},subscribe(R){return S.add(R),()=>S.delete(R)}}}function dC(p){return ue.useSyncExternalStore(p.subscribe,()=>p.getState(),()=>p.getState())}function fC(p,b,T){const S=[],R=[],I={};for(const E of p){const l=E.position||b;I[l]=I[l]||0,I[l]+=1,I[l]<=T?R.push(E):S.push(E)}return{notifications:R,queue:S}}const pC=()=>hC({notifications:[],queue:[],defaultPosition:"bottom-right",limit:5}),hf=pC(),mC=(p=hf)=>dC(p);function Jp(p,b){const T=p.getState(),S=b([...T.notifications,...T.queue]),R=fC(S,T.defaultPosition,T.limit);p.setState({notifications:R.notifications,queue:R.queue,limit:T.limit,defaultPosition:T.defaultPosition})}function gC(p,b=hf){const T=p.id||Bx();return Jp(b,S=>p.id&&S.some(R=>R.id===p.id)?S:[...S,{...p,id:T}]),T}function u1(p,b=hf){return Jp(b,T=>T.filter(S=>S.id===p?(S.onClose?.(S),!1):!0)),p}function _C(p,b=hf){return Jp(b,T=>T.map(S=>S.id===p.id?{...S,...p}:S)),p.id}function yC(p=hf){Jp(p,()=>[])}function vC(p=hf){Jp(p,b=>b.slice(0,p.getState().limit))}const df={show:gC,hide:u1,update:_C,clean:yC,cleanQueue:vC,updateState:Jp};function uv(p,b){return uv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(T,S){return T.__proto__=S,T},uv(p,b)}function h1(p,b){p.prototype=Object.create(b.prototype),p.prototype.constructor=p,uv(p,b)}const gx={disabled:!1},N_=hs.createContext(null);var xC=function(b){return b.scrollTop},dg="unmounted",rf="exited",af="entering",Up="entered",hv="exiting",Nu=(function(p){h1(b,p);function b(S,R){var I;I=p.call(this,S,R)||this;var E=R,l=E&&!E.isMounting?S.enter:S.appear,N;return I.appearStatus=null,S.in?l?(N=rf,I.appearStatus=af):N=Up:S.unmountOnExit||S.mountOnEnter?N=dg:N=rf,I.state={status:N},I.nextCallback=null,I}b.getDerivedStateFromProps=function(R,I){var E=R.in;return E&&I.status===dg?{status:rf}:null};var T=b.prototype;return T.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},T.componentDidUpdate=function(R){var I=null;if(R!==this.props){var E=this.state.status;this.props.in?E!==af&&E!==Up&&(I=af):(E===af||E===Up)&&(I=hv)}this.updateStatus(!1,I)},T.componentWillUnmount=function(){this.cancelNextCallback()},T.getTimeouts=function(){var R=this.props.timeout,I,E,l;return I=E=l=R,R!=null&&typeof R!="number"&&(I=R.exit,E=R.enter,l=R.appear!==void 0?R.appear:E),{exit:I,enter:E,appear:l}},T.updateStatus=function(R,I){if(R===void 0&&(R=!1),I!==null)if(this.cancelNextCallback(),I===af){if(this.props.unmountOnExit||this.props.mountOnEnter){var E=this.props.nodeRef?this.props.nodeRef.current:hg.findDOMNode(this);E&&xC(E)}this.performEnter(R)}else this.performExit();else this.props.unmountOnExit&&this.state.status===rf&&this.setState({status:dg})},T.performEnter=function(R){var I=this,E=this.props.enter,l=this.context?this.context.isMounting:R,N=this.props.nodeRef?[l]:[hg.findDOMNode(this),l],X=N[0],Q=N[1],ee=this.getTimeouts(),le=l?ee.appear:ee.enter;if(!R&&!E||gx.disabled){this.safeSetState({status:Up},function(){I.props.onEntered(X)});return}this.props.onEnter(X,Q),this.safeSetState({status:af},function(){I.props.onEntering(X,Q),I.onTransitionEnd(le,function(){I.safeSetState({status:Up},function(){I.props.onEntered(X,Q)})})})},T.performExit=function(){var R=this,I=this.props.exit,E=this.getTimeouts(),l=this.props.nodeRef?void 0:hg.findDOMNode(this);if(!I||gx.disabled){this.safeSetState({status:rf},function(){R.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:hv},function(){R.props.onExiting(l),R.onTransitionEnd(E.exit,function(){R.safeSetState({status:rf},function(){R.props.onExited(l)})})})},T.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},T.safeSetState=function(R,I){I=this.setNextCallback(I),this.setState(R,I)},T.setNextCallback=function(R){var I=this,E=!0;return this.nextCallback=function(l){E&&(E=!1,I.nextCallback=null,R(l))},this.nextCallback.cancel=function(){E=!1},this.nextCallback},T.onTransitionEnd=function(R,I){this.setNextCallback(I);var E=this.props.nodeRef?this.props.nodeRef.current:hg.findDOMNode(this),l=R==null&&!this.props.addEndListener;if(!E||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var N=this.props.nodeRef?[this.nextCallback]:[E,this.nextCallback],X=N[0],Q=N[1];this.props.addEndListener(X,Q)}R!=null&&setTimeout(this.nextCallback,R)},T.render=function(){var R=this.state.status;if(R===dg)return null;var I=this.props,E=I.children;I.in,I.mountOnEnter,I.unmountOnExit,I.appear,I.enter,I.exit,I.timeout,I.addEndListener,I.onEnter,I.onEntering,I.onEntered,I.onExit,I.onExiting,I.onExited,I.nodeRef;var l=o1(I,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return hs.createElement(N_.Provider,{value:null},typeof E=="function"?E(R,l):hs.cloneElement(hs.Children.only(E),l))},b})(hs.Component);Nu.contextType=N_;Nu.propTypes={};function jp(){}Nu.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:jp,onEntering:jp,onEntered:jp,onExit:jp,onExiting:jp,onExited:jp};Nu.UNMOUNTED=dg;Nu.EXITED=rf;Nu.ENTERING=af;Nu.ENTERED=Up;Nu.EXITING=hv;function bC(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function s0(p,b){var T=function(I){return b&&ue.isValidElement(I)?b(I):I},S=Object.create(null);return p&&ue.Children.map(p,function(R){return R}).forEach(function(R){S[R.key]=T(R)}),S}function wC(p,b){p=p||{},b=b||{};function T(Q){return Q in b?b[Q]:p[Q]}var S=Object.create(null),R=[];for(var I in p)I in b?R.length&&(S[I]=R,R=[]):R.push(I);var E,l={};for(var N in b){if(S[N])for(E=0;E<S[N].length;E++){var X=S[N][E];l[S[N][E]]=T(X)}l[N]=T(N)}for(E=0;E<R.length;E++)l[R[E]]=T(R[E]);return l}function sf(p,b,T){return T[b]!=null?T[b]:p.props[b]}function SC(p,b){return s0(p.children,function(T){return ue.cloneElement(T,{onExited:b.bind(null,T),in:!0,appear:sf(T,"appear",p),enter:sf(T,"enter",p),exit:sf(T,"exit",p)})})}function TC(p,b,T){var S=s0(p.children),R=wC(b,S);return Object.keys(R).forEach(function(I){var E=R[I];if(ue.isValidElement(E)){var l=I in b,N=I in S,X=b[I],Q=ue.isValidElement(X)&&!X.props.in;N&&(!l||Q)?R[I]=ue.cloneElement(E,{onExited:T.bind(null,E),in:!0,exit:sf(E,"exit",p),enter:sf(E,"enter",p)}):!N&&l&&!Q?R[I]=ue.cloneElement(E,{in:!1}):N&&l&&ue.isValidElement(X)&&(R[I]=ue.cloneElement(E,{onExited:T.bind(null,E),in:X.props.in,exit:sf(E,"exit",p),enter:sf(E,"enter",p)}))}}),R}var EC=Object.values||function(p){return Object.keys(p).map(function(b){return p[b]})},CC={component:"div",childFactory:function(b){return b}},Uh=(function(p){h1(b,p);function b(S,R){var I;I=p.call(this,S,R)||this;var E=I.handleExited.bind(bC(I));return I.state={contextValue:{isMounting:!0},handleExited:E,firstRender:!0},I}var T=b.prototype;return T.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},T.componentWillUnmount=function(){this.mounted=!1},b.getDerivedStateFromProps=function(R,I){var E=I.children,l=I.handleExited,N=I.firstRender;return{children:N?SC(R,l):TC(R,E,l),firstRender:!1}},T.handleExited=function(R,I){var E=s0(this.props.children);R.key in E||(R.props.onExited&&R.props.onExited(I),this.mounted&&this.setState(function(l){var N=cv({},l.children);return delete N[R.key],{children:N}}))},T.render=function(){var R=this.props,I=R.component,E=R.childFactory,l=o1(R,["component","childFactory"]),N=this.state.contextValue,X=EC(this.state.children).map(E);return delete l.appear,delete l.enter,delete l.exit,I===null?hs.createElement(N_.Provider,{value:N},X):hs.createElement(N_.Provider,{value:N},hs.createElement(I,l,X))},b})(hs.Component);Uh.propTypes={};Uh.defaultProps=CC;const d1=["bottom-center","bottom-left","bottom-right","top-center","top-left","top-right"];function MC(p,b){return p.reduce((T,S)=>(T[S.position||b].push(S),T),d1.reduce((T,S)=>(T[S]=[],T),{}))}const _x={left:"translateX(-100%)",right:"translateX(100%)","top-center":"translateY(-100%)","bottom-center":"translateY(100%)"},AC={left:"translateX(0)",right:"translateX(0)","top-center":"translateY(0)","bottom-center":"translateY(0)"};function zC({state:p,maxHeight:b,position:T,transitionDuration:S}){const[R,I]=T.split("-"),E=I==="center"?`${R}-center`:I,l={opacity:0,maxHeight:b,transform:_x[E],transitionDuration:`${S}ms, ${S}ms, ${S}ms`,transitionTimingFunction:"cubic-bezier(.51,.3,0,1.21), cubic-bezier(.51,.3,0,1.21), linear",transitionProperty:"opacity, transform, max-height"},N={opacity:1,transform:AC[E]},X={opacity:0,maxHeight:0,transform:_x[E]};return{...l,...{entering:N,entered:N,exiting:X,exited:X}[p]}}function DC(p,b){return typeof b=="number"?b:b===!1||p===!1?!1:p}const f1=ue.forwardRef(({data:p,onHide:b,autoClose:T,...S},R)=>{const{autoClose:I,message:E,...l}=p,N=DC(T,p.autoClose),X=ue.useRef(-1),Q=()=>window.clearTimeout(X.current),ee=()=>{b(p.id),Q()},le=()=>{typeof N=="number"&&(X.current=window.setTimeout(ee,N))};return ue.useEffect(()=>{p.onOpen?.(p)},[]),ue.useEffect(()=>(le(),Q),[N]),Te.jsx(r0,{...S,...l,onClose:ee,ref:R,onMouseEnter:Q,onMouseLeave:le,children:E})});f1.displayName="@mantine/notifications/NotificationContainer";var p1={root:"m_b37d9ac7",notification:"m_5ed0edd0"};const PC=Nu,RC={position:"bottom-right",autoClose:4e3,transitionDuration:250,containerWidth:440,notificationMaxHeight:200,limit:5,zIndex:pv("overlay"),store:hf,withinPortal:!0},IC=(p,{zIndex:b,containerWidth:T})=>({root:{"--notifications-z-index":b?.toString(),"--notifications-container-width":bt(T)}}),ju=$n((p,b)=>{const T=ln("Notifications",RC,p),{classNames:S,className:R,style:I,styles:E,unstyled:l,vars:N,position:X,autoClose:Q,transitionDuration:ee,containerWidth:le,notificationMaxHeight:ce,limit:Ce,zIndex:xe,store:ie,portalProps:Ue,withinPortal:$e,...Le}=T,Ye=Bc(),it=mC(ie),pt=Gw(),Qe=Gx(),_t=ue.useRef({}),Pt=ue.useRef(0),Zt=(Ye.respectReducedMotion?Qe:!1)?1:ee,Ot=Di({name:"Notifications",classes:p1,props:T,className:R,style:I,classNames:S,styles:E,unstyled:l,vars:N,varsResolver:IC});ue.useEffect(()=>{ie?.updateState(Ht=>({...Ht,limit:Ce||5,defaultPosition:X}))},[Ce,X]),fg(()=>{it.notifications.length>Pt.current&&setTimeout(()=>pt(),0),Pt.current=it.notifications.length},[it.notifications]);const Vt=MC(it.notifications,X),Ft=d1.reduce((Ht,Pe)=>(Ht[Pe]=Vt[Pe].map(({style:Xe,...ft})=>Te.jsx(PC,{timeout:Zt,onEnter:()=>_t.current[ft.id].offsetHeight,nodeRef:{current:_t.current[ft.id]},children:yt=>Te.jsx(f1,{ref:It=>{It&&(_t.current[ft.id]=It)},data:ft,onHide:It=>u1(It,ie),autoClose:Q,...Ot("notification",{style:{...zC({state:yt,position:Pe,transitionDuration:Zt,maxHeight:ce}),...Xe}})})},ft.id)),Ht),{});return Te.jsxs(ty,{withinPortal:$e,...Ue,children:[Te.jsx(un,{...Ot("root"),"data-position":"top-center",ref:b,...Le,children:Te.jsx(Uh,{children:Ft["top-center"]})}),Te.jsx(un,{...Ot("root"),"data-position":"top-left",...Le,children:Te.jsx(Uh,{children:Ft["top-left"]})}),Te.jsx(un,{...Ot("root",{className:Ky.classNames.fullWidth}),"data-position":"top-right",...Le,children:Te.jsx(Uh,{children:Ft["top-right"]})}),Te.jsx(un,{...Ot("root",{className:Ky.classNames.fullWidth}),"data-position":"bottom-right",...Le,children:Te.jsx(Uh,{children:Ft["bottom-right"]})}),Te.jsx(un,{...Ot("root"),"data-position":"bottom-left",...Le,children:Te.jsx(Uh,{children:Ft["bottom-left"]})}),Te.jsx(un,{...Ot("root"),"data-position":"bottom-center",...Le,children:Te.jsx(Uh,{children:Ft["bottom-center"]})})]})});ju.classes=p1;ju.displayName="@mantine/notifications/Notifications";ju.show=df.show;ju.hide=df.hide;ju.update=df.update;ju.clean=df.clean;ju.cleanQueue=df.cleanQueue;ju.updateState=df.updateState;var LC={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};const ff=(p,b,T,S)=>{const R=ue.forwardRef(({color:I="currentColor",size:E=24,stroke:l=2,title:N,className:X,children:Q,...ee},le)=>ue.createElement("svg",{ref:le,...LC[p],width:E,height:E,className:["tabler-icon",`tabler-icon-${b}`,X].join(" "),strokeWidth:l,stroke:I,...ee},[N&&ue.createElement("title",{key:"svg-title"},N),...S.map(([ce,Ce])=>ue.createElement(ce,Ce)),...Array.isArray(Q)?Q:[Q]]));return R.displayName=`${T}`,R};const OC=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],kC=ff("outline","arrow-right","ArrowRight",OC);const BC=[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]],yx=ff("outline","check","Check",BC);const FC=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 9h.01",key:"svg-1"}],["path",{d:"M11 12h1v4h1",key:"svg-2"}]],NC=ff("outline","info-circle","InfoCircle",FC);const jC=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454l0 .008",key:"svg-0"}]],VC=ff("outline","moon","Moon",jC);const UC=[["path",{d:"M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065",key:"svg-0"}],["path",{d:"M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],GC=ff("outline","settings","Settings",UC);const qC=[["path",{d:"M8 12a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],$C=ff("outline","sun","Sun",qC);const ZC=[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]],m1=ff("outline","x","X",ZC);function HC({stroke:p,style:b,variant:T}){const{setColorScheme:S}=Kx(),R=O2("light",{getInitialValueInEffect:!0});return Te.jsx(ry,{justify:"center",children:Te.jsxs(qh,{onClick:()=>S(R==="light"?"dark":"light"),variant:T,size:"md",radius:"md","aria-label":"Toggle color scheme",children:[R==="dark"&&Te.jsx($C,{style:b,stroke:p}),R==="light"&&Te.jsx(VC,{style:b,stroke:p})]})})}var I_={exports:{}};var XC=I_.exports,vx;function YC(){return vx||(vx=1,(function(p,b){(function(T,S){p.exports=S()})(XC,(function(){var T={},S={};function R(E,l,N){if(S[E]=N,E==="index"){var X="var sharedModule = {}; ("+S.shared+")(sharedModule); ("+S.worker+")(sharedModule);",Q={};return S.shared(Q),S.index(T,Q),typeof window<"u"&&T.setWorkerUrl(window.URL.createObjectURL(new Blob([X],{type:"text/javascript"}))),T}}R("shared",["exports"],(function(E){function l(i,e,n,s){return new(n||(n=Promise))((function(u,f){function m(A){try{w(s.next(A))}catch(P){f(P)}}function v(A){try{w(s.throw(A))}catch(P){f(P)}}function w(A){var P;A.done?u(A.value):(P=A.value,P instanceof n?P:new n((function(O){O(P)}))).then(m,v)}w((s=s.apply(i,e||[])).next())}))}function N(i,e){this.x=i,this.y=e}function X(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Q,ee;typeof SuppressedError=="function"&&SuppressedError,N.prototype={clone(){return new N(this.x,this.y)},add(i){return this.clone()._add(i)},sub(i){return this.clone()._sub(i)},multByPoint(i){return this.clone()._multByPoint(i)},divByPoint(i){return this.clone()._divByPoint(i)},mult(i){return this.clone()._mult(i)},div(i){return this.clone()._div(i)},rotate(i){return this.clone()._rotate(i)},rotateAround(i,e){return this.clone()._rotateAround(i,e)},matMult(i){return this.clone()._matMult(i)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(i){return this.x===i.x&&this.y===i.y},dist(i){return Math.sqrt(this.distSqr(i))},distSqr(i){const e=i.x-this.x,n=i.y-this.y;return e*e+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith(i){return this.angleWithSep(i.x,i.y)},angleWithSep(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult(i){const e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add(i){return this.x+=i.x,this.y+=i.y,this},_sub(i){return this.x-=i.x,this.y-=i.y,this},_mult(i){return this.x*=i,this.y*=i,this},_div(i){return this.x/=i,this.y/=i,this},_multByPoint(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint(i){return this.x/=i.x,this.y/=i.y,this},_unit(){return this._div(this.mag()),this},_perp(){const i=this.y;return this.y=this.x,this.x=-i,this},_rotate(i){const e=Math.cos(i),n=Math.sin(i),s=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=s,this},_rotateAround(i,e){const n=Math.cos(i),s=Math.sin(i),u=e.y+s*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:N},N.convert=function(i){if(i instanceof N)return i;if(Array.isArray(i))return new N(+i[0],+i[1]);if(i.x!==void 0&&i.y!==void 0)return new N(+i.x,+i.y);throw new Error("Expected [x, y] or {x, y} point format")};var le=(function(){if(ee)return Q;function i(e,n,s,u){this.cx=3*e,this.bx=3*(s-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(u-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=s,this.p2y=u}return ee=1,Q=i,i.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var s=e,u=0;u<8;u++){var f=this.sampleCurveX(s)-e;if(Math.abs(f)<n)return s;var m=this.sampleCurveDerivativeX(s);if(Math.abs(m)<1e-6)break;s-=f/m}var v=0,w=1;for(s=e,u=0;u<20&&(f=this.sampleCurveX(s),!(Math.abs(f-e)<n));u++)e>f?v=s:w=s,s=.5*(w-v)+v;return s},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},Q})(),ce=X(le);let Ce,xe;function ie(){return Ce==null&&(Ce=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ce}function Ue(){if(xe==null&&(xe=!1,ie())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let s=0;s<25;s++){const u=4*s;e.fillStyle=`rgb(${u},${u+1},${u+2})`,e.fillRect(s%5,Math.floor(s/5),1,1)}const n=e.getImageData(0,0,5,5).data;for(let s=0;s<100;s++)if(s%4!=3&&n[s]!==s){xe=!0;break}}}return xe||!1}var $e=1e-6,Le=typeof Float32Array<"u"?Float32Array:Array;function Ye(){var i=new Le(9);return Le!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function it(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function pt(){var i=new Le(3);return Le!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Qe(i){var e=i[0],n=i[1],s=i[2];return Math.sqrt(e*e+n*n+s*s)}function _t(i,e,n){var s=new Le(3);return s[0]=i,s[1]=e,s[2]=n,s}function Pt(i,e,n){return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i[2]=e[2]+n[2],i}function Rt(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i}function Zt(i,e,n){var s=e[0],u=e[1],f=e[2],m=n[0],v=n[1],w=n[2];return i[0]=u*w-f*v,i[1]=f*m-s*w,i[2]=s*v-u*m,i}var Ot,Vt=Qe;function Ft(i,e,n){var s=e[0],u=e[1],f=e[2],m=e[3];return i[0]=n[0]*s+n[4]*u+n[8]*f+n[12]*m,i[1]=n[1]*s+n[5]*u+n[9]*f+n[13]*m,i[2]=n[2]*s+n[6]*u+n[10]*f+n[14]*m,i[3]=n[3]*s+n[7]*u+n[11]*f+n[15]*m,i}function Ht(){var i=new Le(4);return Le!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function Pe(i,e,n,s){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",f=Math.PI/360;e*=f,s*=f,n*=f;var m=Math.sin(e),v=Math.cos(e),w=Math.sin(n),A=Math.cos(n),P=Math.sin(s),O=Math.cos(s);switch(u){case"xyz":i[0]=m*A*O+v*w*P,i[1]=v*w*O-m*A*P,i[2]=v*A*P+m*w*O,i[3]=v*A*O-m*w*P;break;case"xzy":i[0]=m*A*O-v*w*P,i[1]=v*w*O-m*A*P,i[2]=v*A*P+m*w*O,i[3]=v*A*O+m*w*P;break;case"yxz":i[0]=m*A*O+v*w*P,i[1]=v*w*O-m*A*P,i[2]=v*A*P-m*w*O,i[3]=v*A*O+m*w*P;break;case"yzx":i[0]=m*A*O+v*w*P,i[1]=v*w*O+m*A*P,i[2]=v*A*P-m*w*O,i[3]=v*A*O-m*w*P;break;case"zxy":i[0]=m*A*O-v*w*P,i[1]=v*w*O+m*A*P,i[2]=v*A*P+m*w*O,i[3]=v*A*O-m*w*P;break;case"zyx":i[0]=m*A*O-v*w*P,i[1]=v*w*O+m*A*P,i[2]=v*A*P-m*w*O,i[3]=v*A*O+m*w*P;break;default:throw new Error("Unknown angle order "+u)}return i}function Xe(){var i=new Le(2);return Le!=Float32Array&&(i[0]=0,i[1]=0),i}function ft(i,e){var n=new Le(2);return n[0]=i,n[1]=e,n}pt(),Ot=new Le(4),Le!=Float32Array&&(Ot[0]=0,Ot[1]=0,Ot[2]=0,Ot[3]=0),pt(),_t(1,0,0),_t(0,1,0),Ht(),Ht(),Ye(),Xe();const yt=8192;function It(i,e,n){return e*(yt/(i.tileSize*Math.pow(2,n-i.tileID.overscaledZ)))}function Ee(i,e){return(i%e+e)%e}function rt(i,e,n){return i*(1-n)+e*n}function Tt(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,n=e*i;return 4*(i<.5?n:3*(i-e)+n-.75)}function At(i,e,n,s){const u=new ce(i,e,n,s);return f=>u.solve(f)}const Ut=At(.25,.1,.25,1);function Nt(i,e,n){return Math.min(n,Math.max(e,i))}function tn(i,e,n){const s=n-e,u=((i-e)%s+s)%s+e;return u===e?n:u}function fn(i,...e){for(const n of e)for(const s in n)i[s]=n[s];return i}let _n=1;function $i(i,e,n){const s={};for(const u in i)s[u]=e.call(this,i[u],u,i);return s}function Fn(i,e,n){const s={};for(const u in i)e.call(this,i[u],u,i)&&(s[u]=i[u]);return s}function vi(i){return Array.isArray(i)?i.map(vi):typeof i=="object"&&i?$i(i,vi):i}const ya={};function Pn(i){ya[i]||(typeof console<"u"&&console.warn(i),ya[i]=!0)}function Zi(i,e,n){return(n.y-i.y)*(e.x-i.x)>(e.y-i.y)*(n.x-i.x)}function Nn(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let Zn=null;function Ar(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const ea="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function va(i,e,n,s,u){return l(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const f=new VideoFrame(i,{timestamp:0});try{const m=f?.format;if(!m||!m.startsWith("BGR")&&!m.startsWith("RGB"))throw new Error(`Unrecognized format ${m}`);const v=m.startsWith("BGR"),w=new Uint8ClampedArray(s*u*4);if(yield f.copyTo(w,(function(A,P,O,B,F){const G=4*Math.max(-P,0),q=(Math.max(0,O)-O)*B*4+G,Z=4*B,J=Math.max(0,P),de=Math.max(0,O);return{rect:{x:J,y:de,width:Math.min(A.width,P+B)-J,height:Math.min(A.height,O+F)-de},layout:[{offset:q,stride:Z}]}})(i,e,n,s,u)),v)for(let A=0;A<w.length;A+=4){const P=w[A];w[A]=w[A+2],w[A+2]=P}return w}finally{f.close()}}))}let zr,Ga;function jo(i,e,n,s){return i.addEventListener(e,n,s),{unsubscribe:()=>{i.removeEventListener(e,n,s)}}}function Hi(i){return i*Math.PI/180}function Dr(i){return i/Math.PI*180}const xa={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},xi={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},qa="AbortError";class fs extends Error{constructor(e=qa){super(e instanceof Error?e.message:e),this.name=qa,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function De(i){return i.name===qa}const H={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Y(i){return H.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const K="global-dispatcher";class me extends Error{constructor(e,n,s,u){super(`AJAXError: ${n} (${e}): ${s}`),this.status=e,this.statusText=n,this.url=s,this.body=u}}const be=()=>Nn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ie=function(i,e){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const s=Y(i.url);if(s)return s(i,e);if(Nn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:K},e)}if(!(/^file:/.test(n=i.url)||/^file:/.test(be())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(s,u){return l(this,void 0,void 0,(function*(){const f=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:be(),signal:u.signal});let m,v;s.type!=="json"||f.headers.has("Accept")||f.headers.set("Accept","application/json");try{m=yield fetch(f)}catch(A){throw De(A)?A:new me(0,A.message,s.url,new Blob)}if(!m.ok){const A=yield m.blob();throw new me(m.status,m.statusText,s.url,A)}v=s.type==="arrayBuffer"||s.type==="image"?m.arrayBuffer():s.type==="json"?m.json():m.text();const w=yield v;return u.signal.throwIfAborted(),{data:w,cacheControl:m.headers.get("Cache-Control"),expires:m.headers.get("Expires")}}))})(i,e);if(Nn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:K},e)}var n;return(function(s,u){return new Promise(((f,m)=>{var v;const w=new XMLHttpRequest;w.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(w.responseType="arraybuffer");for(const A in s.headers)w.setRequestHeader(A,s.headers[A]);s.type==="json"&&(w.responseType="text",!((v=s.headers)===null||v===void 0)&&v.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=s.credentials==="include",w.onerror=()=>{m(new Error(w.statusText))},w.onload=()=>{if(!u.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let A=w.response;if(s.type==="json")try{A=JSON.parse(w.response)}catch(P){return void m(P)}f({data:A,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{const A=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});m(new me(w.status,w.statusText,s.url,A))}},u.signal.addEventListener("abort",(()=>{w.abort(),m(new fs(u.signal.reason))})),w.send(s.body)}))})(i,e)};function Be(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const e=new URL(i),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function Re(i,e,n){n[i]&&n[i].indexOf(e)!==-1||(n[i]=n[i]||[],n[i].push(e))}function ke(i,e,n){if(n&&n[i]){const s=n[i].indexOf(e);s!==-1&&n[i].splice(s,1)}}class lt{constructor(e,n={}){fn(this,n),this.type=e}}class Ke extends lt{constructor(e,n={}){super("error",fn({error:e},n))}}class ht{on(e,n){return this._listeners=this._listeners||{},Re(e,n,this._listeners),{unsubscribe:()=>{this.off(e,n)}}}off(e,n){return ke(e,n,this._listeners),ke(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Re(e,n,this._oneTimeListeners),this):new Promise((s=>this.once(e,s)))}fire(e,n){typeof e=="string"&&(e=new lt(e,n||{}));const s=e.type;if(this.listens(s)){e.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const v of u)v.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const v of f)ke(s,v,this._oneTimeListeners),v.call(this,e);const m=this._eventedParent;m&&(fn(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof Ke&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var Me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const Wt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Rn(i,e){const n={};for(const s in i)s!=="ref"&&(n[s]=i[s]);return Wt.forEach((s=>{s in e&&(n[s]=e[s])})),n}function kt(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let n=0;n<i.length;n++)if(!kt(i[n],e[n]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(const n in i)if(!kt(i[n],e[n]))return!1;return!0}return i===e}function jt(i,e){i.push(e)}function an(i,e,n){jt(n,{command:"addSource",args:[i,e[i]]})}function ei(i,e,n){jt(e,{command:"removeSource",args:[i]}),n[i]=!0}function ti(i,e,n,s){ei(i,n,s),an(i,e,n)}function Xi(i,e,n){let s;for(s in i[n])if(Object.prototype.hasOwnProperty.call(i[n],s)&&s!=="data"&&!kt(i[n][s],e[n][s]))return!1;for(s in e[n])if(Object.prototype.hasOwnProperty.call(e[n],s)&&s!=="data"&&!kt(i[n][s],e[n][s]))return!1;return!0}function Yi(i,e,n,s,u,f){i=i||{},e=e||{};for(const m in i)Object.prototype.hasOwnProperty.call(i,m)&&(kt(i[m],e[m])||n.push({command:f,args:[s,m,e[m],u]}));for(const m in e)Object.prototype.hasOwnProperty.call(e,m)&&!Object.prototype.hasOwnProperty.call(i,m)&&(kt(i[m],e[m])||n.push({command:f,args:[s,m,e[m],u]}))}function pi(i){return i.id}function Fi(i,e){return i[e.id]=e,i}class ot{constructor(e,n,s,u){this.message=(e?`${e}: `:"")+s,u&&(this.identifier=u),n!=null&&n.__line__&&(this.line=n.__line__)}}function Pi(i,...e){for(const n of e)for(const s in n)i[s]=n[s];return i}class Pr extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class jr{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[s,u]of n)this.bindings[s]=u}concat(e){return new jr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const vn={kind:"null"},gt={kind:"number"},Qt={kind:"string"},cn={kind:"boolean"},ta={kind:"color"},Vu={kind:"projectionDefinition"},uo={kind:"object"},nn={kind:"value"},Hs={kind:"collator"},ho={kind:"formatted"},Vo={kind:"padding"},fo={kind:"colorArray"},po={kind:"numberArray"},bi={kind:"resolvedImage"},Gl={kind:"variableAnchorOffsetCollection"};function br(i,e){return{kind:"array",itemType:i,N:e}}function bn(i){if(i.kind==="array"){const e=bn(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const Uo=[vn,gt,Qt,cn,ta,Vu,ho,uo,br(nn),Vo,po,fo,bi,Gl];function ql(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ql(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const n of Uo)if(!ql(n,e))return null}}return`Expected ${bn(i)} but found ${bn(e)} instead.`}function $l(i,e){return e.some((n=>n.kind===i.kind))}function ps(i,e){return e.some((n=>n==="null"?i===null:n==="array"?Array.isArray(i):n==="object"?i&&!Array.isArray(i)&&typeof i=="object":n===typeof i))}function $a(i,e){return i.kind==="array"&&e.kind==="array"?i.itemType.kind===e.itemType.kind&&typeof i.N=="number":i.kind===e.kind}const Nc=.96422,mo=.82521,ba=4/29,Mn=6/29,Hh=3*Mn*Mn,pf=Mn*Mn*Mn,Xs=Math.PI/180,Xh=180/Math.PI;function jc(i){return(i%=360)<0&&(i+=360),i}function mf([i,e,n,s]){let u,f;const m=Vc((.2225045*(i=Rr(i))+.7168786*(e=Rr(e))+.0606169*(n=Rr(n)))/1);i===e&&e===n?u=f=m:(u=Vc((.4360747*i+.3850649*e+.1430804*n)/Nc),f=Vc((.0139322*i+.0971045*e+.7141733*n)/mo));const v=116*m-16;return[v<0?0:v,500*(u-m),200*(m-f),s]}function Rr(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Vc(i){return i>pf?Math.pow(i,1/3):i/Hh+ba}function Uu([i,e,n,s]){let u=(i+16)/116,f=isNaN(e)?u:u+e/500,m=isNaN(n)?u:u-n/200;return u=1*ms(u),f=Nc*ms(f),m=mo*ms(m),[Uc(3.1338561*f-1.6168667*u-.4906146*m),Uc(-.9787684*f+1.9161415*u+.033454*m),Uc(.0719453*f-.2289914*u+1.4052427*m),s]}function Uc(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function ms(i){return i>Mn?i*i*i:Hh*(i-ba)}const gf=Object.hasOwn||function(i,e){return Object.prototype.hasOwnProperty.call(i,e)};function Zl(i,e){return gf(i,e)?i[e]:void 0}function Go(i){return parseInt(i.padEnd(2,i),16)/255}function _f(i,e){return Ys(e?i/100:i,0,1)}function Ys(i,e,n){return Math.min(Math.max(e,i),n)}function Gu(i){return!i.some(Number.isNaN)}const Ws={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function gs(i,e,n){return i+n*(e-i)}function Hl(i,e,n){return i.map(((s,u)=>gs(s,e[u],n)))}class sn{constructor(e,n,s,u=1,f=!0){this.r=e,this.g=n,this.b=s,this.a=u,f||(this.r*=u,this.g*=u,this.b*=u,u||this.overwriteGetter("rgb",[e,n,s,u]))}static parse(e){if(e instanceof sn)return e;if(typeof e!="string")return;const n=(function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const u=Zl(Ws,s);if(u){const[m,v,w]=u;return[m/255,v/255,w/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const m=s.length<6?1:2;let v=1;return[Go(s.slice(v,v+=m)),Go(s.slice(v,v+=m)),Go(s.slice(v,v+=m)),Go(s.slice(v,v+m)||"ff")]}if(s.startsWith("rgb")){const m=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[v,w,A,P,O,B,F,G,q,Z,J,de]=m,te=[P||" ",F||" ",Z].join("");if(te==="  "||te==="  /"||te===",,"||te===",,,"){const re=[A,B,q].join(""),pe=re==="%%%"?100:re===""?255:0;if(pe){const ve=[Ys(+w/pe,0,1),Ys(+O/pe,0,1),Ys(+G/pe,0,1),J?_f(+J,de):1];if(Gu(ve))return ve}}return}}const f=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(f){const[m,v,w,A,P,O,B,F,G]=f,q=[w||" ",P||" ",B].join("");if(q==="  "||q==="  /"||q===",,"||q===",,,"){const Z=[+v,Ys(+A,0,100),Ys(+O,0,100),F?_f(+F,G):1];if(Gu(Z))return(function([J,de,te,re]){function pe(ve){const Ne=(ve+J/30)%12,nt=de*Math.min(te,1-te);return te-nt*Math.max(-1,Math.min(Ne-3,9-Ne,1))}return J=jc(J),de/=100,te/=100,[pe(0),pe(8),pe(4),re]})(Z)}}})(e);return n?new sn(...n,!1):void 0}get rgb(){const{r:e,g:n,b:s,a:u}=this,f=u||1/0;return this.overwriteGetter("rgb",[e/f,n/f,s/f,u])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[n,s,u,f]=mf(e),m=Math.sqrt(s*s+u*u);return[Math.round(1e4*m)?jc(Math.atan2(u,s)*Xh):NaN,m,n,f]})(this.rgb))}get lab(){return this.overwriteGetter("lab",mf(this.rgb))}overwriteGetter(e,n){return Object.defineProperty(this,e,{value:n}),n}toString(){const[e,n,s,u]=this.rgb;return`rgba(${[e,n,s].map((f=>Math.round(255*f))).join(",")},${u})`}static interpolate(e,n,s,u="rgb"){switch(u){case"rgb":{const[f,m,v,w]=Hl(e.rgb,n.rgb,s);return new sn(f,m,v,w,!1)}case"hcl":{const[f,m,v,w]=e.hcl,[A,P,O,B]=n.hcl;let F,G;if(isNaN(f)||isNaN(A))isNaN(f)?isNaN(A)?F=NaN:(F=A,v!==1&&v!==0||(G=P)):(F=f,O!==1&&O!==0||(G=m));else{let te=A-f;A>f&&te>180?te-=360:A<f&&f-A>180&&(te+=360),F=f+s*te}const[q,Z,J,de]=(function([te,re,pe,ve]){return te=isNaN(te)?0:te*Xs,Uu([pe,Math.cos(te)*re,Math.sin(te)*re,ve])})([F,G??gs(m,P,s),gs(v,O,s),gs(w,B,s)]);return new sn(q,Z,J,de,!1)}case"lab":{const[f,m,v,w]=Uu(Hl(e.lab,n.lab,s));return new sn(f,m,v,w,!1)}}}}sn.black=new sn(0,0,0,1),sn.white=new sn(1,1,1,1),sn.transparent=new sn(0,0,0,0),sn.red=new sn(1,0,0,1);class Za{constructor(e,n,s){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Yh=["bottom","center","top"];class Gc{constructor(e,n,s,u,f,m){this.text=e,this.image=n,this.scale=s,this.fontStack=u,this.textColor=f,this.verticalAlign=m}}class er{constructor(e){this.sections=e}static fromString(e){return new er([new Gc(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof er?e:er.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class Ni{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ni)return e;if(typeof e=="number")return new Ni([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const n of e)if(typeof n!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Ni(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,s){return new Ni(Hl(e.values,n.values,s))}}class si{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof si)return e;if(typeof e=="number")return new si([e]);if(Array.isArray(e)){for(const n of e)if(typeof n!="number")return;return new si(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,s){return new si(Hl(e.values,n.values,s))}}class Yt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Yt)return e;if(typeof e=="string"){const s=sn.parse(e);return s?new Yt([s]):void 0}if(!Array.isArray(e))return;const n=[];for(const s of e){if(typeof s!="string")return;const u=sn.parse(s);if(!u)return;n.push(u)}return new Yt(n)}toString(){return JSON.stringify(this.values)}static interpolate(e,n,s,u="rgb"){const f=[];if(e.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let m=0;m<e.values.length;m++)f.push(sn.interpolate(e.values[m],n.values[m],s,u));return new Yt(f)}}class Hn extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const wa=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class wi{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof wi)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let n=0;n<e.length;n+=2){const s=e[n],u=e[n+1];if(typeof s!="string"||!wa.has(s)||!Array.isArray(u)||u.length!==2||typeof u[0]!="number"||typeof u[1]!="number")return}return new wi(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,s){const u=e.values,f=n.values;if(u.length!==f.length)throw new Hn(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${n.toString()}`);const m=[];for(let v=0;v<u.length;v+=2){if(u[v]!==f[v])throw new Hn(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${u[v]}, to[${v}]: ${f[v]}`);m.push(u[v]);const[w,A]=u[v+1],[P,O]=f[v+1];m.push([gs(w,P,s),gs(A,O,s)])}return new wi(m)}}class Ir{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ir({name:e,available:!1}):null}}class tr{constructor(e,n,s){this.from=e,this.to=n,this.transition=s}static interpolate(e,n,s){return new tr(e,n,s)}static parse(e){return e instanceof tr?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new tr(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new tr(e.from,e.to,e.transition):typeof e=="string"?new tr(e,e,1):void 0}}function na(i,e,n,s){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[i,e,n,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[i,e,n,s]:[i,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function go(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof tr||i instanceof sn||i instanceof Za||i instanceof er||i instanceof Ni||i instanceof si||i instanceof Yt||i instanceof wi||i instanceof Ir)return!0;if(Array.isArray(i)){for(const e of i)if(!go(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!go(i[e]))return!1;return!0}return!1}function li(i){if(i===null)return vn;if(typeof i=="string")return Qt;if(typeof i=="boolean")return cn;if(typeof i=="number")return gt;if(i instanceof sn)return ta;if(i instanceof tr)return Vu;if(i instanceof Za)return Hs;if(i instanceof er)return ho;if(i instanceof Ni)return Vo;if(i instanceof si)return po;if(i instanceof Yt)return fo;if(i instanceof wi)return Gl;if(i instanceof Ir)return bi;if(Array.isArray(i)){const e=i.length;let n;for(const s of i){const u=li(s);if(n){if(n===u)continue;n=nn;break}n=u}return br(n||nn,e)}return uo}function _s(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof sn||i instanceof tr||i instanceof er||i instanceof Ni||i instanceof si||i instanceof Yt||i instanceof wi||i instanceof Ir?i.toString():JSON.stringify(i)}class ia{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!go(e[1]))return n.error("invalid value");const s=e[1];let u=li(s);const f=n.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new ia(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ks={string:Qt,number:gt,boolean:cn,object:uo};class Lr{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let s,u=1;const f=e[0];if(f==="array"){let v,w;if(e.length>2){const A=e[1];if(typeof A!="string"||!(A in Ks)||A==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=Ks[A],u++}else v=nn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);w=e[2],u++}s=br(v,w)}else{if(!Ks[f])throw new Error(`Types doesn't contain name = ${f}`);s=Ks[f]}const m=[];for(;u<e.length;u++){const v=n.parse(e[u],u,nn);if(!v)return null;m.push(v)}return new Lr(s,m)}evaluate(e){for(let n=0;n<this.args.length;n++){const s=this.args[n].evaluate(e);if(!ql(this.type,li(s)))return s;if(n===this.args.length-1)throw new Hn(`Expected value to be of type ${bn(this.type)}, but found ${bn(li(s))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Wi={"to-boolean":cn,"to-color":ta,"to-number":gt,"to-string":Qt};class Or{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[0];if(!Wi[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&e.length!==2)return n.error("Expected one argument.");const u=Wi[s],f=[];for(let m=1;m<e.length;m++){const v=n.parse(e[m],m,nn);if(!v)return null;f.push(v)}return new Or(u,f)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let n,s;for(const u of this.args){if(n=u.evaluate(e),s=null,n instanceof sn)return n;if(typeof n=="string"){const f=e.parseColor(n);if(f)return f}else if(Array.isArray(n)&&(s=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:na(n[0],n[1],n[2],n[3]),!s))return new sn(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Hn(s||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const s of this.args){n=s.evaluate(e);const u=Ni.parse(n);if(u)return u}throw new Hn(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const s of this.args){n=s.evaluate(e);const u=si.parse(n);if(u)return u}throw new Hn(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const s of this.args){n=s.evaluate(e);const u=Yt.parse(n);if(u)return u}throw new Hn(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const s of this.args){n=s.evaluate(e);const u=wi.parse(n);if(u)return u}throw new Hn(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const s of this.args){if(n=s.evaluate(e),n===null)return 0;const u=Number(n);if(!isNaN(u))return u}throw new Hn(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return er.fromString(_s(this.args[0].evaluate(e)));case"resolvedImage":return Ir.fromString(_s(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return _s(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const qc=["Unknown","Point","LineString","Polygon"];class Qs{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?qc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let n=this._parseColorCache.get(e);return n||(n=sn.parse(e),this._parseColorCache.set(e,n)),n}}class Js{constructor(e,n,s=[],u,f=new jr,m=[]){this.registry=e,this.path=s,this.key=s.map((v=>`[${v}]`)).join(""),this.scope=f,this.errors=m,this.expectedType=u,this._isConstant=n}parse(e,n,s,u,f={}){return n?this.concat(n,s,u)._parse(e,f):this._parse(e,f)}_parse(e,n){function s(u,f,m){return m==="assert"?new Lr(f,[u]):m==="coerce"?new Or(f,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let m=f.parse(e,this);if(!m)return null;if(this.expectedType){const v=this.expectedType,w=m.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value"){if(v.kind==="projectionDefinition"&&["string","array"].includes(w.kind)||["color","formatted","resolvedImage"].includes(v.kind)&&["value","string"].includes(w.kind)||["padding","numberArray"].includes(v.kind)&&["value","number","array"].includes(w.kind)||v.kind==="colorArray"&&["value","string","array"].includes(w.kind)||v.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(w.kind))m=s(m,v,n.typeAnnotation||"coerce");else if(this.checkSubtype(v,w))return null}else m=s(m,v,n.typeAnnotation||"assert")}if(!(m instanceof ia)&&m.type.kind!=="resolvedImage"&&this._isConstant(m)){const v=new Qs;try{m=new ia(m.type,m.evaluate(v))}catch(w){return this.error(w.message),null}}return m}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,s){const u=typeof e=="number"?this.path.concat(e):this.path,f=s?this.scope.concat(s):this.scope;return new Js(this.registry,this._isConstant,u,n||null,f,this.errors)}error(e,...n){const s=`${this.key}${n.map((u=>`[${u}]`)).join("")}`;this.errors.push(new Pr(s,e))}checkSubtype(e,n){const s=ql(e,n);return s&&this.error(s),s}}class jn{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let f=1;f<e.length-1;f+=2){const m=e[f];if(typeof m!="string")return n.error(`Expected string, but found ${typeof m} instead.`,f);if(/[^a-zA-Z0-9_]/.test(m))return n.error("Variable names must contain only alphanumeric characters or '_'.",f);const v=n.parse(e[f+1],f+1);if(!v)return null;s.push([m,v])}const u=n.parse(e[e.length-1],e.length-1,n.expectedType,s);return u?new jn(s,u):null}outputDefined(){return this.result.outputDefined()}}class ys{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const s=e[1];return n.scope.has(s)?new ys(s,n.scope.get(s)):n.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class pn{constructor(e,n,s){this.type=e,this.index=n,this.input=s}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,gt),u=n.parse(e[2],2,br(n.expectedType||nn));return s&&u?new pn(u.type.itemType,s,u):null}evaluate(e){const n=this.index.evaluate(e),s=this.input.evaluate(e);if(n<0)throw new Hn(`Array index out of bounds: ${n} < 0.`);if(n>=s.length)throw new Hn(`Array index out of bounds: ${n} > ${s.length-1}.`);if(n!==Math.floor(n))throw new Hn(`Array index must be an integer, but found ${n} instead.`);return s[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class rn{constructor(e,n){this.type=cn,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,nn),u=n.parse(e[2],2,nn);return s&&u?$l(s.type,[cn,Qt,gt,vn,nn])?new rn(s,u):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${bn(s.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!s)return!1;if(!ps(n,["boolean","string","number","null"]))throw new Hn(`Expected first argument to be of type boolean, string, number or null, but found ${bn(li(n))} instead.`);if(!ps(s,["string","array"]))throw new Hn(`Expected second argument to be of type array or string, but found ${bn(li(s))} instead.`);return s.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class el{constructor(e,n,s){this.type=gt,this.needle=e,this.haystack=n,this.fromIndex=s}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,nn),u=n.parse(e[2],2,nn);if(!s||!u)return null;if(!$l(s.type,[cn,Qt,gt,vn,nn]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${bn(s.type)} instead`);if(e.length===4){const f=n.parse(e[3],3,gt);return f?new el(s,u,f):null}return new el(s,u)}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!ps(n,["boolean","string","number","null"]))throw new Hn(`Expected first argument to be of type boolean, string, number or null, but found ${bn(li(n))} instead.`);let u;if(this.fromIndex&&(u=this.fromIndex.evaluate(e)),ps(s,["string"])){const f=s.indexOf(n,u);return f===-1?-1:[...s.slice(0,f)].length}if(ps(s,["array"]))return s.indexOf(n,u);throw new Hn(`Expected second argument to be of type array or string, but found ${bn(li(s))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class wn{constructor(e,n,s,u,f,m){this.inputType=e,this.type=n,this.input=s,this.cases=u,this.outputs=f,this.otherwise=m}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let s,u;n.expectedType&&n.expectedType.kind!=="value"&&(u=n.expectedType);const f={},m=[];for(let A=2;A<e.length-1;A+=2){let P=e[A];const O=e[A+1];Array.isArray(P)||(P=[P]);const B=n.concat(A);if(P.length===0)return B.error("Expected at least one branch label.");for(const G of P){if(typeof G!="number"&&typeof G!="string")return B.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return B.error("Numeric branch labels must be integer values.");if(s){if(B.checkSubtype(s,li(G)))return null}else s=li(G);if(f[String(G)]!==void 0)return B.error("Branch labels must be unique.");f[String(G)]=m.length}const F=n.parse(O,A,u);if(!F)return null;u=u||F.type,m.push(F)}const v=n.parse(e[1],1,nn);if(!v)return null;const w=n.parse(e[e.length-1],e.length-1,u);return w?v.type.kind!=="value"&&n.concat(1).checkSubtype(s,v.type)?null:new wn(s,u,v,f,m,w):null}evaluate(e){const n=this.input.evaluate(e);return(li(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class $c{constructor(e,n,s){this.type=e,this.branches=n,this.otherwise=s}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let s;n.expectedType&&n.expectedType.kind!=="value"&&(s=n.expectedType);const u=[];for(let m=1;m<e.length-1;m+=2){const v=n.parse(e[m],m,cn);if(!v)return null;const w=n.parse(e[m+1],m+1,s);if(!w)return null;u.push([v,w]),s=s||w.type}const f=n.parse(e[e.length-1],e.length-1,s);if(!f)return null;if(!s)throw new Error("Can't infer output type");return new $c(s,u,f)}evaluate(e){for(const[n,s]of this.branches)if(n.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,s]of this.branches)e(n),e(s);e(this.otherwise)}outputDefined(){return this.branches.every((([e,n])=>n.outputDefined()))&&this.otherwise.outputDefined()}}class Sa{constructor(e,n,s,u){this.type=e,this.input=n,this.beginIndex=s,this.endIndex=u}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,nn),u=n.parse(e[2],2,gt);if(!s||!u)return null;if(!$l(s.type,[br(nn),Qt,nn]))return n.error(`Expected first argument to be of type array or string, but found ${bn(s.type)} instead`);if(e.length===4){const f=n.parse(e[3],3,gt);return f?new Sa(s.type,s,u,f):null}return new Sa(s.type,s,u)}evaluate(e){const n=this.input.evaluate(e),s=this.beginIndex.evaluate(e);let u;if(this.endIndex&&(u=this.endIndex.evaluate(e)),ps(n,["string"]))return[...n].slice(s,u).join("");if(ps(n,["array"]))return n.slice(s,u);throw new Hn(`Expected first argument to be of type array or string, but found ${bn(li(n))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function vs(i,e){const n=i.length-1;let s,u,f=0,m=n,v=0;for(;f<=m;)if(v=Math.floor((f+m)/2),s=i[v],u=i[v+1],s<=e){if(v===n||e<u)return v;f=v+1}else{if(!(s>e))throw new Hn("Input is not a number.");m=v-1}return 0}class xs{constructor(e,n,s){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[u,f]of s)this.labels.push(u),this.outputs.push(f)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const s=n.parse(e[1],1,gt);if(!s)return null;const u=[];let f=null;n.expectedType&&n.expectedType.kind!=="value"&&(f=n.expectedType);for(let m=1;m<e.length;m+=2){const v=m===1?-1/0:e[m],w=e[m+1],A=m,P=m+1;if(typeof v!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(u.length&&u[u.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const O=n.parse(w,P,f);if(!O)return null;f=f||O.type,u.push([v,O])}return new xs(f,s,u)}evaluate(e){const n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return s[0].evaluate(e);const f=n.length;return u>=n[f-1]?s[f-1].evaluate(e):s[vs(n,u)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function yf(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Zc,Wh,em=(function(){if(Wh)return Zc;function i(e,n,s,u){this.cx=3*e,this.bx=3*(s-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(u-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=s,this.p2y=u}return Wh=1,Zc=i,i.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var s=e,u=0;u<8;u++){var f=this.sampleCurveX(s)-e;if(Math.abs(f)<n)return s;var m=this.sampleCurveDerivativeX(s);if(Math.abs(m)<1e-6)break;s-=f/m}var v=0,w=1;for(s=e,u=0;u<20&&(f=this.sampleCurveX(s),!(Math.abs(f-e)<n));u++)e>f?v=s:w=s,s=.5*(w-v)+v;return s},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},Zc})(),Kh=yf(em);class kr{constructor(e,n,s,u,f){this.type=e,this.operator=n,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[m,v]of f)this.labels.push(m),this.outputs.push(v)}static interpolationFactor(e,n,s,u){let f=0;if(e.name==="exponential")f=_o(n,e.base,s,u);else if(e.name==="linear")f=_o(n,1,s,u);else if(e.name==="cubic-bezier"){const m=e.controlPoints;f=new Kh(m[0],m[1],m[2],m[3]).solve(_o(n,1,s,u))}return f}static parse(e,n){let[s,u,f,...m]=e;if(!Array.isArray(u)||u.length===0)return n.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const A=u[1];if(typeof A!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:A}}else{if(u[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const A=u.slice(1);if(A.length!==4||A.some((P=>typeof P!="number"||P<0||P>1)))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:A}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(f=n.parse(f,2,gt),!f)return null;const v=[];let w=null;s!=="interpolate-hcl"&&s!=="interpolate-lab"||n.expectedType==fo?n.expectedType&&n.expectedType.kind!=="value"&&(w=n.expectedType):w=ta;for(let A=0;A<m.length;A+=2){const P=m[A],O=m[A+1],B=A+3,F=A+4;if(typeof P!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(v.length&&v[v.length-1][0]>=P)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const G=n.parse(O,F,w);if(!G)return null;w=w||G.type,v.push([P,G])}return $a(w,gt)||$a(w,Vu)||$a(w,ta)||$a(w,Vo)||$a(w,po)||$a(w,fo)||$a(w,Gl)||$a(w,br(gt))?new kr(w,s,u,f,v):n.error(`Type ${bn(w)} is not interpolatable.`)}evaluate(e){const n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return s[0].evaluate(e);const f=n.length;if(u>=n[f-1])return s[f-1].evaluate(e);const m=vs(n,u),v=kr.interpolationFactor(this.interpolation,u,n[m],n[m+1]),w=s[m].evaluate(e),A=s[m+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return gs(w,A,v);case"color":return sn.interpolate(w,A,v);case"padding":return Ni.interpolate(w,A,v);case"colorArray":return Yt.interpolate(w,A,v);case"numberArray":return si.interpolate(w,A,v);case"variableAnchorOffsetCollection":return wi.interpolate(w,A,v);case"array":return Hl(w,A,v);case"projectionDefinition":return tr.interpolate(w,A,v)}case"interpolate-hcl":switch(this.type.kind){case"color":return sn.interpolate(w,A,v,"hcl");case"colorArray":return Yt.interpolate(w,A,v,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return sn.interpolate(w,A,v,"lab");case"colorArray":return Yt.interpolate(w,A,v,"lab")}}}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function _o(i,e,n,s){const u=s-n,f=i-n;return u===0?0:e===1?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}const ci={color:sn.interpolate,number:gs,padding:Ni.interpolate,numberArray:si.interpolate,colorArray:Yt.interpolate,variableAnchorOffsetCollection:wi.interpolate,array:Hl};class tl{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let s=null;const u=n.expectedType;u&&u.kind!=="value"&&(s=u);const f=[];for(const v of e.slice(1)){const w=n.parse(v,1+f.length,s,void 0,{typeAnnotation:"omit"});if(!w)return null;s=s||w.type,f.push(w)}if(!s)throw new Error("No output type");const m=u&&f.some((v=>ql(u,v.type)));return new tl(m?nn:s,f)}evaluate(e){let n,s=null,u=0;for(const f of this.args)if(u++,s=f.evaluate(e),s&&s instanceof Ir&&!s.available&&(n||(n=s.name),s=null,u===this.args.length&&(s=n)),s!==null)break;return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Hc(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Xc(i,e,n,s){return s.compare(e,n)===0}function Si(i,e,n){const s=i!=="=="&&i!=="!=";return class g1{constructor(f,m,v){this.type=cn,this.lhs=f,this.rhs=m,this.collator=v,this.hasUntypedArgument=f.type.kind==="value"||m.type.kind==="value"}static parse(f,m){if(f.length!==3&&f.length!==4)return m.error("Expected two or three arguments.");const v=f[0];let w=m.parse(f[1],1,nn);if(!w)return null;if(!Hc(v,w.type))return m.concat(1).error(`"${v}" comparisons are not supported for type '${bn(w.type)}'.`);let A=m.parse(f[2],2,nn);if(!A)return null;if(!Hc(v,A.type))return m.concat(2).error(`"${v}" comparisons are not supported for type '${bn(A.type)}'.`);if(w.type.kind!==A.type.kind&&w.type.kind!=="value"&&A.type.kind!=="value")return m.error(`Cannot compare types '${bn(w.type)}' and '${bn(A.type)}'.`);s&&(w.type.kind==="value"&&A.type.kind!=="value"?w=new Lr(A.type,[w]):w.type.kind!=="value"&&A.type.kind==="value"&&(A=new Lr(w.type,[A])));let P=null;if(f.length===4){if(w.type.kind!=="string"&&A.type.kind!=="string"&&w.type.kind!=="value"&&A.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(P=m.parse(f[3],3,Hs),!P)return null}return new g1(w,A,P)}evaluate(f){const m=this.lhs.evaluate(f),v=this.rhs.evaluate(f);if(s&&this.hasUntypedArgument){const w=li(m),A=li(v);if(w.kind!==A.kind||w.kind!=="string"&&w.kind!=="number")throw new Hn(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${w.kind}, ${A.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const w=li(m),A=li(v);if(w.kind!=="string"||A.kind!=="string")return e(f,m,v)}return this.collator?n(f,m,v,this.collator.evaluate(f)):e(f,m,v)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}}}const vf=Si("==",(function(i,e,n){return e===n}),Xc),qu=Si("!=",(function(i,e,n){return e!==n}),(function(i,e,n,s){return!Xc(0,e,n,s)})),xf=Si("<",(function(i,e,n){return e<n}),(function(i,e,n,s){return s.compare(e,n)<0})),tm=Si(">",(function(i,e,n){return e>n}),(function(i,e,n,s){return s.compare(e,n)>0})),Xl=Si("<=",(function(i,e,n){return e<=n}),(function(i,e,n,s){return s.compare(e,n)<=0})),$u=Si(">=",(function(i,e,n){return e>=n}),(function(i,e,n,s){return s.compare(e,n)>=0}));class Yl{constructor(e,n,s){this.type=Hs,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const s=e[1];if(typeof s!="object"||Array.isArray(s))return n.error("Collator options argument must be an object.");const u=n.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,cn);if(!u)return null;const f=n.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,cn);if(!f)return null;let m=null;return s.locale&&(m=n.parse(s.locale,1,Qt),!m)?null:new Yl(u,f,m)}evaluate(e){return new Za(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Qh{constructor(e,n,s,u,f){this.type=Qt,this.number=e,this.locale=n,this.currency=s,this.minFractionDigits=u,this.maxFractionDigits=f}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const s=n.parse(e[1],1,gt);if(!s)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return n.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=n.parse(u.locale,1,Qt),!f))return null;let m=null;if(u.currency&&(m=n.parse(u.currency,1,Qt),!m))return null;let v=null;if(u["min-fraction-digits"]&&(v=n.parse(u["min-fraction-digits"],1,gt),!v))return null;let w=null;return u["max-fraction-digits"]&&(w=n.parse(u["max-fraction-digits"],1,gt),!w)?null:new Qh(s,f,m,v,w)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Yc{constructor(e){this.type=ho,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&typeof s=="object")return n.error("First argument must be an image or text section.");const u=[];let f=!1;for(let m=1;m<=e.length-1;++m){const v=e[m];if(f&&typeof v=="object"&&!Array.isArray(v)){f=!1;let w=null;if(v["font-scale"]&&(w=n.parse(v["font-scale"],1,gt),!w))return null;let A=null;if(v["text-font"]&&(A=n.parse(v["text-font"],1,br(Qt)),!A))return null;let P=null;if(v["text-color"]&&(P=n.parse(v["text-color"],1,ta),!P))return null;let O=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!Yh.includes(v["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(O=n.parse(v["vertical-align"],1,Qt),!O)return null}const B=u[u.length-1];B.scale=w,B.font=A,B.textColor=P,B.verticalAlign=O}else{const w=n.parse(e[m],1,nn);if(!w)return null;const A=w.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:w,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Yc(u)}evaluate(e){return new er(this.sections.map((n=>{const s=n.content.evaluate(e);return li(s)===bi?new Gc("",s,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(e):null):new Gc(_s(s),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null,n.verticalAlign?n.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor),n.verticalAlign&&e(n.verticalAlign)}outputDefined(){return!1}}class Wl{constructor(e){this.type=bi,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const s=n.parse(e[1],1,Qt);return s?new Wl(s):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),s=Ir.fromString(n);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(n)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}}class Kl{constructor(e){this.type=gt,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=n.parse(e[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${bn(s.type)} instead.`):new Kl(s):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Hn(`Expected value to be of type string or array, but found ${bn(li(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Ri=8192;function Ql(i,e){const n=(180+i[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(n*u*Ri),Math.round(s*u*Ri)]}function Jl(i,e){const n=Math.pow(2,e.z);return[(u=(i[0]/Ri+e.x)/n,360*u-180),(s=(i[1]/Ri+e.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,u}function ec(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function bs(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function bf(i,e,n){const s=i[0]-e[0],u=i[1]-e[1],f=i[0]-n[0],m=i[1]-n[1];return s*m-f*u==0&&s*f<=0&&u*m<=0}function Wc(i,e,n,s){return(u=[s[0]-n[0],s[1]-n[1]])[0]*(f=[e[0]-i[0],e[1]-i[1]])[1]-u[1]*f[0]!=0&&!(!Hu(i,e,n,s)||!Hu(n,s,i,e));var u,f}function wf(i,e,n){for(const s of n)for(let u=0;u<s.length-1;++u)if(Wc(i,e,s[u],s[u+1]))return!0;return!1}function Ha(i,e,n=!1){let s=!1;for(const v of e)for(let w=0;w<v.length-1;w++){if(bf(i,v[w],v[w+1]))return n;(f=v[w])[1]>(u=i)[1]!=(m=v[w+1])[1]>u[1]&&u[0]<(m[0]-f[0])*(u[1]-f[1])/(m[1]-f[1])+f[0]&&(s=!s)}var u,f,m;return s}function Zu(i,e){for(const n of e)if(Ha(i,n))return!0;return!1}function Sf(i,e){for(const n of i)if(!Ha(n,e))return!1;for(let n=0;n<i.length-1;++n)if(wf(i[n],i[n+1],e))return!1;return!0}function Tf(i,e){for(const n of e)if(Sf(i,n))return!0;return!1}function Hu(i,e,n,s){const u=s[0]-n[0],f=s[1]-n[1],m=(i[0]-n[0])*f-u*(i[1]-n[1]),v=(e[0]-n[0])*f-u*(e[1]-n[1]);return m>0&&v<0||m<0&&v>0}function Xu(i,e,n){const s=[];for(let u=0;u<i.length;u++){const f=[];for(let m=0;m<i[u].length;m++){const v=Ql(i[u][m],n);ec(e,v),f.push(v)}s.push(f)}return s}function nl(i,e,n){const s=[];for(let u=0;u<i.length;u++){const f=Xu(i[u],e,n);s.push(f)}return s}function tc(i,e,n,s){if(i[0]<n[0]||i[0]>n[2]){const u=.5*s;let f=i[0]-n[0]>u?-s:n[0]-i[0]>u?s:0;f===0&&(f=i[0]-n[2]>u?-s:n[2]-i[0]>u?s:0),i[0]+=f}ec(e,i)}function Ef(i,e,n,s){const u=Math.pow(2,s.z)*Ri,f=[s.x*Ri,s.y*Ri],m=[];for(const v of i)for(const w of v){const A=[w.x+f[0],w.y+f[1]];tc(A,e,n,u),m.push(A)}return m}function Kc(i,e,n,s){const u=Math.pow(2,s.z)*Ri,f=[s.x*Ri,s.y*Ri],m=[];for(const w of i){const A=[];for(const P of w){const O=[P.x+f[0],P.y+f[1]];ec(e,O),A.push(O)}m.push(A)}if(e[2]-e[0]<=u/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const w of m)for(const A of w)tc(A,e,n,u)}var v;return m}class ws{constructor(e,n){this.type=cn,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(go(e[1])){const s=e[1];if(s.type==="FeatureCollection"){const u=[];for(const f of s.features){const{type:m,coordinates:v}=f.geometry;m==="Polygon"&&u.push(v),m==="MultiPolygon"&&u.push(...v)}if(u.length)return new ws(s,{type:"MultiPolygon",coordinates:u})}else if(s.type==="Feature"){const u=s.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new ws(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new ws(s,s)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(n,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(s.type==="Polygon"){const v=Xu(s.coordinates,f,m),w=Ef(n.geometry(),u,f,m);if(!bs(u,f))return!1;for(const A of w)if(!Ha(A,v))return!1}if(s.type==="MultiPolygon"){const v=nl(s.coordinates,f,m),w=Ef(n.geometry(),u,f,m);if(!bs(u,f))return!1;for(const A of w)if(!Zu(A,v))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(n,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(s.type==="Polygon"){const v=Xu(s.coordinates,f,m),w=Kc(n.geometry(),u,f,m);if(!bs(u,f))return!1;for(const A of w)if(!Sf(A,v))return!1}if(s.type==="MultiPolygon"){const v=nl(s.coordinates,f,m),w=Kc(n.geometry(),u,f,m);if(!bs(u,f))return!1;for(const A of w)if(!Tf(A,v))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Jh=class{constructor(i=[],e=(n,s)=>n<s?-1:n>s?1:0){if(this.data=i,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:e,compare:n}=this,s=e[i];for(;i>0;){const u=i-1>>1,f=e[u];if(n(s,f)>=0)break;e[i]=f,i=u}e[i]=s}_down(i){const{data:e,compare:n}=this,s=this.length>>1,u=e[i];for(;i<s;){let f=1+(i<<1);const m=f+1;if(m<this.length&&n(e[m],e[f])<0&&(f=m),n(e[f],u)>=0)break;e[i]=e[f],i=f}e[i]=u}};function Qc(i,e,n=0,s=i.length-1,u=ed){for(;s>n;){if(s-n>600){const w=s-n+1,A=e-n+1,P=Math.log(w),O=.5*Math.exp(2*P/3),B=.5*Math.sqrt(P*O*(w-O)/w)*(A-w/2<0?-1:1);Qc(i,e,Math.max(n,Math.floor(e-A*O/w+B)),Math.min(s,Math.floor(e+(w-A)*O/w+B)),u)}const f=i[e];let m=n,v=s;for(Ss(i,n,e),u(i[s],f)>0&&Ss(i,n,s);m<v;){for(Ss(i,m,v),m++,v--;u(i[m],f)<0;)m++;for(;u(i[v],f)>0;)v--}u(i[n],f)===0?Ss(i,n,v):(v++,Ss(i,v,s)),v<=e&&(n=v+1),e<=v&&(s=v-1)}}function Ss(i,e,n){const s=i[e];i[e]=i[n],i[n]=s}function ed(i,e){return i<e?-1:i>e?1:0}function Jc(i,e){if(i.length<=1)return[i];const n=[];let s,u;for(const f of i){const m=nm(f);m!==0&&(f.area=Math.abs(m),u===void 0&&(u=m<0),u===m<0?(s&&n.push(s),s=[f]):s.push(f))}if(s&&n.push(s),e>1)for(let f=0;f<n.length;f++)n[f].length<=e||(Qc(n[f],e,1,n[f].length-1,Cf),n[f]=n[f].slice(0,e));return n}function Cf(i,e){return e.area-i.area}function nm(i){let e=0;for(let n,s,u=0,f=i.length,m=f-1;u<f;m=u++)n=i[u],s=i[m],e+=(s.x-n.x)*(n.y+s.y);return e}const Mf=1/298.257223563,eu=Mf*(2-Mf),Af=Math.PI/180;class td{constructor(e){const n=6378.137*Af*1e3,s=Math.cos(e*Af),u=1/(1-eu*(1-s*s)),f=Math.sqrt(u);this.kx=n*f*s,this.ky=n*f*u*(1-eu)}distance(e,n){const s=this.wrap(e[0]-n[0])*this.kx,u=(e[1]-n[1])*this.ky;return Math.sqrt(s*s+u*u)}pointOnLine(e,n){let s,u,f,m,v=1/0;for(let w=0;w<e.length-1;w++){let A=e[w][0],P=e[w][1],O=this.wrap(e[w+1][0]-A)*this.kx,B=(e[w+1][1]-P)*this.ky,F=0;O===0&&B===0||(F=(this.wrap(n[0]-A)*this.kx*O+(n[1]-P)*this.ky*B)/(O*O+B*B),F>1?(A=e[w+1][0],P=e[w+1][1]):F>0&&(A+=O/this.kx*F,P+=B/this.ky*F)),O=this.wrap(n[0]-A)*this.kx,B=(n[1]-P)*this.ky;const G=O*O+B*B;G<v&&(v=G,s=A,u=P,f=w,m=F)}return{point:[s,u],index:f,t:Math.max(0,Math.min(1,m))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function Vr(i,e){return e[0]-i[0]}function Ts(i){return i[1]-i[0]+1}function Ta(i,e){return i[1]>=i[0]&&i[1]<e}function tu(i,e){if(i[0]>i[1])return[null,null];const n=Ts(i);if(e){if(n===2)return[i,null];const u=Math.floor(n/2);return[[i[0],i[0]+u],[i[0]+u,i[1]]]}if(n===1)return[i,null];const s=Math.floor(n/2)-1;return[[i[0],i[0]+s],[i[0]+s+1,i[1]]]}function Yu(i,e){if(!Ta(e,i.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let s=e[0];s<=e[1];++s)ec(n,i[s]);return n}function Wu(i){const e=[1/0,1/0,-1/0,-1/0];for(const n of i)for(const s of n)ec(e,s);return e}function nu(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function Ku(i,e,n){if(!nu(i)||!nu(e))return NaN;let s=0,u=0;return i[2]<e[0]&&(s=e[0]-i[2]),i[0]>e[2]&&(s=i[0]-e[2]),i[1]>e[3]&&(u=i[1]-e[3]),i[3]<e[1]&&(u=e[1]-i[3]),n.distance([0,0],[s,u])}function Ea(i,e,n){const s=n.pointOnLine(e,i);return n.distance(i,s.point)}function iu(i,e,n,s,u){const f=Math.min(Ea(i,[n,s],u),Ea(e,[n,s],u)),m=Math.min(Ea(n,[i,e],u),Ea(s,[i,e],u));return Math.min(f,m)}function ru(i,e,n,s,u){if(!Ta(e,i.length)||!Ta(s,n.length))return 1/0;let f=1/0;for(let m=e[0];m<e[1];++m){const v=i[m],w=i[m+1];for(let A=s[0];A<s[1];++A){const P=n[A],O=n[A+1];if(Wc(v,w,P,O))return 0;f=Math.min(f,iu(v,w,P,O,u))}}return f}function Qu(i,e,n,s,u){if(!Ta(e,i.length)||!Ta(s,n.length))return NaN;let f=1/0;for(let m=e[0];m<=e[1];++m)for(let v=s[0];v<=s[1];++v)if(f=Math.min(f,u.distance(i[m],n[v])),f===0)return f;return f}function zf(i,e,n){if(Ha(i,e,!0))return 0;let s=1/0;for(const u of e){const f=u[0],m=u[u.length-1];if(f!==m&&(s=Math.min(s,Ea(i,[m,f],n)),s===0))return s;const v=n.pointOnLine(u,i);if(s=Math.min(s,n.distance(i,v.point)),s===0)return s}return s}function il(i,e,n,s){if(!Ta(e,i.length))return NaN;for(let f=e[0];f<=e[1];++f)if(Ha(i[f],n,!0))return 0;let u=1/0;for(let f=e[0];f<e[1];++f){const m=i[f],v=i[f+1];for(const w of n)for(let A=0,P=w.length,O=P-1;A<P;O=A++){const B=w[O],F=w[A];if(Wc(m,v,B,F))return 0;u=Math.min(u,iu(m,v,B,F,s))}}return u}function rl(i,e){for(const n of i)for(const s of n)if(Ha(s,e,!0))return!0;return!1}function nd(i,e,n,s=1/0){const u=Wu(i),f=Wu(e);if(s!==1/0&&Ku(u,f,n)>=s)return s;if(bs(u,f)){if(rl(i,e))return 0}else if(rl(e,i))return 0;let m=1/0;for(const v of i)for(let w=0,A=v.length,P=A-1;w<A;P=w++){const O=v[P],B=v[w];for(const F of e)for(let G=0,q=F.length,Z=q-1;G<q;Z=G++){const J=F[Z],de=F[G];if(Wc(O,B,J,de))return 0;m=Math.min(m,iu(O,B,J,de,n))}}return m}function An(i,e,n,s,u,f){if(!f)return;const m=Ku(Yu(s,f),u,n);m<e&&i.push([m,f,[0,0]])}function yo(i,e,n,s,u,f,m){if(!f||!m)return;const v=Ku(Yu(s,f),Yu(u,m),n);v<e&&i.push([v,f,m])}function au(i,e,n,s,u=1/0){let f=Math.min(s.distance(i[0],n[0][0]),u);if(f===0)return f;const m=new Jh([[0,[0,i.length-1],[0,0]]],Vr),v=Wu(n);for(;m.length>0;){const w=m.pop();if(w[0]>=f)continue;const A=w[1],P=e?50:100;if(Ts(A)<=P){if(!Ta(A,i.length))return NaN;if(e){const O=il(i,A,n,s);if(isNaN(O)||O===0)return O;f=Math.min(f,O)}else for(let O=A[0];O<=A[1];++O){const B=zf(i[O],n,s);if(f=Math.min(f,B),f===0)return 0}}else{const O=tu(A,e);An(m,f,s,i,v,O[0]),An(m,f,s,i,v,O[1])}}return f}function ou(i,e,n,s,u,f=1/0){let m=Math.min(f,u.distance(i[0],n[0]));if(m===0)return m;const v=new Jh([[0,[0,i.length-1],[0,n.length-1]]],Vr);for(;v.length>0;){const w=v.pop();if(w[0]>=m)continue;const A=w[1],P=w[2],O=e?50:100,B=s?50:100;if(Ts(A)<=O&&Ts(P)<=B){if(!Ta(A,i.length)&&Ta(P,n.length))return NaN;let F;if(e&&s)F=ru(i,A,n,P,u),m=Math.min(m,F);else if(e&&!s){const G=i.slice(A[0],A[1]+1);for(let q=P[0];q<=P[1];++q)if(F=Ea(n[q],G,u),m=Math.min(m,F),m===0)return m}else if(!e&&s){const G=n.slice(P[0],P[1]+1);for(let q=A[0];q<=A[1];++q)if(F=Ea(i[q],G,u),m=Math.min(m,F),m===0)return m}else F=Qu(i,A,n,P,u),m=Math.min(m,F)}else{const F=tu(A,e),G=tu(P,s);yo(v,m,u,i,n,F[0],G[0]),yo(v,m,u,i,n,F[0],G[1]),yo(v,m,u,i,n,F[1],G[0]),yo(v,m,u,i,n,F[1],G[1])}}return m}function Ju(i){return i.type==="MultiPolygon"?i.coordinates.map((e=>({type:"Polygon",coordinates:e}))):i.type==="MultiLineString"?i.coordinates.map((e=>({type:"LineString",coordinates:e}))):i.type==="MultiPoint"?i.coordinates.map((e=>({type:"Point",coordinates:e}))):[i]}class al{constructor(e,n){this.type=gt,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(go(e[1])){const s=e[1];if(s.type==="FeatureCollection")return new al(s,s.features.map((u=>Ju(u.geometry))).flat());if(s.type==="Feature")return new al(s,Ju(s.geometry));if("type"in s&&"coordinates"in s)return new al(s,Ju(s))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(n,s){const u=n.geometry(),f=u.flat().map((w=>Jl([w.x,w.y],n.canonical)));if(u.length===0)return NaN;const m=new td(f[0][1]);let v=1/0;for(const w of s){switch(w.type){case"Point":v=Math.min(v,ou(f,!1,[w.coordinates],!1,m,v));break;case"LineString":v=Math.min(v,ou(f,!1,w.coordinates,!0,m,v));break;case"Polygon":v=Math.min(v,au(f,!1,w.coordinates,m,v))}if(v===0)return v}return v})(e,this.geometries);if(e.geometryType()==="LineString")return(function(n,s){const u=n.geometry(),f=u.flat().map((w=>Jl([w.x,w.y],n.canonical)));if(u.length===0)return NaN;const m=new td(f[0][1]);let v=1/0;for(const w of s){switch(w.type){case"Point":v=Math.min(v,ou(f,!0,[w.coordinates],!1,m,v));break;case"LineString":v=Math.min(v,ou(f,!0,w.coordinates,!0,m,v));break;case"Polygon":v=Math.min(v,au(f,!0,w.coordinates,m,v))}if(v===0)return v}return v})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(n,s){const u=n.geometry();if(u.length===0||u[0].length===0)return NaN;const f=Jc(u,0).map((w=>w.map((A=>A.map((P=>Jl([P.x,P.y],n.canonical))))))),m=new td(f[0][0][0][1]);let v=1/0;for(const w of s)for(const A of f){switch(w.type){case"Point":v=Math.min(v,au([w.coordinates],!1,A,m,v));break;case"LineString":v=Math.min(v,au(w.coordinates,!0,A,m,v));break;case"Polygon":v=Math.min(v,nd(A,w.coordinates,m,v))}if(v===0)return v}return v})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class su{constructor(e){this.type=nn,this.key=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=e[1];return s==null?n.error("Global state property must be defined."):typeof s!="string"?n.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new su(s)}evaluate(e){var n;const s=(n=e.globals)===null||n===void 0?void 0:n.globalState;return s&&Object.keys(s).length!==0?Zl(s,this.key):null}eachChild(){}outputDefined(){return!1}}const nc={"==":vf,"!=":qu,">":tm,"<":xf,">=":$u,"<=":Xl,array:Lr,at:pn,boolean:Lr,case:$c,coalesce:tl,collator:Yl,format:Yc,image:Wl,in:rn,"index-of":el,interpolate:kr,"interpolate-hcl":kr,"interpolate-lab":kr,length:Kl,let:jn,literal:ia,match:wn,number:Lr,"number-format":Qh,object:Lr,slice:Sa,step:xs,string:Lr,"to-boolean":Or,"to-color":Or,"to-number":Or,"to-string":Or,var:ys,within:ws,distance:al,"global-state":su};class ra{constructor(e,n,s,u){this.name=e,this.type=n,this._evaluate=s,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,n){const s=e[0],u=ra.definitions[s];if(!u)return n.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,v=m.filter((([A])=>!Array.isArray(A)||A.length===e.length-1));let w=null;for(const[A,P]of v){w=new Js(n.registry,Br,n.path,null,n.scope);const O=[];let B=!1;for(let F=1;F<e.length;F++){const G=e[F],q=Array.isArray(A)?A[F-1]:A.type,Z=w.parse(G,1+O.length,q);if(!Z){B=!0;break}O.push(Z)}if(!B)if(Array.isArray(A)&&A.length!==O.length)w.error(`Expected ${A.length} arguments, but found ${O.length} instead.`);else{for(let F=0;F<O.length;F++){const G=Array.isArray(A)?A[F]:A.type,q=O[F];w.concat(F+1).checkSubtype(G,q.type)}if(w.errors.length===0)return new ra(s,f,P,O)}}if(v.length===1)n.errors.push(...w.errors);else{const A=(v.length?v:m).map((([O])=>{return B=O,Array.isArray(B)?`(${B.map(bn).join(", ")})`:`(${bn(B.type)}...)`;var B})).join(" | "),P=[];for(let O=1;O<e.length;O++){const B=n.parse(e[O],1+P.length);if(!B)return null;P.push(bn(B.type))}n.error(`Expected arguments of type ${A}, but found (${P.join(", ")}) instead.`)}return null}static register(e,n){ra.definitions=n;for(const s in n)e[s]=ra}}function id(i,[e,n,s,u]){e=e.evaluate(i),n=n.evaluate(i),s=s.evaluate(i);const f=u?u.evaluate(i):1,m=na(e,n,s,f);if(m)throw new Hn(m);return new sn(e/255,n/255,s/255,f,!1)}function eh(i,e){return i in e}function aa(i,e){const n=e[i];return n===void 0?null:n}function vo(i){return{type:i}}function Br(i){if(i instanceof ys)return Br(i.boundExpression);if(i instanceof ra&&i.name==="error"||i instanceof Yl||i instanceof ws||i instanceof al||i instanceof su)return!1;const e=i instanceof Or||i instanceof Lr;let n=!0;return i.eachChild((s=>{n=e?n&&Br(s):n&&s instanceof ia})),!!n&&qo(i)&&sl(i,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function qo(i){if(i instanceof ra&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ws||i instanceof al)return!1;let e=!0;return i.eachChild((n=>{e&&!qo(n)&&(e=!1)})),e}function ol(i){if(i instanceof ra&&i.name==="feature-state")return!1;let e=!0;return i.eachChild((n=>{e&&!ol(n)&&(e=!1)})),e}function sl(i,e){if(i instanceof ra&&e.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild((s=>{n&&!sl(s,e)&&(n=!1)})),n}function lu(i){return{result:"success",value:i}}function Es(i){return{result:"error",value:i}}function Ca(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function rd(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function ic(i){return!!i.expression&&i.expression.interpolated}function on(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function th(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)&&li(i)===uo}function oa(i){return i}function nh(i,e){const n=i.stops&&typeof i.stops[0][0]=="object",s=n||!(n||i.property!==void 0),u=i.type||(ic(e)?"exponential":"interval"),f=(function(P){switch(P.type){case"color":return sn.parse;case"padding":return Ni.parse;case"numberArray":return si.parse;case"colorArray":return Yt.parse;default:return null}})(e);if(f&&((i=Pi({},i)).stops&&(i.stops=i.stops.map((P=>[P[0],f(P[1])]))),i.default=f(i.default?i.default:e.default)),i.colorSpace&&(m=i.colorSpace)!=="rgb"&&m!=="hcl"&&m!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var m;const v=(function(P){switch(P){case"exponential":return Cs;case"interval":return ih;case"categorical":return Df;case"identity":return ad;default:throw new Error(`Unknown function type "${P}"`)}})(u);let w,A;if(u==="categorical"){w=Object.create(null);for(const P of i.stops)w[P[0]]=P[1];A=typeof i.stops[0][0]}if(n){const P={},O=[];for(let G=0;G<i.stops.length;G++){const q=i.stops[G],Z=q[0].zoom;P[Z]===void 0&&(P[Z]={zoom:Z,type:i.type,property:i.property,default:i.default,stops:[]},O.push(Z)),P[Z].stops.push([q[0].value,q[1]])}const B=[];for(const G of O)B.push([P[G].zoom,nh(P[G],e)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:kr.interpolationFactor.bind(void 0,F),zoomStops:B.map((G=>G[0])),evaluate:({zoom:G},q)=>Cs({stops:B,base:i.base},e,G).evaluate(G,q)}}if(s){const P=u==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:kr.interpolationFactor.bind(void 0,P),zoomStops:i.stops.map((O=>O[0])),evaluate:({zoom:O})=>v(i,e,O,w,A)}}return{kind:"source",evaluate(P,O){const B=O&&O.properties?O.properties[i.property]:void 0;return B===void 0?sa(i.default,e.default):v(i,e,B,w,A)}}}function sa(i,e,n){return i!==void 0?i:e!==void 0?e:n!==void 0?n:void 0}function Df(i,e,n,s,u){return sa(typeof n===u?s[n]:void 0,i.default,e.default)}function ih(i,e,n){if(on(n)!=="number")return sa(i.default,e.default);const s=i.stops.length;if(s===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[s-1][0])return i.stops[s-1][1];const u=vs(i.stops.map((f=>f[0])),n);return i.stops[u][1]}function Cs(i,e,n){const s=i.base!==void 0?i.base:1;if(on(n)!=="number")return sa(i.default,e.default);const u=i.stops.length;if(u===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[u-1][0])return i.stops[u-1][1];const f=vs(i.stops.map((P=>P[0])),n),m=(function(P,O,B,F){const G=F-B,q=P-B;return G===0?0:O===1?q/G:(Math.pow(O,q)-1)/(Math.pow(O,G)-1)})(n,s,i.stops[f][0],i.stops[f+1][0]),v=i.stops[f][1],w=i.stops[f+1][1],A=ci[e.type]||oa;return typeof v.evaluate=="function"?{evaluate(...P){const O=v.evaluate.apply(void 0,P),B=w.evaluate.apply(void 0,P);if(O!==void 0&&B!==void 0)return A(O,B,m,i.colorSpace)}}:A(v,w,m,i.colorSpace)}function ad(i,e,n){switch(e.type){case"color":n=sn.parse(n);break;case"formatted":n=er.fromString(n.toString());break;case"resolvedImage":n=Ir.fromString(n.toString());break;case"padding":n=Ni.parse(n);break;case"colorArray":n=Yt.parse(n);break;case"numberArray":n=si.parse(n);break;default:on(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0)}return sa(n,i.default,e.default)}ra.register(nc,{error:[{kind:"error"},[Qt],(i,[e])=>{throw new Hn(e.evaluate(i))}],typeof:[Qt,[nn],(i,[e])=>bn(li(e.evaluate(i)))],"to-rgba":[br(gt,4),[ta],(i,[e])=>{const[n,s,u,f]=e.evaluate(i).rgb;return[255*n,255*s,255*u,f]}],rgb:[ta,[gt,gt,gt],id],rgba:[ta,[gt,gt,gt,gt],id],has:{type:cn,overloads:[[[Qt],(i,[e])=>eh(e.evaluate(i),i.properties())],[[Qt,uo],(i,[e,n])=>eh(e.evaluate(i),n.evaluate(i))]]},get:{type:nn,overloads:[[[Qt],(i,[e])=>aa(e.evaluate(i),i.properties())],[[Qt,uo],(i,[e,n])=>aa(e.evaluate(i),n.evaluate(i))]]},"feature-state":[nn,[Qt],(i,[e])=>aa(e.evaluate(i),i.featureState||{})],properties:[uo,[],i=>i.properties()],"geometry-type":[Qt,[],i=>i.geometryType()],id:[nn,[],i=>i.id()],zoom:[gt,[],i=>i.globals.zoom],"heatmap-density":[gt,[],i=>i.globals.heatmapDensity||0],elevation:[gt,[],i=>i.globals.elevation||0],"line-progress":[gt,[],i=>i.globals.lineProgress||0],accumulated:[nn,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[gt,vo(gt),(i,e)=>{let n=0;for(const s of e)n+=s.evaluate(i);return n}],"*":[gt,vo(gt),(i,e)=>{let n=1;for(const s of e)n*=s.evaluate(i);return n}],"-":{type:gt,overloads:[[[gt,gt],(i,[e,n])=>e.evaluate(i)-n.evaluate(i)],[[gt],(i,[e])=>-e.evaluate(i)]]},"/":[gt,[gt,gt],(i,[e,n])=>e.evaluate(i)/n.evaluate(i)],"%":[gt,[gt,gt],(i,[e,n])=>e.evaluate(i)%n.evaluate(i)],ln2:[gt,[],()=>Math.LN2],pi:[gt,[],()=>Math.PI],e:[gt,[],()=>Math.E],"^":[gt,[gt,gt],(i,[e,n])=>Math.pow(e.evaluate(i),n.evaluate(i))],sqrt:[gt,[gt],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[gt,[gt],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[gt,[gt],(i,[e])=>Math.log(e.evaluate(i))],log2:[gt,[gt],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[gt,[gt],(i,[e])=>Math.sin(e.evaluate(i))],cos:[gt,[gt],(i,[e])=>Math.cos(e.evaluate(i))],tan:[gt,[gt],(i,[e])=>Math.tan(e.evaluate(i))],asin:[gt,[gt],(i,[e])=>Math.asin(e.evaluate(i))],acos:[gt,[gt],(i,[e])=>Math.acos(e.evaluate(i))],atan:[gt,[gt],(i,[e])=>Math.atan(e.evaluate(i))],min:[gt,vo(gt),(i,e)=>Math.min(...e.map((n=>n.evaluate(i))))],max:[gt,vo(gt),(i,e)=>Math.max(...e.map((n=>n.evaluate(i))))],abs:[gt,[gt],(i,[e])=>Math.abs(e.evaluate(i))],round:[gt,[gt],(i,[e])=>{const n=e.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[gt,[gt],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[gt,[gt],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[cn,[Qt,nn],(i,[e,n])=>i.properties()[e.value]===n.value],"filter-id-==":[cn,[nn],(i,[e])=>i.id()===e.value],"filter-type-==":[cn,[Qt],(i,[e])=>i.geometryType()===e.value],"filter-<":[cn,[Qt,nn],(i,[e,n])=>{const s=i.properties()[e.value],u=n.value;return typeof s==typeof u&&s<u}],"filter-id-<":[cn,[nn],(i,[e])=>{const n=i.id(),s=e.value;return typeof n==typeof s&&n<s}],"filter->":[cn,[Qt,nn],(i,[e,n])=>{const s=i.properties()[e.value],u=n.value;return typeof s==typeof u&&s>u}],"filter-id->":[cn,[nn],(i,[e])=>{const n=i.id(),s=e.value;return typeof n==typeof s&&n>s}],"filter-<=":[cn,[Qt,nn],(i,[e,n])=>{const s=i.properties()[e.value],u=n.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[cn,[nn],(i,[e])=>{const n=i.id(),s=e.value;return typeof n==typeof s&&n<=s}],"filter->=":[cn,[Qt,nn],(i,[e,n])=>{const s=i.properties()[e.value],u=n.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[cn,[nn],(i,[e])=>{const n=i.id(),s=e.value;return typeof n==typeof s&&n>=s}],"filter-has":[cn,[nn],(i,[e])=>e.value in i.properties()],"filter-has-id":[cn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[cn,[br(Qt)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[cn,[br(nn)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[cn,[Qt,br(nn)],(i,[e,n])=>n.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[cn,[Qt,br(nn)],(i,[e,n])=>(function(s,u,f,m){for(;f<=m;){const v=f+m>>1;if(u[v]===s)return!0;u[v]>s?m=v-1:f=v+1}return!1})(i.properties()[e.value],n.value,0,n.value.length-1)],all:{type:cn,overloads:[[[cn,cn],(i,[e,n])=>e.evaluate(i)&&n.evaluate(i)],[vo(cn),(i,e)=>{for(const n of e)if(!n.evaluate(i))return!1;return!0}]]},any:{type:cn,overloads:[[[cn,cn],(i,[e,n])=>e.evaluate(i)||n.evaluate(i)],[vo(cn),(i,e)=>{for(const n of e)if(n.evaluate(i))return!0;return!1}]]},"!":[cn,[cn],(i,[e])=>!e.evaluate(i)],"is-supported-script":[cn,[Qt],(i,[e])=>{const n=i.globals&&i.globals.isSupportedScript;return!n||n(e.evaluate(i))}],upcase:[Qt,[Qt],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[Qt,[Qt],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[Qt,vo(nn),(i,e)=>e.map((n=>_s(n.evaluate(i)))).join("")],"resolved-locale":[Qt,[Hs],(i,[e])=>e.evaluate(i).resolvedLocale()]});class rh{constructor(e,n,s){this.expression=e,this._warningHistory={},this._evaluator=new Qs,this._defaultValue=n?(function(u){if(u.type==="color"&&th(u.default))return new sn(0,0,0,0);switch(u.type){case"color":return sn.parse(u.default)||null;case"padding":return Ni.parse(u.default)||null;case"numberArray":return si.parse(u.default)||null;case"colorArray":return Yt.parse(u.default)||null;case"variableAnchorOffsetCollection":return wi.parse(u.default)||null;case"projectionDefinition":return tr.parse(u.default)||null;default:return u.default===void 0?null:u.default}})(n):null,this._enumValues=n&&n.type==="enum"?n.values:null,this._globalState=s}evaluateWithoutErrorHandling(e,n,s,u,f,m){return this._globalState&&(e=ar(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=s,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)}evaluate(e,n,s,u,f,m){this._globalState&&(e=ar(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new Hn(`Expected value to be one of ${Object.keys(this._enumValues).map((w=>JSON.stringify(w))).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Ms(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in nc}function rc(i,e,n){const s=new Js(nc,Br,[],e?(function(f){const m={color:ta,string:Qt,number:gt,enum:Qt,boolean:cn,formatted:ho,padding:Vo,numberArray:po,colorArray:fo,projectionDefinition:Vu,resolvedImage:bi,variableAnchorOffsetCollection:Gl};return f.type==="array"?br(m[f.value]||nn,f.length):m[f.type]})(e):void 0),u=s.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?lu(new rh(u,e,n)):Es(s.errors)}class Fr{constructor(e,n,s){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!ol(n.expression),this.globalStateRefs=nr(n.expression),this._globalState=s}evaluateWithoutErrorHandling(e,n,s,u,f,m){return this._globalState&&(e=ar(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,n,s,u,f,m)}evaluate(e,n,s,u,f,m){return this._globalState&&(e=ar(e,this._globalState)),this._styleExpression.evaluate(e,n,s,u,f,m)}}class As{constructor(e,n,s,u,f){this.kind=e,this.zoomStops=s,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!ol(n.expression),this.globalStateRefs=nr(n.expression),this.interpolationType=u,this._globalState=f}evaluateWithoutErrorHandling(e,n,s,u,f,m){return this._globalState&&(e=ar(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,n,s,u,f,m)}evaluate(e,n,s,u,f,m){return this._globalState&&(e=ar(e,this._globalState)),this._styleExpression.evaluate(e,n,s,u,f,m)}interpolationFactor(e,n,s){return this.interpolationType?kr.interpolationFactor(this.interpolationType,e,n,s):0}}function zs(i,e,n){const s=rc(i,e,n);if(s.result==="error")return s;const u=s.value.expression,f=qo(u);if(!f&&!Ca(e))return Es([new Pr("","data expressions not supported")]);const m=sl(u,["zoom"]);if(!m&&!rd(e))return Es([new Pr("","zoom expressions not supported")]);const v=Ds(u);return v||m?v instanceof Pr?Es([v]):v instanceof kr&&!ic(e)?Es([new Pr("",'"interpolate" expressions cannot be used with this property')]):lu(v?new As(f?"camera":"composite",s.value,v.labels,v instanceof kr?v.interpolation:void 0,n):new Fr(f?"constant":"source",s.value,n)):Es([new Pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ll{constructor(e,n){this._parameters=e,this._specification=n,Pi(this,nh(this._parameters,this._specification))}static deserialize(e){return new ll(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Ds(i){let e=null;if(i instanceof jn)e=Ds(i.result);else if(i instanceof tl){for(const n of i.args)if(e=Ds(n),e)break}else(i instanceof xs||i instanceof kr)&&i.input instanceof ra&&i.input.name==="zoom"&&(e=i);return e instanceof Pr||i.eachChild((n=>{const s=Ds(n);s instanceof Pr?e=s:!e&&s?e=new Pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new Pr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function nr(i,e=new Set){return i instanceof su&&e.add(i.key),i.eachChild((n=>{nr(n,e)})),e}function ar(i,e){const{zoom:n,heatmapDensity:s,elevation:u,lineProgress:f,isSupportedScript:m,accumulated:v}=i??{};return{zoom:n,heatmapDensity:s,elevation:u,lineProgress:f,isSupportedScript:m,accumulated:v,globalState:e}}function xo(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!xo(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const bo={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ur(i,e){if(i==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};xo(i)||(i=cl(i));const n=rc(i,bo,e);if(n.result==="error")throw new Error(n.value.map((s=>`${s.key}: ${s.message}`)).join(", "));return{filter:(s,u,f)=>n.value.evaluate(s,u,{},f),needGeometry:od(i),getGlobalStateRefs:()=>nr(n.value.expression)}}function $o(i,e){return i<e?-1:i>e?1:0}function od(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let e=1;e<i.length;e++)if(od(i[e]))return!0;return!1}function cl(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?ac(i[1],i[2],"=="):e==="!="?Xn(ac(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ac(i[1],i[2],e):e==="any"?(n=i.slice(1),["any"].concat(n.map(cl))):e==="all"?["all"].concat(i.slice(1).map(cl)):e==="none"?["all"].concat(i.slice(1).map(cl).map(Xn)):e==="in"?sd(i[1],i.slice(2)):e==="!in"?Xn(sd(i[1],i.slice(2))):e==="has"?or(i[1]):e!=="!has"||Xn(or(i[1]));var n}function ac(i,e,n){switch(i){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,i,e]}}function sd(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((n=>typeof n!=typeof e[0]))?["filter-in-large",i,["literal",e.sort($o)]]:["filter-in-small",i,["literal",e]]}}function or(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Xn(i){return["!",i]}function xn(i){const e=typeof i;if(e==="number"||e==="boolean"||e==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let u="[";for(const f of i)u+=`${xn(f)},`;return`${u}]`}const n=Object.keys(i).sort();let s="{";for(let u=0;u<n.length;u++)s+=`${JSON.stringify(n[u])}:${xn(i[n[u]])},`;return`${s}}`}function Zo(i){let e="";for(const n of Wt)e+=`/${xn(i[n])}`;return e}function la(i){const e=i.value;return e?[new ot(i.key,e,"constants have been deprecated as of v8")]:[]}function mi(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Gr(i){if(Array.isArray(i))return i.map(Gr);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const n in i)e[n]=Gr(i[n]);return e}return mi(i)}function qr(i){const e=i.key,n=i.value,s=i.valueSpec||{},u=i.objectElementValidators||{},f=i.style,m=i.styleSpec,v=i.validateSpec;let w=[];const A=on(n);if(A!=="object")return[new ot(e,n,`object expected, ${A} found`)];for(const P in n){const O=P.split(".")[0],B=Zl(s,O)||s["*"];let F;if(Zl(u,O))F=u[O];else if(Zl(s,O)){if(n[P]===void 0)continue;F=v}else if(u["*"])F=u["*"];else{if(!s["*"]){w.push(new ot(e,n[P],`unknown property "${P}"`));continue}F=v}w=w.concat(F({key:(e&&`${e}.`)+P,value:n[P],valueSpec:B,style:f,styleSpec:m,object:n,objectKey:P,validateSpec:v},n))}for(const P in s)u[P]||s[P].required&&s[P].default===void 0&&n[P]===void 0&&w.push(new ot(e,n,`missing required property "${P}"`));return w}function cu(i){const e=i.value,n=i.valueSpec,s=i.style,u=i.styleSpec,f=i.key,m=i.arrayElementValidator||i.validateSpec;if(on(e)!=="array")return[new ot(f,e,`array expected, ${on(e)} found`)];if(n.length&&e.length!==n.length)return[new ot(f,e,`array length ${n.length} expected, length ${e.length} found`)];let v={type:n.value,values:n.values};u.$version<7&&(v.function=n.function),on(n.value)==="object"&&(v=n.value);let w=[];for(let A=0;A<e.length;A++)w=w.concat(m({array:e,arrayIndex:A,value:e[A],valueSpec:v,validateSpec:i.validateSpec,style:s,styleSpec:u,key:`${f}[${A}]`}));return w}function wo(i){const e=i.key,n=i.value,s=i.valueSpec;let u=on(n);return u==="number"&&n!=n&&(u="NaN"),u!=="number"?[new ot(e,n,`number expected, ${u} found`)]:"minimum"in s&&n<s.minimum?[new ot(e,n,`${n} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&n>s.maximum?[new ot(e,n,`${n} is greater than the maximum value ${s.maximum}`)]:[]}function So(i){const e=i.valueSpec,n=mi(i.value.type);let s,u,f,m={};const v=n!=="categorical"&&i.value.property===void 0,w=!v,A=on(i.value.stops)==="array"&&on(i.value.stops[0])==="array"&&on(i.value.stops[0][0])==="object",P=qr({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(F){if(n==="identity")return[new ot(F.key,F.value,'identity function may not have a "stops" property')];let G=[];const q=F.value;return G=G.concat(cu({key:F.key,value:q,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:O})),on(q)==="array"&&q.length===0&&G.push(new ot(F.key,q,"array must have at least one stop")),G},default:function(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:e,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}});return n==="identity"&&v&&P.push(new ot(i.key,i.value,'missing required property "property"')),n==="identity"||i.value.stops||P.push(new ot(i.key,i.value,'missing required property "stops"')),n==="exponential"&&i.valueSpec.expression&&!ic(i.valueSpec)&&P.push(new ot(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(w&&!Ca(i.valueSpec)?P.push(new ot(i.key,i.value,"property functions not supported")):v&&!rd(i.valueSpec)&&P.push(new ot(i.key,i.value,"zoom functions not supported"))),n!=="categorical"&&!A||i.value.property!==void 0||P.push(new ot(i.key,i.value,'"property" property is required')),P;function O(F){let G=[];const q=F.value,Z=F.key;if(on(q)!=="array")return[new ot(Z,q,`array expected, ${on(q)} found`)];if(q.length!==2)return[new ot(Z,q,`array length 2 expected, length ${q.length} found`)];if(A){if(on(q[0])!=="object")return[new ot(Z,q,`object expected, ${on(q[0])} found`)];if(q[0].zoom===void 0)return[new ot(Z,q,"object stop key must have zoom")];if(q[0].value===void 0)return[new ot(Z,q,"object stop key must have value")];if(f&&f>mi(q[0].zoom))return[new ot(Z,q[0].zoom,"stop zoom values must appear in ascending order")];mi(q[0].zoom)!==f&&(f=mi(q[0].zoom),u=void 0,m={}),G=G.concat(qr({key:`${Z}[0]`,value:q[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:wo,value:B}}))}else G=G.concat(B({key:`${Z}[0]`,value:q[0],validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},q));return Ms(Gr(q[1]))?G.concat([new ot(`${Z}[1]`,q[1],"expressions are not allowed in function stops.")]):G.concat(F.validateSpec({key:`${Z}[1]`,value:q[1],valueSpec:e,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function B(F,G){const q=on(F.value),Z=mi(F.value),J=F.value!==null?F.value:G;if(s){if(q!==s)return[new ot(F.key,J,`${q} stop domain type must match previous stop domain type ${s}`)]}else s=q;if(q!=="number"&&q!=="string"&&q!=="boolean")return[new ot(F.key,J,"stop domain value must be a number, string, or boolean")];if(q!=="number"&&n!=="categorical"){let de=`number expected, ${q} found`;return Ca(e)&&n===void 0&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ot(F.key,J,de)]}return n!=="categorical"||q!=="number"||isFinite(Z)&&Math.floor(Z)===Z?n!=="categorical"&&q==="number"&&u!==void 0&&Z<u?[new ot(F.key,J,"stop domain values must appear in ascending order")]:(u=Z,n==="categorical"&&Z in m?[new ot(F.key,J,"stop domain values must be unique")]:(m[Z]=!0,[])):[new ot(F.key,J,`integer expected, found ${Z}`)]}}function To(i){const e=(i.expressionContext==="property"?zs:rc)(Gr(i.value),i.valueSpec);if(e.result==="error")return e.value.map((s=>new ot(`${i.key}${s.key}`,i.value,s.message)));const n=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!n.outputDefined())return[new ot(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!ol(n))return[new ot(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!ol(n))return[new ot(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!sl(n,["zoom","feature-state"]))return[new ot(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!qo(n))return[new ot(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ho(i){const e=i.key,n=i.value,s=on(n);return s!=="string"?[new ot(e,n,`color expected, ${s} found`)]:sn.parse(String(n))?[]:[new ot(e,n,`color expected, "${n}" found`)]}function Xo(i){const e=i.key,n=i.value,s=i.valueSpec,u=[];return Array.isArray(s.values)?s.values.indexOf(mi(n))===-1&&u.push(new ot(e,n,`expected one of [${s.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(s.values).indexOf(mi(n))===-1&&u.push(new ot(e,n,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(n)} found`)),u}function Ma(i){return xo(Gr(i.value))?To(Pi({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Eo(i)}function Eo(i){const e=i.value,n=i.key;if(on(e)!=="array")return[new ot(n,e,`array expected, ${on(e)} found`)];const s=i.styleSpec;let u,f=[];if(e.length<1)return[new ot(n,e,"filter array must have at least 1 element")];switch(f=f.concat(Xo({key:`${n}[0]`,value:e[0],valueSpec:s.filter_operator,style:i.style,styleSpec:i.styleSpec})),mi(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&mi(e[1])==="$type"&&f.push(new ot(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&f.push(new ot(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=on(e[1]),u!=="string"&&f.push(new ot(`${n}[1]`,e[1],`string expected, ${u} found`)));for(let m=2;m<e.length;m++)u=on(e[m]),mi(e[1])==="$type"?f=f.concat(Xo({key:`${n}[${m}]`,value:e[m],valueSpec:s.geometry_type,style:i.style,styleSpec:i.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&f.push(new ot(`${n}[${m}]`,e[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)f=f.concat(Eo({key:`${n}[${m}]`,value:e[m],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":u=on(e[1]),e.length!==2?f.push(new ot(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&f.push(new ot(`${n}[1]`,e[1],`string expected, ${u} found`))}return f}function Yo(i,e){const n=i.key,s=i.validateSpec,u=i.style,f=i.styleSpec,m=i.value,v=i.objectKey,w=f[`${e}_${i.layerType}`];if(!w)return[];const A=v.match(/^(.*)-transition$/);if(e==="paint"&&A&&w[A[1]]&&w[A[1]].transition)return s({key:n,value:m,valueSpec:f.transition,style:u,styleSpec:f});const P=i.valueSpec||w[v];if(!P)return[new ot(n,m,`unknown property "${v}"`)];let O;if(on(m)==="string"&&Ca(P)&&!P.tokens&&(O=/^{([^}]+)}$/.exec(m)))return[new ot(n,m,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(O[1])} }\`.`)];const B=[];return i.layerType==="symbol"&&v==="text-font"&&th(Gr(m))&&mi(m.type)==="identity"&&B.push(new ot(n,m,'"text-font" does not support identity functions')),B.concat(s({key:i.key,value:m,valueSpec:P,style:u,styleSpec:f,expressionContext:"property",propertyType:e,propertyKey:v}))}function Co(i){return Yo(i,"paint")}function ah(i){return Yo(i,"layout")}function oh(i){let e=[];const n=i.value,s=i.key,u=i.style,f=i.styleSpec;if(on(n)!=="object")return[new ot(s,n,`object expected, ${on(n)} found`)];n.type||n.ref||e.push(new ot(s,n,'either "type" or "ref" is required'));let m=mi(n.type);const v=mi(n.ref);if(n.id){const w=mi(n.id);for(let A=0;A<i.arrayIndex;A++){const P=u.layers[A];mi(P.id)===w&&e.push(new ot(s,n.id,`duplicate layer id "${n.id}", previously used at line ${P.id.__line__}`))}}if("ref"in n){let w;["type","source","source-layer","filter","layout"].forEach((A=>{A in n&&e.push(new ot(s,n[A],`"${A}" is prohibited for ref layers`))})),u.layers.forEach((A=>{mi(A.id)===v&&(w=A)})),w?w.ref?e.push(new ot(s,n.ref,"ref cannot reference another ref layer")):m=mi(w.type):e.push(new ot(s,n.ref,`ref layer "${v}" not found`))}else if(m!=="background")if(n.source){const w=u.sources&&u.sources[n.source],A=w&&mi(w.type);w?A==="vector"&&m==="raster"?e.push(new ot(s,n.source,`layer "${n.id}" requires a raster source`)):A!=="raster-dem"&&m==="hillshade"||A!=="raster-dem"&&m==="color-relief"?e.push(new ot(s,n.source,`layer "${n.id}" requires a raster-dem source`)):A==="raster"&&m!=="raster"?e.push(new ot(s,n.source,`layer "${n.id}" requires a vector source`)):A!=="vector"||n["source-layer"]?A==="raster-dem"&&m!=="hillshade"&&m!=="color-relief"?e.push(new ot(s,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):m!=="line"||!n.paint||!n.paint["line-gradient"]||A==="geojson"&&w.lineMetrics||e.push(new ot(s,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new ot(s,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new ot(s,n.source,`source "${n.source}" not found`))}else e.push(new ot(s,n,'missing required property "source"'));return e=e.concat(qr({key:s,value:n,valueSpec:f.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${s}.type`,value:n.type,valueSpec:f.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:n,objectKey:"type"}),filter:Ma,layout:w=>qr({layer:n,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":A=>ah(Pi({layerType:m},A))}}),paint:w=>qr({layer:n,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":A=>Co(Pi({layerType:m},A))}})}})),e}function ca(i){const e=i.value,n=i.key,s=on(e);return s!=="string"?[new ot(n,e,`string expected, ${s} found`)]:[]}const oc={promoteId:function({key:i,value:e}){if(on(e)==="string")return ca({key:i,value:e});{const n=[];for(const s in e)n.push(...ca({key:`${i}.${s}`,value:e[s]}));return n}}};function Wo(i){const e=i.value,n=i.key,s=i.styleSpec,u=i.style,f=i.validateSpec;if(!e.type)return[new ot(n,e,'"type" is required')];const m=mi(e.type);let v;switch(m){case"vector":case"raster":return v=qr({key:n,value:e,valueSpec:s[`source_${m.replace("-","_")}`],style:i.style,styleSpec:s,objectElementValidators:oc,validateSpec:f}),v;case"raster-dem":return v=(function(w){var A;const P=(A=w.sourceName)!==null&&A!==void 0?A:"",O=w.value,B=w.styleSpec,F=B.source_raster_dem,G=w.style;let q=[];const Z=on(O);if(O===void 0)return q;if(Z!=="object")return q.push(new ot("source_raster_dem",O,`object expected, ${Z} found`)),q;const J=mi(O.encoding)==="custom",de=["redFactor","greenFactor","blueFactor","baseShift"],te=w.value.encoding?`"${w.value.encoding}"`:"Default";for(const re in O)!J&&de.includes(re)?q.push(new ot(re,O[re],`In "${P}": "${re}" is only valid when "encoding" is set to "custom". ${te} encoding found`)):F[re]?q=q.concat(w.validateSpec({key:re,value:O[re],valueSpec:F[re],validateSpec:w.validateSpec,style:G,styleSpec:B})):q.push(new ot(re,O[re],`unknown property "${re}"`));return q})({sourceName:n,value:e,style:i.style,styleSpec:s,validateSpec:f}),v;case"geojson":if(v=qr({key:n,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s,validateSpec:f,objectElementValidators:oc}),e.cluster)for(const w in e.clusterProperties){const[A,P]=e.clusterProperties[w],O=typeof A=="string"?[A,["accumulated"],["get",w]]:A;v.push(...To({key:`${n}.${w}.map`,value:P,expressionContext:"cluster-map"})),v.push(...To({key:`${n}.${w}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return v;case"video":return qr({key:n,value:e,valueSpec:s.source_video,style:u,validateSpec:f,styleSpec:s});case"image":return qr({key:n,value:e,valueSpec:s.source_image,style:u,validateSpec:f,styleSpec:s});case"canvas":return[new ot(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xo({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function ji(i){const e=i.value,n=i.styleSpec,s=n.light,u=i.style;let f=[];const m=on(e);if(e===void 0)return f;if(m!=="object")return f=f.concat([new ot("light",e,`object expected, ${m} found`)]),f;for(const v in e){const w=v.match(/^(.*)-transition$/);f=f.concat(w&&s[w[1]]&&s[w[1]].transition?i.validateSpec({key:v,value:e[v],valueSpec:n.transition,validateSpec:i.validateSpec,style:u,styleSpec:n}):s[v]?i.validateSpec({key:v,value:e[v],valueSpec:s[v],validateSpec:i.validateSpec,style:u,styleSpec:n}):[new ot(v,e[v],`unknown property "${v}"`)])}return f}function uu(i){const e=i.value,n=i.styleSpec,s=n.sky,u=i.style,f=on(e);if(e===void 0)return[];if(f!=="object")return[new ot("sky",e,`object expected, ${f} found`)];let m=[];for(const v in e)m=m.concat(s[v]?i.validateSpec({key:v,value:e[v],valueSpec:s[v],style:u,styleSpec:n}):[new ot(v,e[v],`unknown property "${v}"`)]);return m}function sh(i){const e=i.value,n=i.styleSpec,s=n.terrain,u=i.style;let f=[];const m=on(e);if(e===void 0)return f;if(m!=="object")return f=f.concat([new ot("terrain",e,`object expected, ${m} found`)]),f;for(const v in e)f=f.concat(s[v]?i.validateSpec({key:v,value:e[v],valueSpec:s[v],validateSpec:i.validateSpec,style:u,styleSpec:n}):[new ot(v,e[v],`unknown property "${v}"`)]);return f}function ld(i){let e=[];const n=i.value,s=i.key;if(Array.isArray(n)){const u=[],f=[];for(const m in n)n[m].id&&u.includes(n[m].id)&&e.push(new ot(s,n,`all the sprites' ids must be unique, but ${n[m].id} is duplicated`)),u.push(n[m].id),n[m].url&&f.includes(n[m].url)&&e.push(new ot(s,n,`all the sprites' URLs must be unique, but ${n[m].url} is duplicated`)),f.push(n[m].url),e=e.concat(qr({key:`${s}[${m}]`,value:n[m],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return e}return ca({key:s,value:n})}function Pf(i){return!!i&&i.constructor===Object}function cd(i){return Pf(i.value)?[]:[new ot(i.key,i.value,`object expected, ${on(i.value)} found`)]}const Ii={"*":()=>[],array:cu,boolean:function(i){const e=i.value,n=i.key,s=on(e);return s!=="boolean"?[new ot(n,e,`boolean expected, ${s} found`)]:[]},number:wo,color:Ho,constants:la,enum:Xo,filter:Ma,function:So,layer:oh,object:qr,source:Wo,light:ji,sky:uu,terrain:sh,projection:function(i){const e=i.value,n=i.styleSpec,s=n.projection,u=i.style,f=on(e);if(e===void 0)return[];if(f!=="object")return[new ot("projection",e,`object expected, ${f} found`)];let m=[];for(const v in e)m=m.concat(s[v]?i.validateSpec({key:v,value:e[v],valueSpec:s[v],style:u,styleSpec:n}):[new ot(v,e[v],`unknown property "${v}"`)]);return m},projectionDefinition:function(i){const e=i.key;let n=i.value;n=n instanceof String?n.valueOf():n;const s=on(n);return s!=="array"||(function(u){return Array.isArray(u)&&u.length===3&&typeof u[0]=="string"&&typeof u[1]=="string"&&typeof u[2]=="number"})(n)||(function(u){return!!["interpolate","step","literal"].includes(u[0])})(n)?["array","string"].includes(s)?[]:[new ot(e,n,`projection expected, invalid type "${s}" found`)]:[new ot(e,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:ca,formatted:function(i){return ca(i).length===0?[]:To(i)},resolvedImage:function(i){return ca(i).length===0?[]:To(i)},padding:function(i){const e=i.key,n=i.value;if(on(n)==="array"){if(n.length<1||n.length>4)return[new ot(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const s={type:"number"};let u=[];for(let f=0;f<n.length;f++)u=u.concat(i.validateSpec({key:`${e}[${f}]`,value:n[f],validateSpec:i.validateSpec,valueSpec:s}));return u}return wo({key:e,value:n,valueSpec:{}})},numberArray:function(i){const e=i.key,n=i.value;if(on(n)==="array"){const s={type:"number"};if(n.length<1)return[new ot(e,n,"array length at least 1 expected, length 0 found")];let u=[];for(let f=0;f<n.length;f++)u=u.concat(i.validateSpec({key:`${e}[${f}]`,value:n[f],validateSpec:i.validateSpec,valueSpec:s}));return u}return wo({key:e,value:n,valueSpec:{}})},colorArray:function(i){const e=i.key,n=i.value;if(on(n)==="array"){if(n.length<1)return[new ot(e,n,"array length at least 1 expected, length 0 found")];let s=[];for(let u=0;u<n.length;u++)s=s.concat(Ho({key:`${e}[${u}]`,value:n[u]}));return s}return Ho({key:e,value:n})},variableAnchorOffsetCollection:function(i){const e=i.key,n=i.value,s=on(n),u=i.styleSpec;if(s!=="array"||n.length<1||n.length%2!=0)return[new ot(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let f=[];for(let m=0;m<n.length;m+=2)f=f.concat(Xo({key:`${e}[${m}]`,value:n[m],valueSpec:u.layout_symbol["text-anchor"]})),f=f.concat(cu({key:`${e}[${m+1}]`,value:n[m+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:u}));return f},sprite:ld,state:cd,fontFaces:function(i){const e=i.key,n=i.value,s=i.validateSpec,u=i.styleSpec,f=i.style;if(!Pf(n))return[new ot(e,n,`object expected, ${on(n)} found`)];const m=[];for(const v in n){const w=n[v],A=on(w);if(A==="string")m.push(...ca({key:`${e}.${v}`,value:w}));else if(A==="array"){const P={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[O,B]of w.entries())m.push(...qr({key:`${e}.${v}[${O}]`,value:B,valueSpec:P,styleSpec:u,style:f,validateSpec:s}))}else m.push(new ot(`${e}.${v}`,w,`string or array expected, ${A} found`))}return m}};function Mo(i){const e=i.value,n=i.valueSpec,s=i.styleSpec;return i.validateSpec=Mo,n.expression&&th(mi(e))?So(i):n.expression&&Ms(Gr(e))?To(i):n.type&&Ii[n.type]?Ii[n.type](i):qr(Pi({},i,{valueSpec:n.type?s[n.type]:n}))}function sc(i){const e=i.value,n=i.key,s=ca(i);return s.length||(e.indexOf("{fontstack}")===-1&&s.push(new ot(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&s.push(new ot(n,e,'"glyphs" url must include a "{range}" token'))),s}function wr(i,e=Me){let n=[];return n=n.concat(Mo({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,validateSpec:Mo,objectElementValidators:{glyphs:sc,"*":()=>[]}})),i.constants&&(n=n.concat(la({key:"constants",value:i.constants}))),ul(n)}function ua(i){return function(e){return i(Object.assign({},e,{validateSpec:Mo}))}}function ul(i){return[].concat(i).sort(((e,n)=>e.line-n.line))}function Sr(i){return function(...e){return ul(i.apply(this,e))}}wr.source=Sr(ua(Wo)),wr.sprite=Sr(ua(ld)),wr.glyphs=Sr(ua(sc)),wr.light=Sr(ua(ji)),wr.sky=Sr(ua(uu)),wr.terrain=Sr(ua(sh)),wr.state=Sr(ua(cd)),wr.layer=Sr(ua(oh)),wr.filter=Sr(ua(Ma)),wr.paintProperty=Sr(ua(Co)),wr.layoutProperty=Sr(ua(ah));const im={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class lc{constructor(e,n){this._globalState=n,this.setValue(e)}evaluate(){var e;return(e=this._literalValue)!==null&&e!==void 0?e:this._compiledValue.evaluate({})}setValue(e){if(e==null||e==="visible"||e==="none")return this._literalValue=e==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const n=rc(e,im,this._globalState);if(n.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(n.value.map((s=>`${s.key}: ${s.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=n.value,this._globalStateRefs=nr(n.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const hu=Me,ir=wr,Xa=ir.light,lh=ir.sky,ch=ir.paintProperty,Rf=ir.layoutProperty;function Ya(i,e){let n=!1;if(e&&e.length)for(const s of e)i.fire(new Ke(new Error(s.message))),n=!0;return n}class Ps{constructor(e,n,s){const u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const m=new Int32Array(this.arrayBuffer);e=m[0],this.d=(n=m[1])+2*(s=m[2]);for(let w=0;w<this.d*this.d;w++){const A=m[3+w],P=m[3+w+1];u.push(A===P?null:m.subarray(A,P))}const v=m[3+u.length+1];this.keys=m.subarray(m[3+u.length],v),this.bboxes=m.subarray(v),this.insert=this._insertReadonly}else{this.d=n+2*s;for(let m=0;m<this.d*this.d;m++)u.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=s,this.scale=n/e,this.uid=0;const f=s/n*e;this.min=-f,this.max=e+f}insert(e,n,s,u,f){this._forEachCell(n,s,u,f,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(f)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,n,s,u,f,m){this.cells[f].push(m)}query(e,n,s,u,f){const m=this.min,v=this.max;if(e<=m&&n<=m&&v<=s&&v<=u&&!f)return Array.prototype.slice.call(this.keys);{const w=[];return this._forEachCell(e,n,s,u,this._queryCell,w,{},f),w}}_queryCell(e,n,s,u,f,m,v,w){const A=this.cells[f];if(A!==null){const P=this.keys,O=this.bboxes;for(let B=0;B<A.length;B++){const F=A[B];if(v[F]===void 0){const G=4*F;(w?w(O[G+0],O[G+1],O[G+2],O[G+3]):e<=O[G+2]&&n<=O[G+3]&&s>=O[G+0]&&u>=O[G+1])?(v[F]=!0,m.push(P[F])):v[F]=!1}}}}_forEachCell(e,n,s,u,f,m,v,w){const A=this._convertToCellCoord(e),P=this._convertToCellCoord(n),O=this._convertToCellCoord(s),B=this._convertToCellCoord(u);for(let F=A;F<=O;F++)for(let G=P;G<=B;G++){const q=this.d*G+F;if((!w||w(this._convertFromCellCoord(F),this._convertFromCellCoord(G),this._convertFromCellCoord(F+1),this._convertFromCellCoord(G+1)))&&f.call(this,e,n,s,u,q,m,v,w))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,n=3+this.cells.length+1+1;let s=0;for(let m=0;m<this.cells.length;m++)s+=this.cells[m].length;const u=new Int32Array(n+s+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;let f=n;for(let m=0;m<e.length;m++){const v=e[m];u[3+m]=f,u.set(v,f),f+=v.length}return u[3+e.length]=f,u.set(this.keys,f),f+=this.keys.length,u[3+e.length+1]=f,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer}static serialize(e,n){const s=e.toArrayBuffer();return n&&n.push(s),{buffer:s}}static deserialize(e){return new Ps(e.buffer)}}const $r={};function zt(i,e,n={}){if($r[i])throw new Error(`${i} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:i,writeable:!1}),$r[i]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}zt("Object",Object),zt("Set",Set),zt("TransferableGridIndex",Ps),zt("Color",sn),zt("Error",Error),zt("AJAXError",me),zt("ResolvedImage",Ir),zt("StylePropertyFunction",ll),zt("StyleExpression",rh,{omit:["_evaluator"]}),zt("ZoomDependentExpression",As),zt("ZoomConstantExpression",Fr),zt("CompoundExpression",ra,{omit:["_evaluate"]});for(const i in nc)nc[i]._classRegistryKey||zt(`Expression_${i}`,nc[i]);function du(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function uh(i){return i.$name||i.constructor._classRegistryKey}function Aa(i){return!(function(e){if(e===null||typeof e!="object")return!1;const n=uh(e);return!(!n||n==="Object")})(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||du(i)||Ar(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function Wa(i,e){if(Aa(i))return(du(i)||Ar(i))&&e&&e.push(i),ArrayBuffer.isView(i)&&e&&e.push(i.buffer),i instanceof ImageData&&e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const f=[];for(const m of i)f.push(Wa(m,e));return f}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const n=uh(i);if(!n)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!$r[n])throw new Error(`${n} is not registered.`);const{klass:s}=$r[n],u=s.serialize?s.serialize(i,e):{};if(s.serialize){if(e&&u===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const f in i){if(!i.hasOwnProperty(f)||$r[n].omit.indexOf(f)>=0)continue;const m=i[f];u[f]=$r[n].shallow.indexOf(f)>=0?m:Wa(m,e)}i instanceof Error&&(u.message=i.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(u.$name=n),u}function cc(i){if(Aa(i))return i;if(Array.isArray(i))return i.map(cc);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const e=uh(i)||"Object";if(!$r[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=$r[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(i);const s=Object.create(n.prototype);for(const u of Object.keys(i)){if(u==="$name")continue;const f=i[u];s[u]=$r[e].shallow.indexOf(u)>=0?f:cc(f)}return s}class hh{constructor(){this.first=!0}update(e,n){const s=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=s,!0))}}function Ao(i){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(i))}function hl(i){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(i))}function fu(i){return/\s/u.test(String.fromCodePoint(i))}function zo(i){for(const e of i)if(hl(e.codePointAt(0)))return!0;return!1}function dh(i){for(const e of i)if(!ud(e.codePointAt(0)))return!1;return!0}function pu(i){const e=i.map((n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}})).filter((n=>n));return new RegExp(e.join("|"),"u")}const Do=pu(["Arab","Dupl","Mong","Ougr","Syrc"]);function ud(i){return!Do.test(String.fromCodePoint(i))}function Po(i){return!(hl(i)||(e=i,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(e))));var e}const fh=pu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function mu(i){return fh.test(String.fromCodePoint(i))}function Ro(i,e){return!(!e&&mu(i)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(i)))}function Ko(i){for(const e of i)if(mu(e.codePointAt(0)))return!0;return!1}const za=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){if(za.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(i,e){return l(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(i.pluginStatus!=="loading")return this.setState(i),i;const n=i.pluginURL,s=new Promise((f=>{this.loadScriptResolve=f}));e(n);const u=new Promise((f=>setTimeout((()=>f()),this.TIMEOUT)));if(yield Promise.race([s,u]),this.isParsed()){const f={pluginStatus:"loaded",pluginURL:n};return this.setState(f),f}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}))}};class On{constructor(e,n){this.isSupportedScript=hd,this.zoom=e,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new hh,this.transition=n.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new hh,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),s=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*n}}}function hd(i){return(function(e,n){for(const s of e)if(!Ro(s.codePointAt(0),n))return!1;return!0})(i,za.getRTLTextPluginStatus()==="loaded")}const Qo="-transition";class Rs{constructor(e,n,s){this.property=e,this.value=n,this.expression=(function(u,f,m){if(th(u))return new ll(u,f);if(Ms(u)){const v=zs(u,f,m);if(v.result==="error")throw new Error(v.value.map((w=>`${w.key}: ${w.message}`)).join(", "));return v.value}{let v=u;return f.type==="color"&&typeof u=="string"?v=sn.parse(u):f.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?f.type!=="numberArray"||typeof u!="number"&&!Array.isArray(u)?f.type!=="colorArray"||typeof u!="string"&&!Array.isArray(u)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?v=wi.parse(u):f.type==="projectionDefinition"&&typeof u=="string"&&(v=tr.parse(u)):v=Yt.parse(u):v=si.parse(u):v=Ni.parse(u),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>v}}})(n===void 0?e.specification.default:n,e.specification,s)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,n,s){return this.property.possiblyEvaluate(this,e,n,s)}}class gu{constructor(e,n){this.property=e,this.value=new Rs(e,void 0,n)}transitioned(e,n){return new dl(this.property,this.value,n,fn({},e.transition,this.transition),e.now)}untransitioned(){return new dl(this.property,this.value,null,{},0)}}class ph{constructor(e,n){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=n}getValue(e){return vi(this._values[e].value.value)}setValue(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new gu(this._values[e].property,this._globalState)),this._values[e].value=new Rs(this._values[e].property,n===null?void 0:vi(n),this._globalState)}getTransition(e){return vi(this._values[e].transition)}setTransition(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new gu(this._values[e].property,this._globalState)),this._values[e].transition=vi(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);s!==void 0&&(e[n]=s);const u=this.getTransition(n);u!==void 0&&(e[`${n}${Qo}`]=u)}return e}transitioned(e,n){const s=new _u(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(e,n._values[u]);return s}untransitioned(){const e=new _u(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class dl{constructor(e,n,s,u,f){this.property=e,this.value=n,this.begin=f+u.delay||0,this.end=this.begin+u.duration||0,e.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(e,n,s){const u=e.now||0,f=this.value.possiblyEvaluate(e,n,s),m=this.prior;if(m){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return m.possiblyEvaluate(e,n,s);{const v=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,n,s),f,Tt(v))}}return f}}class _u{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,s){const u=new fl(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,n,s);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class dd{constructor(e,n){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=n}hasValue(e){return this._values[e].value!==void 0}getValue(e){return vi(this._values[e].value)}setValue(e,n){this._values[e]=new Rs(this._values[e].property,n===null?void 0:vi(n),this._globalState)}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);s!==void 0&&(e[n]=s)}return e}possiblyEvaluate(e,n,s){const u=new fl(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,n,s);return u}}class ha{constructor(e,n,s){this.property=e,this.value=n,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,s,u){return this.property.evaluate(this.value,this.parameters,e,n,s,u)}}class fl{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Dt{constructor(e){this.specification=e}possiblyEvaluate(e,n){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(n)}interpolate(e,n,s){const u=ci[this.specification.type];return u?u(e,n,s):e}}class Bt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,s,u){return new ha(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},s,u)}:e.expression,n)}interpolate(e,n,s){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new ha(this,{kind:"constant",value:void 0},e.parameters);const u=ci[this.specification.type];if(u){const f=u(e.value.value,n.value.value,s);return new ha(this,{kind:"constant",value:f},e.parameters)}return e}evaluate(e,n,s,u,f,m){return e.kind==="constant"?e.value:e.evaluate(n,s,u,f,m)}}class Da extends Bt{possiblyEvaluate(e,n,s,u){if(e.value===void 0)return new ha(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const f=e.expression.evaluate(n,null,{},s,u),m=e.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,v=this._calculate(m,m,m,n);return new ha(this,{kind:"constant",value:v},n)}if(e.expression.kind==="camera"){const f=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new ha(this,{kind:"constant",value:f},n)}return new ha(this,e.expression,n)}evaluate(e,n,s,u,f,m){if(e.kind==="source"){const v=e.evaluate(n,s,u,f,m);return this._calculate(v,v,v,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},s,u),e.evaluate({zoom:Math.floor(n.zoom)},s,u),e.evaluate({zoom:Math.floor(n.zoom)+1},s,u),n):e.value}_calculate(e,n,s,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:s,to:n}}interpolate(e){return e}}class uc{constructor(e){this.specification=e}possiblyEvaluate(e,n,s,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const f=e.expression.evaluate(n,null,{},s,u);return this._calculate(f,f,f,n)}return this._calculate(e.expression.evaluate(new On(Math.floor(n.zoom-1),n)),e.expression.evaluate(new On(Math.floor(n.zoom),n)),e.expression.evaluate(new On(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,s,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:s,to:n}}interpolate(e){return e}}class yu{constructor(e){this.specification=e}possiblyEvaluate(e,n,s,u){return!!e.expression.evaluate(n,null,{},s,u)}interpolate(){return!1}}class Li{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const s=e[n];s.specification.overridable&&this.overridableProperties.push(n);const u=this.defaultPropertyValues[n]=new Rs(s,void 0,void 0),f=this.defaultTransitionablePropertyValues[n]=new gu(s,void 0);this.defaultTransitioningPropertyValues[n]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=u.possiblyEvaluate({})}}}zt("DataDrivenProperty",Bt),zt("DataConstantProperty",Dt),zt("CrossFadedDataDrivenProperty",Da),zt("CrossFadedProperty",uc),zt("ColorRampProperty",yu);class gi extends ht{constructor(e,n,s){if(super(),this.id=e.id,this.type=e.type,this._globalState=s,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(u,f){return new lc(u,f)})(this.visibility,s),e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=Ur(e.filter,s)),n.layout&&(this._unevaluatedLayout=new dd(n.layout,s)),n.paint)){this._transitionablePaint=new ph(n.paint,s);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fl(n.paint)}}setFilter(e){this.filter=e,this._featureFilter=Ur(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;for(const n of this._visibilityExpression.getGlobalStateRefs())e.add(n);if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const s=this._unevaluatedLayout._values[n];for(const u of s.getGlobalStateRefs())e.add(u)}for(const n of this._featureFilter.getGlobalStateRefs())e.add(n);return e}getPaintAffectingGlobalStateRefs(){var e;const n=new globalThis.Map;if(this._transitionablePaint)for(const s in this._transitionablePaint._values){const u=this._transitionablePaint._values[s].value;for(const f of u.getGlobalStateRefs()){const m=(e=n.get(f))!==null&&e!==void 0?e:[];m.push({name:s,value:u.value}),n.set(f,m)}}return n}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(e,n,s={}){if(n==null||!this._validate(Rf,`layers.${this.id}.layout.${e}`,e,n,s))return e==="visibility"?(this.visibility=n,this._visibilityExpression.setValue(n),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(e,n)}getPaintProperty(e){return e.endsWith(Qo)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,s={}){if(n!=null&&this._validate(ch,`layers.${this.id}.paint.${e}`,e,n,s))return!1;if(e.endsWith(Qo))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.property.specification["property-type"]==="cross-faded-data-driven",m=u.value.isDataDriven(),v=u.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value;return w.isDataDriven()||m||f||this._handleOverridablePaintPropertyUpdate(e,v,w)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,n,s){return!1}isHidden(e=this.minzoom,n=!1){return!!(this.minzoom&&e<(n?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Fn(e,((n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length)))}_validate(e,n,s,u,f={}){return(!f||f.validate!==!1)&&Ya(this,e.call(ir,{key:n,layerType:this.type,objectKey:s,value:u,styleSpec:Me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof ha&&Ca(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}let Ti;var vu={get paint(){return Ti=Ti||new Li({"raster-opacity":new Dt(Me.paint_raster["raster-opacity"]),"raster-hue-rotate":new Dt(Me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Dt(Me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Dt(Me.paint_raster["raster-brightness-max"]),"raster-saturation":new Dt(Me.paint_raster["raster-saturation"]),"raster-contrast":new Dt(Me.paint_raster["raster-contrast"]),"raster-resampling":new Dt(Me.paint_raster["raster-resampling"]),"raster-fade-duration":new Dt(Me.paint_raster["raster-fade-duration"])})}};class Jo extends gi{constructor(e,n){super(e,vu,n)}}const dn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class In{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class hn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ui(i,e=1){let n=0,s=0;return{members:i.map((u=>{const f=dn[u.type].BYTES_PER_ELEMENT,m=n=Pa(n,Math.max(e,f)),v=u.components||1;return s=Math.max(s,f),n+=f*v,{name:u.name,type:u.type,components:v,offset:m}})),size:Pa(n,Math.max(s,e)),alignment:e}}function Pa(i,e){return Math.ceil(i/e)*e}class Ka extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const u=2*e;return this.int16[u+0]=n,this.int16[u+1]=s,e}}Ka.prototype.bytesPerElement=4,zt("StructArrayLayout2i4",Ka);class pl extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,s)}emplace(e,n,s,u){const f=3*e;return this.int16[f+0]=n,this.int16[f+1]=s,this.int16[f+2]=u,e}}pl.prototype.bytesPerElement=6,zt("StructArrayLayout3i6",pl);class ml extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,s,u)}emplace(e,n,s,u,f){const m=4*e;return this.int16[m+0]=n,this.int16[m+1]=s,this.int16[m+2]=u,this.int16[m+3]=f,e}}ml.prototype.bytesPerElement=8,zt("StructArrayLayout4i8",ml);class es extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,s,u,f,m)}emplace(e,n,s,u,f,m,v){const w=6*e;return this.int16[w+0]=n,this.int16[w+1]=s,this.int16[w+2]=u,this.int16[w+3]=f,this.int16[w+4]=m,this.int16[w+5]=v,e}}es.prototype.bytesPerElement=12,zt("StructArrayLayout2i4i12",es);class fd extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,s,u,f,m)}emplace(e,n,s,u,f,m,v){const w=4*e,A=8*e;return this.int16[w+0]=n,this.int16[w+1]=s,this.uint8[A+4]=u,this.uint8[A+5]=f,this.uint8[A+6]=m,this.uint8[A+7]=v,e}}fd.prototype.bytesPerElement=8,zt("StructArrayLayout2i4ub8",fd);class ri extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const u=2*e;return this.float32[u+0]=n,this.float32[u+1]=s,e}}ri.prototype.bytesPerElement=8,zt("StructArrayLayout2f8",ri);class Qa extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m,v,w,A,P){const O=this.length;return this.resize(O+1),this.emplace(O,e,n,s,u,f,m,v,w,A,P)}emplace(e,n,s,u,f,m,v,w,A,P,O){const B=10*e;return this.uint16[B+0]=n,this.uint16[B+1]=s,this.uint16[B+2]=u,this.uint16[B+3]=f,this.uint16[B+4]=m,this.uint16[B+5]=v,this.uint16[B+6]=w,this.uint16[B+7]=A,this.uint16[B+8]=P,this.uint16[B+9]=O,e}}Qa.prototype.bytesPerElement=20,zt("StructArrayLayout10ui20",Qa);class hc extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m,v,w){const A=this.length;return this.resize(A+1),this.emplace(A,e,n,s,u,f,m,v,w)}emplace(e,n,s,u,f,m,v,w,A){const P=8*e;return this.uint16[P+0]=n,this.uint16[P+1]=s,this.uint16[P+2]=u,this.uint16[P+3]=f,this.uint16[P+4]=m,this.uint16[P+5]=v,this.uint16[P+6]=w,this.uint16[P+7]=A,e}}hc.prototype.bytesPerElement=16,zt("StructArrayLayout8ui16",hc);class dc extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m,v,w,A,P,O,B){const F=this.length;return this.resize(F+1),this.emplace(F,e,n,s,u,f,m,v,w,A,P,O,B)}emplace(e,n,s,u,f,m,v,w,A,P,O,B,F){const G=12*e;return this.int16[G+0]=n,this.int16[G+1]=s,this.int16[G+2]=u,this.int16[G+3]=f,this.uint16[G+4]=m,this.uint16[G+5]=v,this.uint16[G+6]=w,this.uint16[G+7]=A,this.int16[G+8]=P,this.int16[G+9]=O,this.int16[G+10]=B,this.int16[G+11]=F,e}}dc.prototype.bytesPerElement=24,zt("StructArrayLayout4i4ui4i24",dc);class xu extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,s)}emplace(e,n,s,u){const f=3*e;return this.float32[f+0]=n,this.float32[f+1]=s,this.float32[f+2]=u,e}}xu.prototype.bytesPerElement=12,zt("StructArrayLayout3f12",xu);class bu extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}bu.prototype.bytesPerElement=4,zt("StructArrayLayout1ul4",bu);class wu extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m,v,w,A){const P=this.length;return this.resize(P+1),this.emplace(P,e,n,s,u,f,m,v,w,A)}emplace(e,n,s,u,f,m,v,w,A,P){const O=10*e,B=5*e;return this.int16[O+0]=n,this.int16[O+1]=s,this.int16[O+2]=u,this.int16[O+3]=f,this.int16[O+4]=m,this.int16[O+5]=v,this.uint32[B+3]=w,this.uint16[O+8]=A,this.uint16[O+9]=P,e}}wu.prototype.bytesPerElement=20,zt("StructArrayLayout6i1ul2ui20",wu);class Is extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,s,u,f,m)}emplace(e,n,s,u,f,m,v){const w=6*e;return this.int16[w+0]=n,this.int16[w+1]=s,this.int16[w+2]=u,this.int16[w+3]=f,this.int16[w+4]=m,this.int16[w+5]=v,e}}Is.prototype.bytesPerElement=12,zt("StructArrayLayout2i2i2i12",Is);class ts extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,s,u,f)}emplace(e,n,s,u,f,m){const v=4*e,w=8*e;return this.float32[v+0]=n,this.float32[v+1]=s,this.float32[v+2]=u,this.int16[w+6]=f,this.int16[w+7]=m,e}}ts.prototype.bytesPerElement=16,zt("StructArrayLayout2f1f2i16",ts);class _r extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,s,u,f,m)}emplace(e,n,s,u,f,m,v){const w=16*e,A=4*e,P=8*e;return this.uint8[w+0]=n,this.uint8[w+1]=s,this.float32[A+1]=u,this.float32[A+2]=f,this.int16[P+6]=m,this.int16[P+7]=v,e}}_r.prototype.bytesPerElement=16,zt("StructArrayLayout2ub2f2i16",_r);class hi extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,s)}emplace(e,n,s,u){const f=3*e;return this.uint16[f+0]=n,this.uint16[f+1]=s,this.uint16[f+2]=u,e}}hi.prototype.bytesPerElement=6,zt("StructArrayLayout3ui6",hi);class Io extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m,v,w,A,P,O,B,F,G,q,Z,J){const de=this.length;return this.resize(de+1),this.emplace(de,e,n,s,u,f,m,v,w,A,P,O,B,F,G,q,Z,J)}emplace(e,n,s,u,f,m,v,w,A,P,O,B,F,G,q,Z,J,de){const te=24*e,re=12*e,pe=48*e;return this.int16[te+0]=n,this.int16[te+1]=s,this.uint16[te+2]=u,this.uint16[te+3]=f,this.uint32[re+2]=m,this.uint32[re+3]=v,this.uint32[re+4]=w,this.uint16[te+10]=A,this.uint16[te+11]=P,this.uint16[te+12]=O,this.float32[re+7]=B,this.float32[re+8]=F,this.uint8[pe+36]=G,this.uint8[pe+37]=q,this.uint8[pe+38]=Z,this.uint32[re+10]=J,this.int16[te+22]=de,e}}Io.prototype.bytesPerElement=48,zt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Io);class gl extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u,f,m,v,w,A,P,O,B,F,G,q,Z,J,de,te,re,pe,ve,Ne,nt,et,st,wt,mt){const Je=this.length;return this.resize(Je+1),this.emplace(Je,e,n,s,u,f,m,v,w,A,P,O,B,F,G,q,Z,J,de,te,re,pe,ve,Ne,nt,et,st,wt,mt)}emplace(e,n,s,u,f,m,v,w,A,P,O,B,F,G,q,Z,J,de,te,re,pe,ve,Ne,nt,et,st,wt,mt,Je){const He=32*e,Mt=16*e;return this.int16[He+0]=n,this.int16[He+1]=s,this.int16[He+2]=u,this.int16[He+3]=f,this.int16[He+4]=m,this.int16[He+5]=v,this.int16[He+6]=w,this.int16[He+7]=A,this.uint16[He+8]=P,this.uint16[He+9]=O,this.uint16[He+10]=B,this.uint16[He+11]=F,this.uint16[He+12]=G,this.uint16[He+13]=q,this.uint16[He+14]=Z,this.uint16[He+15]=J,this.uint16[He+16]=de,this.uint16[He+17]=te,this.uint16[He+18]=re,this.uint16[He+19]=pe,this.uint16[He+20]=ve,this.uint16[He+21]=Ne,this.uint16[He+22]=nt,this.uint32[Mt+12]=et,this.float32[Mt+13]=st,this.float32[Mt+14]=wt,this.uint16[He+30]=mt,this.uint16[He+31]=Je,e}}gl.prototype.bytesPerElement=64,zt("StructArrayLayout8i15ui1ul2f2ui64",gl);class _l extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}_l.prototype.bytesPerElement=4,zt("StructArrayLayout1f4",_l);class fc extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,s)}emplace(e,n,s,u){const f=3*e;return this.uint16[6*e+0]=n,this.float32[f+1]=s,this.float32[f+2]=u,e}}fc.prototype.bytesPerElement=12,zt("StructArrayLayout1ui2f12",fc);class Ja extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,s)}emplace(e,n,s,u){const f=4*e;return this.uint32[2*e+0]=n,this.uint16[f+2]=s,this.uint16[f+3]=u,e}}Ja.prototype.bytesPerElement=8,zt("StructArrayLayout1ul2ui8",Ja);class g extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const u=2*e;return this.uint16[u+0]=n,this.uint16[u+1]=s,e}}g.prototype.bytesPerElement=4,zt("StructArrayLayout2ui4",g);class t extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}t.prototype.bytesPerElement=2,zt("StructArrayLayout1ui2",t);class a extends hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,s,u)}emplace(e,n,s,u,f){const m=4*e;return this.float32[m+0]=n,this.float32[m+1]=s,this.float32[m+2]=u,this.float32[m+3]=f,e}}a.prototype.bytesPerElement=16,zt("StructArrayLayout4f16",a);class c extends In{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new N(this.anchorPointX,this.anchorPointY)}}c.prototype.size=20;class d extends wu{get(e){return new c(this,e)}}zt("CollisionBoxArray",d);class y extends In{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}y.prototype.size=48;class x extends Io{get(e){return new y(this,e)}}zt("PlacedSymbolArray",x);class C extends In{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}C.prototype.size=64;class z extends gl{get(e){return new C(this,e)}}zt("SymbolInstanceArray",z);class L extends _l{getoffsetX(e){return this.float32[1*e+0]}}zt("GlyphOffsetArray",L);class k extends pl{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}zt("SymbolLineVertexArray",k);class V extends In{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}V.prototype.size=12;class j extends fc{get(e){return new V(this,e)}}zt("TextAnchorOffsetArray",j);class $ extends In{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}$.prototype.size=8;class W extends Ja{get(e){return new $(this,e)}}zt("FeatureIndexArray",W);class ae extends Ka{}class se extends Ka{}class oe extends Ka{}class fe extends es{}class ye extends fd{}class he extends ri{}class _e extends Qa{}class we extends hc{}class ge extends dc{}class Ae extends xu{}class Ge extends bu{}class Fe extends Is{}class je extends _r{}class Ve extends hi{}class vt extends g{}const xt=ui([{name:"a_pos",components:2,type:"Int16"}],4),{members:ct}=xt;class St{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,n,s,u){const f=this.segments[this.segments.length-1];return e>St.MAX_VERTEX_ARRAY_LENGTH&&Pn(`Max vertices per segment is ${St.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${St.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!f||f.vertexLength+e>St.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u?this.createNewSegment(n,s,u):f}createNewSegment(e,n,s){const u={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return s!==void 0&&(u.sortKey=s),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(u),u}getOrCreateLatestSegment(e,n,s){return this.prepareSegment(0,e,n,s)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,s,u){return new St([{vertexOffset:e,primitiveOffset:n,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}function en(i,e){return 256*(i=Nt(Math.floor(i),0,255))+Nt(Math.floor(e),0,255)}St.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zt("SegmentVector",St);const Ln=ui([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Jn=ui([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Yn,ai,Vn,_i={exports:{}},oi={exports:{}},sr={exports:{}},Ei=(function(){if(Vn)return _i.exports;Vn=1;var i=(Yn||(Yn=1,oi.exports=function(n,s){var u,f,m,v,w,A,P,O;for(f=n.length-(u=3&n.length),m=s,w=3432918353,A=461845907,O=0;O<f;)P=255&n.charCodeAt(O)|(255&n.charCodeAt(++O))<<8|(255&n.charCodeAt(++O))<<16|(255&n.charCodeAt(++O))<<24,++O,m=27492+(65535&(v=5*(65535&(m=(m^=P=(65535&(P=(P=(65535&P)*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*A+(((P>>>16)*A&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(P=0,u){case 3:P^=(255&n.charCodeAt(O+2))<<16;case 2:P^=(255&n.charCodeAt(O+1))<<8;case 1:m^=P=(65535&(P=(P=(65535&(P^=255&n.charCodeAt(O)))*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*A+(((P>>>16)*A&65535)<<16)&4294967295}return m^=n.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}),oi.exports),e=(ai||(ai=1,sr.exports=function(n,s){for(var u,f=n.length,m=s^f,v=0;f>=4;)u=1540483477*(65535&(u=255&n.charCodeAt(v)|(255&n.charCodeAt(++v))<<8|(255&n.charCodeAt(++v))<<16|(255&n.charCodeAt(++v))<<24))+((1540483477*(u>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++v;switch(f){case 3:m^=(255&n.charCodeAt(v+2))<<16;case 2:m^=(255&n.charCodeAt(v+1))<<8;case 1:m=1540483477*(65535&(m^=255&n.charCodeAt(v)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}),sr.exports);return _i.exports=i,_i.exports.murmur3=i,_i.exports.murmur2=e,_i.exports})(),Ci=X(Ei);class lr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,s,u){this.ids.push(Lo(e)),this.positions.push(n,s,u)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Lo(e);let s=0,u=this.ids.length-1;for(;s<u;){const m=s+u>>1;this.ids[m]>=n?u=m:s=m+1}const f=[];for(;this.ids[s]===n;)f.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return f}static serialize(e,n){const s=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Oo(s,u,0,s.length-1),n&&n.push(s.buffer,u.buffer),{ids:s,positions:u}}static deserialize(e){const n=new lr;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function Lo(i){const e=+i;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ci(String(i))}function Oo(i,e,n,s){for(;n<s;){const u=i[n+s>>1];let f=n-1,m=s+1;for(;;){do f++;while(i[f]<u);do m--;while(i[m]>u);if(f>=m)break;eo(i,f,m),eo(e,3*f,3*m),eo(e,3*f+1,3*m+1),eo(e,3*f+2,3*m+2)}m-n<s-m?(Oo(i,e,n,m),n=m+1):(Oo(i,e,m+1,s),s=m)}}function eo(i,e,n){const s=i[e];i[e]=i[n],i[n]=s}zt("FeaturePositionMap",lr);class Zr{constructor(e,n){this.gl=e.gl,this.location=n}}class yl extends Zr{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class pc extends Zr{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class to extends Zr{constructor(e,n){super(e,n),this.current=sn.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Hr=new Float32Array(16);function da(i){return[en(255*i.r,255*i.g),en(255*i.b,255*i.a)]}class Ra{constructor(e,n,s){this.value=e,this.uniformNames=n.map((u=>`u_${u}`)),this.type=s}setUniform(e,n,s){e.set(s.constantOr(this.value))}getBinding(e,n,s){return this.type==="color"?new to(e,n):new yl(e,n)}}class Ia{constructor(e,n){this.uniformNames=n.map((s=>`u_${s}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,n){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,n.y,n.height,n.width]}setUniform(e,n,s,u){let f=null;u==="u_pattern_to"?f=this.patternTo:u==="u_pattern_from"?f=this.patternFrom:u==="u_dasharray_to"?f=this.dashTo:u==="u_dasharray_from"?f=this.dashFrom:u==="u_pixel_ratio_to"?f=this.pixelRatioTo:u==="u_pixel_ratio_from"&&(f=this.pixelRatioFrom),f!==null&&e.set(f)}getBinding(e,n,s){return s.substr(0,9)==="u_pattern"||s.substr(0,12)==="u_dasharray_"?new pc(e,n):new yl(e,n)}}class kn{constructor(e,n,s,u){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=n.map((f=>({name:`a_${f}`,type:"Float32",components:s==="color"?2:1,offset:0}))),this.paintVertexArray=new u}populatePaintArray(e,n,s){const u=this.paintVertexArray.length,f=this.expression.evaluate(new On(0,s),n,{},s.canonical,[],s.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(u,e,f)}updatePaintArray(e,n,s,u,f){const m=this.expression.evaluate(new On(0,f),s,u);this._setPaintValue(e,n,m)}_setPaintValue(e,n,s){if(this.type==="color"){const u=da(s);for(let f=e;f<n;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<n;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wn{constructor(e,n,s,u,f,m){this.expression=e,this.uniformNames=n.map((v=>`u_${v}_t`)),this.type=s,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=n.map((v=>({name:`a_${v}`,type:"Float32",components:s==="color"?4:2,offset:0}))),this.paintVertexArray=new m}populatePaintArray(e,n,s){const u=this.expression.evaluate(new On(this.zoom,s),n,{},s.canonical,[],s.formattedSection),f=this.expression.evaluate(new On(this.zoom+1,s),n,{},s.canonical,[],s.formattedSection),m=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(m,e,u,f)}updatePaintArray(e,n,s,u,f){const m=this.expression.evaluate(new On(this.zoom,f),s,u),v=this.expression.evaluate(new On(this.zoom+1,f),s,u);this._setPaintValue(e,n,m,v)}_setPaintValue(e,n,s,u){if(this.type==="color"){const f=da(s),m=da(u);for(let v=e;v<n;v++)this.paintVertexArray.emplace(v,f[0],f[1],m[0],m[1])}else{for(let f=e;f<n;f++)this.paintVertexArray.emplace(f,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const s=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,u=Nt(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);e.set(u)}getBinding(e,n,s){return new yl(e,n)}}class Vi{constructor(e,n,s,u,f,m){this.expression=e,this.type=n,this.useIntegerZoom=s,this.zoom=u,this.layerId=m,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f}populatePaintArray(e,n,s){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,this.getPositionIds(n),s)}updatePaintArray(e,n,s,u,f){this._setPaintValues(e,n,this.getPositionIds(s),f)}_setPaintValues(e,n,s,u){const f=this.getPositions(u);if(!f||!s)return;const m=f[s.min],v=f[s.mid],w=f[s.max];if(m&&v&&w)for(let A=e;A<n;A++)this.emplace(this.zoomInPaintVertexArray,A,v,m),this.emplace(this.zoomOutPaintVertexArray,A,v,w)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const n=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,n,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,n,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ki extends Vi{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return Ln.members}emplace(e,n,s,u){e.emplace(n,s.tlbr[0],s.tlbr[1],s.tlbr[2],s.tlbr[3],u.tlbr[0],u.tlbr[1],u.tlbr[2],u.tlbr[3],s.pixelRatio,u.pixelRatio)}}class mh extends Vi{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return Jn.members}emplace(e,n,s,u){e.emplace(n,0,s.y,s.height,s.width,0,u.y,u.height,u.width)}}class gh{constructor(e,n,s){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!s(f))continue;const m=e.paint.get(f);if(!(m instanceof ha&&Ca(m.property.specification)))continue;const v=If(f,e.type),w=m.value,A=m.property.specification.type,P=m.property.useIntegerZoom,O=m.property.specification["property-type"],B=O==="cross-faded"||O==="cross-faded-data-driven";if(w.kind==="constant")this.binders[f]=B?new Ia(w.value,v):new Ra(w.value,v,A),u.push(`/u_${f}`);else if(w.kind==="source"||B){const F=Os(f,A,"source");this.binders[f]=B?f==="line-dasharray"?new mh(w,A,P,n,F,e.id):new Ki(w,A,P,n,F,e.id):new kn(w,v,A,F),u.push(`/a_${f}`)}else{const F=Os(f,A,"composite");this.binders[f]=new Wn(w,v,A,P,n,F),u.push(`/z_${f}`)}}this.cacheKey=u.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof kn||n instanceof Wn?n.maxValue:0}populatePaintArrays(e,n,s){for(const u in this.binders){const f=this.binders[u];(f instanceof kn||f instanceof Wn||f instanceof Vi)&&f.populatePaintArray(e,n,s)}}setConstantPatternPositions(e,n){for(const s in this.binders){const u=this.binders[s];u instanceof Ia&&u.setConstantPatternPositions(e,n)}}setConstantDashPositions(e,n){for(const s in this.binders){const u=this.binders[s];u instanceof Ia&&u.setConstantDashPositions(e,n)}}updatePaintArrays(e,n,s,u,f){let m=!1;for(const v in e){const w=n.getPositions(v);for(const A of w){const P=s.feature(A.index);for(const O in this.binders){const B=this.binders[O];if((B instanceof kn||B instanceof Wn||B instanceof Vi)&&B.expression.isStateDependent===!0){const F=u.paint.get(O);B.expression=F.value,B.updatePaintArray(A.start,A.end,P,e[v],f),m=!0}}}}return m}defines(){const e=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Ra||s instanceof Ia)&&e.push(...s.uniformNames.map((u=>`#define HAS_UNIFORM_${u}`)))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof kn||s instanceof Wn)for(let u=0;u<s.paintVertexAttributes.length;u++)e.push(s.paintVertexAttributes[u].name);else if(s instanceof Vi){const u=s.getVertexAttributes();for(const f of u)e.push(f.name)}}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof Ra||s instanceof Ia||s instanceof Wn)for(const u of s.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Ra||f instanceof Ia||f instanceof Wn){for(const m of f.uniformNames)if(n[m]){const v=f.getBinding(e,n[m],m);s.push({name:m,property:u,binding:v})}}}return s}setUniforms(e,n,s,u){for(const{name:f,property:m,binding:v}of n)this.binders[m].setUniform(v,u,s.get(m),f)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const s=this.binders[n];if(e&&s instanceof Vi){const u=e.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(s instanceof kn||s instanceof Wn)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(e){for(const n in this.binders){const s=this.binders[n];(s instanceof kn||s instanceof Wn||s instanceof Vi)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof kn||n instanceof Wn||n instanceof Vi)&&n.destroy()}}}class Ls{constructor(e,n,s=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new gh(u,n,s);this.needsUpload=!1,this._featureMap=new lr,this._bufferOffset=0}populatePaintArrays(e,n,s,u){for(const f in this.programConfigurations)this.programConfigurations[f].populatePaintArrays(e,n,u);n.id!==void 0&&this._featureMap.add(n.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,s,u){for(const f of s)this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(e,this._featureMap,n,f,u)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function If(i,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}function Os(i,e,n){const s={color:{source:ri,composite:a},number:{source:_l,composite:ri}},u=(function(f){return{"line-pattern":{source:_e,composite:_e},"fill-pattern":{source:_e,composite:_e},"fill-extrusion-pattern":{source:_e,composite:_e},"line-dasharray":{source:we,composite:we}}[f]})(i);return u&&u[n]||s[e][n]}zt("ConstantBinder",Ra),zt("CrossFadedConstantBinder",Ia),zt("SourceExpressionBinder",kn),zt("CrossFadedPatternBinder",Ki),zt("CrossFadedDasharrayBinder",mh),zt("CompositeExpressionBinder",Wn),zt("ProgramConfiguration",gh,{omit:["_buffers"]}),zt("ProgramConfigurationSet",Ls);const _h=Math.pow(2,14)-1,ns=-_h-1;function is(i){const e=yt/i.extent,n=i.loadGeometry();for(let s=0;s<n.length;s++){const u=n[s];for(let f=0;f<u.length;f++){const m=u[f],v=Math.round(m.x*e),w=Math.round(m.y*e);m.x=Nt(v,ns,_h),m.y=Nt(w,ns,_h),(v<m.x||v>m.x+1||w<m.y||w>m.y+1)&&Pn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function no(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?is(i):[]}}const yh=-32768;function Su(i,e,n,s,u){i.emplaceBack(yh+8*e+s,yh+8*n+u)}class Tu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new se,this.indexArray=new Ve,this.segments=new St,this.programConfigurations=new Ls(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,s){const u=this.layers[0],f=[];let m=null,v=!1,w=u.type==="heatmap";if(u.type==="circle"){const P=u;m=P.layout.get("circle-sort-key"),v=!m.isConstant(),w=w||P.paint.get("circle-pitch-alignment")==="map"}const A=w?n.subdivisionGranularity.circle:1;for(const{feature:P,id:O,index:B,sourceLayerIndex:F}of e){const G=this.layers[0]._featureFilter.needGeometry,q=no(P,G);if(!this.layers[0]._featureFilter.filter(new On(this.zoom),q,s))continue;const Z=v?m.evaluate(q,{},s):void 0,J={id:O,properties:P.properties,type:P.type,sourceLayerIndex:F,index:B,geometry:G?q.geometry:is(P),patterns:{},sortKey:Z};f.push(J)}v&&f.sort(((P,O)=>P.sortKey-O.sortKey));for(const P of f){const{geometry:O,index:B,sourceLayerIndex:F}=P,G=e[B].feature;this.addFeature(P,O,B,s,A),n.featureIndex.insert(G,O,B,F,this.index)}}update(e,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:s})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ct),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,s,u,f=1){let m;switch(f){case 1:m=[0,7];break;case 3:m=[0,2,5,7];break;case 5:m=[0,1,3,4,6,7];break;case 7:m=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${f}; valid values are 1, 3, 5, 7.`)}const v=m.length;for(const w of n)for(const A of w){const P=A.x,O=A.y;if(P<0||P>=yt||O<0||O>=yt)continue;const B=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,e.sortKey),F=B.vertexLength;for(let G=0;G<v;G++)for(let q=0;q<v;q++)Su(this.layoutVertexArray,P,O,m[q],m[G]);for(let G=0;G<v-1;G++)for(let q=0;q<v-1;q++){const Z=F+G*v+q,J=F+(G+1)*v+q;this.indexArray.emplaceBack(Z,J+1,Z+1),this.indexArray.emplaceBack(Z,J,J+1)}B.vertexLength+=v*v,B.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{imagePositions:{},canonical:u})}}function Eu(i,e){for(let n=0;n<i.length;n++)if(ks(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(ks(i,e[n]))return!0;return!!yr(i,e)}function Lf(i,e,n){return!!ks(i,e)||!!kf(e,i,n)}function Of(i,e){if(i.length===1)return am(e,i[0]);for(let n=0;n<e.length;n++){const s=e[n];for(let u=0;u<s.length;u++)if(ks(i,s[u]))return!0}for(let n=0;n<i.length;n++)if(am(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(yr(i,e[n]))return!0;return!1}function cr(i,e,n){if(i.length>1){if(yr(i,e))return!0;for(let s=0;s<e.length;s++)if(kf(e[s],i,n))return!0}for(let s=0;s<i.length;s++)if(kf(i[s],e,n))return!0;return!1}function yr(i,e){if(i.length===0||e.length===0)return!1;for(let n=0;n<i.length-1;n++){const s=i[n],u=i[n+1];for(let f=0;f<e.length-1;f++)if(Sg(s,u,e[f],e[f+1]))return!0}return!1}function Sg(i,e,n,s){return Zi(i,n,s)!==Zi(e,n,s)&&Zi(i,e,n)!==Zi(i,e,s)}function kf(i,e,n){const s=n*n;if(e.length===1)return i.distSqr(e[0])<s;for(let u=1;u<e.length;u++)if(rm(i,e[u-1],e[u])<s)return!0;return!1}function rm(i,e,n){const s=e.distSqr(n);if(s===0)return i.distSqr(e);const u=((i.x-e.x)*(n.x-e.x)+(i.y-e.y)*(n.y-e.y))/s;return i.distSqr(u<0?e:u>1?n:n.sub(e)._mult(u)._add(e))}function am(i,e){let n,s,u,f=!1;for(let m=0;m<i.length;m++){n=i[m];for(let v=0,w=n.length-1;v<n.length;w=v++)s=n[v],u=n[w],s.y>e.y!=u.y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(f=!f)}return f}function ks(i,e){let n=!1;for(let s=0,u=i.length-1;s<i.length;u=s++){const f=i[s],m=i[u];f.y>e.y!=m.y>e.y&&e.x<(m.x-f.x)*(e.y-f.y)/(m.y-f.y)+f.x&&(n=!n)}return n}function Tg(i,e,n){const s=n[0],u=n[2];if(i.x<s.x&&e.x<s.x||i.x>u.x&&e.x>u.x||i.y<s.y&&e.y<s.y||i.y>u.y&&e.y>u.y)return!1;const f=Zi(i,e,n[0]);return f!==Zi(i,e,n[1])||f!==Zi(i,e,n[2])||f!==Zi(i,e,n[3])}function vl(i,e,n){const s=e.paint.get(i).value;return s.kind==="constant"?s.value:n.programConfigurations.get(e.id).getMaxValue(i)}function pd(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Bf(i,e,n,s,u){if(!e[0]&&!e[1])return i;const f=N.convert(e)._mult(u);n==="viewport"&&f._rotate(-s);const m=[];for(let v=0;v<i.length;v++)m.push(i[v].sub(f));return m}function Ff(i){const e=[];for(let n=0;n<i.length;n++){const s=i[n],u=e.at(-1);(n===0||u&&!s.equals(u))&&e.push(s)}return e}function om({queryGeometry:i,size:e},n){return Lf(i,n,e)}function Eg({queryGeometry:i,size:e,transform:n,unwrappedTileID:s,getElevation:u},f){return Lf(i,f,e*(n.projectTileCoordinates(f.x,f.y,s,u).signedDistanceFromCamera/n.cameraToCenterDistance))}function Cg({queryGeometry:i,size:e,transform:n,unwrappedTileID:s,getElevation:u},f){const m=n.projectTileCoordinates(f.x,f.y,s,u).signedDistanceFromCamera,v=e*(n.cameraToCenterDistance/m);return Lf(i,md(f,n,s,u),v)}function Mg({queryGeometry:i,size:e,transform:n,unwrappedTileID:s,getElevation:u},f){return Lf(i,md(f,n,s,u),e)}function Nf({queryGeometry:i,size:e,transform:n,unwrappedTileID:s,getElevation:u,pitchAlignment:f="map",pitchScale:m="map"},v){const w=f==="map"?m==="map"?om:Eg:m==="map"?Cg:Mg,A={queryGeometry:i,size:e,transform:n,unwrappedTileID:s,getElevation:u};for(const P of v)for(const O of P)if(w(A,O))return!0;return!1}function md(i,e,n,s){const u=e.projectTileCoordinates(i.x,i.y,n,s).point;return new N((.5*u.x+.5)*e.width,(.5*-u.y+.5)*e.height)}let jf,sm;zt("CircleBucket",Tu,{omit:["layers"]});var lm={get paint(){return sm=sm||new Li({"circle-radius":new Bt(Me.paint_circle["circle-radius"]),"circle-color":new Bt(Me.paint_circle["circle-color"]),"circle-blur":new Bt(Me.paint_circle["circle-blur"]),"circle-opacity":new Bt(Me.paint_circle["circle-opacity"]),"circle-translate":new Dt(Me.paint_circle["circle-translate"]),"circle-translate-anchor":new Dt(Me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Dt(Me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Dt(Me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bt(Me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bt(Me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bt(Me.paint_circle["circle-stroke-opacity"])})},get layout(){return jf=jf||new Li({"circle-sort-key":new Bt(Me.layout_circle["circle-sort-key"])})}};class Vf extends gi{constructor(e,n){super(e,lm,n)}createBucket(e){return new Tu(e)}queryRadius(e){const n=e;return vl("circle-radius",this,n)+vl("circle-stroke-width",this,n)+pd(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:s,geometry:u,transform:f,pixelsToTileUnits:m,unwrappedTileID:v,getElevation:w}){const A=Bf(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-f.bearingInRadians,m),P=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s),O=this.paint.get("circle-pitch-scale"),B=this.paint.get("circle-pitch-alignment");let F,G;return B==="map"?(F=A,G=P*m):(F=(function(q,Z,J,de){return q.map((te=>md(te,Z,J,de)))})(A,f,v,w),G=P),Nf({queryGeometry:F,size:G,transform:f,unwrappedTileID:v,getElevation:w,pitchAlignment:B,pitchScale:O},u)}}class Uf extends Tu{}let cm;zt("HeatmapBucket",Uf,{omit:["layers"]});var um={get paint(){return cm=cm||new Li({"heatmap-radius":new Bt(Me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bt(Me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Dt(Me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yu(Me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Dt(Me.paint_heatmap["heatmap-opacity"])})}};function Gf(i,{width:e,height:n},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*n*s)throw new RangeError(`mismatched image size. expected: ${u.length} but got: ${e*n*s}`)}else u=new Uint8Array(e*n*s);return i.width=e,i.height=n,i.data=u,i}function Bs(i,{width:e,height:n},s){if(e===i.width&&n===i.height)return;const u=Gf({},{width:e,height:n},s);gd(i,u,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,e),height:Math.min(i.height,n)},s),i.width=e,i.height=n,i.data=u.data}function gd(i,e,n,s,u,f){if(u.width===0||u.height===0)return e;if(u.width>i.width||u.height>i.height||n.x>i.width-u.width||n.y>i.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=i.data,v=e.data;if(m===v)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<u.height;w++){const A=((n.y+w)*i.width+n.x)*f,P=((s.y+w)*e.width+s.x)*f;for(let O=0;O<u.width*f;O++)v[P+O]=m[A+O]}return e}class _d{constructor(e,n){Gf(this,e,1,n)}resize(e){Bs(this,e,1)}clone(){return new _d({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,u,f){gd(e,n,s,u,f,1)}}class Xr{constructor(e,n){Gf(this,e,4,n)}resize(e){Bs(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Xr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,u,f){gd(e,n,s,u,f,4)}setPixel(e,n,s){const u=4*(e*this.width+n);this.data[u+0]=Math.round(255*s.r/s.a),this.data[u+1]=Math.round(255*s.g/s.a),this.data[u+2]=Math.round(255*s.b/s.a),this.data[u+3]=Math.round(255*s.a)}}function Fs(i){const e={},n=i.resolution||256,s=i.clips?i.clips.length:1,u=i.image||new Xr({width:n,height:s});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const f=(m,v,w)=>{e[i.evaluationKey]=w;const A=i.expression.evaluate(e);u.setPixel(m/4/n,v/4,A)};if(i.clips)for(let m=0,v=0;m<s;++m,v+=4*n)for(let w=0,A=0;w<n;w++,A+=4){const P=w/(n-1),{start:O,end:B}=i.clips[m];f(v,A,O*(1-P)+B*P)}else for(let m=0,v=0;m<n;m++,v+=4)f(0,v,m/(n-1));return u}zt("AlphaImage",_d),zt("RGBAImage",Xr);const yd="big-fb";class Ag extends gi{createBucket(e){return new Uf(e)}constructor(e,n){super(e,um,n),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Fs({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(yd)&&this.heatmapFbos.delete(yd)}queryRadius(e){return vl("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:s,geometry:u,transform:f,pixelsToTileUnits:m,unwrappedTileID:v,getElevation:w}){return Nf({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(n,s)*m,transform:f,unwrappedTileID:v,getElevation:w},u)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let vd;var xd={get paint(){return vd=vd||new Li({"hillshade-illumination-direction":new Dt(Me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Dt(Me.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Dt(Me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Dt(Me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Dt(Me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Dt(Me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Dt(Me.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Dt(Me.paint_hillshade["hillshade-method"])})}};class Mi extends gi{constructor(e,n){super(e,xd,n),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,s=this.paint.get("hillshade-highlight-color").values,u=this.paint.get("hillshade-shadow-color").values;const f=Math.max(e.length,n.length,s.length,u.length);e=e.concat(Array(f-e.length).fill(e.at(-1))),n=n.concat(Array(f-n.length).fill(n.at(-1))),s=s.concat(Array(f-s.length).fill(s.at(-1))),u=u.concat(Array(f-u.length).fill(u.at(-1)));const m=n.map(Hi);return{directionRadians:e.map(Hi),altitudeRadians:m,shadowColor:u,highlightColor:s}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let zg;var dy={get paint(){return zg=zg||new Li({"color-relief-opacity":new Dt(Me["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new yu(Me["paint_color-relief"]["color-relief-color"])})}};class qf{constructor(e,n,s,u){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(n,u)}update(e,n,s){const{width:u,height:f}=e,m=!(this.size&&this.size[0]===u&&this.size[1]===f||s),{context:v}=this,{gl:w}=v;if(this.useMipmap=!!(n&&n.useMipmap),w.bindTexture(w.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!n||n.premultiply!==!1)),m)this.size=[u,f],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Ar(e)?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,u,f,0,this.format,w.UNSIGNED_BYTE,e.data);else{const{x:A,y:P}=s||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Ar(e)?w.texSubImage2D(w.TEXTURE_2D,0,A,P,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,A,P,u,f,w.RGBA,w.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&w.generateMipmap(w.TEXTURE_2D),v.pixelStoreUnpackFlipY.setDefault(),v.pixelStoreUnpack.setDefault(),v.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,n,s){const{context:u}=this,{gl:f}=u;f.bindTexture(f.TEXTURE_2D,this.texture),s!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(s=f.LINEAR),e!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,s||e),this.filter=e),n!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,n),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class vh{constructor(e,n,s,u=1,f=1,m=1,v=0){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(s&&!["mapbox","terrarium","custom"].includes(s))return void Pn(`"${s}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const w=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),s){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=u,this.greenFactor=f,this.blueFactor=m,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let A=0;A<w;A++)this.data[this._idx(-1,A)]=this.data[this._idx(0,A)],this.data[this._idx(w,A)]=this.data[this._idx(w-1,A)],this.data[this._idx(A,-1)]=this.data[this._idx(A,0)],this.data[this._idx(A,w)]=this.data[this._idx(A,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let A=0;A<w;A++)for(let P=0;P<w;P++){const O=this.get(A,P);O>this.max&&(this.max=O),O<this.min&&(this.min=O)}}get(e,n){const s=new Uint8Array(this.data.buffer),u=4*this._idx(e,n);return this.unpack(s[u],s[u+1],s[u+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${e}, y: ${n}, dim: ${this.dim}`);return(n+1)*this.stride+(e+1)}unpack(e,n,s){return e*this.redFactor+n*this.greenFactor+s*this.blueFactor-this.baseShift}pack(e){return xl(e,this.getUnpackVector())}getPixels(){return new Xr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=n*this.dim,f=n*this.dim+this.dim,m=s*this.dim,v=s*this.dim+this.dim;switch(n){case-1:u=f-1;break;case 1:f=u+1}switch(s){case-1:m=v-1;break;case 1:v=m+1}const w=-n*this.dim,A=-s*this.dim;for(let P=m;P<v;P++)for(let O=u;O<f;O++)this.data[this._idx(O,P)]=e.data[this._idx(O+w,P+A)]}}function xl(i,e){const n=e[0],s=e[1],u=e[2],f=e[3],m=Math.min(n,s,u),v=Math.round((i+f)/m);return{r:Math.floor(v*m/n)%256,g:Math.floor(v*m/s)%256,b:Math.floor(v*m/u)%256}}zt("DEMData",vh);class Dg extends gi{constructor(e,n){super(e,dy,n)}_createColorRamp(e){const n={elevationStops:[],colorStops:[]},s=this._transitionablePaint._values["color-relief-color"].value.expression;if(s instanceof Fr&&s._styleExpression.expression instanceof kr){this.colorRampExpression=s;const m=s._styleExpression.expression;n.elevationStops=m.labels,n.colorStops=[];for(const v of n.elevationStops)n.colorStops.push(m.evaluate({globals:{elevation:v}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[sn.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=e)return n;const u={elevationStops:[],colorStops:[]},f=(n.elevationStops.length-1)/(e-1);for(let m=0;m<n.elevationStops.length-.5;m+=f)u.elevationStops.push(n.elevationStops[Math.round(m)]),u.colorStops.push(n.colorStops[Math.round(m)]);return Pn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${n.elevationStops.length}`),u}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,n,s){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const u=this._createColorRamp(n),f=new Xr({width:u.colorStops.length,height:1}),m=new Xr({width:u.colorStops.length,height:1});for(let v=0;v<u.elevationStops.length;v++){const w=xl(u.elevationStops[v],s);m.setPixel(0,v,new sn(w.r/255,w.g/255,w.b/255,1)),f.setPixel(0,v,u.colorStops[v])}return this.colorRampTextures={elevationTexture:new qf(e,m,e.gl.RGBA),colorTexture:new qf(e,f,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const Pg=ui([{name:"a_pos",components:2,type:"Int16"}],4),{members:bd}=Pg;function io(i,e,n){const s=n.patternDependencies;let u=!1;for(const f of e){const m=f.paint.get(`${i}-pattern`);m.isConstant()||(u=!0);const v=m.constantOr(null);v&&(u=!0,s[v.to]=!0,s[v.from]=!0)}return u}function $f(i,e,n,s,u){const{zoom:f}=s,m=u.patternDependencies;for(const v of e){const w=v.paint.get(`${i}-pattern`).value;if(w.kind!=="constant"){let A=w.evaluate({zoom:f-1},n,{},u.availableImages),P=w.evaluate({zoom:f},n,{},u.availableImages),O=w.evaluate({zoom:f+1},n,{},u.availableImages);A=A&&A.name?A.name:A,P=P&&P.name?P.name:P,O=O&&O.name?O.name:O,m[A]=!0,m[P]=!0,m[O]=!0,n.patterns[v.id]={min:A,mid:P,max:O}}}return n}function Zf(i,e,n,s,u){let f;if(u===(function(m,v,w,A){let P=0;for(let O=v,B=w-A;O<w;O+=A)P+=(m[B]-m[O])*(m[O+1]+m[B+1]),B=O;return P})(i,e,n,s)>0)for(let m=e;m<n;m+=s)f=fa(m/s|0,i[m],i[m+1],f);else for(let m=n-s;m>=e;m-=s)f=fa(m/s|0,i[m],i[m+1],f);return f&&La(f,f.next)&&(pa(f),f=f.next),f}function mc(i,e){if(!i)return i;e||(e=i);let n,s=i;do if(n=!1,s.steiner||!La(s,s.next)&&zn(s.prev,s,s.next)!==0)s=s.next;else{if(pa(s),s=e=s.prev,s===s.next)break;n=!0}while(n||s!==e);return e}function Cu(i,e,n,s,u,f,m){if(!i)return;!m&&f&&(function(w,A,P,O){let B=w;do B.z===0&&(B.z=hr(B.x,B.y,A,P,O)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==w);B.prevZ.nextZ=null,B.prevZ=null,(function(F){let G,q=1;do{let Z,J=F;F=null;let de=null;for(G=0;J;){G++;let te=J,re=0;for(let ve=0;ve<q&&(re++,te=te.nextZ,te);ve++);let pe=q;for(;re>0||pe>0&&te;)re!==0&&(pe===0||!te||J.z<=te.z)?(Z=J,J=J.nextZ,re--):(Z=te,te=te.nextZ,pe--),de?de.nextZ=Z:F=Z,Z.prevZ=de,de=Z;J=te}de.nextZ=null,q*=2}while(G>1)})(B)})(i,s,u,f);let v=i;for(;i.prev!==i.next;){const w=i.prev,A=i.next;if(f?Hf(i,s,u,f):hm(i))e.push(w.i,i.i,A.i),pa(i),i=A.next,v=A.next;else if((i=A)===v){m?m===1?Cu(i=Rg(mc(i),e),e,n,s,u,f,2):m===2&&bl(i,e,n,s,u,f):Cu(mc(i),e,n,s,u,f,1);break}}}function hm(i){const e=i.prev,n=i,s=i.next;if(zn(e,n,s)>=0)return!1;const u=e.x,f=n.x,m=s.x,v=e.y,w=n.y,A=s.y,P=Math.min(u,f,m),O=Math.min(v,w,A),B=Math.max(u,f,m),F=Math.max(v,w,A);let G=s.next;for(;G!==e;){if(G.x>=P&&G.x<=B&&G.y>=O&&G.y<=F&&xh(u,v,f,w,m,A,G.x,G.y)&&zn(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function Hf(i,e,n,s){const u=i.prev,f=i,m=i.next;if(zn(u,f,m)>=0)return!1;const v=u.x,w=f.x,A=m.x,P=u.y,O=f.y,B=m.y,F=Math.min(v,w,A),G=Math.min(P,O,B),q=Math.max(v,w,A),Z=Math.max(P,O,B),J=hr(F,G,e,n,s),de=hr(q,Z,e,n,s);let te=i.prevZ,re=i.nextZ;for(;te&&te.z>=J&&re&&re.z<=de;){if(te.x>=F&&te.x<=q&&te.y>=G&&te.y<=Z&&te!==u&&te!==m&&xh(v,P,w,O,A,B,te.x,te.y)&&zn(te.prev,te,te.next)>=0||(te=te.prevZ,re.x>=F&&re.x<=q&&re.y>=G&&re.y<=Z&&re!==u&&re!==m&&xh(v,P,w,O,A,B,re.x,re.y)&&zn(re.prev,re,re.next)>=0))return!1;re=re.nextZ}for(;te&&te.z>=J;){if(te.x>=F&&te.x<=q&&te.y>=G&&te.y<=Z&&te!==u&&te!==m&&xh(v,P,w,O,A,B,te.x,te.y)&&zn(te.prev,te,te.next)>=0)return!1;te=te.prevZ}for(;re&&re.z<=de;){if(re.x>=F&&re.x<=q&&re.y>=G&&re.y<=Z&&re!==u&&re!==m&&xh(v,P,w,O,A,B,re.x,re.y)&&zn(re.prev,re,re.next)>=0)return!1;re=re.nextZ}return!0}function Rg(i,e){let n=i;do{const s=n.prev,u=n.next.next;!La(s,u)&&pm(s,n,n.next,u)&&Td(s,u)&&Td(u,s)&&(e.push(s.i,n.i,u.i),pa(n),pa(n.next),n=i=u),n=n.next}while(n!==i);return mc(n)}function bl(i,e,n,s,u,f){let m=i;do{let v=m.next.next;for(;v!==m.prev;){if(m.i!==v.i&&Oi(m,v)){let w=Ed(m,v);return m=mc(m,m.next),w=mc(w,w.next),Cu(m,e,n,s,u,f,0),void Cu(w,e,n,s,u,f,0)}v=v.next}m=m.next}while(m!==i)}function ur(i,e){let n=i.x-e.x;return n===0&&(n=i.y-e.y,n===0)&&(n=(i.next.y-i.y)/(i.next.x-i.x)-(e.next.y-e.y)/(e.next.x-e.x)),n}function dm(i,e){const n=(function(u,f){let m=f;const v=u.x,w=u.y;let A,P=-1/0;if(La(u,m))return m;do{if(La(u,m.next))return m.next;if(w<=m.y&&w>=m.next.y&&m.next.y!==m.y){const q=m.x+(w-m.y)*(m.next.x-m.x)/(m.next.y-m.y);if(q<=v&&q>P&&(P=q,A=m.x<m.next.x?m:m.next,q===v))return A}m=m.next}while(m!==f);if(!A)return null;const O=A,B=A.x,F=A.y;let G=1/0;m=A;do{if(v>=m.x&&m.x>=B&&v!==m.x&&fm(w<F?v:P,w,B,F,w<F?P:v,w,m.x,m.y)){const q=Math.abs(w-m.y)/(v-m.x);Td(m,u)&&(q<G||q===G&&(m.x>A.x||m.x===A.x&&Ig(A,m)))&&(A=m,G=q)}m=m.next}while(m!==O);return A})(i,e);if(!n)return e;const s=Ed(n,i);return mc(s,s.next),mc(n,n.next)}function Ig(i,e){return zn(i.prev,i,e.prev)<0&&zn(e.next,i,i.next)<0}function hr(i,e,n,s,u){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-n)*u|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function fy(i){let e=i,n=i;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==i);return n}function fm(i,e,n,s,u,f,m,v){return(u-m)*(e-v)>=(i-m)*(f-v)&&(i-m)*(s-v)>=(n-m)*(e-v)&&(n-m)*(f-v)>=(u-m)*(s-v)}function xh(i,e,n,s,u,f,m,v){return!(i===m&&e===v)&&fm(i,e,n,s,u,f,m,v)}function Oi(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!(function(n,s){let u=n;do{if(u.i!==n.i&&u.next.i!==n.i&&u.i!==s.i&&u.next.i!==s.i&&pm(u,u.next,n,s))return!0;u=u.next}while(u!==n);return!1})(i,e)&&(Td(i,e)&&Td(e,i)&&(function(n,s){let u=n,f=!1;const m=(n.x+s.x)/2,v=(n.y+s.y)/2;do u.y>v!=u.next.y>v&&u.next.y!==u.y&&m<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next;while(u!==n);return f})(i,e)&&(zn(i.prev,i,e.prev)||zn(i,e.prev,e))||La(i,e)&&zn(i.prev,i,i.next)>0&&zn(e.prev,e,e.next)>0)}function zn(i,e,n){return(e.y-i.y)*(n.x-e.x)-(e.x-i.x)*(n.y-e.y)}function La(i,e){return i.x===e.x&&i.y===e.y}function pm(i,e,n,s){const u=Sd(zn(i,e,n)),f=Sd(zn(i,e,s)),m=Sd(zn(n,s,i)),v=Sd(zn(n,s,e));return u!==f&&m!==v||!(u!==0||!wd(i,n,e))||!(f!==0||!wd(i,s,e))||!(m!==0||!wd(n,i,s))||!(v!==0||!wd(n,e,s))}function wd(i,e,n){return e.x<=Math.max(i.x,n.x)&&e.x>=Math.min(i.x,n.x)&&e.y<=Math.max(i.y,n.y)&&e.y>=Math.min(i.y,n.y)}function Sd(i){return i>0?1:i<0?-1:0}function Td(i,e){return zn(i.prev,i,i.next)<0?zn(i,e,i.next)>=0&&zn(i,i.prev,e)>=0:zn(i,e,i.prev)<0||zn(i,i.next,e)<0}function Ed(i,e){const n=Xf(i.i,i.x,i.y),s=Xf(e.i,e.x,e.y),u=i.next,f=e.prev;return i.next=e,e.prev=i,n.next=u,u.prev=n,s.next=n,n.prev=s,f.next=s,s.prev=f,s}function fa(i,e,n,s){const u=Xf(i,e,n);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function pa(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Xf(i,e,n){return{i,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class vr{constructor(e,n){if(n>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=n}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class Cd{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}Cd.noSubdivision=new Cd({fill:new vr(0,0),line:new vr(0,0),tile:new vr(0,0),stencil:new vr(0,0),circle:1}),zt("SubdivisionGranularityExpression",vr),zt("SubdivisionGranularitySetting",Cd);const Oa=-32768,rs=32767;class wl{constructor(e,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=yt/e,this._canonical=n}_getKey(e,n){return(e+=32768)<<16|n+32768}_vertexToIndex(e,n){if(e<-32768||n<-32768||e>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const s=0|Math.round(e),u=0|Math.round(n),f=this._getKey(s,u);if(this._vertexDictionary.has(f))return this._vertexDictionary.get(f);const m=this._vertexBuffer.length/2;return this._vertexDictionary.set(f,m),this._vertexBuffer.push(s,u),m}_subdivideTrianglesScanline(e){if(this._granularity<2)return(function(u,f){const m=[];for(let v=0;v<f.length;v+=3){const w=f[v],A=f[v+1],P=f[v+2],O=u[2*w],B=u[2*w+1];(u[2*A]-O)*(u[2*P+1]-B)-(u[2*A+1]-B)*(u[2*P]-O)>0?(m.push(w),m.push(P),m.push(A)):(m.push(w),m.push(A),m.push(P))}return m})(this._vertexBuffer,e);const n=[],s=e.length;for(let u=0;u<s;u+=3){const f=[e[u+0],e[u+1],e[u+2]],m=[this._vertexBuffer[2*e[u+0]+0],this._vertexBuffer[2*e[u+0]+1],this._vertexBuffer[2*e[u+1]+0],this._vertexBuffer[2*e[u+1]+1],this._vertexBuffer[2*e[u+2]+0],this._vertexBuffer[2*e[u+2]+1]];let v=1/0,w=1/0,A=-1/0,P=-1/0;for(let q=0;q<3;q++){const Z=m[2*q],J=m[2*q+1];v=Math.min(v,Z),A=Math.max(A,Z),w=Math.min(w,J),P=Math.max(P,J)}if(v===A||w===P)continue;const O=Math.floor(v/this._granularityCellSize),B=Math.ceil(A/this._granularityCellSize),F=Math.floor(w/this._granularityCellSize),G=Math.ceil(P/this._granularityCellSize);if(O!==B||F!==G)for(let q=F;q<G;q++){const Z=this._scanlineGenerateVertexRingForCellRow(q,m,f);as(this._vertexBuffer,Z,n)}else n.push(...f)}return n}_scanlineGenerateVertexRingForCellRow(e,n,s){const u=e*this._granularityCellSize,f=u+this._granularityCellSize,m=[];for(let v=0;v<3;v++){const w=n[2*v],A=n[2*v+1],P=n[2*(v+1)%6],O=n[(2*(v+1)+1)%6],B=n[2*(v+2)%6],F=n[(2*(v+2)+1)%6],G=P-w,q=O-A,Z=G===0,J=q===0,de=(u-A)/q,te=(f-A)/q,re=Math.min(de,te),pe=Math.max(de,te);if(!J&&(re>=1||pe<=0)||J&&(A<u||A>f)){O>=u&&O<=f&&m.push(s[(v+1)%3]);continue}!J&&re>0&&m.push(this._vertexToIndex(w+G*re,A+q*re));const ve=w+G*Math.max(re,0),Ne=w+G*Math.min(pe,1);Z||this._generateIntraEdgeVertices(m,w,A,P,O,ve,Ne),!J&&pe<1&&m.push(this._vertexToIndex(w+G*pe,A+q*pe)),(J||O>=u&&O<=f)&&m.push(s[(v+1)%3]),!J&&(O<=u||O>=f)&&this._generateInterEdgeVertices(m,w,A,P,O,B,F,Ne,u,f)}return m}_generateIntraEdgeVertices(e,n,s,u,f,m,v){const w=u-n,A=f-s,P=A===0,O=P?Math.min(n,u):Math.min(m,v),B=P?Math.max(n,u):Math.max(m,v),F=Math.floor(O/this._granularityCellSize)+1,G=Math.ceil(B/this._granularityCellSize)-1;if(P?n<u:m<v)for(let q=F;q<=G;q++){const Z=q*this._granularityCellSize;e.push(this._vertexToIndex(Z,s+A*(Z-n)/w))}else for(let q=G;q>=F;q--){const Z=q*this._granularityCellSize;e.push(this._vertexToIndex(Z,s+A*(Z-n)/w))}}_generateInterEdgeVertices(e,n,s,u,f,m,v,w,A,P){const O=f-s,B=m-u,F=v-f,G=(A-f)/F,q=(P-f)/F,Z=Math.min(G,q),J=Math.max(G,q),de=u+B*Z;let te=Math.floor(Math.min(de,w)/this._granularityCellSize)+1,re=Math.ceil(Math.max(de,w)/this._granularityCellSize)-1,pe=w<de;const ve=F===0;if(ve&&(v===A||v===P))return;if(ve||Z>=1||J<=0){const nt=s-v,et=m+(n-m)*Math.min((A-v)/nt,(P-v)/nt);te=Math.floor(Math.min(et,w)/this._granularityCellSize)+1,re=Math.ceil(Math.max(et,w)/this._granularityCellSize)-1,pe=w<et}const Ne=O>0?P:A;if(pe)for(let nt=te;nt<=re;nt++)e.push(this._vertexToIndex(nt*this._granularityCellSize,Ne));else for(let nt=re;nt>=te;nt--)e.push(this._vertexToIndex(nt*this._granularityCellSize,Ne))}_generateOutline(e){const n=[];for(const s of e){const u=Sl(s,this._granularity,!0),f=this._pointArrayToIndices(u),m=[];for(let v=1;v<f.length;v++)m.push(f[v-1]),m.push(f[v]);n.push(m)}return n}_handlePoles(e){let n=!1,s=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(s=!0)),(n||s)&&this._fillPoles(e,n,s)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let n=0;n<e.length;n+=2){const s=e[n+1];s===Oa&&(e[n+1]=-32767),s===rs&&(e[n+1]=32766)}}_generatePoleQuad(e,n,s,u,f,m){u>f!=(m===Oa)?(e.push(n),e.push(s),e.push(this._vertexToIndex(u,m)),e.push(s),e.push(this._vertexToIndex(f,m)),e.push(this._vertexToIndex(u,m))):(e.push(s),e.push(n),e.push(this._vertexToIndex(u,m)),e.push(this._vertexToIndex(f,m)),e.push(s),e.push(this._vertexToIndex(u,m)))}_fillPoles(e,n,s){const u=this._vertexBuffer,f=yt,m=e.length;for(let v=2;v<m;v+=3){const w=e[v-2],A=e[v-1],P=e[v],O=u[2*w],B=u[2*w+1],F=u[2*A],G=u[2*A+1],q=u[2*P],Z=u[2*P+1];n&&(B===0&&G===0&&this._generatePoleQuad(e,w,A,O,F,Oa),G===0&&Z===0&&this._generatePoleQuad(e,A,P,F,q,Oa),Z===0&&B===0&&this._generatePoleQuad(e,P,w,q,O,Oa)),s&&(B===f&&G===f&&this._generatePoleQuad(e,w,A,O,F,rs),G===f&&Z===f&&this._generatePoleQuad(e,A,P,F,q,rs),Z===f&&B===f&&this._generatePoleQuad(e,P,w,q,O,rs))}}_initializeVertices(e){for(let n=0;n<e.length;n+=2)this._vertexToIndex(e[n],e[n+1])}subdividePolygonInternal(e,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:s,holeIndices:u}=(function(v){const w=[],A=[];for(const P of v)if(P.length!==0){P!==v[0]&&w.push(A.length/2);for(let O=0;O<P.length;O++)A.push(P[O].x),A.push(P[O].y)}return{flattened:A,holeIndices:w}})(e);let f;this._initializeVertices(s);try{const v=(function(A,P,O=2){const B=P&&P.length,F=B?P[0]*O:A.length;let G=Zf(A,0,F,O,!0);const q=[];if(!G||G.next===G.prev)return q;let Z,J,de;if(B&&(G=(function(te,re,pe,ve){const Ne=[];for(let nt=0,et=re.length;nt<et;nt++){const st=Zf(te,re[nt]*ve,nt<et-1?re[nt+1]*ve:te.length,ve,!1);st===st.next&&(st.steiner=!0),Ne.push(fy(st))}Ne.sort(ur);for(let nt=0;nt<Ne.length;nt++)pe=dm(Ne[nt],pe);return pe})(A,P,G,O)),A.length>80*O){Z=A[0],J=A[1];let te=Z,re=J;for(let pe=O;pe<F;pe+=O){const ve=A[pe],Ne=A[pe+1];ve<Z&&(Z=ve),Ne<J&&(J=Ne),ve>te&&(te=ve),Ne>re&&(re=Ne)}de=Math.max(te-Z,re-J),de=de!==0?32767/de:0}return Cu(G,q,O,Z,J,de,0),q})(s,u),w=this._convertIndices(s,v);f=this._subdivideTrianglesScanline(w)}catch(v){console.error(v)}let m=[];return n&&(m=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(f),{verticesFlattened:this._vertexBuffer,indicesTriangles:f,indicesLineList:m}}_convertIndices(e,n){const s=[];for(let u=0;u<n.length;u++)s.push(this._vertexToIndex(e[2*n[u]],e[2*n[u]+1]));return s}_pointArrayToIndices(e){const n=[];for(let s=0;s<e.length;s++){const u=e[s];n.push(this._vertexToIndex(u.x,u.y))}return n}}function Yf(i,e,n,s=!0){return new wl(n,e).subdividePolygonInternal(i,s)}function Sl(i,e,n=!1){if(!i||i.length<1)return[];if(i.length<2)return[];const s=i[0],u=i[i.length-1],f=n&&(s.x!==u.x||s.y!==u.y);if(e<2)return f?[...i,i[0]]:[...i];const m=Math.floor(yt/e),v=[];v.push(new N(i[0].x,i[0].y));const w=i.length,A=f?w:w-1;for(let P=0;P<A;P++){const O=i[P],B=P<w-1?i[P+1]:i[0],F=O.x,G=O.y,q=B.x,Z=B.y,J=F!==q,de=G!==Z;if(!J&&!de)continue;const te=q-F,re=Z-G,pe=Math.abs(te),ve=Math.abs(re);let Ne=F,nt=G;for(;;){const st=te>0?(Math.floor(Ne/m)+1)*m:(Math.ceil(Ne/m)-1)*m,wt=re>0?(Math.floor(nt/m)+1)*m:(Math.ceil(nt/m)-1)*m,mt=Math.abs(Ne-st),Je=Math.abs(nt-wt),He=Math.abs(Ne-q),Mt=Math.abs(nt-Z),Et=J?mt/pe:Number.POSITIVE_INFINITY,Lt=de?Je/ve:Number.POSITIVE_INFINITY;if((He<=mt||!J)&&(Mt<=Je||!de))break;if(Et<Lt&&J||!de){Ne=st,nt+=re*Et;const Ct=new N(Ne,Math.round(nt));v[v.length-1].x===Ct.x&&v[v.length-1].y===Ct.y||v.push(Ct)}else{Ne+=te*Lt,nt=wt;const Ct=new N(Math.round(Ne),nt);v[v.length-1].x===Ct.x&&v[v.length-1].y===Ct.y||v.push(Ct)}}const et=new N(q,Z);v[v.length-1].x===et.x&&v[v.length-1].y===et.y||v.push(et)}return v}function as(i,e,n){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let s=0,u=i[2*e[0]];for(let w=1;w<e.length;w++){const A=i[2*e[w]];A<u&&(u=A,s=w)}const f=e.length;let m=s,v=(m+1)%f;for(;;){const w=m-1>=0?m-1:f-1,A=(v+1)%f,P=i[2*e[w]],O=i[2*e[A]],B=i[2*e[m]],F=i[2*e[m]+1],G=i[2*e[v]+1];let q=!1;if(P<O)q=!0;else if(P>O)q=!1;else{const Z=G-F,J=-(i[2*e[v]]-B),de=F<G?1:-1;((P-B)*Z+(i[2*e[w]+1]-F)*J)*de>((O-B)*Z+(i[2*e[A]+1]-F)*J)*de&&(q=!0)}if(q){const Z=e[w],J=e[m],de=e[v];Z!==J&&Z!==de&&J!==de&&n.push(de,J,Z),m--,m<0&&(m=f-1)}else{const Z=e[A],J=e[m],de=e[v];Z!==J&&Z!==de&&J!==de&&n.push(de,J,Z),v++,v>=f&&(v=0)}if(w===A)break}}function mm(i,e,n,s,u,f,m,v,w){const A=u.length/2,P=m&&v&&w;if(A<St.MAX_VERTEX_ARRAY_LENGTH){const O=e.prepareSegment(A,n,s),B=O.vertexLength;for(let q=0;q<f.length;q+=3)s.emplaceBack(B+f[q],B+f[q+1],B+f[q+2]);let F,G;O.vertexLength+=A,O.primitiveLength+=f.length/3,P&&(G=m.prepareSegment(A,n,v),F=G.vertexLength,G.vertexLength+=A);for(let q=0;q<u.length;q+=2)i(u[q],u[q+1]);if(P)for(let q=0;q<w.length;q++){const Z=w[q];for(let J=1;J<Z.length;J+=2)v.emplaceBack(F+Z[J-1],F+Z[J]);G.primitiveLength+=Z.length/2}}else(function(O,B,F,G,q,Z){const J=[];for(let ve=0;ve<G.length/2;ve++)J.push(-1);const de={count:0};let te=0,re=O.getOrCreateLatestSegment(B,F),pe=re.vertexLength;for(let ve=2;ve<q.length;ve+=3){const Ne=q[ve-2],nt=q[ve-1],et=q[ve];let st=J[Ne]<te,wt=J[nt]<te,mt=J[et]<te;re.vertexLength+((st?1:0)+(wt?1:0)+(mt?1:0))>St.MAX_VERTEX_ARRAY_LENGTH&&(re=O.createNewSegment(B,F),te=de.count,st=!0,wt=!0,mt=!0,pe=0);const Je=Ns(J,G,Z,de,Ne,st,re),He=Ns(J,G,Z,de,nt,wt,re),Mt=Ns(J,G,Z,de,et,mt,re);F.emplaceBack(pe+Je-te,pe+He-te,pe+Mt-te),re.primitiveLength++}})(e,n,s,u,f,i),P&&(function(O,B,F,G,q,Z){const J=[];for(let ve=0;ve<G.length/2;ve++)J.push(-1);const de={count:0};let te=0,re=O.getOrCreateLatestSegment(B,F),pe=re.vertexLength;for(let ve=0;ve<q.length;ve++){const Ne=q[ve];for(let nt=1;nt<q[ve].length;nt+=2){const et=Ne[nt-1],st=Ne[nt];let wt=J[et]<te,mt=J[st]<te;re.vertexLength+((wt?1:0)+(mt?1:0))>St.MAX_VERTEX_ARRAY_LENGTH&&(re=O.createNewSegment(B,F),te=de.count,wt=!0,mt=!0,pe=0);const Je=Ns(J,G,Z,de,et,wt,re),He=Ns(J,G,Z,de,st,mt,re);F.emplaceBack(pe+Je-te,pe+He-te),re.primitiveLength++}}})(m,n,v,u,w,i),e.forceNewSegmentOnNextPrepare(),m?.forceNewSegmentOnNextPrepare()}function Ns(i,e,n,s,u,f,m){if(f){const v=s.count;return n(e[2*u],e[2*u+1]),i[u]=s.count,s.count++,m.vertexLength++,v}return i[u]}class Mu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new oe,this.indexArray=new Ve,this.indexArray2=new vt,this.programConfigurations=new Ls(e.layers,e.zoom),this.segments=new St,this.segments2=new St,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,s){this.hasDependencies=io("fill",this.layers,n);const u=this.layers[0].layout.get("fill-sort-key"),f=!u.isConstant(),m=[];for(const{feature:v,id:w,index:A,sourceLayerIndex:P}of e){const O=this.layers[0]._featureFilter.needGeometry,B=no(v,O);if(!this.layers[0]._featureFilter.filter(new On(this.zoom),B,s))continue;const F=f?u.evaluate(B,{},s,n.availableImages):void 0,G={id:w,properties:v.properties,type:v.type,sourceLayerIndex:P,index:A,geometry:O?B.geometry:is(v),patterns:{},sortKey:F};m.push(G)}f&&m.sort(((v,w)=>v.sortKey-w.sortKey));for(const v of m){const{geometry:w,index:A,sourceLayerIndex:P}=v;if(this.hasDependencies){const O=$f("fill",this.layers,v,{zoom:this.zoom},n);this.patternFeatures.push(O)}else this.addFeature(v,w,A,s,{},n.subdivisionGranularity);n.featureIndex.insert(e[A].feature,w,A,P,this.index)}}update(e,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:s})}addFeatures(e,n,s){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,n,s,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,bd),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,s,u,f,m){for(const v of Jc(n,500)){const w=Yf(v,u,m.fill.getGranularityForZoomLevel(u.z)),A=this.layoutVertexArray;mm(((P,O)=>{A.emplaceBack(P,O)}),this.segments,this.layoutVertexArray,this.indexArray,w.verticesFlattened,w.indicesTriangles,this.segments2,this.indexArray2,w.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{imagePositions:f,canonical:u})}}let bh,Au;zt("FillBucket",Mu,{omit:["layers","patternFeatures"]});var Lg={get paint(){return Au=Au||new Li({"fill-antialias":new Dt(Me.paint_fill["fill-antialias"]),"fill-opacity":new Bt(Me.paint_fill["fill-opacity"]),"fill-color":new Bt(Me.paint_fill["fill-color"]),"fill-outline-color":new Bt(Me.paint_fill["fill-outline-color"]),"fill-translate":new Dt(Me.paint_fill["fill-translate"]),"fill-translate-anchor":new Dt(Me.paint_fill["fill-translate-anchor"]),"fill-pattern":new Da(Me.paint_fill["fill-pattern"])})},get layout(){return bh=bh||new Li({"fill-sort-key":new Bt(Me.layout_fill["fill-sort-key"])})}};class Og extends gi{constructor(e,n){super(e,Lg,n)}recalculate(e,n){super.recalculate(e,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Mu(e)}queryRadius(){return pd(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:n,transform:s,pixelsToTileUnits:u}){return Of(Bf(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-s.bearingInRadians,u),n)}isTileClipped(){return!0}}const Md=ui([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),kg=ui([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Wf}=Md;class wh{constructor(e,n,s,u,f){this.properties={},this.extent=s,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(py,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos,s=[];let u,f=1,m=0,v=0,w=0;for(;e.pos<n;){if(m<=0){const A=e.readVarint();f=7&A,m=A>>3}if(m--,f===1||f===2)v+=e.readSVarint(),w+=e.readSVarint(),f===1&&(u&&s.push(u),u=[]),u&&u.push(new N(v,w));else{if(f!==7)throw new Error(`unknown command ${f}`);u&&u.push(u[0].clone())}}return u&&s.push(u),s}bbox(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let s=1,u=0,f=0,m=0,v=1/0,w=-1/0,A=1/0,P=-1/0;for(;e.pos<n;){if(u<=0){const O=e.readVarint();s=7&O,u=O>>3}if(u--,s===1||s===2)f+=e.readSVarint(),m+=e.readSVarint(),f<v&&(v=f),f>w&&(w=f),m<A&&(A=m),m>P&&(P=m);else if(s!==7)throw new Error(`unknown command ${s}`)}return[v,A,w,P]}toGeoJSON(e,n,s){const u=this.extent*Math.pow(2,s),f=this.extent*e,m=this.extent*n,v=this.loadGeometry();function w(B){return[360*(B.x+f)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(B.y+m)/u)*Math.PI))-90]}function A(B){return B.map(w)}let P;if(this.type===1){const B=[];for(const G of v)B.push(G[0]);const F=A(B);P=B.length===1?{type:"Point",coordinates:F[0]}:{type:"MultiPoint",coordinates:F}}else if(this.type===2){const B=v.map(A);P=B.length===1?{type:"LineString",coordinates:B[0]}:{type:"MultiLineString",coordinates:B}}else{if(this.type!==3)throw new Error("unknown feature type");{const B=Bg(v),F=[];for(const G of B)F.push(G.map(A));P=F.length===1?{type:"Polygon",coordinates:F[0]}:{type:"MultiPolygon",coordinates:F}}}const O={type:"Feature",geometry:P,properties:this.properties};return this.id!=null&&(O.id=this.id),O}}function py(i,e,n){i===1?e.id=n.readVarint():i===2?(function(s,u){const f=s.readVarint()+s.pos;for(;s.pos<f;){const m=u._keys[s.readVarint()],v=u._values[s.readVarint()];u.properties[m]=v}})(n,e):i===3?e.type=n.readVarint():i===4&&(e._geometry=n.pos)}function Bg(i){const e=i.length;if(e<=1)return[i];const n=[];let s,u;for(let f=0;f<e;f++){const m=Kn(i[f]);m!==0&&(u===void 0&&(u=m<0),u===m<0?(s&&n.push(s),s=[i[f]]):s&&s.push(i[f]))}return s&&n.push(s),n}function Kn(i){let e=0;for(let n,s,u=0,f=i.length,m=f-1;u<f;m=u++)n=i[u],s=i[m],e+=(s.x-n.x)*(n.y+s.y);return e}wh.types=["Unknown","Point","LineString","Polygon"];class di{constructor(e,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Tn,this,n),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const n=this._pbf.readVarint()+this._pbf.pos;return new wh(this._pbf,n,this.extent,this._keys,this._values)}}function Tn(i,e,n){i===15?e.version=n.readVarint():i===1?e.name=n.readString():i===5?e.extent=n.readVarint():i===2?e._features.push(n.pos):i===3?e._keys.push(n.readString()):i===4&&e._values.push((function(s){let u=null;const f=s.readVarint()+s.pos;for(;s.pos<f;){const m=s.readVarint()>>3;u=m===1?s.readString():m===2?s.readFloat():m===3?s.readDouble():m===4?s.readVarint64():m===5?s.readVarint():m===6?s.readSVarint():m===7?s.readBoolean():null}if(u==null)throw new Error("unknown feature value");return u})(n))}class En{constructor(e,n){this.layers=e.readFields(ni,{},n)}}function ni(i,e,n){if(i===3){const s=new di(n,n.readVarint()+n.pos);s.length&&(e[s.name]=s)}}const ma=Math.pow(2,13);function ko(i,e,n,s,u,f,m,v){i.emplaceBack(e,n,2*Math.floor(s*ma)+m,u*ma*2,f*ma*2,Math.round(v))}class gc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new fe,this.centroidVertexArray=new ae,this.indexArray=new Ve,this.programConfigurations=new Ls(e.layers,e.zoom),this.segments=new St,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,s){this.features=[],this.hasDependencies=io("fill-extrusion",this.layers,n);for(const{feature:u,id:f,index:m,sourceLayerIndex:v}of e){const w=this.layers[0]._featureFilter.needGeometry,A=no(u,w);if(!this.layers[0]._featureFilter.filter(new On(this.zoom),A,s))continue;const P={id:f,sourceLayerIndex:v,index:m,geometry:w?A.geometry:is(u),properties:u.properties,type:u.type,patterns:{}};this.hasDependencies?this.features.push($f("fill-extrusion",this.layers,P,{zoom:this.zoom},n)):this.addFeature(P,P.geometry,m,s,{},n.subdivisionGranularity),n.featureIndex.insert(u,P.geometry,m,v,this.index,!0)}}addFeatures(e,n,s){for(const u of this.features){const{geometry:f}=u;this.addFeature(u,f,u.index,n,s,e.subdivisionGranularity)}}update(e,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:s})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Wf),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,kg.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,n,s,u,f,m){for(const v of Jc(n,500)){const w={x:0,y:0,sampleCount:0},A=this.layoutVertexArray.length;this.processPolygon(w,u,e,v,m);const P=this.layoutVertexArray.length-A,O=Math.floor(w.x/w.sampleCount),B=Math.floor(w.y/w.sampleCount);for(let F=0;F<P;F++)this.centroidVertexArray.emplaceBack(O,B)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{imagePositions:f,canonical:u})}processPolygon(e,n,s,u,f){if(u.length<1||Ui(u[0]))return;for(const O of u)O.length!==0&&gm(e,O);const m={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=f.fill.getGranularityForZoomLevel(n.z),w=wh.types[s.type]==="Polygon";for(const O of u){if(O.length===0||Ui(O))continue;const B=Sl(O,v,w);this._generateSideFaces(B,m)}if(!w)return;const A=Yf(u,n,v,!1),P=this.layoutVertexArray;mm(((O,B)=>{ko(P,O,B,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,A.verticesFlattened,A.indicesTriangles)}_generateSideFaces(e,n){let s=0;for(let u=1;u<e.length;u++){const f=e[u],m=e[u-1];if(Tl(f,m))continue;n.segment.vertexLength+4>St.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=f.sub(m)._perp()._unit(),w=m.dist(f);s+w>32768&&(s=0),ko(this.layoutVertexArray,f.x,f.y,v.x,v.y,0,0,s),ko(this.layoutVertexArray,f.x,f.y,v.x,v.y,0,1,s),s+=w,ko(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,0,s),ko(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,1,s);const A=n.segment.vertexLength;this.indexArray.emplaceBack(A,A+2,A+1),this.indexArray.emplaceBack(A+1,A+2,A+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function gm(i,e){for(let n=0;n<e.length;n++){const s=e[n];n===e.length-1&&e[0].x===s.x&&e[0].y===s.y||(i.x+=s.x,i.y+=s.y,i.sampleCount++)}}function Tl(i,e){return i.x===e.x&&(i.x<0||i.x>yt)||i.y===e.y&&(i.y<0||i.y>yt)}function Ui(i){return i.every((e=>e.x<0))||i.every((e=>e.x>yt))||i.every((e=>e.y<0))||i.every((e=>e.y>yt))}let El;zt("FillExtrusionBucket",gc,{omit:["layers","features"]});var zu={get paint(){return El=El||new Li({"fill-extrusion-opacity":new Dt(Me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bt(Me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Dt(Me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Dt(Me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Da(Me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bt(Me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bt(Me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Dt(Me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class _m extends gi{constructor(e,n){super(e,zu,n)}createBucket(e){return new gc(e)}queryRadius(){return pd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:s,geometry:u,transform:f,pixelsToTileUnits:m,pixelPosMatrix:v}){const w=Bf(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-f.bearingInRadians,m),A=this.paint.get("fill-extrusion-height").evaluate(n,s),P=this.paint.get("fill-extrusion-base").evaluate(n,s),O=(function(F,G){const q=[];for(const Z of F){const J=[Z.x,Z.y,0,1];Ft(J,J,G),q.push(new N(J[0]/J[3],J[1]/J[3]))}return q})(w,v),B=(function(F,G,q,Z){const J=[],de=[],te=Z[8]*G,re=Z[9]*G,pe=Z[10]*G,ve=Z[11]*G,Ne=Z[8]*q,nt=Z[9]*q,et=Z[10]*q,st=Z[11]*q;for(const wt of F){const mt=[],Je=[];for(const He of wt){const Mt=He.x,Et=He.y,Lt=Z[0]*Mt+Z[4]*Et+Z[12],Ct=Z[1]*Mt+Z[5]*Et+Z[13],$t=Z[2]*Mt+Z[6]*Et+Z[14],Dn=Z[3]*Mt+Z[7]*Et+Z[15],yn=$t+pe,Ai=Dn+ve,Qr=Lt+Ne,mr=Ct+nt,zi=$t+et,yi=Dn+st,qn=new N((Lt+te)/Ai,(Ct+re)/Ai);qn.z=yn/Ai,mt.push(qn);const Gi=new N(Qr/yi,mr/yi);Gi.z=zi/yi,Je.push(Gi)}J.push(mt),de.push(Je)}return[J,de]})(u,P,A,v);return(function(F,G,q){let Z=1/0;Of(q,G)&&(Z=Du(q,G[0]));for(let J=0;J<G.length;J++){const de=G[J],te=F[J];for(let re=0;re<de.length-1;re++){const pe=de[re],ve=[pe,de[re+1],te[re+1],te[re],pe];Eu(q,ve)&&(Z=Math.min(Z,Du(q,ve)))}}return Z!==1/0&&Z})(B[0],B[1],O)}}function Nr(i,e){return i.x*e.x+i.y*e.y}function Du(i,e){if(i.length===1){let n=0;const s=e[n++];let u;for(;!u||s.equals(u);)if(u=e[n++],!u)return 1/0;for(;n<e.length;n++){const f=e[n],m=i[0],v=u.sub(s),w=f.sub(s),A=m.sub(s),P=Nr(v,v),O=Nr(v,w),B=Nr(w,w),F=Nr(A,v),G=Nr(A,w),q=P*B-O*O,Z=(B*F-O*G)/q,J=(P*G-O*F)/q,de=s.z*(1-Z-J)+u.z*Z+f.z*J;if(isFinite(de))return de}return 1/0}{let n=1/0;for(const s of e)n=Math.min(n,s.z);return n}}const Ad=ui([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ka}=Ad,ym=ui([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Kf}=ym,Fg=Math.cos(Math.PI/180*37.5),zd=Math.pow(2,14)/.5;class Sh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((n=>{this.gradients[n.id]={}})),this.layoutVertexArray=new ye,this.layoutVertexArray2=new he,this.indexArray=new Ve,this.programConfigurations=new Ls(e.layers,e.zoom),this.segments=new St,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,s){this.hasDependencies=io("line",this.layers,n)||this.hasLineDasharray(this.layers);const u=this.layers[0].layout.get("line-sort-key"),f=!u.isConstant(),m=[];for(const{feature:v,id:w,index:A,sourceLayerIndex:P}of e){const O=this.layers[0]._featureFilter.needGeometry,B=no(v,O);if(!this.layers[0]._featureFilter.filter(new On(this.zoom),B,s))continue;const F=f?u.evaluate(B,{},s):void 0,G={id:w,properties:v.properties,type:v.type,sourceLayerIndex:P,index:A,geometry:O?B.geometry:is(v),patterns:{},dashes:{},sortKey:F};m.push(G)}f&&m.sort(((v,w)=>v.sortKey-w.sortKey));for(const v of m){const{geometry:w,index:A,sourceLayerIndex:P}=v;this.hasDependencies?(io("line",this.layers,n)?$f("line",this.layers,v,{zoom:this.zoom},n):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,v,this.zoom,n),this.patternFeatures.push(v)):this.addFeature(v,w,A,s,{},{},n.subdivisionGranularity),n.featureIndex.insert(e[A].feature,w,A,P,this.index)}}update(e,n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:s,dashPositions:u})}addFeatures(e,n,s,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,n,s,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Kf)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ka),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,s,u,f,m,v){const w=this.layers[0].layout,A=w.get("line-join").evaluate(e,{}),P=w.get("line-cap"),O=w.get("line-miter-limit"),B=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const F of n)this.addLine(F,e,A,P,O,B,u,v);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{imagePositions:f,dashPositions:m,canonical:u})}addLine(e,n,s,u,f,m,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=Sl(e,v?w.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let te=0;te<e.length-1;te++)this.totalDistance+=e[te].dist(e[te+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const A=wh.types[n.type]==="Polygon";let P=e.length;for(;P>=2&&e[P-1].equals(e[P-2]);)P--;let O=0;for(;O<P-1&&e[O].equals(e[O+1]);)O++;if(P<(A?3:2))return;s==="bevel"&&(f=1.05);const B=this.overscaling<=16?122880/(512*this.overscaling):0,F=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let G,q,Z,J,de;this.e1=this.e2=-1,A&&(G=e[P-2],de=e[O].sub(G)._unit()._perp());for(let te=O;te<P;te++){if(Z=te===P-1?A?e[O+1]:void 0:e[te+1],Z&&e[te].equals(Z))continue;de&&(J=de),G&&(q=G),G=e[te],de=Z?Z.sub(G)._unit()._perp():J,J=J||de;let re=J.add(de);re.x===0&&re.y===0||re._unit();const pe=J.x*de.x+J.y*de.y,ve=re.x*de.x+re.y*de.y,Ne=ve!==0?1/ve:1/0,nt=2*Math.sqrt(2-2*ve),et=ve<Fg&&q&&Z,st=J.x*de.y-J.y*de.x>0;if(et&&te>O){const Je=G.dist(q);if(Je>2*B){const He=G.sub(G.sub(q)._mult(B/Je)._round());this.updateDistance(q,He),this.addCurrentVertex(He,J,0,0,F),q=He}}const wt=q&&Z;let mt=wt?s:A?"butt":u;if(wt&&mt==="round"&&(Ne<m?mt="miter":Ne<=2&&(mt="fakeround")),mt==="miter"&&Ne>f&&(mt="bevel"),mt==="bevel"&&(Ne>2&&(mt="flipbevel"),Ne<f&&(mt="miter")),q&&this.updateDistance(q,G),mt==="miter")re._mult(Ne),this.addCurrentVertex(G,re,0,0,F);else if(mt==="flipbevel"){if(Ne>100)re=de.mult(-1);else{const Je=Ne*J.add(de).mag()/J.sub(de).mag();re._perp()._mult(Je*(st?-1:1))}this.addCurrentVertex(G,re,0,0,F),this.addCurrentVertex(G,re.mult(-1),0,0,F)}else if(mt==="bevel"||mt==="fakeround"){const Je=-Math.sqrt(Ne*Ne-1),He=st?Je:0,Mt=st?0:Je;if(q&&this.addCurrentVertex(G,J,He,Mt,F),mt==="fakeround"){const Et=Math.round(180*nt/Math.PI/20);for(let Lt=1;Lt<Et;Lt++){let Ct=Lt/Et;if(Ct!==.5){const Dn=Ct-.5;Ct+=Ct*Dn*(Ct-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*Dn*Dn+(.848013+pe*(.215638*pe-1.06021)))}const $t=de.sub(J)._mult(Ct)._add(J)._unit()._mult(st?-1:1);this.addHalfVertex(G,$t.x,$t.y,!1,st,0,F)}}Z&&this.addCurrentVertex(G,de,-He,-Mt,F)}else if(mt==="butt")this.addCurrentVertex(G,re,0,0,F);else if(mt==="square"){const Je=q?1:-1;this.addCurrentVertex(G,re,Je,Je,F)}else mt==="round"&&(q&&(this.addCurrentVertex(G,J,0,0,F),this.addCurrentVertex(G,J,1,1,F,!0)),Z&&(this.addCurrentVertex(G,de,-1,-1,F,!0),this.addCurrentVertex(G,de,0,0,F)));if(et&&te<P-1){const Je=G.dist(Z);if(Je>2*B){const He=G.add(Z.sub(G)._mult(B/Je)._round());this.updateDistance(G,He),this.addCurrentVertex(He,de,0,0,F),G=He}}}}addCurrentVertex(e,n,s,u,f,m=!1){const v=n.y*u-n.x,w=-n.y-n.x*u;this.addHalfVertex(e,n.x+n.y*s,n.y-n.x*s,m,!1,s,f),this.addHalfVertex(e,v,w,m,!0,-u,f),this.distance>zd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,n,s,u,f,m))}addHalfVertex({x:e,y:n},s,u,f,m,v,w){const A=.5*(this.lineClips?this.scaledDistance*(zd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(n<<1)+(m?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(v===0?0:v<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,P,this.e2),w.primitiveLength++),m?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}hasLineDasharray(e){for(const n of e){const s=n.paint.get("line-dasharray");if(s&&!s.isConstant())return!0}return!1}addLineDashDependencies(e,n,s,u){for(const f of e){const m=f.paint.get("line-dasharray");if(!m||m.value.kind==="constant")continue;const v=f.layout.get("line-cap")==="round",w={dasharray:m.value.evaluate({zoom:s-1},n,{}),round:v},A={dasharray:m.value.evaluate({zoom:s},n,{}),round:v},P={dasharray:m.value.evaluate({zoom:s+1},n,{}),round:v},O=`${w.dasharray.join(",")},${w.round}`,B=`${A.dasharray.join(",")},${A.round}`,F=`${P.dasharray.join(",")},${P.round}`;u.dashDependencies[O]=w,u.dashDependencies[B]=A,u.dashDependencies[F]=P,n.dashes[f.id]={min:O,mid:B,max:F}}}}let Cl,dr;zt("LineBucket",Sh,{omit:["layers","patternFeatures"]});var Ml={get paint(){return dr=dr||new Li({"line-opacity":new Bt(Me.paint_line["line-opacity"]),"line-color":new Bt(Me.paint_line["line-color"]),"line-translate":new Dt(Me.paint_line["line-translate"]),"line-translate-anchor":new Dt(Me.paint_line["line-translate-anchor"]),"line-width":new Bt(Me.paint_line["line-width"]),"line-gap-width":new Bt(Me.paint_line["line-gap-width"]),"line-offset":new Bt(Me.paint_line["line-offset"]),"line-blur":new Bt(Me.paint_line["line-blur"]),"line-dasharray":new Da(Me.paint_line["line-dasharray"]),"line-pattern":new Da(Me.paint_line["line-pattern"]),"line-gradient":new yu(Me.paint_line["line-gradient"])})},get layout(){return Cl=Cl||new Li({"line-cap":new Dt(Me.layout_line["line-cap"]),"line-join":new Bt(Me.layout_line["line-join"]),"line-miter-limit":new Dt(Me.layout_line["line-miter-limit"]),"line-round-limit":new Dt(Me.layout_line["line-round-limit"]),"line-sort-key":new Bt(Me.layout_line["line-sort-key"])})}};class Th extends Bt{possiblyEvaluate(e,n){return n=new On(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(e,n)}evaluate(e,n,s,u){return n=fn({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(e,n,s,u)}}let Bo;class vm extends gi{constructor(e,n){super(e,Ml,n),this.gradientVersion=0,Bo||(Bo=new Th(Ml.paint.properties["line-width"].specification),Bo.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!(function(s){return s._styleExpression!==void 0})(n)&&n._styleExpression.expression instanceof xs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,n){super.recalculate(e,n),this.paint._values["line-floorwidth"]=Bo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Sh(e)}queryRadius(e){const n=e,s=Qf(vl("line-width",this,n),vl("line-gap-width",this,n)),u=vl("line-offset",this,n);return s/2+Math.abs(u)+pd(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:s,geometry:u,transform:f,pixelsToTileUnits:m}){const v=Bf(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-f.bearingInRadians,m),w=m/2*Qf(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),A=this.paint.get("line-offset").evaluate(n,s);return A&&(u=(function(P,O){const B=[];for(let F=0;F<P.length;F++){const G=Ff(P[F]),q=[];for(let Z=0;Z<G.length;Z++){const J=G[Z],de=G[Z-1],te=G[Z+1],re=Z===0?new N(0,0):J.sub(de)._unit()._perp(),pe=Z===G.length-1?new N(0,0):te.sub(J)._unit()._perp(),ve=re._add(pe)._unit(),Ne=ve.x*pe.x+ve.y*pe.y;Ne!==0&&ve._mult(1/Ne),q.push(ve._mult(O)._add(J))}B.push(q)}return B})(u,A*m)),(function(P,O,B){for(let F=0;F<O.length;F++){const G=O[F];if(P.length>=3){for(let q=0;q<G.length;q++)if(ks(P,G[q]))return!0}if(cr(P,G,B))return!0}return!1})(v,u,w)}isTileClipped(){return!0}}function Qf(i,e){return e>0?e+2*i:i}const Ng=ui([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Dd=ui([{name:"a_projected_pos",components:3,type:"Float32"}],4);ui([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const xm=ui([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ui([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ba=ui([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jg=ui([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Fa(i,e,n){return i.sections.forEach((s=>{s.text=(function(u,f,m){const v=f.layout.get("text-transform").evaluate(m,{});return v==="uppercase"?u=u.toLocaleUpperCase():v==="lowercase"&&(u=u.toLocaleLowerCase()),za.applyArabicShaping&&(u=za.applyArabicShaping(u)),u})(s.text,e,n)})),i}ui([{name:"triangle",components:3,type:"Uint16"}]),ui([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ui([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ui([{type:"Float32",name:"offsetX"}]),ui([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ui([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var rr=24;const Eh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},my={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},_c={40:!0};function Pd(i,e,n,s,u,f){if("fontStack"in e){const m=n[e.fontStack],v=m&&m[i];return v?v.metrics.advance*e.scale+u:0}{const m=s[e.imageName];return m?m.displaySize[0]*e.scale*rr/f+u:0}}function Jf(i,e,n,s){const u=Math.pow(i-e,2);return s?i<e?u/2:2*u:u+Math.abs(n)*n}function Ch(i,e,n){let s=0;return i===10&&(s-=1e4),n&&(s+=150),i!==40&&i!==65288||(s+=50),e!==41&&e!==65289||(s+=50),s}function bm(i,e,n,s,u,f){let m=null,v=Jf(e,n,u,f);for(const w of s){const A=Jf(e-w.x,n,u,f)+w.badness;A<=v&&(m=w,v=A)}return{index:i,x:e,priorBreak:m,badness:v}}function wm(i){return i?wm(i.priorBreak).concat(i.index):[]}class Pu{constructor(e="",n=[],s=[]){this.text=e,this.sections=n,this.sectionIndex=s,this.imageSectionID=null}static fromFeature(e,n){const s=new Pu;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?s.addImageSection(f):s.addTextSection(f,n)}return s}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=(function(e){let n="",s={premature:!0,value:void 0};const u=e[Symbol.iterator]();let f=u.next();const m=e[Symbol.iterator]();m.next();let v=m.next();for(;!f.done;)n+=!v.done&&Po(v.value.codePointAt(0))&&!Eh[v.value]||!s.premature&&Po(s.value.codePointAt(0))&&!Eh[s.value]||!Eh[f.value]?f.value:Eh[f.value],s={value:f.value,premature:!1},f=u.next(),v=m.next();return n})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),n=e?e[0].length:0,s=this.text.match(/\S\s*$/),u=s?s[0].length-1:0;this.text=this.text.substring(n,this.text.length-u),this.sectionIndex=this.sectionIndex.slice(n,this.sectionIndex.length-u)}substring(e,n){const s=[...this.text].slice(e,n).join(""),u=this.sectionIndex.slice(e,n);return new Pu(s,this.sections,u)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,n)=>Math.max(e,this.sections[n].scale)),0)}getMaxImageSize(e){let n=0,s=0;for(let u=0;u<this.length();u++){const f=this.getSection(u);if("imageName"in f){const m=e[f.imageName];if(!m)continue;const v=m.displaySize;n=Math.max(n,v[0]),s=Math.max(s,v[1])}}return{maxImageWidth:n,maxImageHeight:s}}addTextSection(e,n){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||n});const s=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>s)))}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void Pn("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:n}),this.sectionIndex.push(this.sections.length-1)):Pn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,n,s,u,f){const m=[],v=this.determineAverageLineWidth(e,n,s,u,f),w=this.hasZeroWidthSpaces();let A=0,P=0;const O=this.text[Symbol.iterator]();let B=O.next();const F=this.text[Symbol.iterator]();F.next();let G=F.next();const q=this.text[Symbol.iterator]();q.next(),q.next();let Z=q.next();for(;!B.done;){const J=this.getSection(P),de=B.value.codePointAt(0);if(fu(de)||(A+=Pd(de,J,s,u,e,f)),!G.done){const te=Ao(de),re=G.value.codePointAt(0);(my[de]||te||"imageName"in J||!Z.done&&_c[re])&&m.push(bm(P+1,A,v,m,Ch(de,re,te&&w),!1))}P++,B=O.next(),G=F.next(),Z=q.next()}return wm(bm(this.length(),A,v,m,0,!0))}determineAverageLineWidth(e,n,s,u,f){let m=0,v=0;for(const w of this.text){const A=this.getSection(v);m+=Pd(w.codePointAt(0),A,s,u,e,f),v++}return m/Math.max(1,Math.ceil(m/n))}}const ep=4294967296,Rd=1/ep,tp=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class np{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,n,s=this.length){for(;this.pos<s;){const u=this.readVarint(),f=u>>3,m=this.pos;this.type=7&u,e(f,n,this),this.pos===m&&this.skip(u)}return n}readMessage(e,n){return this.readFields(e,n,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*ep;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*ep;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const n=this.buf;let s,u;return u=n[this.pos++],s=127&u,u<128?s:(u=n[this.pos++],s|=(127&u)<<7,u<128?s:(u=n[this.pos++],s|=(127&u)<<14,u<128?s:(u=n[this.pos++],s|=(127&u)<<21,u<128?s:(u=n[this.pos],s|=(15&u)<<28,(function(f,m,v){const w=v.buf;let A,P;if(P=w[v.pos++],A=(112&P)>>4,P<128||(P=w[v.pos++],A|=(127&P)<<3,P<128)||(P=w[v.pos++],A|=(127&P)<<10,P<128)||(P=w[v.pos++],A|=(127&P)<<17,P<128)||(P=w[v.pos++],A|=(127&P)<<24,P<128)||(P=w[v.pos++],A|=(1&P)<<31,P<128))return Mh(f,A,m);throw new Error("Expected varint not more than 10 bytes")})(s,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=12&&tp?tp.decode(this.buf.subarray(n,e)):(function(s,u,f){let m="",v=u;for(;v<f;){const w=s[v];let A,P,O,B=null,F=w>239?4:w>223?3:w>191?2:1;if(v+F>f)break;F===1?w<128&&(B=w):F===2?(A=s[v+1],(192&A)==128&&(B=(31&w)<<6|63&A,B<=127&&(B=null))):F===3?(A=s[v+1],P=s[v+2],(192&A)==128&&(192&P)==128&&(B=(15&w)<<12|(63&A)<<6|63&P,(B<=2047||B>=55296&&B<=57343)&&(B=null))):F===4&&(A=s[v+1],P=s[v+2],O=s[v+3],(192&A)==128&&(192&P)==128&&(192&O)==128&&(B=(15&w)<<18|(63&A)<<12|(63&P)<<6|63&O,(B<=65535||B>=1114112)&&(B=null))),B===null?(B=65533,F=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),v+=F}return m})(this.buf,n,e)}readBytes(){const e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n}readPackedVarint(e=[],n){const s=this.readPackedEnd();for(;this.pos<s;)e.push(this.readVarint(n));return e}readPackedSVarint(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const n=7&e;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(e,n){this.writeVarint(e<<3|n)}realloc(e){let n=this.length||16;for(;n<this.pos+e;)n*=2;if(n!==this.length){const s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.dataView=new DataView(s.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Rd),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Rd),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?(function(n,s){let u,f;if(n>=0?(u=n%4294967296|0,f=n/4294967296|0):(u=~(-n%4294967296),f=~(-n/4294967296),4294967295^u?u=u+1|0:(u=0,f=f+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),(function(m,v,w){w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,w.buf[w.pos]=127&(m>>>=7)})(u,0,s),(function(m,v){const w=(7&m)<<4;v.buf[v.pos++]|=w|((m>>>=3)?128:0),m&&(v.buf[v.pos++]=127&m|((m>>>=7)?128:0),m&&(v.buf[v.pos++]=127&m|((m>>>=7)?128:0),m&&(v.buf[v.pos++]=127&m|((m>>>=7)?128:0),m&&(v.buf[v.pos++]=127&m|((m>>>=7)?128:0),m&&(v.buf[v.pos++]=127&m)))))})(f,s)})(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const n=this.pos;this.pos=(function(u,f,m){for(let v,w,A=0;A<f.length;A++){if(v=f.charCodeAt(A),v>55295&&v<57344){if(!w){v>56319||A+1===f.length?(u[m++]=239,u[m++]=191,u[m++]=189):w=v;continue}if(v<56320){u[m++]=239,u[m++]=191,u[m++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(u[m++]=239,u[m++]=191,u[m++]=189,w=null);v<128?u[m++]=v:(v<2048?u[m++]=v>>6|192:(v<65536?u[m++]=v>>12|224:(u[m++]=v>>18|240,u[m++]=v>>12&63|128),u[m++]=v>>6&63|128),u[m++]=63&v|128)}return m})(this.buf,e,this.pos);const s=this.pos-n;s>=128&&Vg(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const n=e.length;this.writeVarint(n),this.realloc(n);for(let s=0;s<n;s++)this.buf[this.pos++]=e[s]}writeRawMessage(e,n){this.pos++;const s=this.pos;e(n,this);const u=this.pos-s;u>=128&&Vg(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u}writeMessage(e,n,s){this.writeTag(e,2),this.writeRawMessage(n,s)}writePackedVarint(e,n){n.length&&this.writeMessage(e,Ug,n)}writePackedSVarint(e,n){n.length&&this.writeMessage(e,Gg,n)}writePackedBoolean(e,n){n.length&&this.writeMessage(e,qg,n)}writePackedFloat(e,n){n.length&&this.writeMessage(e,Ah,n)}writePackedDouble(e,n){n.length&&this.writeMessage(e,ip,n)}writePackedFixed32(e,n){n.length&&this.writeMessage(e,$g,n)}writePackedSFixed32(e,n){n.length&&this.writeMessage(e,Zg,n)}writePackedFixed64(e,n){n.length&&this.writeMessage(e,Hg,n)}writePackedSFixed64(e,n){n.length&&this.writeMessage(e,Xg,n)}writeBytesField(e,n){this.writeTag(e,2),this.writeBytes(n)}writeFixed32Field(e,n){this.writeTag(e,5),this.writeFixed32(n)}writeSFixed32Field(e,n){this.writeTag(e,5),this.writeSFixed32(n)}writeFixed64Field(e,n){this.writeTag(e,1),this.writeFixed64(n)}writeSFixed64Field(e,n){this.writeTag(e,1),this.writeSFixed64(n)}writeVarintField(e,n){this.writeTag(e,0),this.writeVarint(n)}writeSVarintField(e,n){this.writeTag(e,0),this.writeSVarint(n)}writeStringField(e,n){this.writeTag(e,2),this.writeString(n)}writeFloatField(e,n){this.writeTag(e,5),this.writeFloat(n)}writeDoubleField(e,n){this.writeTag(e,1),this.writeDouble(n)}writeBooleanField(e,n){this.writeVarintField(e,+n)}}function Mh(i,e,n){return n?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function Vg(i,e,n){const s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(s);for(let u=n.pos-1;u>=i;u--)n.buf[u+s]=n.buf[u]}function Ug(i,e){for(let n=0;n<i.length;n++)e.writeVarint(i[n])}function Gg(i,e){for(let n=0;n<i.length;n++)e.writeSVarint(i[n])}function Ah(i,e){for(let n=0;n<i.length;n++)e.writeFloat(i[n])}function ip(i,e){for(let n=0;n<i.length;n++)e.writeDouble(i[n])}function qg(i,e){for(let n=0;n<i.length;n++)e.writeBoolean(i[n])}function $g(i,e){for(let n=0;n<i.length;n++)e.writeFixed32(i[n])}function Zg(i,e){for(let n=0;n<i.length;n++)e.writeSFixed32(i[n])}function Hg(i,e){for(let n=0;n<i.length;n++)e.writeFixed64(i[n])}function Xg(i,e){for(let n=0;n<i.length;n++)e.writeSFixed64(i[n])}function Yg(i,e,n){i===1&&n.readMessage(rp,e)}function rp(i,e,n){if(i===3){const{id:s,bitmap:u,width:f,height:m,left:v,top:w,advance:A}=n.readMessage(Wg,{});e.push({id:s,bitmap:new _d({width:f+6,height:m+6},u),metrics:{width:f,height:m,left:v,top:w,advance:A}})}}function Wg(i,e,n){i===1?e.id=n.readVarint():i===2?e.bitmap=n.readBytes():i===3?e.width=n.readVarint():i===4?e.height=n.readVarint():i===5?e.left=n.readSVarint():i===6?e.top=n.readSVarint():i===7&&(e.advance=n.readVarint())}function Sm(i){let e=0,n=0;for(const m of i)e+=m.w*m.h,n=Math.max(n,m.w);i.sort(((m,v)=>v.h-m.h));const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let u=0,f=0;for(const m of i)for(let v=s.length-1;v>=0;v--){const w=s[v];if(!(m.w>w.w||m.h>w.h)){if(m.x=w.x,m.y=w.y,f=Math.max(f,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===w.w&&m.h===w.h){const A=s.pop();A&&v<s.length&&(s[v]=A)}else m.h===w.h?(w.x+=m.w,w.w-=m.w):m.w===w.w?(w.y+=m.h,w.h-=m.h):(s.push({x:w.x+m.w,y:w.y,w:w.w-m.w,h:m.h}),w.y+=m.h,w.h-=m.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}class Qn{constructor(e,{pixelRatio:n,version:s,stretchX:u,stretchY:f,content:m,textFitWidth:v,textFitHeight:w}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=u,this.stretchY=f,this.content=m,this.version=s,this.textFitWidth=v,this.textFitHeight=w}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ap{constructor(e,n){const s={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,s,f),this.addImages(n,u,f);const{w:m,h:v}=Sm(f),w=new Xr({width:m||1,height:v||1});for(const A in e){const P=e[A],O=s[A].paddedRect;Xr.copy(P.data,w,{x:0,y:0},{x:O.x+1,y:O.y+1},P.data)}for(const A in n){const P=n[A],O=u[A].paddedRect,B=O.x+1,F=O.y+1,G=P.data.width,q=P.data.height;Xr.copy(P.data,w,{x:0,y:0},{x:B,y:F},P.data),Xr.copy(P.data,w,{x:0,y:q-1},{x:B,y:F-1},{width:G,height:1}),Xr.copy(P.data,w,{x:0,y:0},{x:B,y:F+q},{width:G,height:1}),Xr.copy(P.data,w,{x:G-1,y:0},{x:B-1,y:F},{width:1,height:q}),Xr.copy(P.data,w,{x:0,y:0},{x:B+G,y:F},{width:1,height:q})}this.image=w,this.iconPositions=s,this.patternPositions=u}addImages(e,n,s){for(const u in e){const f=e[u],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};s.push(m),n[u]=new Qn(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),n),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),n)}patchUpdatedImage(e,n,s){if(!e||!n||e.version===n.version)return;e.version=n.version;const[u,f]=e.tl;s.update(n.data,void 0,{x:u,y:f})}}var yc;function Id(i,e,n,s,u,f,m,v,w,A,P,O,B,F,G){const q=Pu.fromFeature(i,u);let Z;O===E.az.vertical&&q.verticalizePunctuation();let J=q.determineLineBreaks(A,f,e,s,F);const{processBidirectionalText:de,processStyledBidirectionalText:te}=za;if(de&&q.sections.length===1){Z=[],J=J.map((Ne=>q.toCodeUnitIndex(Ne)));const ve=de(q.toString(),J);for(const Ne of ve){const nt=[...Ne].map((()=>0));Z.push(new Pu(Ne,q.sections,nt))}}else if(te){Z=[],J=J.map((et=>q.toCodeUnitIndex(et)));let ve=0;const Ne=[];for(const et of q.text)Ne.push(...Array(et.length).fill(q.sectionIndex[ve])),ve++;const nt=te(q.text,Ne,J);for(const et of nt){const st=[];let wt="";for(const mt of et[0])st.push(et[1][wt.length]),wt+=mt;Z.push(new Pu(et[0],q.sections,st))}}else Z=(function(ve,Ne){const nt=[];let et=0;for(const st of Ne)nt.push(ve.substring(et,st)),et=st;return et<ve.length()&&nt.push(ve.substring(et,ve.length())),nt})(q,J);const re=[],pe={positionedLines:re,text:q.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:O,iconsInText:!1,verticalizable:!1};return(function(ve,Ne,nt,et,st,wt,mt,Je,He,Mt,Et,Lt){let Ct=0,$t=0,Dn=0,yn=0;const Ai=Je==="right"?1:Je==="left"?0:.5,Qr=rr/Lt;let mr=0;for(const qn of st){qn.trim();const Gi=qn.getMaxScale(),Ji={positionedGlyphs:[],lineOffset:0};ve.positionedLines[mr]=Ji;const fi=Ji.positionedGlyphs;let oo=0;if(!qn.length()){$t+=wt,++mr;continue}const Jr=gy(et,qn,Qr);let so=0;for(const Cr of qn.text){const ki=qn.getSection(so),gr=Cr.codePointAt(0),qi=op(He,Et,gr),Mr={glyph:gr,imageName:null,x:Ct,y:$t+-17,vertical:qi,scale:1,fontStack:"",sectionIndex:qn.getSectionIndex(so),metrics:null,rect:null};let Ou;if("fontStack"in ki){if(Ou=zh(ki,gr,qi,Jr,Ne,nt),!Ou)continue;Mr.fontStack=ki.fontStack}else{if(ve.iconsInText=!0,ki.scale*=Qr,Ou=Em(ki,qi,Gi,Jr,et),!Ou)continue;oo=Math.max(oo,Ou.imageOffset),Mr.imageName=ki.imageName}const{rect:Il,metrics:ag,baselineOffset:Nh}=Ou;Mr.y+=Nh,Mr.scale=ki.scale,Mr.metrics=ag,Mr.rect=Il,fi.push(Mr),qi?(ve.verticalizable=!0,Ct+=("imageName"in ki?ag.advance:rr)*ki.scale+Mt):Ct+=ag.advance*ki.scale+Mt,so++}fi.length!==0&&(Dn=Math.max(Ct-Mt,Dn),sp(fi,0,fi.length-1,Ai)),Ct=0,Ji.lineOffset=Math.max(oo,(Gi-1)*rr);const Us=wt*Gi+oo;$t+=Us,yn=Math.max(Us,yn),++mr}const{horizontalAlign:zi,verticalAlign:yi}=Tm(mt);(function(qn,Gi,Ji,fi,oo,Jr,so,Us,Cr){const ki=(Gi-Ji)*oo;let gr=0;gr=Jr!==so?-Us*fi- -17:-fi*Cr*so+.5*so;for(const qi of qn)for(const Mr of qi.positionedGlyphs)Mr.x+=ki,Mr.y+=gr})(ve.positionedLines,Ai,zi,yi,Dn,yn,wt,$t,st.length),ve.top+=-yi*$t,ve.bottom=ve.top+$t,ve.left+=-zi*Dn,ve.right=ve.left+Dn})(pe,e,n,s,Z,m,v,w,O,A,B,G),!(function(ve){for(const Ne of ve)if(Ne.positionedGlyphs.length!==0)return!1;return!0})(re)&&pe}function Tm(i){let e=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function gy(i,e,n){const s=e.getMaxScale()*rr,{maxImageWidth:u,maxImageHeight:f}=e.getMaxImageSize(i),m=Math.max(s,f*n);return{verticalLineContentWidth:Math.max(s,u*n),horizontalLineContentHeight:m}}function Kg(i){switch(i){case"top":return 0;case"center":return .5;default:return 1}}function op(i,e,n){return!(i===E.az.horizontal||!e&&!hl(n)||e&&(fu(n)||(s=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(s)))));var s}function zh(i,e,n,s,u,f){const m=f[i.fontStack],v=(function(A,P,O,B){if(A&&A.rect)return A;const F=P[O.fontStack],G=F&&F[B];return G?{rect:null,metrics:G.metrics}:null})(m&&m[e],u,i,e);if(v===null)return null;let w;if(n)w=s.verticalLineContentWidth-i.scale*rr;else{const A=Kg(i.verticalAlign);w=(s.horizontalLineContentHeight-i.scale*rr)*A}return{rect:v.rect,metrics:v.metrics,baselineOffset:w}}function Em(i,e,n,s,u){const f=u[i.imageName];if(!f)return null;const m=f.paddedRect,v=f.displaySize,w={width:v[0],height:v[1],left:1,top:-3,advance:e?v[1]:v[0]};let A;if(e)A=s.verticalLineContentWidth-v[1]*i.scale;else{const P=Kg(i.verticalAlign);A=(s.horizontalLineContentHeight-v[1]*i.scale)*P}return{rect:m,metrics:w,baselineOffset:A,imageOffset:(e?v[0]:v[1])*i.scale-rr*n}}function sp(i,e,n,s){if(s===0)return;const u=i[n],f=(i[n].x+u.metrics.advance*u.scale)*s;for(let m=e;m<=n;m++)i[m].x-=f}function Cm(i,e,n){const{horizontalAlign:s,verticalAlign:u}=Tm(n),f=e[0]-i.displaySize[0]*s,m=e[1]-i.displaySize[1]*u;return{image:i,top:m,bottom:m+i.displaySize[1],left:f,right:f+i.displaySize[0]}}function Al(i){var e,n;let s=i.left,u=i.top,f=i.right-s,m=i.bottom-u;const v=(e=i.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",w=(n=i.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",A=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(w==="proportional"){if(v==="stretchOnly"&&f/m<A||v==="proportional"){const P=Math.ceil(m*A);s*=P/f,f=P}}else if(v==="proportional"&&w==="stretchOnly"&&A!==0&&f/m>A){const P=Math.ceil(f/A);u*=P/m,m=P}return{x1:s,y1:u,x2:s+f,y2:u+m}}function os(i,e,n,s,u,f){const m=i.image;let v;if(m.content){const Z=m.content,J=m.pixelRatio||1;v=[Z[0]/J,Z[1]/J,m.displaySize[0]-Z[2]/J,m.displaySize[1]-Z[3]/J]}const w=e.left*f,A=e.right*f;let P,O,B,F;n==="width"||n==="both"?(F=u[0]+w-s[3],O=u[0]+A+s[1]):(F=u[0]+(w+A-m.displaySize[0])/2,O=F+m.displaySize[0]);const G=e.top*f,q=e.bottom*f;return n==="height"||n==="both"?(P=u[1]+G-s[0],B=u[1]+q+s[2]):(P=u[1]+(G+q-m.displaySize[1])/2,B=P+m.displaySize[1]),{image:m,top:P,right:O,bottom:B,left:F,collisionPadding:v}}zt("ImagePosition",Qn),zt("ImageAtlas",ap),E.az=void 0,(yc=E.az||(E.az={}))[yc.none=0]="none",yc[yc.horizontal=1]="horizontal",yc[yc.vertical=2]="vertical",yc[yc.horizontalOnly=3]="horizontalOnly";const ro=128,vc=32640;function Mm(i,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new On(i+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:u}=n;let f=0;for(;f<s.length&&s[f]<=i;)f++;f=Math.max(0,f-1);let m=f;for(;m<s.length&&s[m]<i+1;)m++;m=Math.min(s.length-1,m);const v=s[f],w=s[m];return n.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:u}:{kind:"camera",minZoom:v,maxZoom:w,minSize:n.evaluate(new On(v)),maxSize:n.evaluate(new On(w)),interpolationType:u}}}function lp(i,e,n){let s="never";const u=i.get(e);return u?s=u:i.get(n)&&(s="always"),s}const Qg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ld(i,e,n,s,u,f,m,v,w,A,P,O,B){const F=v?Math.min(vc,Math.round(v[0])):0,G=v?Math.min(vc,Math.round(v[1])):0;i.emplaceBack(e,n,Math.round(32*s),Math.round(32*u),f,m,(F<<1)+(w?1:0),G,16*A,16*P,256*O,256*B)}function Am(i,e,n){i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n)}function zm(i){for(const e of i.sections)if(Ko(e.text))return!0;return!1}class cp{constructor(e){this.layoutVertexArray=new ge,this.indexArray=new Ve,this.programConfigurations=e,this.segments=new St,this.dynamicLayoutVertexArray=new Ae,this.opacityVertexArray=new Ge,this.hasVisibleVertices=!1,this.placedSymbolArray=new x}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,s,u){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ng.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Dd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Qg,!0),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}zt("SymbolBuffers",cp);class up{constructor(e,n,s){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new s,this.segments=new St,this.collisionVertexArray=new je}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,xm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}zt("CollisionBuffers",up);class Dh{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((m=>m.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mm(this.zoom,n["text-size"]),this.iconSizeData=Mm(this.zoom,n["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),f=s.get("symbol-z-order");this.canOverlap=lp(s,"text-overlap","text-allow-overlap")!=="never"||lp(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&!u.isConstant(),this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map((m=>E.az[m]))),this.stateDependentLayerIds=this.layers.filter((m=>m.isStateDependent())).map((m=>m.id)),this.sourceID=e.sourceID}createArrays(){this.text=new cp(new Ls(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new cp(new Ls(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new L,this.lineVertexArray=new k,this.symbolInstances=new z,this.textAnchorOffsets=new j}calculateGlyphDependencies(e,n,s,u,f){for(const m of e)if(n[m.codePointAt(0)]=!0,(s||u)&&f){const v=Eh[m];v&&(n[v.codePointAt(0)]=!0)}}populate(e,n,s){const u=this.layers[0],f=u.layout,m=f.get("text-font"),v=f.get("text-field"),w=f.get("icon-image"),A=(v.value.kind!=="constant"||v.value.value instanceof er&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),P=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,O=f.get("symbol-sort-key");if(this.features=[],!A&&!P)return;const B=n.iconDependencies,F=n.glyphDependencies,G=n.availableImages,q=new On(this.zoom);for(const{feature:Z,id:J,index:de,sourceLayerIndex:te}of e){const re=u._featureFilter.needGeometry,pe=no(Z,re);if(!u._featureFilter.filter(q,pe,s))continue;let ve,Ne;if(re||(pe.geometry=is(Z)),A){const et=u.getValueAndResolveTokens("text-field",pe,s,G),st=er.factory(et),wt=this.hasRTLText=this.hasRTLText||zm(st);(!wt||za.getRTLTextPluginStatus()==="unavailable"||wt&&za.isParsed())&&(ve=Fa(st,u,pe))}if(P){const et=u.getValueAndResolveTokens("icon-image",pe,s,G);Ne=et instanceof Ir?et:Ir.fromString(et)}if(!ve&&!Ne)continue;const nt=this.sortFeaturesByKey?O.evaluate(pe,{},s):void 0;if(this.features.push({id:J,text:ve,icon:Ne,index:de,sourceLayerIndex:te,geometry:pe.geometry,properties:Z.properties,type:wh.types[Z.type],sortKey:nt}),Ne&&(B[Ne.name]=!0),ve){const et=m.evaluate(pe,{},s).join(","),st=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.az.vertical)>=0;for(const wt of ve.sections)if(wt.image)B[wt.image.name]=!0;else{const mt=zo(ve.toString()),Je=wt.fontStack||et,He=F[Je]=F[Je]||{};this.calculateGlyphDependencies(wt.text,He,st,this.allowVerticalPlacement,mt)}}}f.get("symbol-placement")==="line"&&(this.features=(function(Z){const J={},de={},te=[];let re=0;function pe(et){te.push(Z[et]),re++}function ve(et,st,wt){const mt=de[et];return delete de[et],de[st]=mt,te[mt].geometry[0].pop(),te[mt].geometry[0]=te[mt].geometry[0].concat(wt[0]),mt}function Ne(et,st,wt){const mt=J[st];return delete J[st],J[et]=mt,te[mt].geometry[0].shift(),te[mt].geometry[0]=wt[0].concat(te[mt].geometry[0]),mt}function nt(et,st,wt){const mt=wt?st[0][st[0].length-1]:st[0][0];return`${et}:${mt.x}:${mt.y}`}for(let et=0;et<Z.length;et++){const st=Z[et],wt=st.geometry,mt=st.text?st.text.toString():null;if(!mt){pe(et);continue}const Je=nt(mt,wt),He=nt(mt,wt,!0);if(Je in de&&He in J&&de[Je]!==J[He]){const Mt=Ne(Je,He,wt),Et=ve(Je,He,te[Mt].geometry);delete J[Je],delete de[He],de[nt(mt,te[Et].geometry,!0)]=Et,te[Mt].geometry=null}else Je in de?ve(Je,He,wt):He in J?Ne(Je,He,wt):(pe(et),J[Je]=re-1,de[He]=re-1)}return te.filter((et=>et.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Z,J)=>Z.sortKey-J.sortKey))}update(e,n,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,{imagePositions:s}),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,{imagePositions:s}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const s=this.lineVertexArray.length;if(e.segment!==void 0){let u=e.dist(n[e.segment+1]),f=e.dist(n[e.segment]);const m={};for(let v=e.segment+1;v<n.length;v++)m[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:u},v<n.length-1&&(u+=n[v+1].dist(n[v]));for(let v=e.segment||0;v>=0;v--)m[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:f},v>0&&(f+=n[v-1].dist(n[v]));for(let v=0;v<n.length;v++){const w=m[v];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,n,s,u,f,m,v,w,A,P,O,B){const F=e.indexArray,G=e.layoutVertexArray,q=e.segments.prepareSegment(4*n.length,G,F,this.canOverlap?m.sortKey:void 0),Z=this.glyphOffsetArray.length,J=q.vertexLength,de=this.allowVerticalPlacement&&v===E.az.vertical?Math.PI/2:0,te=m.text&&m.text.sections;for(let re=0;re<n.length;re++){const{tl:pe,tr:ve,bl:Ne,br:nt,tex:et,pixelOffsetTL:st,pixelOffsetBR:wt,minFontScaleX:mt,minFontScaleY:Je,glyphOffset:He,isSDF:Mt,sectionIndex:Et}=n[re],Lt=q.vertexLength,Ct=He[1];Ld(G,w.x,w.y,pe.x,Ct+pe.y,et.x,et.y,s,Mt,st.x,st.y,mt,Je),Ld(G,w.x,w.y,ve.x,Ct+ve.y,et.x+et.w,et.y,s,Mt,wt.x,st.y,mt,Je),Ld(G,w.x,w.y,Ne.x,Ct+Ne.y,et.x,et.y+et.h,s,Mt,st.x,wt.y,mt,Je),Ld(G,w.x,w.y,nt.x,Ct+nt.y,et.x+et.w,et.y+et.h,s,Mt,wt.x,wt.y,mt,Je),Am(e.dynamicLayoutVertexArray,w,de),F.emplaceBack(Lt,Lt+2,Lt+1),F.emplaceBack(Lt+1,Lt+2,Lt+3),q.vertexLength+=4,q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(He[0]),re!==n.length-1&&Et===n[re+1].sectionIndex||e.programConfigurations.populatePaintArrays(G.length,m,m.index,{imagePositions:{},canonical:B,formattedSection:te&&te[Et]})}e.placedSymbolArray.emplaceBack(w.x,w.y,Z,this.glyphOffsetArray.length-Z,J,A,P,w.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],v,0,!1,0,O)}_addCollisionDebugVertex(e,n,s,u,f,m){return n.emplaceBack(0,0),e.emplaceBack(s.x,s.y,u,f,Math.round(m.x),Math.round(m.y))}addCollisionDebugVertices(e,n,s,u,f,m,v){const w=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),A=w.vertexLength,P=f.layoutVertexArray,O=f.collisionVertexArray,B=v.anchorX,F=v.anchorY;this._addCollisionDebugVertex(P,O,m,B,F,new N(e,n)),this._addCollisionDebugVertex(P,O,m,B,F,new N(s,n)),this._addCollisionDebugVertex(P,O,m,B,F,new N(s,u)),this._addCollisionDebugVertex(P,O,m,B,F,new N(e,u)),w.vertexLength+=4;const G=f.indexArray;G.emplaceBack(A,A+1),G.emplaceBack(A+1,A+2),G.emplaceBack(A+2,A+3),G.emplaceBack(A+3,A),w.primitiveLength+=4}addDebugCollisionBoxes(e,n,s,u){for(let f=e;f<n;f++){const m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,u?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new up(Fe,Ba.members,vt),this.iconCollisionBox=new up(Fe,Ba.members,vt);for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(e,n,s,u,f,m,v,w,A){const P={};for(let O=n;O<s;O++){const B=e.get(O);P.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.textFeatureIndex=B.featureIndex;break}for(let O=u;O<f;O++){const B=e.get(O);P.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.verticalTextFeatureIndex=B.featureIndex;break}for(let O=m;O<v;O++){const B=e.get(O);P.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.iconFeatureIndex=B.featureIndex;break}for(let O=w;O<A;O++){const B=e.get(O);P.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.verticalIconFeatureIndex=B.featureIndex;break}return P}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const s=e.placedSymbolArray.get(n),u=s.vertexStartIndex+4*s.numGlyphs;for(let f=s.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+2,f+1),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),s=Math.cos(e),u=[],f=[],m=[];for(let v=0;v<this.symbolInstances.length;++v){m.push(v);const w=this.symbolInstances.get(v);u.push(0|Math.round(n*w.anchorX+s*w.anchorY)),f.push(w.featureIndex)}return m.sort(((v,w)=>u[v]-u[w]||f[w]-f[v])),m}addToSortKeyRanges(e,n){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===n?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const s=this.symbolInstances.get(n);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach(((u,f,m)=>{u>=0&&m.indexOf(u)===f&&this.addIndicesForPlacedSymbol(this.text,u)})),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let hp,dp;zt("SymbolBucket",Dh,{omit:["layers","collisionBoxArray","features","compareText"]}),Dh.MAX_GLYPHS=65535,Dh.addDynamicAttributes=Am;var Dm={get paint(){return dp=dp||new Li({"icon-opacity":new Bt(Me.paint_symbol["icon-opacity"]),"icon-color":new Bt(Me.paint_symbol["icon-color"]),"icon-halo-color":new Bt(Me.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bt(Me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bt(Me.paint_symbol["icon-halo-blur"]),"icon-translate":new Dt(Me.paint_symbol["icon-translate"]),"icon-translate-anchor":new Dt(Me.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bt(Me.paint_symbol["text-opacity"]),"text-color":new Bt(Me.paint_symbol["text-color"],{runtimeType:ta,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Bt(Me.paint_symbol["text-halo-color"]),"text-halo-width":new Bt(Me.paint_symbol["text-halo-width"]),"text-halo-blur":new Bt(Me.paint_symbol["text-halo-blur"]),"text-translate":new Dt(Me.paint_symbol["text-translate"]),"text-translate-anchor":new Dt(Me.paint_symbol["text-translate-anchor"])})},get layout(){return hp=hp||new Li({"symbol-placement":new Dt(Me.layout_symbol["symbol-placement"]),"symbol-spacing":new Dt(Me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Dt(Me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bt(Me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Dt(Me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Dt(Me.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Dt(Me.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Dt(Me.layout_symbol["icon-ignore-placement"]),"icon-optional":new Dt(Me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Dt(Me.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bt(Me.layout_symbol["icon-size"]),"icon-text-fit":new Dt(Me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Dt(Me.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bt(Me.layout_symbol["icon-image"]),"icon-rotate":new Bt(Me.layout_symbol["icon-rotate"]),"icon-padding":new Bt(Me.layout_symbol["icon-padding"]),"icon-keep-upright":new Dt(Me.layout_symbol["icon-keep-upright"]),"icon-offset":new Bt(Me.layout_symbol["icon-offset"]),"icon-anchor":new Bt(Me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Dt(Me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Dt(Me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Dt(Me.layout_symbol["text-rotation-alignment"]),"text-field":new Bt(Me.layout_symbol["text-field"]),"text-font":new Bt(Me.layout_symbol["text-font"]),"text-size":new Bt(Me.layout_symbol["text-size"]),"text-max-width":new Bt(Me.layout_symbol["text-max-width"]),"text-line-height":new Dt(Me.layout_symbol["text-line-height"]),"text-letter-spacing":new Bt(Me.layout_symbol["text-letter-spacing"]),"text-justify":new Bt(Me.layout_symbol["text-justify"]),"text-radial-offset":new Bt(Me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Dt(Me.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Bt(Me.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Bt(Me.layout_symbol["text-anchor"]),"text-max-angle":new Dt(Me.layout_symbol["text-max-angle"]),"text-writing-mode":new Dt(Me.layout_symbol["text-writing-mode"]),"text-rotate":new Bt(Me.layout_symbol["text-rotate"]),"text-padding":new Dt(Me.layout_symbol["text-padding"]),"text-keep-upright":new Dt(Me.layout_symbol["text-keep-upright"]),"text-transform":new Bt(Me.layout_symbol["text-transform"]),"text-offset":new Bt(Me.layout_symbol["text-offset"]),"text-allow-overlap":new Dt(Me.layout_symbol["text-allow-overlap"]),"text-overlap":new Dt(Me.layout_symbol["text-overlap"]),"text-ignore-placement":new Dt(Me.layout_symbol["text-ignore-placement"]),"text-optional":new Dt(Me.layout_symbol["text-optional"])})}};class Jg{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:vn,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zt("FormatSectionOverride",Jg,{omit:["defaultValue"]});class xc extends gi{constructor(e,n){super(e,Dm,n)}recalculate(e,n){if(super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const f of s)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,n,s,u){const f=this.layout.get(e).evaluate(n,{},s,u),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||Ms(m.value)||!f?f:(function(v,w){return w.replace(/{([^{}]+)}/g,((A,P)=>v&&P in v?String(v[P]):""))})(n.properties,f)}createBucket(e){return new Dh(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Dm.paint.overridableProperties){if(!xc.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),s=new Jg(n),u=new rh(s,n.property.specification);let f=null;f=n.value.kind==="constant"||n.value.kind==="source"?new Fr("source",u):new As("composite",u,n.value.zoomStops),this.paint._values[e]=new ha(n.property,f,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven())&&xc.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const s=e.get("text-field"),u=Dm.paint.properties[n];let f=!1;const m=v=>{for(const w of v)if(u.overrides&&u.overrides.hasOverride(w))return void(f=!0)};if(s.value.kind==="constant"&&s.value.value instanceof er)m(s.value.value.sections);else if(s.value.kind==="source"||s.value.kind==="composite"){const v=A=>{f||(A instanceof ia&&li(A.value)===ho?m(A.value.sections):A instanceof Yc?m(A.sections):A.eachChild(v))},w=s.value;w._styleExpression&&v(w._styleExpression.expression)}return f}}let e_;var t_={get paint(){return e_=e_||new Li({"background-color":new Dt(Me.paint_background["background-color"]),"background-pattern":new uc(Me.paint_background["background-pattern"]),"background-opacity":new Dt(Me.paint_background["background-opacity"])})}};class Cn extends gi{constructor(e,n){super(e,t_,n)}}class Pm extends gi{constructor(e,n){super(e,{},n),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class fp{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Rm={once:!0},pp=63710088e-1;class js{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new js(tn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,s=this.lat*n,u=e.lat*n,f=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((e.lng-this.lng)*n);return pp*Math.acos(Math.min(f,1))}static convert(e){if(e instanceof js)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new js(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new js(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ph=2*Math.PI*pp;function Od(i){return Ph*Math.cos(i*Math.PI/180)}function n_(i){return(180+i)/360}function Im(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function i_(i,e){return i/Od(e)}function r_(i){return 360*i-180}function kd(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Lm(i,e){return i*Od(kd(e))}class Un{constructor(e,n,s=0){this.x=+e,this.y=+n,this.z=+s}static fromLngLat(e,n=0){const s=js.convert(e);return new Un(n_(s.lng),Im(s.lat),i_(n,s.lat))}toLngLat(){return new js(r_(this.x),kd(this.y))}toAltitude(){return Lm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ph*(e=kd(this.y),1/Math.cos(e*Math.PI/180));var e}}function mp(i,e,n){var s=2*Math.PI*6378137/256/Math.pow(2,n);return[i*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class xr{constructor(e,n,s){if(!(function(u,f,m){return!(u<0||u>25||m<0||m>=Math.pow(2,u)||f<0||f>=Math.pow(2,u))})(e,n,s))throw new Error(`x=${n}, y=${s}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=n,this.y=s,this.key=Rh(0,e,e,n,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n,s){const u=(m=this.y,v=this.z,w=mp(256*(f=this.x),256*(m=Math.pow(2,v)-m-1),v),A=mp(256*(f+1),256*(m+1),v),w[0]+","+w[1]+","+A[0]+","+A[1]);var f,m,v,w,A;const P=(function(O,B,F){let G,q="";for(let Z=O;Z>0;Z--)G=1<<Z-1,q+=(B&G?1:0)+(F&G?2:0);return q})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,u)}isChildOf(e){const n=this.z-e.z;return n>0&&e.x===this.x>>n&&e.y===this.y>>n}getTilePoint(e){const n=Math.pow(2,this.z);return new N((e.x*n-this.x)*yt,(e.y*n-this.y)*yt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class a_{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Rh(e,n.z,n.z,n.x,n.y)}}class Na{constructor(e,n,s,u,f){if(this.terrainRttPosMatrix32f=null,e<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${s}`);this.overscaledZ=e,this.wrap=n,this.canonical=new xr(s,+u,+f),this.key=Rh(n,e,s,u,f)}clone(){return new Na(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-e;return e>this.canonical.z?new Na(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Na(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,n){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-e;return e>this.canonical.z?Rh(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):Rh(this.wrap*+n,e,e,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(e){if(e.wrap!==this.wrap||this.overscaledZ-e.overscaledZ<=0)return!1;if(e.overscaledZ===0)return this.overscaledZ>0;const n=this.canonical.z-e.canonical.z;return!(n<0)&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Na(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new Na(n,this.wrap,n,s,u),new Na(n,this.wrap,n,s+1,u),new Na(n,this.wrap,n,s,u+1),new Na(n,this.wrap,n,s+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Na(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Na(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new a_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Un(e.x-this.wrap,e.y))}}function Rh(i,e,n,s,u){(i*=2)<0&&(i=-1*i-1);const f=1<<n;return(f*f*i+f*u+s).toString(36)+n.toString(36)+e.toString(36)}function Bd(i,e){return e?i.properties[e]:i.id}function Om(i,e){const n={id:i.id};if(e.removeAllProperties&&(delete i.removeProperties,delete i.addOrUpdateProperties,delete e.removeProperties),e.removeProperties)for(const s of e.removeProperties){const u=i.addOrUpdateProperties.findIndex((f=>f.key===s));u>-1&&i.addOrUpdateProperties.splice(u,1)}return(i.removeAllProperties||e.removeAllProperties)&&(n.removeAllProperties=!0),(i.removeProperties||e.removeProperties)&&(n.removeProperties=[...i.removeProperties||[],...e.removeProperties||[]]),(i.addOrUpdateProperties||e.addOrUpdateProperties)&&(n.addOrUpdateProperties=[...i.addOrUpdateProperties||[],...e.addOrUpdateProperties||[]]),(i.newGeometry||e.newGeometry)&&(n.newGeometry=e.newGeometry||i.newGeometry),n}function Fd(i){var e,n;if(!i)return{};const s={};return s.removeAll=i.removeAll,s.remove=new Set(i.remove||[]),s.add=new Map((e=i.add)===null||e===void 0?void 0:e.map((u=>[u.id,u]))),s.update=new Map((n=i.update)===null||n===void 0?void 0:n.map((u=>[u.id,u]))),s}zt("CanonicalTileID",xr),zt("OverscaledTileID",Na,{omit:["terrainRttPosMatrix32f"]});class bc{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const n=new bc;return n.extend(e(new N(this.minX,this.minY))),n.extend(e(new N(this.maxX,this.minY))),n.extend(e(new N(this.minX,this.maxY))),n.extend(e(new N(this.maxX,this.maxY))),n}static fromPoints(e){const n=new bc;for(const s of e)n.extend(s);return n}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class km{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const s=e[n];this._stringToNumber[s]=n,this._numberToString[n]=s}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class gp{constructor(e,n,s,u,f){this.type="Feature",this._vectorTileFeature=e,this._x=s,this._y=u,this._z=n,this.properties=e.properties,this.id=f}projectPoint(e,n,s,u){return[360*(e.x+n)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+s)/u)*Math.PI))-90]}projectLine(e,n,s,u){return e.map((f=>this.projectPoint(f,n,s,u)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,n=e.extent*Math.pow(2,this._z),s=e.extent*this._x,u=e.extent*this._y,f=e.loadGeometry();switch(e.type){case 1:{const m=[];for(const w of f)m.push(w[0]);const v=this.projectLine(m,s,u,n);this._geometry=m.length===1?{type:"Point",coordinates:v[0]}:{type:"MultiPoint",coordinates:v};break}case 2:{const m=f.map((v=>this.projectLine(v,s,u,n)));this._geometry=m.length===1?{type:"LineString",coordinates:m[0]}:{type:"MultiLineString",coordinates:m};break}case 3:{const m=Bg(f),v=[];for(const w of m)v.push(w.map((A=>this.projectLine(A,s,u,n))));this._geometry=v.length===1?{type:"Polygon",coordinates:v[0]}:{type:"MultiPolygon",coordinates:v};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&n!=="_x"&&n!=="_y"&&n!=="_z"&&(e[n]=this[n]);return e}}class wc{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,n,s){this._name=e,this.dataBuffer=n,typeof s=="number"?this._size=s:(this.nullabilityBuffer=s,this._size=s.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class _p extends wc{}class yp extends _p{getValueFromBuffer(e){return this.dataBuffer[e]}}class Bm extends _p{getValueFromBuffer(e){return this.dataBuffer[e]}}class Fm extends wc{delta;constructor(e,n,s,u){super(e,n,u),this.delta=s}}class Nm extends Fm{constructor(e,n,s,u){super(e,Int32Array.of(n),s,u)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class jm extends wc{constructor(e,n,s){super(e,Int32Array.of(n),s)}getValueFromBuffer(e){return this.dataBuffer[0]}}class Sc{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,n,s,u,f=4096){this._name=e,this._geometryVector=n,this._idVector=s,this._propertyVectors=u,this._extent=f}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((n=>[n.name,n])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let n=0;for(;n<this.numFeatures;){let s;this.idVector&&(s=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(n)):this.idVector.getValue(n));const u=e?.next().value,f={};for(const m of this.propertyVectors){if(!m)continue;const v=m.name,w=m.getValue(n);w!==null&&(f[v]=w)}n++,yield{id:s,geometry:u,properties:f}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],n=this.geometryVector.getGeometries();for(let s=0;s<this.numFeatures;s++){let u;this.idVector&&(u=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(s)):this.idVector.getValue(s));const f={coordinates:n[s],type:this.geometryVector.geometryType(s)},m={};for(const v of this.propertyVectors){if(!v)continue;const w=v.name,A=v.getValue(s);A!==null&&(m[w]=A)}e.push({id:u,geometry:f,properties:m})}return e}containsMaxSaveIntegerValues(e){return e instanceof yp||e instanceof jm&&e instanceof Nm||e instanceof Bm}}class o_{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var mn,ss,Tr,ls,Tc,Yr,Qi,fr,ao,ga;function pr(i,e,n){const s=new Int32Array(n);let u=0,f=e.get();for(let m=0;m<s.length;m++){let v=i[f++],w=127&v;v<128||(v=i[f++],w|=(127&v)<<7,v<128||(v=i[f++],w|=(127&v)<<14,v<128||(v=i[f++],w|=(127&v)<<21,v<128||(v=i[f++],w|=(15&v)<<28)))),s[u++]=w}return e.set(f),s}function Nd(i,e,n){const s=new BigInt64Array(n);for(let u=0;u<s.length;u++)s[u]=vp(i,e);return s}function s_(i,e){let n,s;return s=i[e.get()],e.increment(),n=127&s,s<128?n:(s=i[e.get()],e.increment(),n|=(127&s)<<7,s<128?n:(s=i[e.get()],e.increment(),n|=(127&s)<<14,s<128?n:(s=i[e.get()],e.increment(),n|=(127&s)<<21,s<128?n:(s=i[e.get()],n|=(15&s)<<28,(function(u,f,m){let v,w;if(w=f[m.get()],m.increment(),v=(112&w)>>4,w<128||(w=f[m.get()],m.increment(),v|=(127&w)<<3,w<128)||(w=f[m.get()],m.increment(),v|=(127&w)<<10,w<128)||(w=f[m.get()],m.increment(),v|=(127&w)<<17,w<128)||(w=f[m.get()],m.increment(),v|=(127&w)<<24,w<128)||(w=f[m.get()],m.increment(),v|=(1&w)<<31,w<128))return 4294967296*v+(u>>>0);throw new Error("Expected varint not more than 10 bytes")})(n,i,e)))))}function Ih(i,e,n,s){throw new Error("FastPFor is not implemented yet.")}function Er(i){return i>>>1^-(1&i)}function Ru(i){return i>>1n^-(1n&i)}function vp(i,e){let n=0n,s=0,u=e.get();for(;u<i.length;){const f=i[u++];if(n|=BigInt(127&f)<<BigInt(s),!(128&f))break;if(s+=7,s>=64)throw new Error("Varint too long")}return e.set(u),n}function Vs(i,e,n){const s=new Int32Array(n);let u=0;for(let f=0;f<e;f++){const m=i[f];s.fill(i[f+e],u,u+m),u+=m}return s}function l_(i,e,n){const s=new BigInt64Array(n);let u=0;for(let f=0;f<e;f++){const m=Number(i[f]);s.fill(i[f+e],u,u+m),u+=m}return s}function c_(i,e,n){const s=new Float64Array(n);let u=0;for(let f=0;f<e;f++){const m=i[f];s.fill(i[f+e],u,u+m),u+=m}return s}function Ec(i){const e=i.length/4*4;let n=1;if(e>=4)for(let s=i[0];n<e-4;n+=4)s=i[n]+=s,s=i[n+1]+=s,s=i[n+2]+=s,s=i[n+3]+=s;for(;n!=i.length;)i[n]+=i[n-1],++n}function Vm(i){i[0]=i[0]>>>1^-(1&i[0]),i[1]=i[1]>>>1^-(1&i[1]);const e=i.length/4*4;let n=2;if(e>=4)for(;n<e-4;n+=4){const s=i[n],u=i[n+1],f=i[n+2],m=i[n+3];i[n]=(s>>>1^-(1&s))+i[n-2],i[n+1]=(u>>>1^-(1&u))+i[n-1],i[n+2]=(f>>>1^-(1&f))+i[n],i[n+3]=(m>>>1^-(1&m))+i[n+1]}for(;n!=i.length;n+=2)i[n]=(i[n]>>>1^-(1&i[n]))+i[n-2],i[n+1]=(i[n+1]>>>1^-(1&i[n+1]))+i[n-1]}(function(i){i.NONE="NONE",i.DELTA="DELTA",i.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",i.RLE="RLE",i.MORTON="MORTON",i.PDE="PDE"})(mn||(mn={})),(function(i){i.NONE="NONE",i.FAST_PFOR="FAST_PFOR",i.VARINT="VARINT",i.ALP="ALP"})(ss||(ss={})),(function(i){i.PRESENT="PRESENT",i.DATA="DATA",i.OFFSET="OFFSET",i.LENGTH="LENGTH"})(Tr||(Tr={}));class Um{_dictionaryType;_offsetType;_lengthType;constructor(e,n,s){this._dictionaryType=e,this._offsetType=n,this._lengthType=s}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function Wr(i,e){const n=(function(s,u){const f=s[u.get()],m=Object.values(Tr)[f>>4];let v=null;switch(m){case Tr.DATA:v=new Um(Object.values(ls)[15&f]);break;case Tr.OFFSET:v=new Um(null,Object.values(Tc)[15&f]);break;case Tr.LENGTH:v=new Um(null,null,Object.values(Yr)[15&f])}u.increment();const w=s[u.get()],A=Object.values(mn)[w>>5],P=Object.values(mn)[w>>2&7],O=Object.values(ss)[3&w];u.increment();const B=pr(s,u,2),F=B[0];return{physicalStreamType:m,logicalStreamType:v,logicalLevelTechnique1:A,logicalLevelTechnique2:P,physicalLevelTechnique:O,numValues:F,byteLength:B[1],decompressedCount:F}})(i,e);return n.logicalLevelTechnique1===mn.MORTON?(function(s,u,f){const m=pr(u,f,2);return{physicalStreamType:s.physicalStreamType,logicalStreamType:s.logicalStreamType,logicalLevelTechnique1:s.logicalLevelTechnique1,logicalLevelTechnique2:s.logicalLevelTechnique2,physicalLevelTechnique:s.physicalLevelTechnique,numValues:s.numValues,byteLength:s.byteLength,decompressedCount:s.decompressedCount,numBits:m[0],coordinateShift:m[1]}})(n,i,e):mn.RLE!==n.logicalLevelTechnique1&&mn.RLE!==n.logicalLevelTechnique2||ss.NONE===n.physicalLevelTechnique?n:(function(s,u,f){const m=pr(u,f,2);return{physicalStreamType:s.physicalStreamType,logicalStreamType:s.logicalStreamType,logicalLevelTechnique1:s.logicalLevelTechnique1,logicalLevelTechnique2:s.logicalLevelTechnique2,physicalLevelTechnique:s.physicalLevelTechnique,numValues:s.numValues,byteLength:s.byteLength,decompressedCount:m[1],runs:m[0],numRleValues:m[1]}})(n,i,e)}(function(i){i.NONE="NONE",i.SINGLE="SINGLE",i.SHARED="SHARED",i.VERTEX="VERTEX",i.MORTON="MORTON",i.FSST="FSST"})(ls||(ls={})),(function(i){i.VERTEX="VERTEX",i.INDEX="INDEX",i.STRING="STRING",i.KEY="KEY"})(Tc||(Tc={})),(function(i){i.VAR_BINARY="VAR_BINARY",i.GEOMETRIES="GEOMETRIES",i.PARTS="PARTS",i.RINGS="RINGS",i.TRIANGLES="TRIANGLES",i.SYMBOL="SYMBOL",i.DICTIONARY="DICTIONARY"})(Yr||(Yr={})),(function(i){i[i.FLAT=0]="FLAT",i[i.CONST=1]="CONST",i[i.SEQUENCE=2]="SEQUENCE",i[i.DICTIONARY=3]="DICTIONARY",i[i.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(Qi||(Qi={}));class cs{values;_size;constructor(e,n){this.values=e,this._size=n}get(e){const n=Math.floor(e/8);return(this.values[n]>>e%8&1)==1}set(e,n){const s=Math.floor(e/8);this.values[s]=this.values[s]|(n?1:0)<<e%8}getInt(e){const n=Math.floor(e/8);return this.values[n]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function Kr(i,e,n,s,u){return(function(f,m,v){switch(m.logicalLevelTechnique1){case mn.DELTA:return m.logicalLevelTechnique2===mn.RLE?(function(w,A,P){const O=new Int32Array(P);let B=0,F=0;for(let G=0;G<A;G++){const q=w[G],Z=Er(w[G+A]);for(let J=0;J<q;J++)F+=Z,O[B++]=F}return O})(f,m.runs,m.numRleValues):((function(w){w[0]=w[0]>>>1^-(1&w[0]);const A=w.length/4*4;let P=1;if(A>=4)for(;P<A-4;P+=4){const O=w[P],B=w[P+1],F=w[P+2],G=w[P+3];w[P]=(O>>>1^-(1&O))+w[P-1],w[P+1]=(B>>>1^-(1&B))+w[P],w[P+2]=(F>>>1^-(1&F))+w[P+1],w[P+3]=(G>>>1^-(1&G))+w[P+2]}for(;P!=w.length;++P)w[P]=(w[P]>>>1^-(1&w[P]))+w[P-1]})(f),f);case mn.RLE:return(function(w,A,P){return P?(function(O,B,F){const G=new Int32Array(F);let q=0;for(let Z=0;Z<B;Z++){const J=O[Z];let de=O[Z+B];de=de>>>1^-(1&de),G.fill(de,q,q+J),q+=J}return G})(w,A.runs,A.numRleValues):Vs(w,A.runs,A.numRleValues)})(f,m,v);case mn.MORTON:return Ec(f),f;case mn.COMPONENTWISE_DELTA:return Vm(f),f;case mn.NONE:return v&&(function(w){for(let A=0;A<w.length;A++){const P=w[A];w[A]=P>>>1^-(1&P)}})(f),f;default:throw new Error(`The specified Logical level technique is not supported: ${m.logicalLevelTechnique1}`)}})(xp(i,e,n),n,s)}function Cc(i,e,n){return(function(s,u){if(u.logicalLevelTechnique1===mn.DELTA&&u.logicalLevelTechnique2===mn.NONE)return(function(m){const v=new Int32Array(m.length+1);v[0]=0,v[1]=Er(m[0]);let w=v[1],A=2;for(;A!=v.length;++A){const P=m[A-1];w+=P>>>1^-(1&P),v[A]=v[A-1]+w}return v})(s);if(u.logicalLevelTechnique1===mn.RLE&&u.logicalLevelTechnique2===mn.NONE)return(function(m,v,w){const A=new Int32Array(w+1);A[0]=0;let P=1,O=A[0];for(let B=0;B<v;B++){const F=m[B],G=m[B+v];for(let q=P;q<P+F;q++)A[q]=G+O,O=A[q];P+=F}return A})(s,u.runs,u.numRleValues);if(u.logicalLevelTechnique1===mn.NONE&&u.logicalLevelTechnique2===mn.NONE){(function(m){let v=0;for(let w=0;w<m.length;w++)m[w]+=v,v=m[w]})(s);const f=new Int32Array(u.numValues+1);return f[0]=0,f.set(s,1),f}if(u.logicalLevelTechnique1===mn.DELTA&&u.logicalLevelTechnique2===mn.RLE){const f=(function(m,v,w){const A=new Int32Array(w+1);A[0]=0;let P=1,O=A[0];for(let B=0;B<v;B++){const F=m[B];let G=m[B+v];G=G>>>1^-(1&G);for(let q=P;q<P+F;q++)A[q]=G+O,O=A[q];P+=F}return A})(s,u.runs,u.numRleValues);return Ec(f),f}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(xp(i,e,n),n)}function xp(i,e,n){const s=n.physicalLevelTechnique;if(s===ss.FAST_PFOR)return Ih();if(s===ss.VARINT)return pr(i,e,n.numValues);if(s===ss.NONE){const u=e.get();e.add(n.byteLength);const f=i.subarray(u,e.get());return new Int32Array(f)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function Gm(i,e,n,s){const u=xp(i,e,n);if(u.length===1){const f=u[0];return s?Er(f):f}return s?(function(f){return Er(f[1])})(u):(function(f){return f[1]})(u)}function qm(i,e,n){return(function(s){if(s.length==2){const u=Er(s[1]);return[u,u]}return[Er(s[2]),Er(s[3])]})(xp(i,e,n))}function Iu(i,e,n){return(function(s){if(s.length==2){const u=Ru(s[1]);return[u,u]}return[Ru(s[2]),Ru(s[3])]})(Nd(i,e,n.numValues))}function Lh(i,e,n,s){return(function(u,f,m){switch(f.logicalLevelTechnique1){case mn.DELTA:return f.logicalLevelTechnique2===mn.RLE?(function(v,w,A){const P=new BigInt64Array(A);let O=0,B=0n;for(let F=0;F<w;F++){const G=Number(v[F]),q=Ru(v[F+w]);for(let Z=0;Z<G;Z++)B+=q,P[O++]=B}return P})(u,f.runs,f.numRleValues):((function(v){v[0]=v[0]>>1n^-(1n&v[0]);const w=v.length/4*4;let A=1;if(w>=4)for(;A<w-4;A+=4){const P=v[A],O=v[A+1],B=v[A+2],F=v[A+3];v[A]=(P>>1n^-(1n&P))+v[A-1],v[A+1]=(O>>1n^-(1n&O))+v[A],v[A+2]=(B>>1n^-(1n&B))+v[A+1],v[A+3]=(F>>1n^-(1n&F))+v[A+2]}for(;A!=v.length;++A)v[A]=(v[A]>>1n^-(1n&v[A]))+v[A-1]})(u),u);case mn.RLE:return(function(v,w,A){return A?(function(P,O,B){const F=new BigInt64Array(B);let G=0;for(let q=0;q<O;q++){const Z=Number(P[q]);let J=P[q+O];J=J>>1n^-(1n&J),F.fill(J,G,G+Z),G+=Z}return F})(v,w.runs,w.numRleValues):l_(v,w.runs,w.numRleValues)})(u,f,m);case mn.NONE:return m&&(function(v){for(let w=0;w<v.length;w++){const A=v[w];v[w]=A>>1n^-(1n&A)}})(u),u;default:throw new Error(`The specified Logical level technique is not supported: ${f.logicalLevelTechnique1}`)}})(Nd(i,e,n.numValues),n,s)}function $m(i,e,n,s){const u=Nd(i,e,n.numValues);if(u.length===1){const f=u[0];return s?Ru(f):f}return s?(function(f){return Ru(f[1])})(u):(function(f){return f[1]})(u)}function Zm(i,e,n,s,u){return(function(f,m,v,w){switch(m.logicalLevelTechnique1){case mn.DELTA:return m.logicalLevelTechnique2===mn.RLE&&(f=Vs(f,m.runs,m.numRleValues)),(function(A,P){const O=new Int32Array(A.size());let B=0;A.get(0)?(O[0]=A.get(0)?P[0]>>>1^-(1&P[0]):0,B=1):O[0]=0;let F=1;for(;F!=O.length;++F)O[F]=A.get(F)?O[F-1]+(P[B]>>>1^-(1&P[B++])):O[F-1];return O})(w,f);case mn.RLE:return(function(A,P,O,B){const F=P;return O?(function(G,q,Z){const J=new Int32Array(G.size());let de=0;for(let te=0;te<Z;te++){const re=q[te];let pe=q[te+Z];pe=pe>>>1^-(1&pe);for(let ve=de;ve<de+re;ve++)G.get(ve)?J[ve]=pe:(J[ve]=0,de++);de+=re}return J})(B,A,F.runs):(function(G,q,Z){const J=new Int32Array(G.size());let de=0;for(let te=0;te<Z;te++){const re=q[te],pe=q[te+Z];for(let ve=de;ve<de+re;ve++)G.get(ve)?J[ve]=pe:(J[ve]=0,de++);de+=re}return J})(B,A,F.runs)})(f,m,v,w);case mn.MORTON:return Ec(f),f;case mn.COMPONENTWISE_DELTA:return Vm(f),f;case mn.NONE:return f=v?(function(A,P){const O=new Int32Array(A.size());let B=0,F=0;for(;F!=O.length;++F)if(A.get(F)){const G=P[B++];O[F]=G>>>1^-(1&G)}else O[F]=0;return O})(w,f):(function(A,P){const O=new Int32Array(A.size());let B=0,F=0;for(;F!=O.length;++F)O[F]=A.get(F)?P[B++]:0;return O})(w,f),f;default:throw new Error("The specified Logical level technique is not supported")}})(n.physicalLevelTechnique===ss.FAST_PFOR?Ih():pr(i,e,n.numValues),n,s,u)}function zl(i,e,n,s){const u=i.logicalLevelTechnique1;if(u===mn.RLE)return i.runs===1?Qi.CONST:Qi.FLAT;const f=e instanceof cs?e.size():e;if(u===mn.DELTA&&i.logicalLevelTechnique2===mn.RLE){const m=i.runs,v=2;if(i.numRleValues!==f)return Qi.FLAT;if(m===1)return Qi.SEQUENCE;if(m===2){const w=s.get();let A;if(i.physicalLevelTechnique===ss.VARINT)A=pr(n,s,4);else{const P=s.get();A=new Int32Array(n.buffer,n.byteOffset+P,4)}if(s.set(w),A[2]===v&&A[3]===v)return Qi.SEQUENCE}}return i.numValues===1?Qi.CONST:Qi.FLAT}class Oh extends _p{getValueFromBuffer(e){return this.dataBuffer[e]}}class Hm extends Fm{constructor(e,n,s,u){super(e,BigInt64Array.of(n),s,u)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class Dl{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,n,s){this._geometryOffsets=e,this._partOffsets=n,this._ringOffsets=s}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function jd(i,e,n){return{x:bp(i,e)-n,y:bp(i>>1,e)-n}}function bp(i,e){let n=0;for(let s=0;s<e;s++)n|=(i&1<<2*s)>>s;return n}(function(i){i[i.POINT=0]="POINT",i[i.LINESTRING=1]="LINESTRING",i[i.POLYGON=2]="POLYGON",i[i.MULTIPOINT=3]="MULTIPOINT",i[i.MULTILINESTRING=4]="MULTILINESTRING",i[i.MULTIPOLYGON=5]="MULTIPOLYGON"})(fr||(fr={})),(function(i){i[i.POINT=0]="POINT",i[i.LINESTRING=1]="LINESTRING",i[i.POLYGON=2]="POLYGON"})(ao||(ao={})),(function(i){i[i.MORTON=0]="MORTON",i[i.VEC_2=1]="VEC_2",i[i.VEC_3=2]="VEC_3"})(ga||(ga={}));class wp{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((n=>[n]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,n){return[e].concat(n)}createMultiPolygon(e){return e.flat()}}function Xm(i){const e=new Array(i.numGeometries);let n=1,s=1,u=1,f=0;const m=new wp;let v=0,w=0;const A=i.mortonSettings,P=i.topologyVector,O=P.geometryOffsets,B=P.partOffsets,F=P.ringOffsets,G=i.vertexOffsets,q=i.containsPolygonGeometry(),Z=i.vertexBuffer;for(let J=0;J<i.numGeometries;J++){const de=i.geometryType(J);if(de===fr.POINT){if(G&&G.length!==0)if(i.vertexBufferType===ga.VEC_2){const te=2*G[w++],re=new N(Z[te],Z[te+1]);e[f++]=m.createPoint(re)}else{const te=jd(Z[G[w++]],A.numBits,A.coordinateShift),re=new N(te.x,te.y);e[f++]=m.createPoint(re)}else{const te=new N(Z[v++],Z[v++]);e[f++]=m.createPoint(te)}O&&u++,B&&n++,F&&s++}else if(de===fr.MULTIPOINT){const te=O[u]-O[u-1];u++;const re=new Array(te);if(G&&G.length!==0){for(let pe=0;pe<te;pe++){const ve=2*G[w++];re[pe]=new N(Z[ve],Z[ve+1])}e[f++]=m.createMultiPoint(re)}else{for(let pe=0;pe<te;pe++){const ve=Z[v++],Ne=Z[v++];re[pe]=new N(ve,Ne)}e[f++]=m.createMultiPoint(re)}}else if(de===fr.LINESTRING){let te,re=0;q?(re=F[s]-F[s-1],s++):re=B[n]-B[n-1],n++,G&&G.length!==0?(te=i.vertexBufferType===ga.VEC_2?Gd(Z,G,w,re,!1):Wm(Z,G,w,re,!1,A),w+=re):(te=Ym(Z,v,re,!1),v+=2*re),e[f++]=m.createLineString(te),O&&u++}else if(de===fr.POLYGON){const te=B[n]-B[n-1];n++;const re=new Array(te-1);let pe=F[s]-F[s-1];if(s++,G&&G.length!==0){const ve=i.vertexBufferType===ga.VEC_2?Sp(Z,G,w,pe):Ud(Z,G,w,pe,0,A);w+=pe;for(let Ne=0;Ne<re.length;Ne++)pe=F[s]-F[s-1],s++,re[Ne]=i.vertexBufferType===ga.VEC_2?Sp(Z,G,w,pe):Ud(Z,G,w,pe,0,A),w+=pe;e[f++]=m.createPolygon(ve,re)}else{const ve=Vd(Z,v,pe);v+=2*pe;for(let Ne=0;Ne<re.length;Ne++)pe=F[s]-F[s-1],s++,re[Ne]=Vd(Z,v,pe),v+=2*pe;e[f++]=m.createPolygon(ve,re)}O&&u++}else if(de===fr.MULTILINESTRING){const te=O[u]-O[u-1];u++;const re=new Array(te);if(G&&G.length!==0){for(let pe=0;pe<te;pe++){let ve=0;q?(ve=F[s]-F[s-1],s++):ve=B[n]-B[n-1],n++;const Ne=i.vertexBufferType===ga.VEC_2?Gd(Z,G,w,ve,!1):Wm(Z,G,w,ve,!1,A);re[pe]=Ne,w+=ve}e[f++]=m.createMultiLineString(re)}else{for(let pe=0;pe<te;pe++){let ve=0;q?(ve=F[s]-F[s-1],s++):ve=B[n]-B[n-1],n++,re[pe]=Ym(Z,v,ve,!1),v+=2*ve}e[f++]=m.createMultiLineString(re)}}else{if(de!==fr.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const te=O[u]-O[u-1];u++;const re=new Array(te);let pe=0;if(G&&G.length!==0){for(let ve=0;ve<te;ve++){const Ne=B[n]-B[n-1];n++;const nt=new Array(Ne-1);pe=F[s]-F[s-1],s++;const et=i.vertexBufferType===ga.VEC_2?Sp(Z,G,w,pe):Ud(Z,G,w,pe,0,A);w+=pe;for(let st=0;st<nt.length;st++)pe=F[s]-F[s-1],s++,nt[st]=i.vertexBufferType===ga.VEC_2?Sp(Z,G,w,pe):Ud(Z,G,w,pe,0,A),w+=pe;re[ve]=m.createPolygon(et,nt)}e[f++]=m.createMultiPolygon(re)}else{for(let ve=0;ve<te;ve++){const Ne=B[n]-B[n-1];n++;const nt=new Array(Ne-1);pe=F[s]-F[s-1],s++;const et=Vd(Z,v,pe);v+=2*pe;for(let st=0;st<nt.length;st++){const wt=F[s]-F[s-1];s++,nt[st]=Vd(Z,v,wt),v+=2*wt}re[ve]=m.createPolygon(et,nt)}e[f++]=m.createMultiPolygon(re)}}}}return e}function Vd(i,e,n){return Ym(i,e,n,!0)}function Sp(i,e,n,s){return Gd(i,e,n,s,!0)}function Ud(i,e,n,s,u,f){return Wm(i,e,n,s,!0,f)}function Ym(i,e,n,s){const u=new Array(s?n+1:n);for(let f=0;f<2*n;f+=2)u[f/2]=new N(i[e+f],i[e+f+1]);return s&&(u[u.length-1]=u[0]),u}function Gd(i,e,n,s,u){const f=new Array(u?s+1:s);for(let m=0;m<2*s;m+=2){const v=2*e[n+m/2];f[m/2]=new N(i[v],i[v+1])}return u&&(f[f.length-1]=f[0]),f}function Wm(i,e,n,s,u,f){const m=new Array(u?s+1:s);for(let v=0;v<s;v++){const w=jd(i[e[n+v]],f.numBits,f.coordinateShift);m[v]=new N(w.x,w.y)}return u&&(m[m.length-1]=m[0]),m}class qd{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,n,s,u,f){this._vertexBufferType=e,this._topologyVector=n,this._vertexOffsets=s,this._vertexBuffer=u,this._mortonSettings=f}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=Xm(this);let n=0;for(;n<this.numGeometries;)yield{coordinates:e[n],type:this.geometryType(n)},n++}getSimpleEncodedVertex(e){const n=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[n],this.vertexBuffer[n+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const s=jd(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[s.x,s.y]}const n=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[n],this.vertexBuffer[n+1]]}getGeometries(){return Xm(this)}get mortonSettings(){return this._mortonSettings}}class $d extends qd{_numGeometries;_geometryType;constructor(e,n,s,u,f,m,v){super(s,u,f,m,v),this._numGeometries=e,this._geometryType=n}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===fr.POLYGON||this._geometryType===fr.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class Zd extends qd{_geometryTypes;constructor(e,n,s,u,f,m){super(e,s,u,f,m),this._geometryTypes=n}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===fr.POLYGON||this.geometryType(e)===fr.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class u_{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,n,s,u){this._triangleOffsets=e,this._indexBuffer=n,this._vertexBuffer=s,this._topologyVector=u}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),n=this._topologyVector,s=n.partOffsets,u=n.ringOffsets,f=n.geometryOffsets;let m=0,v=1,w=1,A=1;for(let P=0;P<this.numGeometries;P++)switch(this.geometryType(P)){case fr.POLYGON:{const O=s[v]-s[v-1];v++;const B=[];for(let F=0;F<O;F++){const G=u[w]-u[w-1];w++;const q=[];for(let Z=0;Z<G;Z++){const J=this._vertexBuffer[m++],de=this._vertexBuffer[m++];q.push(new N(J,de))}q.length>0&&q.push(q[0]),B.push(q)}e[P]=B,f&&A++}break;case fr.MULTIPOLYGON:{const O=f[A]-f[A-1];A++;const B=[];for(let F=0;F<O;F++){const G=s[v]-s[v-1];v++;for(let q=0;q<G;q++){const Z=u[w]-u[w-1];w++;const J=[];for(let de=0;de<Z;de++){const te=this._vertexBuffer[m++],re=this._vertexBuffer[m++];J.push(new N(te,re))}J.length>0&&J.push(J[0]),B.push(J)}}e[P]=B}}return e}[Symbol.iterator](){return null}}function kh(i,e,n,s,u,f){return new _y(i,e,n,s,u,f)}class _y extends u_{_numGeometries;_geometryType;constructor(e,n,s,u,f,m){super(s,u,f,m),this._numGeometries=e,this._geometryType=n}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function Km(i,e,n,s,u){return new h_(i,e,n,s,u)}class h_ extends u_{_geometryTypes;constructor(e,n,s,u,f){super(n,s,u,f),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function d_(i,e,n,s,u){const f=Wr(i,n);let m=null,v=null,w=null,A=null,P=null,O=null,B=null,F=null;if(zl(f,s,i,n)===Qi.CONST){const q=Gm(i,n,f,!1);for(let Z=0;Z<e-1;Z++){const J=Wr(i,n);switch(J.physicalStreamType){case Tr.LENGTH:switch(J.logicalStreamType.lengthType){case Yr.GEOMETRIES:m=Cc(i,n,J);break;case Yr.PARTS:v=Cc(i,n,J);break;case Yr.RINGS:w=Cc(i,n,J);break;case Yr.TRIANGLES:B=Cc(i,n,J)}break;case Tr.OFFSET:switch(J.logicalStreamType.offsetType){case Tc.VERTEX:A=Kr(i,n,J,!1);break;case Tc.INDEX:F=Kr(i,n,J,!1)}break;case Tr.DATA:ls.VERTEX===J.logicalStreamType.dictionaryType?P=Kr(i,n,J,!0):(O={numBits:J.numBits,coordinateShift:J.coordinateShift},P=Kr(i,n,J,!1))}}return F!==null?m!=null||v!=null?kh(s,q,B,F,P,new Dl(m,v,w)):kh(s,q,B,F,P):O===null?(function(Z,J,de,te,re){return new $d(Z,J,ga.VEC_2,de,te,re)})(s,q,new Dl(m,v,w),A,P):(function(Z,J,de,te,re,pe){return new $d(Z,J,ga.MORTON,de,te,re,pe)})(s,q,new Dl(m,v,w),A,P,O)}const G=Kr(i,n,f,!1);for(let q=0;q<e-1;q++){const Z=Wr(i,n);switch(Z.physicalStreamType){case Tr.LENGTH:switch(Z.logicalStreamType.lengthType){case Yr.GEOMETRIES:m=Kr(i,n,Z,!1);break;case Yr.PARTS:v=Kr(i,n,Z,!1);break;case Yr.RINGS:w=Kr(i,n,Z,!1);break;case Yr.TRIANGLES:B=Cc(i,n,Z)}break;case Tr.OFFSET:switch(Z.logicalStreamType.offsetType){case Tc.VERTEX:A=Kr(i,n,Z,!1);break;case Tc.INDEX:F=Kr(i,n,Z,!1)}break;case Tr.DATA:ls.VERTEX===Z.logicalStreamType.dictionaryType?P=Kr(i,n,Z,!0):(O={numBits:Z.numBits,coordinateShift:Z.coordinateShift},P=Kr(i,n,Z,!1))}}return F!==null&&v===null?Km(G,B,F,P):(m!==null?(m=Tp(G,m,2),v!==null&&w!==null?(v=Ep(G,m,v,!1),w=(function(q,Z,J,de){const te=new Int32Array(J[J.length-1]+1);let re=0;te[0]=re;let pe=1,ve=1,Ne=0;for(let nt=0;nt<q.length;nt++){const et=q[nt],st=Z[nt+1]-Z[nt];if(et!==0&&et!==3)for(let wt=0;wt<st;wt++){const mt=J[pe]-J[pe-1];pe++;for(let Je=0;Je<mt;Je++)re=te[ve++]=re+de[Ne++]}else for(let wt=0;wt<st;wt++)te[ve++]=++re,pe++}return te})(G,m,v,w)):v!==null&&(v=(function(q,Z,J){const de=new Int32Array(Z[Z.length-1]+1);let te=0;de[0]=te;let re=1,pe=0;for(let ve=0;ve<q.length;ve++){const Ne=q[ve],nt=Z[ve+1]-Z[ve];if(Ne===4||Ne===1)for(let et=0;et<nt;et++)te=de[re++]=te+J[pe++];else for(let et=0;et<nt;et++)de[re++]=++te}return de})(G,m,v))):v!==null&&w!==null?(v=Tp(G,v,1),w=Ep(G,v,w,!0)):v!==null&&(v=Tp(G,v,0)),F!==null?Km(G,B,F,P,new Dl(m,v,w)):O===null?(function(q,Z,J,de){return new Zd(ga.VEC_2,q,Z,J,de)})(G,new Dl(m,v,w),A,P):(function(q,Z,J,de,te){return new Zd(ga.MORTON,q,Z,J,de,te)})(G,new Dl(m,v,w),A,P,O))}function Tp(i,e,n){const s=new Int32Array(i.length+1);let u=0;s[0]=u;let f=0;for(let m=0;m<i.length;m++)u=s[m+1]=u+(i[m]>n?e[f++]:1);return s}function Ep(i,e,n,s){const u=new Int32Array(e[e.length-1]+1);let f=0;u[0]=f;let m=1,v=0;for(let w=0;w<i.length;w++){const A=i[w],P=e[w+1]-e[w];if(A===5||A===2||s&&(A===4||A===1))for(let O=0;O<P;O++)f=u[m++]=f+n[v++];else for(let O=0;O<P;O++)u[m++]=++f}return u}class f_ extends wc{dataVector;constructor(e,n,s){super(e,n.getBuffer(),s),this.dataVector=n}getValueFromBuffer(e){return this.dataVector.get(e)}}class p_ extends _p{getValueFromBuffer(e){return this.dataBuffer[e]}}class Hd extends wc{constructor(e,n,s){super(e,BigInt64Array.of(n),s)}getValueFromBuffer(e){return this.dataBuffer[0]}}function Xd(i,e,n){return m_(i,Math.ceil(e/8),n)}function m_(i,e,n){const s=new Uint8Array(e);let u=0;for(;u<e;){const f=i[n.increment()];if(f<=127){const m=f+3,v=i[n.increment()],w=u+m;s.fill(v,u,w),u=w}else{const m=256-f;for(let v=0;v<m;v++)s[u++]=i[n.increment()]}}return s}const Qm=new TextDecoder;function Yd(i,e,n){return n-e>=12?Qm.decode(i.subarray(e,n)):(function(s,u,f){let m="",v=u;for(;v<f;){const w=s[v];let A,P,O,B=null,F=w>239?4:w>223?3:w>191?2:1;if(v+F>f)break;F===1?w<128&&(B=w):F===2?(A=s[v+1],(192&A)==128&&(B=(31&w)<<6|63&A,B<=127&&(B=null))):F===3?(A=s[v+1],P=s[v+2],(192&A)==128&&(192&P)==128&&(B=(15&w)<<12|(63&A)<<6|63&P,(B<=2047||B>=55296&&B<=57343)&&(B=null))):F===4&&(A=s[v+1],P=s[v+2],O=s[v+3],(192&A)==128&&(192&P)==128&&(192&O)==128&&(B=(15&w)<<18|(63&A)<<12|(63&P)<<6|63&O,(B<=65535||B>=1114112)&&(B=null))),B===null?(B=65533,F=1):B>65535&&(B-=65536,m+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),m+=String.fromCharCode(B),v+=F}return m})(i,e,n)}class Bh extends wc{offsetBuffer;constructor(e,n,s,u){super(e,s,u),this.offsetBuffer=n}}class Cp extends Bh{textEncoder;constructor(e,n,s,u){super(e,n,s,u??n.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return Yd(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class Lu extends Bh{indexBuffer;textEncoder;constructor(e,n,s,u,f){super(e,s,u,f??n.length),this.indexBuffer=n,this.indexBuffer=n,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const n=this.indexBuffer[e];return Yd(this.dataBuffer,this.offsetBuffer[n],this.offsetBuffer[n+1])}}class Mp extends Bh{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,n,s,u,f,m,v){super(e,s,u,v),this.indexBuffer=n,this.symbolOffsetBuffer=f,this.symbolTableBuffer=m,this.textEncoder=new TextEncoder}getValueFromBuffer(e){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(s,u,f){const m=[],v=new Array(u.length).fill(0);for(let w=1;w<u.length;w++)v[w]=v[w-1]+u[w-1];for(let w=0;w<f.length;w++)if(f[w]===255)m.push(f[++w]);else{const A=u[f[w]],P=v[f[w]];for(let O=0;O<A;O++)m.push(s[P+O])}return new Uint8Array(m)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const n=this.indexBuffer[e];return Yd(this.decodedDictionary,this.offsetBuffer[n],this.offsetBuffer[n+1])}offsetToLengthBuffer(e){const n=new Uint32Array(e.length-1);let s=e[0];for(let u=1;u<e.length;u++){const f=e[u];n[u-1]=f-s,s=f}return n}}function Mc(i,e,n,s,u,f){return n.type==="scalarType"?(function(m,v,w,A,P,O){let B=null,F=0;if(m===0)return null;if(O.nullable){const q=Wr(v,w);F=q.numValues;const Z=w.get(),J=Xd(v,F,w);w.set(Z+q.byteLength),B=new cs(J,q.numValues)}const G=B??A;switch(P.physicalType){case 4:case 3:return(function(q,Z,J,de,te){const re=Wr(q,Z),pe=zl(re,te,q,Z),ve=de.physicalType===3;if(pe===Qi.FLAT){const Ne=Fo(te)?Zm(q,Z,re,ve,te):Kr(q,Z,re,ve);return new yp(J.name,Ne,te)}if(pe===Qi.SEQUENCE){const Ne=qm(q,Z,re);return new Nm(J.name,Ne[0],Ne[1],re.numRleValues)}{const Ne=Gm(q,Z,re,ve);return new jm(J.name,Ne,te)}})(v,w,O,P,G);case 9:return(function(q,Z,J,de,te){let re=null,pe=null,ve=null,Ne=null,nt=null,et=null,st=null,wt=null;for(let mt=0;mt<de;mt++){const Je=Wr(Z,J);if(Je.byteLength!==0)switch(Je.physicalStreamType){case Tr.PRESENT:{const He=Xd(Z,Je.numValues,J);et=new cs(He,Je.numValues);break}case Tr.OFFSET:pe=te!=null||et!=null?Zm(Z,J,Je,!1,te??et):Kr(Z,J,Je,!1);break;case Tr.LENGTH:{const He=Cc(Z,J,Je);Yr.DICTIONARY===Je.logicalStreamType.lengthType?re=He:Yr.SYMBOL===Je.logicalStreamType.lengthType?Ne=He:st=He;break}case Tr.DATA:{const He=Z.subarray(J.get(),J.get()+Je.byteLength);J.add(Je.byteLength);const Mt=Je.logicalStreamType.dictionaryType;ls.FSST===Mt?nt=He:ls.SINGLE===Mt||ls.SHARED===Mt?ve=He:ls.NONE===Mt&&(wt=He);break}}}return(function(mt,Je,He,Mt,Et,Lt,Ct){return Je?new Mp(mt,He,Mt,Et,Lt,Je,Ct):null})(q,nt,pe,re,ve,Ne,te??et)??(function(mt,Je,He,Mt,Et){return Je?Et?new Lu(mt,He,Mt,Je,Et):new Lu(mt,He,Mt,Je):null})(q,ve,pe,re,te??et)??(function(mt,Je,He,Mt,Et){if(!Je||!He)return null;if(Mt)return Et?new Lu(mt,Mt,Je,He,Et):new Lu(mt,Mt,Je,He);if(Et&&Et.size()!==Je.length-1){const Lt=new Int32Array(Et.size());let Ct=0;for(let $t=0;$t<Et.size();$t++)Lt[$t]=Et.get($t)?Ct++:0;return new Lu(mt,Lt,Je,He,Et)}return Et?new Cp(mt,Je,He,Et):new Cp(mt,Je,He)})(q,st,wt,pe,te??et)})(O.name,v,w,O.nullable?m-1:m,B);case 0:return(function(q,Z,J,de,te){const re=Wr(q,Z),pe=re.numValues,ve=Z.get(),Ne=Fo(te)?(function(et,st,wt,mt){const Je=m_(et,Math.ceil(st/8),wt),He=new cs(Je,st),Mt=mt.size(),Et=new cs(new Uint8Array(Mt),Mt);let Lt=0;for(let Ct=0;Ct<mt.size();Ct++){const $t=!!mt.get(Ct)&&He.get(Lt++);Et.set(Ct,$t)}return Et.getBuffer()})(q,pe,Z,te):Xd(q,pe,Z);Z.set(ve+re.byteLength);const nt=new cs(Ne,pe);return new f_(J.name,nt,te)})(v,w,O,0,G);case 6:case 5:return(function(q,Z,J,de,te){const re=Wr(q,Z),pe=zl(re,de,q,Z),ve=te.physicalType===5;if(pe===Qi.FLAT){const Ne=Fo(de)?(function(nt,et,st,wt,mt){return(function(Je,He,Mt,Et){switch(He.logicalLevelTechnique1){case mn.DELTA:return He.logicalLevelTechnique2===mn.RLE&&(Je=l_(Je,He.runs,He.numRleValues)),(function(Lt,Ct){const $t=new BigInt64Array(Lt.size());let Dn=0;Lt.get(0)?($t[0]=Lt.get(0)?Ct[0]>>1n^-(1n&Ct[0]):0n,Dn=1):$t[0]=0n;let yn=1;for(;yn!=$t.length;++yn)$t[yn]=Lt.get(yn)?$t[yn-1]+(Ct[Dn]>>1n^-(1n&Ct[Dn++])):$t[yn-1];return $t})(Et,Je);case mn.RLE:return(function(Lt,Ct,$t,Dn){const yn=Ct;return $t?(function(Ai,Qr,mr){const zi=new BigInt64Array(Ai.size());let yi=0;for(let qn=0;qn<mr;qn++){const Gi=Number(Qr[qn]);let Ji=Qr[qn+mr];Ji=Ji>>1n^-(1n&Ji);for(let fi=yi;fi<yi+Gi;fi++)Ai.get(fi)?zi[fi]=Ji:(zi[fi]=0n,yi++);yi+=Gi}return zi})(Dn,Lt,yn.runs):(function(Ai,Qr,mr){const zi=new BigInt64Array(Ai.size());let yi=0;for(let qn=0;qn<mr;qn++){const Gi=Number(Qr[qn]),Ji=Qr[qn+mr];for(let fi=yi;fi<yi+Gi;fi++)Ai.get(fi)?zi[fi]=Ji:(zi[fi]=0n,yi++);yi+=Gi}return zi})(Dn,Lt,yn.runs)})(Je,He,Mt,Et);case mn.NONE:return Je=Mt?(function(Lt,Ct){const $t=new BigInt64Array(Lt.size());let Dn=0,yn=0;for(;yn!=$t.length;++yn)if(Lt.get(yn)){const Ai=Ct[Dn++];$t[yn]=Ai>>1n^-(1n&Ai)}else $t[yn]=0n;return $t})(Et,Je):(function(Lt,Ct){const $t=new BigInt64Array(Lt.size());let Dn=0,yn=0;for(;yn!=$t.length;++yn)$t[yn]=Lt.get(yn)?Ct[Dn++]:0n;return $t})(Et,Je),Je;default:throw new Error("The specified Logical level technique is not supported")}})(Nd(nt,et,st.numValues),st,wt,mt)})(q,Z,re,ve,de):Lh(q,Z,re,ve);return new Oh(J.name,Ne,de)}if(pe===Qi.SEQUENCE){const Ne=Iu(q,Z,re);return new Hm(J.name,Ne[0],Ne[1],re.numRleValues)}{const Ne=$m(q,Z,re,ve);return new Hd(J.name,Ne,de)}})(v,w,O,G,P);case 7:return(function(q,Z,J,de){const te=Wr(q,Z),re=Fo(de)?(function(pe,ve,Ne,nt){const et=ve.get(),st=et+nt*Float32Array.BYTES_PER_ELEMENT,wt=new Uint8Array(pe.subarray(et,st)).buffer,mt=new Float32Array(wt);ve.set(st);const Je=Ne.size(),He=new Float32Array(Je);let Mt=0;for(let Et=0;Et<Je;Et++)He[Et]=Ne.get(Et)?mt[Mt++]:0;return He})(q,Z,de,te.numValues):(function(pe,ve,Ne){const nt=ve.get(),et=nt+Ne*Float32Array.BYTES_PER_ELEMENT,st=new Uint8Array(pe.subarray(nt,et)).buffer,wt=new Float32Array(st);return ve.set(et),wt})(q,Z,te.numValues);return new p_(J.name,re,de)})(v,w,O,G);case 8:return(function(q,Z,J,de){const te=Wr(q,Z),re=Fo(de)?(function(pe,ve,Ne,nt){const et=ve.get(),st=et+nt*Float64Array.BYTES_PER_ELEMENT,wt=new Uint8Array(pe.subarray(et,st)).buffer,mt=new Float64Array(wt);ve.set(st);const Je=Ne.size(),He=new Float64Array(Je);let Mt=0;for(let Et=0;Et<Je;Et++)He[Et]=Ne.get(Et)?mt[Mt++]:0;return He})(q,Z,de,te.numValues):(function(pe,ve,Ne){const nt=ve.get(),et=nt+Ne*Float64Array.BYTES_PER_ELEMENT,st=new Uint8Array(pe.subarray(nt,et)).buffer,wt=new Float64Array(st);return ve.set(et),wt})(q,Z,te.numValues);return new Bm(J.name,re,de)})(v,w,O,G);default:throw new Error(`The specified data type for the field is currently not supported: ${P}`)}})(s,i,e,u,n.scalarType,n):s!=1?null:(function(m,v,w,A){let P=null,O=null,B=null,F=null,G=!1;for(;!G;){const de=Wr(m,v);switch(de.physicalStreamType){case Tr.LENGTH:Yr.DICTIONARY===de.logicalStreamType.lengthType?P=Cc(m,v,de):B=Cc(m,v,de);break;case Tr.DATA:ls.SINGLE===de.logicalStreamType.dictionaryType||ls.SHARED===de.logicalStreamType.dictionaryType?(O=m.subarray(v.get(),v.get()+de.byteLength),G=!0):F=m.subarray(v.get(),v.get()+de.byteLength),v.add(de.byteLength)}}const q=w.complexType.children,Z=[];let J=0;for(const de of q){const te=pr(m,v,1)[0];if(te==0)continue;const re=`${w.name}${de.name==="default"?"":":"+de.name}`;if(te!==2||de.type!=="scalarField"||de.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const pe=Wr(m,v),ve=Xd(m,pe.numValues,v),Ne=Wr(m,v),nt=Ne.decompressedCount!==A?Zm(m,v,Ne,!1,new cs(ve,pe.numValues)):Kr(m,v,Ne,!1);Z[J++]=F?new Mp(re,nt,P,O,B,F,new cs(ve,pe.numValues)):new Lu(re,nt,P,O,new cs(ve,pe.numValues))}return Z})(i,e,n,u)}function Fo(i){return i instanceof cs}function Ac(i){if(i.name==="id")return!1;if(i.type==="scalarType"){const e=i.scalarType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(e.type==="logicalType")return!1}else if(i.type==="complexType"){const e=i.complexType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",i),!1}const Wd=new TextDecoder;function Fh(i,e){const n=pr(i,e,1)[0];if(n===0)return"";const s=e.get(),u=i.subarray(s,s+n);return e.add(n),Wd.decode(u)}function Pl(i,e){const n=pr(i,e,1)[0]>>>0,s=!!(4&n),u=!!(2&n),f=pr(i,e,1)[0]>>>0,m={};if(1&n&&(m.nullable=!0),u){const v={};if(s?(v.type="logicalType",v.logicalType=f):(v.type="physicalType",v.physicalType=f),8&n){const w=pr(i,e,1)[0]>>>0;v.children=new Array(w);for(let A=0;A<w;A++)v.children[A]=Pl(i,e)}m.type="complexField",m.complexField=v}else{const v={};s?(v.type="logicalType",v.logicalType=f):(v.type="physicalType",v.physicalType=f),m.type="scalarField",m.scalarField=v}return m}function yy(i,e){const n=pr(i,e,1)[0]>>>0,s=(function(u){switch(u){case 0:case 1:case 2:case 3:{const f={};f.nullable=!!(1&u),f.columnScope=0;const m={};return m.physicalType=u>1?6:4,m.type="physicalType",f.scalarType=m,f.type="scalarType",f}case 4:{const f={nullable:!1,columnScope:0},m={type:"physicalType",physicalType:0};return f.type="complexType",f.complexType=m,f}case 30:{const f={nullable:!1,columnScope:0},m={type:"physicalType",physicalType:1};return f.type="complexType",f.complexType=m,f}default:return(function(f){let m=null;switch(f){case 10:case 11:m=0;break;case 12:case 13:m=1;break;case 14:case 15:m=2;break;case 16:case 17:m=3;break;case 18:case 19:m=4;break;case 20:case 21:m=5;break;case 22:case 23:m=6;break;case 24:case 25:m=7;break;case 26:case 27:m=8;break;case 28:case 29:m=9;break;default:return null}const v={};v.nullable=!!(1&f),v.columnScope=0;const w={type:"physicalType"};return w.physicalType=m,v.type="scalarType",v.scalarType=w,v})(u)}})(n);if(!s)throw new Error(`Unsupported column type code: ${n}`);if((function(u){return u>=10})(n)?s.name=Fh(i,e):n>=0&&n<=3?s.name="id":n===4&&(s.name="geometry"),(function(u){return u===30})(n)){const u=pr(i,e,1)[0]>>>0,f=s.complexType;f.children=new Array(u);for(let m=0;m<u;m++)f.children[m]=Pl(i,e)}return s}function g_(i,e){const n={featureTables:[]},s={};s.name=Fh(i,e);const u=pr(i,e,1)[0]>>>0,f=pr(i,e,1)[0]>>>0;s.columns=new Array(f);for(let m=0;m<f;m++)s.columns[m]=yy(i,e);return n.featureTables.push(s),[n,u]}function Kd(i,e,n,s,u,f,m=!1){const v=e.scalarType.physicalType,w=zl(u,f,i,n);if(v===4)switch(w){case Qi.FLAT:{const A=Kr(i,n,u,!1);return new yp(s,A,f)}case Qi.SEQUENCE:{const A=qm(i,n,u);return new Nm(s,A[0],A[1],u.numRleValues)}case Qi.CONST:{const A=Gm(i,n,u,!1);return new jm(s,A,f)}}else switch(w){case Qi.FLAT:{if(m){const P=(function(O,B,F,G){const q=(function(Z,J,de){const te=new Float64Array(J);for(let re=0;re<J;re++)te[re]=s_(Z,de);return te})(O,F.numValues,B);return(function(Z,J,de){switch(J.logicalLevelTechnique1){case mn.DELTA:return J.logicalLevelTechnique2===mn.RLE&&(Z=c_(Z,J.runs,J.numRleValues)),(function(te){te[0]=te[0]%2==1?(te[0]+1)/-2:te[0]/2;const re=te.length/4*4;let pe=1;if(re>=4)for(;pe<re-4;pe+=4){const ve=te[pe],Ne=te[pe+1],nt=te[pe+2],et=te[pe+3];te[pe]=(ve%2==1?(ve+1)/-2:ve/2)+te[pe-1],te[pe+1]=(Ne%2==1?(Ne+1)/-2:Ne/2)+te[pe],te[pe+2]=(nt%2==1?(nt+1)/-2:nt/2)+te[pe+1],te[pe+3]=(et%2==1?(et+1)/-2:et/2)+te[pe+2]}for(;pe!=te.length;++pe)te[pe]=(te[pe]%2==1?(te[pe]+1)/-2:te[pe]/2)+te[pe-1]})(Z),Z;case mn.RLE:return(function(te,re,pe){return c_(te,re.runs,re.numRleValues)})(Z,J);case mn.NONE:return Z;default:throw new Error(`The specified Logical level technique is not supported: ${J.logicalLevelTechnique1}`)}})(q,F)})(i,n,u);return new Bm(s,P,f)}const A=Lh(i,n,u,!1);return new Oh(s,A,f)}case Qi.SEQUENCE:{const A=Iu(i,n,u);return new Hm(s,A[0],A[1],u.numRleValues)}case Qi.CONST:{const A=$m(i,n,u,!1);return new Hd(s,A,f)}}throw new Error("Vector type not supported for id column.")}class vy{constructor(e,n){var s;switch(this._featureData=e,this.properties=this._featureData.properties||{},(s=this._featureData.geometry)===null||s===void 0?void 0:s.type){case fr.POINT:case fr.MULTIPOINT:this.type=1;break;case fr.LINESTRING:case fr.MULTILINESTRING:this.type=2;break;case fr.POLYGON:case fr.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=n,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const n of this._featureData.geometry.coordinates){const s=[];for(const u of n)s.push(new N(u.x,u.y));e.push(s)}return e}}class __{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new vy(this.features[e],this.extent)}}class Qd{constructor(e){this.layers={};const n=(function(s,u,f=!0){const m=new o_(0),v=[];for(;m.get()<s.length;){const w=pr(s,m,1)[0]>>>0,A=m.get()+w;if(A>s.length)throw new Error(`Block overruns tile: ${A} > ${s.length}`);if(pr(s,m,1)[0]>>>0!=1){m.set(A);continue}const P=g_(s,m),O=P[1],B=P[0].featureTables[0];let F=null,G=null;const q=[];let Z=0;for(const de of B.columns){const te=de.name;if(te==="id"){let re=null;if(de.nullable){const ve=Wr(s,m),Ne=m.get(),nt=Xd(s,ve.numValues,m);m.set(Ne+ve.byteLength),re=new cs(nt,ve.numValues)}const pe=Wr(s,m);Z=pe.decompressedCount,F=Kd(s,de,m,te,pe,re??Z,f)}else if(te==="geometry"){const re=pr(s,m,1)[0];if(Z===0){const pe=m.get();Z=Wr(s,m).decompressedCount,m.set(pe)}G=d_(s,re,m,Z)}else{const re=Ac(de)?pr(s,m,1)[0]:1;if(re===0&&de.type==="scalarType")continue;const pe=Mc(s,m,de,re,Z);if(pe)if(Array.isArray(pe))for(const ve of pe)q.push(ve);else q.push(pe)}}const J=new Sc(B.name,G,F,q,O);v.push(J),m.set(A)}return v})(new Uint8Array(e));this.layers=n.reduce(((s,u)=>Object.assign(Object.assign({},s),{[u.name]:new __(u)})),{})}}class y_{constructor(e,n){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=n,"id"in e&&(typeof e.id=="string"?this.id=parseInt(e.id,10):typeof e.id!="number"||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],n=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const s of n){const u=[];for(const f of s)u.push(new N(f[0],f[1]));e.push(u)}return e}}const Jd="_geojsonTileLayer";function Ap(i,e){e.writeVarintField(15,i.version||1),e.writeStringField(1,i.name||""),e.writeVarintField(5,i.extent||4096);const n={keys:[],values:[],keycache:{},valuecache:{}};for(let f=0;f<i.length;f++)n.feature=i.feature(f),e.writeMessage(2,zp,n);const s=n.keys;for(const f of s)e.writeStringField(3,f);const u=n.values;for(const f of u)e.writeMessage(4,Dp,f)}function zp(i,e){if(!i.feature)return;const n=i.feature;n.id!==void 0&&e.writeVarintField(1,n.id),e.writeMessage(2,v_,i),e.writeVarintField(3,n.type),e.writeMessage(4,eg,n)}function v_(i,e){for(const n in i.feature?.properties){let s=i.feature.properties[n],u=i.keycache[n];if(s==null)continue;u===void 0&&(i.keys.push(n),u=i.keys.length-1,i.keycache[n]=u),e.writeVarint(u),typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"&&(s=JSON.stringify(s));const f=typeof s+":"+s;let m=i.valuecache[f];m===void 0&&(i.values.push(s),m=i.values.length-1,i.valuecache[f]=m),e.writeVarint(m)}}function zc(i,e){return(e<<3)+(7&i)}function Jm(i){return i<<1^i>>31}function eg(i,e){const n=i.loadGeometry(),s=i.type;let u=0,f=0;for(const m of n){let v=1;s===1&&(v=m.length),e.writeVarint(zc(1,v));const w=s===3?m.length-1:m.length;for(let A=0;A<w;A++){A===1&&s!==1&&e.writeVarint(zc(2,w-1));const P=m[A].x-u,O=m[A].y-f;e.writeVarint(Jm(P)),e.writeVarint(Jm(O)),u+=P,f+=O}i.type===3&&e.writeVarint(zc(7,1))}}function Dp(i,e){const n=typeof i;n==="string"?e.writeStringField(1,i):n==="boolean"?e.writeBooleanField(7,i):n==="number"&&(i%1!=0?e.writeDoubleField(3,i):i<0?e.writeSVarintField(6,i):e.writeVarintField(5,i))}class tg{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ps(yt,16,0),this.grid3D=new Ps(yt,16,0),this.featureIndexArray=new W,this.promoteId=n}insert(e,n,s,u,f,m){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,f);const w=m?this.grid3D:this.grid;for(let A=0;A<n.length;A++){const P=n[A],O=[1/0,1/0,-1/0,-1/0];for(let B=0;B<P.length;B++){const F=P[B];O[0]=Math.min(O[0],F.x),O[1]=Math.min(O[1],F.y),O[2]=Math.max(O[2],F.x),O[3]=Math.max(O[3],F.y)}O[0]<yt&&O[1]<yt&&O[2]>=0&&O[3]>=0&&w.insert(v,O[0],O[1],O[2],O[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new En(new np(this.rawTileData)).layers:new Qd(this.rawTileData).layers,this.sourceLayerCoder=new km(this.vtLayers?Object.keys(this.vtLayers).sort():[Jd])),this.vtLayers}query(e,n,s,u){this.loadVTLayers();const f=e.params,m=yt/e.tileSize/e.scale,v=Ur(f.filter,f.globalState),w=e.queryGeometry,A=e.queryPadding*m,P=bc.fromPoints(w),O=this.grid.query(P.minX-A,P.minY-A,P.maxX+A,P.maxY+A),B=bc.fromPoints(e.cameraQueryGeometry).expandBy(A),F=this.grid3D.query(B.minX,B.minY,B.maxX,B.maxY,((Z,J,de,te)=>(function(re,pe,ve,Ne,nt){for(const st of re)if(pe<=st.x&&ve<=st.y&&Ne>=st.x&&nt>=st.y)return!0;const et=[new N(pe,ve),new N(pe,nt),new N(Ne,nt),new N(Ne,ve)];if(re.length>2){for(const st of et)if(ks(re,st))return!0}for(let st=0;st<re.length-1;st++)if(Tg(re[st],re[st+1],et))return!0;return!1})(e.cameraQueryGeometry,Z-A,J-A,de+A,te+A)));for(const Z of F)O.push(Z);O.sort(Pp);const G={};let q;for(let Z=0;Z<O.length;Z++){const J=O[Z];if(J===q)continue;q=J;const de=this.featureIndexArray.get(J);let te=null;this.loadMatchingFeature(G,de.bucketIndex,de.sourceLayerIndex,de.featureIndex,v,f.layers,f.availableImages,n,s,u,((re,pe,ve)=>(te||(te=is(re)),pe.queryIntersectsFeature({queryGeometry:w,feature:re,featureState:ve,geometry:te,zoom:this.z,transform:e.transform,pixelsToTileUnits:m,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return G}loadMatchingFeature(e,n,s,u,f,m,v,w,A,P,O){const B=this.bucketLayerIDs[n];if(m&&!B.some((Z=>m.has(Z))))return;const F=this.sourceLayerCoder.decode(s),G=this.vtLayers[F].feature(u);if(f.needGeometry){const Z=no(G,!0);if(!f.filter(new On(this.tileID.overscaledZ),Z,this.tileID.canonical))return}else if(!f.filter(new On(this.tileID.overscaledZ),G))return;const q=this.getId(G,F);for(let Z=0;Z<B.length;Z++){const J=B[Z];if(m&&!m.has(J))continue;const de=w[J];if(!de)continue;let te={};q&&P&&(te=P.getState(de.sourceLayer||Jd,q));const re=fn({},A[J]);re.paint=x_(re.paint,de.paint,G,te,v),re.layout=x_(re.layout,de.layout,G,te,v);const pe=!O||O(G,de,te);if(!pe)continue;const ve=new gp(G,this.z,this.x,this.y,q);ve.layer=re;let Ne=e[J];Ne===void 0&&(Ne=e[J]=[]),Ne.push({featureIndex:u,feature:ve,intersectionZ:pe})}}lookupSymbolFeatures(e,n,s,u,f,m,v,w){const A={};this.loadVTLayers();const P=Ur(f.filterSpec,f.globalState);for(const O of e)this.loadMatchingFeature(A,s,u,O,P,m,v,w,n);return A}hasLayer(e){for(const n of this.bucketLayerIDs)for(const s of n)if(e===s)return!0;return!1}getId(e,n){var s;let u=e.id;return this.promoteId&&(u=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof u=="boolean"&&(u=Number(u)),u===void 0&&(!((s=e.properties)===null||s===void 0)&&s.cluster)&&this.promoteId&&(u=Number(e.properties.cluster_id))),u}}function x_(i,e,n,s,u){return $i(i,((f,m)=>{const v=e instanceof fl?e.get(m):null;return v&&v.evaluate?v.evaluate(n,s,u):v}))}function Pp(i,e){return e-i}function r(i,e,n,s,u){const f=[];for(let m=0;m<i.length;m++){const v=i[m];let w;for(let A=0;A<v.length-1;A++){let P=v[A],O=v[A+1];P.x<e&&O.x<e||(P.x<e?P=new N(e,P.y+(e-P.x)/(O.x-P.x)*(O.y-P.y))._round():O.x<e&&(O=new N(e,P.y+(e-P.x)/(O.x-P.x)*(O.y-P.y))._round()),P.y<n&&O.y<n||(P.y<n?P=new N(P.x+(n-P.y)/(O.y-P.y)*(O.x-P.x),n)._round():O.y<n&&(O=new N(P.x+(n-P.y)/(O.y-P.y)*(O.x-P.x),n)._round()),P.x>=s&&O.x>=s||(P.x>=s?P=new N(s,P.y+(s-P.x)/(O.x-P.x)*(O.y-P.y))._round():O.x>=s&&(O=new N(s,P.y+(s-P.x)/(O.x-P.x)*(O.y-P.y))._round()),P.y>=u&&O.y>=u||(P.y>=u?P=new N(P.x+(u-P.y)/(O.y-P.y)*(O.x-P.x),u)._round():O.y>=u&&(O=new N(P.x+(u-P.y)/(O.y-P.y)*(O.x-P.x),u)._round()),w&&P.equals(w[w.length-1])||(w=[P],f.push(w)),w.push(O)))))}}return f}function o(i,e,n,s,u){switch(e){case 1:return(function(f,m,v,w){const A=[];for(const P of f)for(const O of P){const B=w===0?O.x:O.y;B>=m&&B<=v&&A.push([O])}return A})(i,n,s,u);case 2:return _(i,n,s,u,!1);case 3:return _(i,n,s,u,!0)}return[]}function h(i,e,n,s,u){const f=s===0?M:D;let m=[];const v=[];for(let P=0;P<i.length-1;P++){const O=i[P],B=i[P+1],F=s===0?O.x:O.y,G=s===0?B.x:B.y;let q=!1;F<e?G>e&&m.push(f(O,B,e)):F>n?G<n&&m.push(f(O,B,n)):m.push(O),G<e&&F>=e&&(m.push(f(O,B,e)),q=!0),G>n&&F<=n&&(m.push(f(O,B,n)),q=!0),!u&&q&&(v.push(m),m=[])}const w=i.length-1,A=s===0?i[w].x:i[w].y;return A>=e&&A<=n&&m.push(i[w]),u&&m.length>0&&!m[0].equals(m[m.length-1])&&m.push(new N(m[0].x,m[0].y)),m.length>0&&v.push(m),v}function _(i,e,n,s,u){const f=[];for(const m of i){const v=h(m,e,n,s,u);v.length>0&&f.push(...v)}return f}function M(i,e,n){return new N(n,i.y+(n-i.x)/(e.x-i.x)*(e.y-i.y))}function D(i,e,n){return new N(i.x+(n-i.y)/(e.y-i.y)*(e.x-i.x),n)}zt("FeatureIndex",tg,{omit:["rawTileData","sourceLayerCoder"]});class U extends N{constructor(e,n,s,u){super(e,n),this.angle=s,u!==void 0&&(this.segment=u)}clone(){return new U(this.x,this.y,this.angle,this.segment)}}function ne(i,e,n,s,u){if(e.segment===void 0||n===0)return!0;let f=e,m=e.segment+1,v=0;for(;v>-n/2;){if(m--,m<0)return!1;v-=i[m].dist(f),f=i[m]}v+=i[m].dist(i[m+1]),m++;const w=[];let A=0;for(;v<n/2;){const P=i[m],O=i[m+1];if(!O)return!1;let B=i[m-1].angleTo(P)-P.angleTo(O);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:B}),A+=B;v-w[0].distance>s;)A-=w.shift().angleDelta;if(A>u)return!1;m++,v+=P.dist(O)}return!0}function Se(i){let e=0;for(let n=0;n<i.length-1;n++)e+=i[n].dist(i[n+1]);return e}function Ze(i,e,n){return i?.6*e*n:0}function at(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function dt(i,e,n,s,u,f){const m=Ze(n,u,f),v=at(n,s)*f;let w=0;const A=Se(i)/2;for(let P=0;P<i.length-1;P++){const O=i[P],B=i[P+1],F=O.dist(B);if(w+F>A){const G=(A-w)/F,q=ci.number(O.x,B.x,G),Z=ci.number(O.y,B.y,G),J=new U(q,Z,B.angleTo(O),P);return J._round(),!m||ne(i,J,v,m,e)?J:void 0}w+=F}}function We(i,e,n,s,u,f,m,v,w){const A=Ze(s,f,m),P=at(s,u),O=P*m,B=i[0].x===0||i[0].x===w||i[0].y===0||i[0].y===w;return e-O<e/4&&(e=O+e/4),tt(i,B?e/2*v%e:(P/2+2*f)*m*v%e,e,A,n,O,B,!1,w)}function tt(i,e,n,s,u,f,m,v,w){const A=f/2,P=Se(i);let O=0,B=e-n,F=[];for(let G=0;G<i.length-1;G++){const q=i[G],Z=i[G+1],J=q.dist(Z),de=Z.angleTo(q);for(;B+n<O+J;){B+=n;const te=(B-O)/J,re=ci.number(q.x,Z.x,te),pe=ci.number(q.y,Z.y,te);if(re>=0&&re<w&&pe>=0&&pe<w&&B-A>=0&&B+A<=P){const ve=new U(re,pe,de,G);ve._round(),s&&!ne(i,ve,f,s,u)||F.push(ve)}}O+=J}return v||F.length||m||(F=tt(i,O/2,n,s,u,f,m,!0,w)),F}function Gt(i,e,n,s){const u=[],f=i.image,m=f.pixelRatio,v=f.paddedRect.w-2,w=f.paddedRect.h-2;let A={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const P=f.stretchX||[[0,v]],O=f.stretchY||[[0,w]],B=(He,Mt)=>He+Mt[1]-Mt[0],F=P.reduce(B,0),G=O.reduce(B,0),q=v-F,Z=w-G;let J=0,de=F,te=0,re=G,pe=0,ve=q,Ne=0,nt=Z;if(f.content&&s){const He=f.content,Mt=He[2]-He[0],Et=He[3]-He[1];(f.textFitWidth||f.textFitHeight)&&(A=Al(i)),J=Jt(P,0,He[0]),te=Jt(O,0,He[1]),de=Jt(P,He[0],He[2]),re=Jt(O,He[1],He[3]),pe=He[0]-J,Ne=He[1]-te,ve=Mt-de,nt=Et-re}const et=A.x1,st=A.y1,wt=A.x2-et,mt=A.y2-st,Je=(He,Mt,Et,Lt)=>{const Ct=Oe(He.stretch-J,de,wt,et),$t=ze(He.fixed-pe,ve,He.stretch,F),Dn=Oe(Mt.stretch-te,re,mt,st),yn=ze(Mt.fixed-Ne,nt,Mt.stretch,G),Ai=Oe(Et.stretch-J,de,wt,et),Qr=ze(Et.fixed-pe,ve,Et.stretch,F),mr=Oe(Lt.stretch-te,re,mt,st),zi=ze(Lt.fixed-Ne,nt,Lt.stretch,G),yi=new N(Ct,Dn),qn=new N(Ai,Dn),Gi=new N(Ai,mr),Ji=new N(Ct,mr),fi=new N($t/m,yn/m),oo=new N(Qr/m,zi/m),Jr=e*Math.PI/180;if(Jr){const Cr=Math.sin(Jr),ki=Math.cos(Jr),gr=[ki,-Cr,Cr,ki];yi._matMult(gr),qn._matMult(gr),Ji._matMult(gr),Gi._matMult(gr)}const so=He.stretch+He.fixed,Us=Mt.stretch+Mt.fixed;return{tl:yi,tr:qn,bl:Ji,br:Gi,tex:{x:f.paddedRect.x+1+so,y:f.paddedRect.y+1+Us,w:Et.stretch+Et.fixed-so,h:Lt.stretch+Lt.fixed-Us},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fi,pixelOffsetBR:oo,minFontScaleX:ve/m/wt,minFontScaleY:nt/m/mt,isSDF:n}};if(s&&(f.stretchX||f.stretchY)){const He=ii(P,q,F),Mt=ii(O,Z,G);for(let Et=0;Et<He.length-1;Et++){const Lt=He[Et],Ct=He[Et+1];for(let $t=0;$t<Mt.length-1;$t++)u.push(Je(Lt,Mt[$t],Ct,Mt[$t+1]))}}else u.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return u}function Jt(i,e,n){let s=0;for(const u of i)s+=Math.max(e,Math.min(n,u[1]))-Math.max(e,Math.min(n,u[0]));return s}function ii(i,e,n){const s=[{fixed:-1,stretch:0}];for(const[u,f]of i){const m=s[s.length-1];s.push({fixed:u-m.stretch,stretch:m.stretch}),s.push({fixed:u-m.stretch,stretch:m.stretch+(f-u)})}return s.push({fixed:e+1,stretch:n}),s}function Oe(i,e,n,s){return i/e*n+s}function ze(i,e,n,s){return i-e*n/s}zt("Anchor",U);class qe{constructor(e,n,s,u,f,m,v,w,A,P){var O;if(this.boxStartIndex=e.length,A){let B=m.top,F=m.bottom;const G=m.collisionPadding;G&&(B-=G[1],F+=G[3]);let q=F-B;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{const B=!((O=m.image)===null||O===void 0)&&O.content&&(m.image.textFitWidth||m.image.textFitHeight)?Al(m):{x1:m.left,y1:m.top,x2:m.right,y2:m.bottom};B.y1=B.y1*v-w[0],B.y2=B.y2*v+w[2],B.x1=B.x1*v-w[3],B.x2=B.x2*v+w[1];const F=m.collisionPadding;if(F&&(B.x1-=F[0]*v,B.y1-=F[1]*v,B.x2+=F[2]*v,B.y2+=F[3]*v),P){const G=new N(B.x1,B.y1),q=new N(B.x2,B.y1),Z=new N(B.x1,B.y2),J=new N(B.x2,B.y2),de=P*Math.PI/180;G._rotate(de),q._rotate(de),Z._rotate(de),J._rotate(de),B.x1=Math.min(G.x,q.x,Z.x,J.x),B.x2=Math.max(G.x,q.x,Z.x,J.x),B.y1=Math.min(G.y,q.y,Z.y,J.y),B.y2=Math.max(G.y,q.y,Z.y,J.y)}e.emplaceBack(n.x,n.y,B.x1,B.y1,B.x2,B.y2,s,u,f)}this.boxEndIndex=e.length}}class ut{constructor(e=[],n=(s,u)=>s<u?-1:s>u?1:0){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:s}=this,u=n[e];for(;e>0;){const f=e-1>>1,m=n[f];if(s(u,m)>=0)break;n[e]=m,e=f}n[e]=u}_down(e){const{data:n,compare:s}=this,u=this.length>>1,f=n[e];for(;e<u;){let m=1+(e<<1);const v=m+1;if(v<this.length&&s(n[v],n[m])<0&&(m=v),s(n[m],f)>=0)break;n[e]=n[m],e=m}n[e]=f}}function Kt(i,e=1,n=!1){const s=bc.fromPoints(i[0]),u=Math.min(s.width(),s.height());let f=u/2;const m=new ut([],Gn),{minX:v,minY:w,maxX:A,maxY:P}=s;if(u===0)return new N(v,w);for(let F=v;F<A;F+=u)for(let G=w;G<P;G+=u)m.push(new qt(F+f,G+f,f,i));let O=(function(F){let G=0,q=0,Z=0;const J=F[0];for(let de=0,te=J.length,re=te-1;de<te;re=de++){const pe=J[de],ve=J[re],Ne=pe.x*ve.y-ve.x*pe.y;q+=(pe.x+ve.x)*Ne,Z+=(pe.y+ve.y)*Ne,G+=3*Ne}return new qt(q/G,Z/G,0,F)})(i),B=m.length;for(;m.length;){const F=m.pop();(F.d>O.d||!O.d)&&(O=F,n&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,B)),F.max-O.d<=e||(f=F.h/2,m.push(new qt(F.p.x-f,F.p.y-f,f,i)),m.push(new qt(F.p.x+f,F.p.y-f,f,i)),m.push(new qt(F.p.x-f,F.p.y+f,f,i)),m.push(new qt(F.p.x+f,F.p.y+f,f,i)),B+=4)}return n&&(console.log(`num probes: ${B}`),console.log(`best distance: ${O.d}`)),O.p}function Gn(i,e){return e.max-i.max}function qt(i,e,n,s){this.p=new N(i,e),this.h=n,this.d=(function(u,f){let m=!1,v=1/0;for(let w=0;w<f.length;w++){const A=f[w];for(let P=0,O=A.length,B=O-1;P<O;B=P++){const F=A[P],G=A[B];F.y>u.y!=G.y>u.y&&u.x<(G.x-F.x)*(u.y-F.y)/(G.y-F.y)+F.x&&(m=!m),v=Math.min(v,rm(u,F,G))}}return(m?1:-1)*Math.sqrt(v)})(this.p,s),this.max=this.d+this.h*Math.SQRT2}var Xt;E.aP=void 0,(Xt=E.aP||(E.aP={}))[Xt.center=1]="center",Xt[Xt.left=2]="left",Xt[Xt.right=3]="right",Xt[Xt.top=4]="top",Xt[Xt.bottom=5]="bottom",Xt[Xt["top-left"]=6]="top-left",Xt[Xt["top-right"]=7]="top-right",Xt[Xt["bottom-left"]=8]="bottom-left",Xt[Xt["bottom-right"]=9]="bottom-right";const Sn=Number.POSITIVE_INFINITY;function Bn(i,e){return e[1]!==Sn?(function(n,s,u){let f=0,m=0;switch(s=Math.abs(s),u=Math.abs(u),n){case"top-right":case"top-left":case"top":m=u-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-u}switch(n){case"top-right":case"bottom-right":case"right":f=-s;break;case"top-left":case"bottom-left":case"left":f=s}return[f,m]})(i,e[0],e[1]):(function(n,s){let u=0,f=0;s<0&&(s=0);const m=s/Math.SQRT2;switch(n){case"top-right":case"top-left":f=m-7;break;case"bottom-right":case"bottom-left":f=7-m;break;case"bottom":f=7-s;break;case"top":f=s-7}switch(n){case"top-right":case"bottom-right":u=-m;break;case"top-left":case"bottom-left":u=m;break;case"left":u=s;break;case"right":u=-s}return[u,f]})(i,e[0])}function Rl(i,e,n){var s;const u=i.layout,f=(s=u.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(e,{},n);if(f){const v=f.values,w=[];for(let A=0;A<v.length;A+=2){const P=w[A]=v[A],O=v[A+1].map((B=>B*rr));P.startsWith("top")?O[1]-=7:P.startsWith("bottom")&&(O[1]+=7),w[A+1]=O}return new wi(w)}const m=u.get("text-variable-anchor");if(m){let v;v=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[u.get("text-radial-offset").evaluate(e,{},n)*rr,Sn]:u.get("text-offset").evaluate(e,{},n).map((A=>A*rr));const w=[];for(const A of m)w.push(A,Bn(A,v));return new wi(w)}return null}function ng(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function y1(i,e,n,s,u,f,m,v,w,A,P,O){let B=f.textMaxSize.evaluate(e,{});B===void 0&&(B=m);const F=i.layers[0].layout,G=F.get("icon-offset").evaluate(e,{},P),q=u0(n.horizontal),Z=m/24,J=i.tilePixelRatio*Z,de=i.tilePixelRatio*B/24,te=i.tilePixelRatio*v,re=i.tilePixelRatio*F.get("symbol-spacing"),pe=F.get("text-padding")*i.tilePixelRatio,ve=(function(Et,Lt,Ct,$t=1){const Dn=Et.get("icon-padding").evaluate(Lt,{},Ct),yn=Dn&&Dn.values;return[yn[0]*$t,yn[1]*$t,yn[2]*$t,yn[3]*$t]})(F,e,P,i.tilePixelRatio),Ne=F.get("text-max-angle")/180*Math.PI,nt=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",et=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",st=F.get("symbol-placement"),wt=re/2,mt=F.get("icon-text-fit");let Je;s&&mt!=="none"&&(i.allowVerticalPlacement&&n.vertical&&(Je=os(s,n.vertical,mt,F.get("icon-text-fit-padding"),G,Z)),q&&(s=os(s,q,mt,F.get("icon-text-fit-padding"),G,Z)));const He=P?O.line.getGranularityForZoomLevel(P.z):1,Mt=(Et,Lt)=>{Lt.x<0||Lt.x>=yt||Lt.y<0||Lt.y>=yt||(function(Ct,$t,Dn,yn,Ai,Qr,mr,zi,yi,qn,Gi,Ji,fi,oo,Jr,so,Us,Cr,ki,gr,qi,Mr,Ou,Il,ag){const Nh=Ct.addToLineVertexArray($t,Dn);let ef,Rp,Ip,Lp,p0=0,m0=0,g0=0,_0=0,My=-1,Ay=-1;const ku={};let y0=Ci("");if(Ct.allowVerticalPlacement&&yn.vertical){const _a=zi.layout.get("text-rotate").evaluate(qi,{},Il)+90;Ip=new qe(yi,$t,qn,Gi,Ji,yn.vertical,fi,oo,Jr,_a),mr&&(Lp=new qe(yi,$t,qn,Gi,Ji,mr,Us,Cr,Jr,_a))}if(Ai){const _a=zi.layout.get("icon-rotate").evaluate(qi,{}),us=zi.layout.get("icon-text-fit")!=="none",tf=Gt(Ai,_a,Ou,us),Ol=mr?Gt(mr,_a,Ou,us):void 0;Rp=new qe(yi,$t,qn,Gi,Ji,Ai,Us,Cr,!1,_a),p0=4*tf.length;const nf=Ct.iconSizeData;let Dc=null;nf.kind==="source"?(Dc=[ro*zi.layout.get("icon-size").evaluate(qi,{})],Dc[0]>vc&&Pn(`${Ct.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):nf.kind==="composite"&&(Dc=[ro*Mr.compositeIconSizes[0].evaluate(qi,{},Il),ro*Mr.compositeIconSizes[1].evaluate(qi,{},Il)],(Dc[0]>vc||Dc[1]>vc)&&Pn(`${Ct.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,tf,Dc,gr,ki,qi,E.az.none,$t,Nh.lineStartIndex,Nh.lineLength,-1,Il),My=Ct.icon.placedSymbolArray.length-1,Ol&&(m0=4*Ol.length,Ct.addSymbols(Ct.icon,Ol,Dc,gr,ki,qi,E.az.vertical,$t,Nh.lineStartIndex,Nh.lineLength,-1,Il),Ay=Ct.icon.placedSymbolArray.length-1)}const v0=Object.keys(yn.horizontal);for(const _a of v0){const us=yn.horizontal[_a];if(!ef){y0=Ci(us.text);const Ol=zi.layout.get("text-rotate").evaluate(qi,{},Il);ef=new qe(yi,$t,qn,Gi,Ji,us,fi,oo,Jr,Ol)}const tf=us.positionedLines.length===1;if(g0+=c0(Ct,$t,us,Qr,zi,Jr,qi,so,Nh,yn.vertical?E.az.horizontal:E.az.horizontalOnly,tf?v0:[_a],ku,My,Mr,Il),tf)break}yn.vertical&&(_0+=c0(Ct,$t,yn.vertical,Qr,zi,Jr,qi,so,Nh,E.az.vertical,["vertical"],ku,Ay,Mr,Il));const b1=ef?ef.boxStartIndex:Ct.collisionBoxArray.length,w1=ef?ef.boxEndIndex:Ct.collisionBoxArray.length,S1=Ip?Ip.boxStartIndex:Ct.collisionBoxArray.length,T1=Ip?Ip.boxEndIndex:Ct.collisionBoxArray.length,E1=Rp?Rp.boxStartIndex:Ct.collisionBoxArray.length,C1=Rp?Rp.boxEndIndex:Ct.collisionBoxArray.length,M1=Lp?Lp.boxStartIndex:Ct.collisionBoxArray.length,A1=Lp?Lp.boxEndIndex:Ct.collisionBoxArray.length;let Ll=-1;const w_=(_a,us)=>_a&&_a.circleDiameter?Math.max(_a.circleDiameter,us):us;Ll=w_(ef,Ll),Ll=w_(Ip,Ll),Ll=w_(Rp,Ll),Ll=w_(Lp,Ll);const x0=Ll>-1?1:0;x0&&(Ll*=ag/rr),Ct.glyphOffsetArray.length>=Dh.MAX_GLYPHS&&Pn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),qi.sortKey!==void 0&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,qi.sortKey);const z1=Rl(zi,qi,Il),[D1,P1]=(function(_a,us){const tf=_a.length,Ol=us?.values;if(Ol?.length>0)for(let nf=0;nf<Ol.length;nf+=2){const Dc=Ol[nf+1];_a.emplaceBack(E.aP[Ol[nf]],Dc[0],Dc[1])}return[tf,_a.length]})(Ct.textAnchorOffsets,z1);Ct.symbolInstances.emplaceBack($t.x,$t.y,ku.right>=0?ku.right:-1,ku.center>=0?ku.center:-1,ku.left>=0?ku.left:-1,ku.vertical||-1,My,Ay,y0,b1,w1,S1,T1,E1,C1,M1,A1,qn,g0,_0,p0,m0,x0,0,fi,Ll,D1,P1)})(i,Lt,Et,n,s,u,Je,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,J,[pe,pe,pe,pe],nt,w,te,ve,et,G,e,f,A,P,m)};if(st==="line")for(const Et of r(e.geometry,0,0,yt,yt)){const Lt=Sl(Et,He),Ct=We(Lt,re,Ne,n.vertical||q,s,24,de,i.overscaling,yt);for(const $t of Ct)q&&v1(i,q.text,wt,$t)||Mt(Lt,$t)}else if(st==="line-center"){for(const Et of e.geometry)if(Et.length>1){const Lt=Sl(Et,He),Ct=dt(Lt,Ne,n.vertical||q,s,24,de);Ct&&Mt(Lt,Ct)}}else if(e.type==="Polygon")for(const Et of Jc(e.geometry,0)){const Lt=Kt(Et,16);Mt(Sl(Et[0],He,!0),new U(Lt.x,Lt.y,0))}else if(e.type==="LineString")for(const Et of e.geometry){const Lt=Sl(Et,He);Mt(Lt,new U(Lt[0].x,Lt[0].y,0))}else if(e.type==="Point")for(const Et of e.geometry)for(const Lt of Et)Mt([Lt],new U(Lt.x,Lt.y,0))}function c0(i,e,n,s,u,f,m,v,w,A,P,O,B,F,G){const q=(function(de,te,re,pe,ve,Ne,nt,et){const st=pe.layout.get("text-rotate").evaluate(Ne,{})*Math.PI/180,wt=[];for(const mt of te.positionedLines)for(const Je of mt.positionedGlyphs){if(!Je.rect)continue;const He=Je.rect||{};let Mt=4,Et=!0,Lt=1,Ct=0;const $t=(ve||et)&&Je.vertical,Dn=Je.metrics.advance*Je.scale/2;if(et&&te.verticalizable&&(Ct=mt.lineOffset/2-(Je.imageName?-(rr-Je.metrics.width*Je.scale)/2:(Je.scale-1)*rr)),Je.imageName){const Cr=nt[Je.imageName];Et=Cr.sdf,Lt=Cr.pixelRatio,Mt=1/Lt}const yn=ve?[Je.x+Dn,Je.y]:[0,0];let Ai=ve?[0,0]:[Je.x+Dn+re[0],Je.y+re[1]-Ct],Qr=[0,0];$t&&(Qr=Ai,Ai=[0,0]);const mr=Je.metrics.isDoubleResolution?2:1,zi=(Je.metrics.left-Mt)*Je.scale-Dn+Ai[0],yi=(-Je.metrics.top-Mt)*Je.scale+Ai[1],qn=zi+He.w/mr*Je.scale/Lt,Gi=yi+He.h/mr*Je.scale/Lt,Ji=new N(zi,yi),fi=new N(qn,yi),oo=new N(zi,Gi),Jr=new N(qn,Gi);if($t){const Cr=new N(-Dn,Dn- -17),ki=-Math.PI/2,gr=12-Dn,qi=new N(22-gr,-(Je.imageName?gr:0)),Mr=new N(...Qr);Ji._rotateAround(ki,Cr)._add(qi)._add(Mr),fi._rotateAround(ki,Cr)._add(qi)._add(Mr),oo._rotateAround(ki,Cr)._add(qi)._add(Mr),Jr._rotateAround(ki,Cr)._add(qi)._add(Mr)}if(st){const Cr=Math.sin(st),ki=Math.cos(st),gr=[ki,-Cr,Cr,ki];Ji._matMult(gr),fi._matMult(gr),oo._matMult(gr),Jr._matMult(gr)}const so=new N(0,0),Us=new N(0,0);wt.push({tl:Ji,tr:fi,bl:oo,br:Jr,tex:He,writingMode:te.writingMode,glyphOffset:yn,sectionIndex:Je.sectionIndex,isSDF:Et,pixelOffsetTL:so,pixelOffsetBR:Us,minFontScaleX:0,minFontScaleY:0})}return wt})(0,n,v,u,f,m,s,i.allowVerticalPlacement),Z=i.textSizeData;let J=null;Z.kind==="source"?(J=[ro*u.layout.get("text-size").evaluate(m,{})],J[0]>vc&&Pn(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Z.kind==="composite"&&(J=[ro*F.compositeTextSizes[0].evaluate(m,{},G),ro*F.compositeTextSizes[1].evaluate(m,{},G)],(J[0]>vc||J[1]>vc)&&Pn(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,q,J,v,f,m,A,e,w.lineStartIndex,w.lineLength,B,G);for(const de of P)O[de]=i.text.placedSymbolArray.length-1;return 4*q.length}function u0(i){for(const e in i)return i[e];return null}function v1(i,e,n,s){const u=i.compareText;if(e in u){const f=u[e];for(let m=f.length-1;m>=0;m--)if(s.dist(f[m])<n)return!0}else u[e]=[];return u[e].push(s),!1}const h0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xy{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,s]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=s>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const f=h0[15&s];if(!f)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new xy(v,m,f,e)}constructor(e,n=64,s=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=s,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const f=h0.indexOf(this.ArrayType),m=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-v%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${s}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+w,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+m+v+w),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+w,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=e,this.coords[this._pos++]=n,s}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return by(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:m,nodeSize:v}=this,w=[0,f.length-1,0],A=[];for(;w.length;){const P=w.pop()||0,O=w.pop()||0,B=w.pop()||0;if(O-B<=v){for(let Z=B;Z<=O;Z++){const J=m[2*Z],de=m[2*Z+1];J>=e&&J<=s&&de>=n&&de<=u&&A.push(f[Z])}continue}const F=B+O>>1,G=m[2*F],q=m[2*F+1];G>=e&&G<=s&&q>=n&&q<=u&&A.push(f[F]),(P===0?e<=G:n<=q)&&(w.push(B),w.push(F-1),w.push(1-P)),(P===0?s>=G:u>=q)&&(w.push(F+1),w.push(O),w.push(1-P))}return A}within(e,n,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:f,nodeSize:m}=this,v=[0,u.length-1,0],w=[],A=s*s;for(;v.length;){const P=v.pop()||0,O=v.pop()||0,B=v.pop()||0;if(O-B<=m){for(let Z=B;Z<=O;Z++)f0(f[2*Z],f[2*Z+1],e,n)<=A&&w.push(u[Z]);continue}const F=B+O>>1,G=f[2*F],q=f[2*F+1];f0(G,q,e,n)<=A&&w.push(u[F]),(P===0?e-s<=G:n-s<=q)&&(v.push(B),v.push(F-1),v.push(1-P)),(P===0?e+s>=G:n+s>=q)&&(v.push(F+1),v.push(O),v.push(1-P))}return w}}function by(i,e,n,s,u,f){if(u-s<=n)return;const m=s+u>>1;d0(i,e,m,s,u,f),by(i,e,n,s,m-1,1-f),by(i,e,n,m+1,u,1-f)}function d0(i,e,n,s,u,f){for(;u>s;){if(u-s>600){const A=u-s+1,P=n-s+1,O=Math.log(A),B=.5*Math.exp(2*O/3),F=.5*Math.sqrt(O*B*(A-B)/A)*(P-A/2<0?-1:1);d0(i,e,n,Math.max(s,Math.floor(n-P*B/A+F)),Math.min(u,Math.floor(n+(A-P)*B/A+F)),f)}const m=e[2*n+f];let v=s,w=u;for(ig(i,e,s,n),e[2*u+f]>m&&ig(i,e,s,u);v<w;){for(ig(i,e,v,w),v++,w--;e[2*v+f]<m;)v++;for(;e[2*w+f]>m;)w--}e[2*s+f]===m?ig(i,e,s,w):(w++,ig(i,e,w,u)),w<=n&&(s=w+1),n<=w&&(u=w-1)}}function ig(i,e,n,s){wy(i,n,s),wy(e,2*n,2*s),wy(e,2*n+1,2*s+1)}function wy(i,e,n){const s=i[e];i[e]=i[n],i[n]=s}function f0(i,e,n,s){const u=i-n,f=e-s;return u*u+f*f}var Sy;E.cI=void 0,(Sy=E.cI||(E.cI={})).create="create",Sy.load="load",Sy.fullLoad="fullLoad";let b_=null,rg=[];const Ty=1e3/60,Ey="loadTime",Cy="fullLoadTime",x1={mark(i){performance.mark(i)},frame(i){const e=i;b_!=null&&rg.push(e-b_),b_=e},clearMetrics(){b_=null,rg=[],performance.clearMeasures(Ey),performance.clearMeasures(Cy);for(const i in E.cI)performance.clearMarks(E.cI[i])},getPerformanceMetrics(){performance.measure(Ey,E.cI.create,E.cI.load),performance.measure(Cy,E.cI.create,E.cI.fullLoad);const i=performance.getEntriesByName(Ey)[0].duration,e=performance.getEntriesByName(Cy)[0].duration,n=rg.length,s=1/(rg.reduce(((f,m)=>f+m),0)/n/1e3),u=rg.filter((f=>f>Ty)).reduce(((f,m)=>f+(m-Ty)/Ty),0);return{loadTime:i,fullLoadTime:e,fps:s,percentDroppedFrames:u/(n+u)*100,totalFrames:n}}};E.$=ie,E.A=Le,E.B=Ya,E.C=ir,E.D=Dt,E.E=ht,E.F=function([i,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:i*Math.cos(e)*Math.sin(n),y:i*Math.sin(e)*Math.sin(n),z:i*Math.cos(n)}},E.G=ci,E.H=On,E.I=Qn,E.J=lh,E.K=function(i){if(Zn==null){const e=i.navigator?i.navigator.userAgent:null;Zn=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Zn},E.L=class{constructor(i,e){this.target=i,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new fp((()=>this.process())),this.subscription=jo(this.target,"message",(n=>this.receive(n)),!1),this.globalScope=Nn(self)?i:window}registerMessageHandler(i,e){this.messageHandlers[i]=e}unregisterMessageHandler(i){delete this.messageHandlers[i]}sendAsync(i,e){return new Promise(((n,s)=>{const u=Math.round(1e18*Math.random()).toString(36).substring(0,10),f=e?jo(e.signal,"abort",(()=>{f?.unsubscribe(),delete this.resolveRejects[u];const w={id:u,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)}),Rm):null;this.resolveRejects[u]={resolve:w=>{f?.unsubscribe(),n(w)},reject:w=>{f?.unsubscribe(),s(w)}};const m=[],v=Object.assign(Object.assign({},i),{id:u,sourceMapId:this.mapId,origin:location.origin,data:Wa(i.data,m)});this.target.postMessage(v,{transfer:m})}))}receive(i){const e=i.data,n=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[n];const s=this.abortControllers[n];return delete this.abortControllers[n],void(s&&s.abort())}if(Nn(self)||e.mustQueue)return this.tasks[n]=e,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,e)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),e=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(i,e)}processTask(i,e){return l(this,void 0,void 0,(function*(){if(e.type==="<response>"){const u=this.resolveRejects[i];return delete this.resolveRejects[i],u?void(e.error?u.reject(cc(e.error)):u.resolve(cc(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=cc(e.data),s=new AbortController;this.abortControllers[i]=s;try{const u=yield this.messageHandlers[e.type](e.sourceMapId,n,s);this.completeTask(i,null,u)}catch(u){this.completeTask(i,u)}}))}completeTask(i,e,n){const s=[];delete this.abortControllers[i];const u={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?Wa(e):null,data:Wa(n,s)};this.target.postMessage(u,{transfer:s})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.M=K,E.N=function(){var i=new Le(16);return Le!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},E.O=function(i,e,n){var s,u,f,m,v,w,A,P,O,B,F,G,q=n[0],Z=n[1],J=n[2];return e===i?(i[12]=e[0]*q+e[4]*Z+e[8]*J+e[12],i[13]=e[1]*q+e[5]*Z+e[9]*J+e[13],i[14]=e[2]*q+e[6]*Z+e[10]*J+e[14],i[15]=e[3]*q+e[7]*Z+e[11]*J+e[15]):(u=e[1],f=e[2],m=e[3],v=e[4],w=e[5],A=e[6],P=e[7],O=e[8],B=e[9],F=e[10],G=e[11],i[0]=s=e[0],i[1]=u,i[2]=f,i[3]=m,i[4]=v,i[5]=w,i[6]=A,i[7]=P,i[8]=O,i[9]=B,i[10]=F,i[11]=G,i[12]=s*q+v*Z+O*J+e[12],i[13]=u*q+w*Z+B*J+e[13],i[14]=f*q+A*Z+F*J+e[14],i[15]=m*q+P*Z+G*J+e[15]),i},E.P=N,E.Q=function(i,e,n){var s=n[0],u=n[1],f=n[2];return i[0]=e[0]*s,i[1]=e[1]*s,i[2]=e[2]*s,i[3]=e[3]*s,i[4]=e[4]*u,i[5]=e[5]*u,i[6]=e[6]*u,i[7]=e[7]*u,i[8]=e[8]*f,i[9]=e[9]*f,i[10]=e[10]*f,i[11]=e[11]*f,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},E.R=Xr,E.S=function(i,e,n){var s=e[0],u=e[1],f=e[2],m=e[3],v=e[4],w=e[5],A=e[6],P=e[7],O=e[8],B=e[9],F=e[10],G=e[11],q=e[12],Z=e[13],J=e[14],de=e[15],te=n[0],re=n[1],pe=n[2],ve=n[3];return i[0]=te*s+re*v+pe*O+ve*q,i[1]=te*u+re*w+pe*B+ve*Z,i[2]=te*f+re*A+pe*F+ve*J,i[3]=te*m+re*P+pe*G+ve*de,i[4]=(te=n[4])*s+(re=n[5])*v+(pe=n[6])*O+(ve=n[7])*q,i[5]=te*u+re*w+pe*B+ve*Z,i[6]=te*f+re*A+pe*F+ve*J,i[7]=te*m+re*P+pe*G+ve*de,i[8]=(te=n[8])*s+(re=n[9])*v+(pe=n[10])*O+(ve=n[11])*q,i[9]=te*u+re*w+pe*B+ve*Z,i[10]=te*f+re*A+pe*F+ve*J,i[11]=te*m+re*P+pe*G+ve*de,i[12]=(te=n[12])*s+(re=n[13])*v+(pe=n[14])*O+(ve=n[15])*q,i[13]=te*u+re*w+pe*B+ve*Z,i[14]=te*f+re*A+pe*F+ve*J,i[15]=te*m+re*P+pe*G+ve*de,i},E.T=qf,E.U=function(i,e){const n={};for(let s=0;s<e.length;s++){const u=e[s];u in i&&(n[u]=i[u])}return n},E.V=js,E.W=tn,E.X=Im,E.Y=n_,E.Z=De,E._=l,E.a=fs,E.a$=Rt,E.a0=Ue,E.a1=va,E.a2=Na,E.a3=r_,E.a4=kd,E.a5=yt,E.a6=function(i,e,n){if(!i)return e||{};if(!e)return i||{};const s=Fd(i),u=Fd(e);(function(m,v){v.removeAll&&(m.add.clear(),m.update.clear(),m.remove.clear(),v.remove.clear());for(const w of v.remove)m.add.delete(w),m.update.delete(w);for(const[w,A]of v.update){const P=m.update.get(w);P&&(v.update.set(w,Om(P,A)),m.update.delete(w))}})(s,u);const f={};if((s.removeAll||u.removeAll)&&(f.removeAll=!0),f.remove=new Set([...s.remove,...u.remove]),f.add=new Map([...s.add,...u.add]),f.update=new Map([...s.update,...u.update]),f.remove.size&&f.add.size)for(const m of f.add.keys())f.remove.delete(m);return(function(m){const v={};return m.removeAll&&(v.removeAll=m.removeAll),m.remove&&(v.remove=Array.from(m.remove)),m.add&&(v.add=Array.from(m.add.values())),m.update&&(v.update=Array.from(m.update.values())),v})(f)},E.a7=function(i,e){const n=new Map;if(i==null||i.type==null)return n;if(i.type==="Feature"){const s=Bd(i,e);return s==null?void 0:(n.set(s,i),n)}if(i.type==="FeatureCollection"){const s=new Set;for(const u of i.features){const f=Bd(u,e);if(f==null||s.has(f))return;s.add(f),n.set(f,u)}return n}},E.a8=function(i,e,n){var s,u;const f=[];if(e.removeAll)i.clear();else if(e.remove)for(const m of e.remove){const v=i.get(m);v&&(f.push(v.geometry),i.delete(m))}if(e.add)for(const m of e.add){const v=Bd(m,n);if(v==null)continue;const w=i.get(v);w&&f.push(w.geometry),f.push(m.geometry),i.set(v,m)}if(e.update)for(const m of e.update){const v=i.get(m.id);if(!v)continue;const w=!!m.newGeometry,A=m.removeAllProperties||((s=m.removeProperties)===null||s===void 0?void 0:s.length)>0||((u=m.addOrUpdateProperties)===null||u===void 0?void 0:u.length)>0;if(!w&&!A)continue;f.push(v.geometry);const P=Object.assign({},v);if(i.set(m.id,P),w&&(f.push(m.newGeometry),P.geometry=m.newGeometry),A){if(P.properties=m.removeAllProperties?{}:Object.assign({},P.properties||{}),m.removeProperties)for(const O of m.removeProperties)delete P.properties[O];if(m.addOrUpdateProperties)for(const{key:O,value:B}of m.addOrUpdateProperties)P.properties[O]=B}}return f},E.a9=Un,E.aA=function(i,{uSize:e,uSizeT:n},{lowerSize:s,upperSize:u}){return i.kind==="source"?s/ro:i.kind==="composite"?ci.number(s/ro,u/ro,n):e},E.aB=function(i,e){var n=e[0],s=e[1],u=e[2],f=e[3],m=e[4],v=e[5],w=e[6],A=e[7],P=e[8],O=e[9],B=e[10],F=e[11],G=e[12],q=e[13],Z=e[14],J=e[15],de=n*v-s*m,te=n*w-u*m,re=n*A-f*m,pe=s*w-u*v,ve=s*A-f*v,Ne=u*A-f*w,nt=P*q-O*G,et=P*Z-B*G,st=P*J-F*G,wt=O*Z-B*q,mt=O*J-F*q,Je=B*J-F*Z,He=de*Je-te*mt+re*wt+pe*st-ve*et+Ne*nt;return He?(i[0]=(v*Je-w*mt+A*wt)*(He=1/He),i[1]=(u*mt-s*Je-f*wt)*He,i[2]=(q*Ne-Z*ve+J*pe)*He,i[3]=(B*ve-O*Ne-F*pe)*He,i[4]=(w*st-m*Je-A*et)*He,i[5]=(n*Je-u*st+f*et)*He,i[6]=(Z*re-G*Ne-J*te)*He,i[7]=(P*Ne-B*re+F*te)*He,i[8]=(m*mt-v*st+A*nt)*He,i[9]=(s*st-n*mt-f*nt)*He,i[10]=(G*ve-q*re+J*de)*He,i[11]=(O*re-P*ve-F*de)*He,i[12]=(v*et-m*wt-w*nt)*He,i[13]=(n*wt-s*et+u*nt)*He,i[14]=(q*te-G*pe-Z*de)*He,i[15]=(P*pe-O*te+B*de)*He,i):null},E.aC=Xe,E.aD=function(i){var e=i[0],n=i[1];return Math.sqrt(e*e+n*n)},E.aE=function(i){return i[0]=0,i[1]=0,i},E.aF=function(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i},E.aG=Am,E.aH=Ft,E.aI=function(i,e,n,s){const u=e.y-i.y,f=e.x-i.x,m=s.y-n.y,v=s.x-n.x,w=m*f-v*u;if(w===0)return null;const A=(v*(i.y-n.y)-m*(i.x-n.x))/w;return new N(i.x+A*f,i.y+A*u)},E.aJ=r,E.aK=Eu,E.aL=function(i){let e=1/0,n=1/0,s=-1/0,u=-1/0;for(const f of i)e=Math.min(e,f.x),n=Math.min(n,f.y),s=Math.max(s,f.x),u=Math.max(u,f.y);return[e,n,s,u]},E.aM=rr,E.aN=It,E.aO=function(i,e,n,s,u=!1){if(!n[0]&&!n[1])return[0,0];const f=u?s==="map"?-i.bearingInRadians:0:s==="viewport"?i.bearingInRadians:0;if(f){const m=Math.sin(f),v=Math.cos(f);n=[n[0]*v-n[1]*m,n[0]*m+n[1]*v]}return[u?n[0]:It(e,n[0],i.zoom),u?n[1]:It(e,n[1],i.zoom)]},E.aQ=lp,E.aR=ng,E.aS=Tm,E.aT=xy,E.aU=ui,E.aV=Cd,E.aW=ae,E.aX=St,E.aY=Ve,E.aZ=Dr,E.a_=Lm,E.aa=bc,E.ab=25,E.ac=xr,E.ad=i=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((n=>{e.onloadstart=()=>{n(e)};for(const s of i){const u=window.document.createElement("source");Be(s)||(e.crossOrigin="Anonymous"),u.src=s,e.appendChild(u)}}))},E.ae=ot,E.af=function(){return _n++},E.ag=d,E.ah=Dh,E.ai=Jd,E.aj=Ur,E.ak=no,E.al=gp,E.am=function(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((n,s,u,f)=>{const m=u||f;return e[s]=!m||m.toLowerCase(),""})),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e},E.an=Nt,E.ao=85.051129,E.ap=Hi,E.aq=function(i){return Math.pow(2,i)},E.ar=it,E.as=i_,E.at=function(i){return Math.log(i)/Math.LN2},E.au=function(i){var e=i[0],n=i[1];return e*e+n*n},E.av=function(i){if(!i.length)return new Set;const e=Math.max(...i.map((w=>w.canonical.z)));let n=1/0,s=-1/0,u=1/0,f=-1/0;const m=[];for(const w of i){const{x:A,y:P,z:O}=w.canonical,B=Math.pow(2,e-O),F=A*B,G=P*B;m.push({id:w,x:F,y:G}),F<n&&(n=F),F>s&&(s=F),G<u&&(u=G),G>f&&(f=G)}const v=new Set;for(const w of m)w.x!==n&&w.x!==s&&w.y!==u&&w.y!==f||v.add(w.id);return v},E.aw=function(i,e){const n=Math.abs(2*i.wrap)-+(i.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||s-n||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x},E.ax=class{constructor(i,e){this.max=i,this.onRemove=e,this.reset()}reset(){for(const i in this.data)for(const e of this.data[i])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(i,e,n){const s=i.wrapped().key;this.data[s]===void 0&&(this.data[s]=[]);const u={value:e,timeout:void 0};if(n!==void 0&&(u.timeout=setTimeout((()=>{this.remove(i,u)}),n)),this.data[s].push(u),this.order.push(s),this.order.length>this.max){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const e=this.data[i].shift();return e.timeout&&clearTimeout(e.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),e.value}getByKey(i){const e=this.data[i];return e?e[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,e){if(!this.has(i))return this;const n=i.wrapped().key,s=e===void 0?0:this.data[n].indexOf(e),u=this.data[n][s];return this.data[n].splice(s,1),u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(u.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(i){const e=[];for(const n in this.data)for(const s of this.data[n])i(s.value)||e.push(s);for(const n of e)this.remove(n.value.tileID,n)}},E.ay=function(i,e){let n=0,s=0;if(i.kind==="constant")s=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:u,minZoom:f,maxZoom:m}=i,v=u?Nt(kr.interpolationFactor(u,e,f,m),0,1):0;i.kind==="camera"?s=ci.number(i.minSize,i.maxSize,v):n=v}return{uSizeT:n,uSize:s}},E.b=Ar,E.b$=to,E.b0=Pt,E.b1=function(i){var e=new Le(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e},E.b2=function(i,e,n){return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],i},E.b3=function(i,e){var n=e[0],s=e[1],u=e[2],f=n*n+s*s+u*u;return f>0&&(f=1/Math.sqrt(f)),i[0]=e[0]*f,i[1]=e[1]*f,i[2]=e[2]*f,i},E.b4=Zt,E.b5=function(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]},E.b6=function(i,e,n){return i[0]=e[0]*n[0],i[1]=e[1]*n[1],i[2]=e[2]*n[2],i[3]=e[3]*n[3],i},E.b7=Qe,E.b8=function(i,e,n){const s=e[0]*n[0]+e[1]*n[1]+e[2]*n[2];return s===0?null:(-(i[0]*n[0]+i[1]*n[1]+i[2]*n[2])-n[3])/s},E.b9=Vt,E.bA=function(){return new Float64Array(3)},E.bB=Pe,E.bC=function(i,e,n){var s=n[0],u=n[1],f=n[2],m=n[3],v=e[0],w=e[1],A=e[2],P=u*A-f*w,O=f*v-s*A,B=s*w-u*v;return i[0]=v+m*(P+=P)+u*(B+=B)-f*(O+=O),i[1]=w+m*O+f*P-s*B,i[2]=A+m*B+s*O-u*P,i},E.bD=function(i,e,n){const s=(u=[i[0],i[1],i[2],e[0],e[1],e[2],n[0],n[1],n[2]])[0]*((P=u[8])*(m=u[4])-(v=u[5])*(A=u[7]))+u[1]*(-P*(f=u[3])+v*(w=u[6]))+u[2]*(A*f-m*w);var u,f,m,v,w,A,P;if(s===0)return null;const O=Zt([],[e[0],e[1],e[2]],[n[0],n[1],n[2]]),B=Zt([],[n[0],n[1],n[2]],[i[0],i[1],i[2]]),F=Zt([],[i[0],i[1],i[2]],[e[0],e[1],e[2]]),G=Rt([],O,-i[3]);return Pt(G,G,Rt([],B,-e[3])),Pt(G,G,Rt([],F,-n[3])),Rt(G,G,1/s),G},E.bE=pp,E.bF=function(){return new Float64Array(4)},E.bG=function(i,e,n,s){var u=[],f=[];return u[0]=e[0]-n[0],u[1]=e[1]-n[1],u[2]=e[2]-n[2],f[0]=u[0]*Math.cos(s)-u[1]*Math.sin(s),f[1]=u[0]*Math.sin(s)+u[1]*Math.cos(s),f[2]=u[2],i[0]=f[0]+n[0],i[1]=f[1]+n[1],i[2]=f[2]+n[2],i},E.bH=function(i,e,n,s){var u=[],f=[];return u[0]=e[0]-n[0],u[1]=e[1]-n[1],u[2]=e[2]-n[2],f[0]=u[0],f[1]=u[1]*Math.cos(s)-u[2]*Math.sin(s),f[2]=u[1]*Math.sin(s)+u[2]*Math.cos(s),i[0]=f[0]+n[0],i[1]=f[1]+n[1],i[2]=f[2]+n[2],i},E.bI=function(i,e,n,s){var u=[],f=[];return u[0]=e[0]-n[0],u[1]=e[1]-n[1],u[2]=e[2]-n[2],f[0]=u[2]*Math.sin(s)+u[0]*Math.cos(s),f[1]=u[1],f[2]=u[2]*Math.cos(s)-u[0]*Math.sin(s),i[0]=f[0]+n[0],i[1]=f[1]+n[1],i[2]=f[2]+n[2],i},E.bJ=function(i,e,n){var s=Math.sin(n),u=Math.cos(n),f=e[0],m=e[1],v=e[2],w=e[3],A=e[8],P=e[9],O=e[10],B=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=f*u-A*s,i[1]=m*u-P*s,i[2]=v*u-O*s,i[3]=w*u-B*s,i[8]=f*s+A*u,i[9]=m*s+P*u,i[10]=v*s+O*u,i[11]=w*s+B*u,i},E.bK=function(i,e){const n=Ee(i,360),s=Ee(e,360),u=s-n,f=s>n?u-360:u+360;return Math.abs(u)<Math.abs(f)?u:f},E.bL=function(i){return i[0]=0,i[1]=0,i[2]=0,i},E.bM=function(i,e,n,s){const u=Math.sqrt(i*i+e*e),f=Math.sqrt(n*n+s*s);i/=u,e/=u,n/=f,s/=f;const m=Math.acos(i*n+e*s);return-e*n+i*s>0?m:-m},E.bN=function(i,e){const n=Ee(i,2*Math.PI),s=Ee(e,2*Math.PI);return Math.min(Math.abs(n-s),Math.abs(n-s+2*Math.PI),Math.abs(n-s-2*Math.PI))},E.bO=function(){const i={},e=Me.$version;for(const n in Me.$root){const s=Me.$root[n];if(s.required){let u=null;u=n==="version"?e:s.type==="array"?[]:{},u!=null&&(i[n]=u)}}return i},E.bP=be,E.bQ=hh,E.bR=function i(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(!i(e[s],n[s]))return!1;return!0}if(typeof e=="object"&&e!==null&&n!==null){if(typeof n!="object"||Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(!i(e[s],n[s]))return!1;return!0}return e===n},E.bS=function(i){i=i.slice();const e=Object.create(null);for(let n=0;n<i.length;n++)e[i[n].id]=i[n];for(let n=0;n<i.length;n++)"ref"in i[n]&&(i[n]=Rn(i[n],e[i[n].ref]));return i},E.bT=function(i,e){if(i.type==="custom")return new Pm(i,e);switch(i.type){case"background":return new Cn(i,e);case"circle":return new Vf(i,e);case"color-relief":return new Dg(i,e);case"fill":return new Og(i,e);case"fill-extrusion":return new _m(i,e);case"heatmap":return new Ag(i,e);case"hillshade":return new Mi(i,e);case"line":return new vm(i,e);case"raster":return new Jo(i,e);case"symbol":return new xc(i,e)}},E.bU=i=>i.type==="raster",E.bV=vi,E.bW=function(i,e){if(!i)return[{command:"setStyle",args:[e]}];let n=[];try{if(!kt(i.version,e.version))return[{command:"setStyle",args:[e]}];kt(i.center,e.center)||n.push({command:"setCenter",args:[e.center]}),kt(i.state,e.state)||n.push({command:"setGlobalState",args:[e.state]}),kt(i.centerAltitude,e.centerAltitude)||n.push({command:"setCenterAltitude",args:[e.centerAltitude]}),kt(i.zoom,e.zoom)||n.push({command:"setZoom",args:[e.zoom]}),kt(i.bearing,e.bearing)||n.push({command:"setBearing",args:[e.bearing]}),kt(i.pitch,e.pitch)||n.push({command:"setPitch",args:[e.pitch]}),kt(i.roll,e.roll)||n.push({command:"setRoll",args:[e.roll]}),kt(i.sprite,e.sprite)||n.push({command:"setSprite",args:[e.sprite]}),kt(i.glyphs,e.glyphs)||n.push({command:"setGlyphs",args:[e.glyphs]}),kt(i.transition,e.transition)||n.push({command:"setTransition",args:[e.transition]}),kt(i.light,e.light)||n.push({command:"setLight",args:[e.light]}),kt(i.terrain,e.terrain)||n.push({command:"setTerrain",args:[e.terrain]}),kt(i.sky,e.sky)||n.push({command:"setSky",args:[e.sky]}),kt(i.projection,e.projection)||n.push({command:"setProjection",args:[e.projection]});const s={},u=[];(function(m,v,w,A){let P;for(P in v=v||{},m=m||{})Object.prototype.hasOwnProperty.call(m,P)&&(Object.prototype.hasOwnProperty.call(v,P)||ei(P,w,A));for(P in v)Object.prototype.hasOwnProperty.call(v,P)&&(Object.prototype.hasOwnProperty.call(m,P)?kt(m[P],v[P])||(m[P].type==="geojson"&&v[P].type==="geojson"&&Xi(m,v,P)?jt(w,{command:"setGeoJSONSourceData",args:[P,v[P].data]}):ti(P,v,w,A)):an(P,v,w))})(i.sources,e.sources,u,s);const f=[];i.layers&&i.layers.forEach((m=>{"source"in m&&s[m.source]?n.push({command:"removeLayer",args:[m.id]}):f.push(m)})),n=n.concat(u),(function(m,v,w){v=v||[];const A=(m=m||[]).map(pi),P=v.map(pi),O=m.reduce(Fi,{}),B=v.reduce(Fi,{}),F=A.slice(),G=Object.create(null);let q,Z,J,de,te;for(let re=0,pe=0;re<A.length;re++)q=A[re],Object.prototype.hasOwnProperty.call(B,q)?pe++:(jt(w,{command:"removeLayer",args:[q]}),F.splice(F.indexOf(q,pe),1));for(let re=0,pe=0;re<P.length;re++)q=P[P.length-1-re],F[F.length-1-re]!==q&&(Object.prototype.hasOwnProperty.call(O,q)?(jt(w,{command:"removeLayer",args:[q]}),F.splice(F.lastIndexOf(q,F.length-pe),1)):pe++,de=F[F.length-re],jt(w,{command:"addLayer",args:[B[q],de]}),F.splice(F.length-re,0,q),G[q]=!0);for(let re=0;re<P.length;re++)if(q=P[re],Z=O[q],J=B[q],!G[q]&&!kt(Z,J))if(kt(Z.source,J.source)&&kt(Z["source-layer"],J["source-layer"])&&kt(Z.type,J.type)){for(te in Yi(Z.layout,J.layout,w,q,null,"setLayoutProperty"),Yi(Z.paint,J.paint,w,q,null,"setPaintProperty"),kt(Z.filter,J.filter)||jt(w,{command:"setFilter",args:[q,J.filter]}),kt(Z.minzoom,J.minzoom)&&kt(Z.maxzoom,J.maxzoom)||jt(w,{command:"setLayerZoomRange",args:[q,J.minzoom,J.maxzoom]}),Z)Object.prototype.hasOwnProperty.call(Z,te)&&te!=="layout"&&te!=="paint"&&te!=="filter"&&te!=="metadata"&&te!=="minzoom"&&te!=="maxzoom"&&(te.indexOf("paint.")===0?Yi(Z[te],J[te],w,q,te.slice(6),"setPaintProperty"):kt(Z[te],J[te])||jt(w,{command:"setLayerProperty",args:[q,te,J[te]]}));for(te in J)Object.prototype.hasOwnProperty.call(J,te)&&!Object.prototype.hasOwnProperty.call(Z,te)&&te!=="layout"&&te!=="paint"&&te!=="filter"&&te!=="metadata"&&te!=="minzoom"&&te!=="maxzoom"&&(te.indexOf("paint.")===0?Yi(Z[te],J[te],w,q,te.slice(6),"setPaintProperty"):kt(Z[te],J[te])||jt(w,{command:"setLayerProperty",args:[q,te,J[te]]}))}else jt(w,{command:"removeLayer",args:[q]}),de=F[F.lastIndexOf(q)+1],jt(w,{command:"addLayer",args:[J,de]})})(f,e.layers,n)}catch(s){console.warn("Unable to compute style diff:",s),n=[{command:"setStyle",args:[e]}]}return n},E.bX=function(i){const e=[],n=i.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},E.bY=$i,E.bZ=Fn,E.b_=class extends Zr{constructor(i,e){super(i,e),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},E.ba=function(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i},E.bb=function(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]},E.bc=a_,E.bd=Rh,E.be=function(i,e,n,s,u){var f=1/Math.tan(e/2);if(i[0]=f/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=f,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,u!=null&&u!==1/0){var m=1/(s-u);i[10]=(u+s)*m,i[14]=2*u*s*m}else i[10]=-1,i[14]=-2*s;return i},E.bf=function(i){var e=new Le(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},E.bg=function(i,e,n){var s=Math.sin(n),u=Math.cos(n),f=e[0],m=e[1],v=e[2],w=e[3],A=e[4],P=e[5],O=e[6],B=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=f*u+A*s,i[1]=m*u+P*s,i[2]=v*u+O*s,i[3]=w*u+B*s,i[4]=A*u-f*s,i[5]=P*u-m*s,i[6]=O*u-v*s,i[7]=B*u-w*s,i},E.bh=function(i,e,n){var s=Math.sin(n),u=Math.cos(n),f=e[4],m=e[5],v=e[6],w=e[7],A=e[8],P=e[9],O=e[10],B=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=f*u+A*s,i[5]=m*u+P*s,i[6]=v*u+O*s,i[7]=w*u+B*s,i[8]=A*u-f*s,i[9]=P*u-m*s,i[10]=O*u-v*s,i[11]=B*u-w*s,i},E.bi=function(){const i=new Float32Array(16);return it(i),i},E.bj=function(){const i=new Float64Array(16);return it(i),i},E.bk=function(){return new Float64Array(16)},E.bl=function(i,e,n){const s=new Float64Array(4);return Pe(s,i,e-90,n),s},E.bm=function(i,e,n,s){var u,f,m,v,w,A=e[0],P=e[1],O=e[2],B=e[3],F=n[0],G=n[1],q=n[2],Z=n[3];return(f=A*F+P*G+O*q+B*Z)<0&&(f=-f,F=-F,G=-G,q=-q,Z=-Z),1-f>$e?(u=Math.acos(f),m=Math.sin(u),v=Math.sin((1-s)*u)/m,w=Math.sin(s*u)/m):(v=1-s,w=s),i[0]=v*A+w*F,i[1]=v*P+w*G,i[2]=v*O+w*q,i[3]=v*B+w*Z,i},E.bn=function(i){const e=new Float64Array(9);var n,s,u,f,m,v,w,A,P,O,B,F,G,q,Z,J,de,te;O=(u=(s=i)[0])*(w=u+u),B=(f=s[1])*w,G=(m=s[2])*w,q=m*(A=f+f),J=(v=s[3])*w,de=v*A,te=v*(P=m+m),(n=e)[0]=1-(F=f*A)-(Z=m*P),n[3]=B-te,n[6]=G+de,n[1]=B+te,n[4]=1-O-Z,n[7]=q-J,n[2]=G-de,n[5]=q+J,n[8]=1-O-F;const re=Dr(-Math.asin(Nt(e[2],-1,1)));let pe,ve;return Math.hypot(e[5],e[8])<.001?(pe=0,ve=-Dr(Math.atan2(e[3],e[4]))):(pe=Dr(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),ve=Dr(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:pe,pitch:re+90,bearing:ve}},E.bo=function(i,e){return i.roll==e.roll&&i.pitch==e.pitch&&i.bearing==e.bearing},E.bp=sn,E.bq=yl,E.br=Oa,E.bs=rs,E.bt=vr,E.bu=rt,E.bv=Tt,E.bw=tr,E.bx=function(i,e,n,s,u){return rt(s,u,Nt((i-e)/(n-e),0,1))},E.by=function(i,e,n,s){return i[0]=e[0]+n[0]*s,i[1]=e[1]+n[1]*s,i[2]=e[2]+n[2]*s,i},E.bz=Ee,E.c=H,E.c$=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},E.c0=class extends Zr{constructor(i,e){super(i,e),this.current=Hr}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},E.c1=pc,E.c2=class extends Zr{constructor(i,e){super(i,e),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},E.c3=class extends Zr{constructor(i,e){super(i,e),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},E.c4=Ye,E.c5=function(i,e){var n=Math.sin(e),s=Math.cos(e);return i[0]=s,i[1]=n,i[2]=0,i[3]=-n,i[4]=s,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},E.c6=function(i,e,n){var s=e[0],u=e[1],f=e[2];return i[0]=s*n[0]+u*n[3]+f*n[6],i[1]=s*n[1]+u*n[4]+f*n[7],i[2]=s*n[2]+u*n[5]+f*n[8],i},E.c7=function(i,e,n,s,u,f,m){var v=1/(e-n),w=1/(s-u),A=1/(f-m);return i[0]=-2*v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*A,i[11]=0,i[12]=(e+n)*v,i[13]=(u+s)*w,i[14]=(m+f)*A,i[15]=1,i},E.c8=class extends Zr{constructor(i,e){super(i,e),this.current=new Array}set(i){if(i!=this.current){this.current=i;const e=new Float32Array(4*i.length);for(let n=0;n<i.length;n++)e[4*n]=i[n].r,e[4*n+1]=i[n].g,e[4*n+2]=i[n].b,e[4*n+3]=i[n].a;this.gl.uniform4fv(this.location,e)}}},E.c9=class extends Zr{constructor(i,e){super(i,e),this.current=new Array}set(i){if(i!=this.current){this.current=i;const e=new Float32Array(i);this.gl.uniform1fv(this.location,e)}}},E.cA=function(i,e){var n;if(!xi[e])return!1;const s=i?.target,u=((n=s?.ownerDocument)===null||n===void 0?void 0:n.defaultView)||window;return i instanceof u.MouseEvent||i instanceof u.WheelEvent},E.cB=function(i,e){return xa[e]&&"touches"in i},E.cC=function(i){return xa[i]||xi[i]},E.cD=function(i,e,n){var s=e[0],u=e[1];return i[0]=n[0]*s+n[4]*u+n[12],i[1]=n[1]*s+n[5]*u+n[13],i},E.cE=function(i,e){const{x:n,y:s}=Un.fromLngLat(e);return!(i<0||i>25||s<0||s>=1||n<0||n>=1)},E.cF=function(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},E.cG=class extends pl{},E.cH=x1,E.cJ=me,E.cK=function(i,e){H.REGISTERED_PROTOCOLS[i]=e},E.cL=function(i){delete H.REGISTERED_PROTOCOLS[i]},E.cM=function(i,e){const n={};for(let u=0;u<i.length;u++){const f=e&&e[i[u].id]||Zo(i[u]);e&&(e[i[u].id]=f);let m=n[f];m||(m=n[f]=[]),m.push(i[u])}const s=[];for(const u in n)s.push(n[u]);return s},E.cN=zt,E.cO=km,E.cP=tg,E.cQ=ap,E.cR=function(i){var e;i.bucket.createArrays(),i.bucket.tilePixelRatio=yt/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const n=i.bucket.layers[0],s=n.layout,u=n._unevaluatedLayout._values,f={layoutIconSize:u["icon-size"].possiblyEvaluate(new On(i.bucket.zoom+1),i.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new On(i.bucket.zoom+1),i.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new On(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:O}=i.bucket.textSizeData;f.compositeTextSizes=[u["text-size"].possiblyEvaluate(new On(P),i.canonical),u["text-size"].possiblyEvaluate(new On(O),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:O}=i.bucket.iconSizeData;f.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new On(P),i.canonical),u["icon-size"].possiblyEvaluate(new On(O),i.canonical)]}const m=s.get("text-line-height")*rr,v=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",w=s.get("text-keep-upright"),A=s.get("text-size");for(const P of i.bucket.features){const O=s.get("text-font").evaluate(P,{},i.canonical).join(","),B=A.evaluate(P,{},i.canonical),F=f.layoutTextSize.evaluate(P,{},i.canonical),G=f.layoutIconSize.evaluate(P,{},i.canonical),q={horizontal:{},vertical:void 0},Z=P.text;let J,de=[0,0];if(Z){const pe=Z.toString(),ve=s.get("text-letter-spacing").evaluate(P,{},i.canonical)*rr,Ne=dh(pe)?ve:0,nt=s.get("text-anchor").evaluate(P,{},i.canonical),et=Rl(n,P,i.canonical);if(!et){const Je=s.get("text-radial-offset").evaluate(P,{},i.canonical);de=Je?Bn(nt,[Je*rr,Sn]):s.get("text-offset").evaluate(P,{},i.canonical).map((He=>He*rr))}let st=v?"center":s.get("text-justify").evaluate(P,{},i.canonical);const wt=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(P,{},i.canonical)*rr:1/0,mt=()=>{i.bucket.allowVerticalPlacement&&zo(pe)&&(q.vertical=Id(Z,i.glyphMap,i.glyphPositions,i.imagePositions,O,wt,m,nt,"left",Ne,de,E.az.vertical,!0,F,B))};if(!v&&et){const Je=new Set;if(st==="auto")for(let Mt=0;Mt<et.values.length;Mt+=2)Je.add(ng(et.values[Mt]));else Je.add(st);let He=!1;for(const Mt of Je)if(!q.horizontal[Mt])if(He)q.horizontal[Mt]=q.horizontal[0];else{const Et=Id(Z,i.glyphMap,i.glyphPositions,i.imagePositions,O,wt,m,"center",Mt,Ne,de,E.az.horizontal,!1,F,B);Et&&(q.horizontal[Mt]=Et,He=Et.positionedLines.length===1)}mt()}else{st==="auto"&&(st=ng(nt));const Je=Id(Z,i.glyphMap,i.glyphPositions,i.imagePositions,O,wt,m,nt,st,Ne,de,E.az.horizontal,!1,F,B);Je&&(q.horizontal[st]=Je),mt(),zo(pe)&&v&&w&&(q.vertical=Id(Z,i.glyphMap,i.glyphPositions,i.imagePositions,O,wt,m,nt,st,Ne,de,E.az.vertical,!1,F,B))}}let te=!1;if(P.icon&&P.icon.name){const pe=i.imageMap[P.icon.name];pe&&(J=Cm(i.imagePositions[P.icon.name],s.get("icon-offset").evaluate(P,{},i.canonical),s.get("icon-anchor").evaluate(P,{},i.canonical)),te=!!pe.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=te:i.bucket.sdfIcons!==te&&Pn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==i.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const re=u0(q.horizontal)||q.vertical;(e=i.bucket).iconsInText||(e.iconsInText=!!re&&re.iconsInText),(re||J)&&y1(i.bucket,P,q,J,i.imageMap,f,F,G,de,te,i.canonical,i.subdivisionGranularity)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},E.cS=Mu,E.cT=gc,E.cU=Sh,E.cV=function(i){const e=new np;return(function(n,s){for(const u in n.layers)s.writeMessage(3,Ap,n.layers[u])})(i,e),e.finish()},E.cW=function(i,e,n,s,u,f){let m=o(i,e,n,u,0);return m=o(m,e,s,f,1),m},E.cX=class{constructor(i){this.maxEntries=i,this.map=new Map}get(i){const e=this.map.get(i);return e!==void 0&&(this.map.delete(i),this.map.set(i,e)),e}set(i,e){if(this.map.has(i))this.map.delete(i);else if(this.map.size>=this.maxEntries){const n=this.map.keys().next().value;this.map.delete(n)}this.map.set(i,e)}clear(){this.map.clear()}},E.cY=En,E.cZ=np,E.c_=Qd,E.ca=class extends ts{},E.cb=jg,E.cc=class extends hi{},E.cd=yd,E.ce=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},E.cf=Fs,E.cg=function(i,e,n){var s=e[0],u=e[1],f=e[2],m=n[3]*s+n[7]*u+n[11]*f+n[15];return i[0]=(n[0]*s+n[4]*u+n[8]*f+n[12])/(m=m||1),i[1]=(n[1]*s+n[5]*u+n[9]*f+n[13])/m,i[2]=(n[2]*s+n[6]*u+n[10]*f+n[14])/m,i},E.ch=class extends ml{},E.ci=class extends t{},E.cj=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]&&i[9]===e[9]&&i[10]===e[10]&&i[11]===e[11]&&i[12]===e[12]&&i[13]===e[13]&&i[14]===e[14]&&i[15]===e[15]},E.ck=function(i,e){var n=i[0],s=i[1],u=i[2],f=i[3],m=i[4],v=i[5],w=i[6],A=i[7],P=i[8],O=i[9],B=i[10],F=i[11],G=i[12],q=i[13],Z=i[14],J=i[15],de=e[0],te=e[1],re=e[2],pe=e[3],ve=e[4],Ne=e[5],nt=e[6],et=e[7],st=e[8],wt=e[9],mt=e[10],Je=e[11],He=e[12],Mt=e[13],Et=e[14],Lt=e[15];return Math.abs(n-de)<=$e*Math.max(1,Math.abs(n),Math.abs(de))&&Math.abs(s-te)<=$e*Math.max(1,Math.abs(s),Math.abs(te))&&Math.abs(u-re)<=$e*Math.max(1,Math.abs(u),Math.abs(re))&&Math.abs(f-pe)<=$e*Math.max(1,Math.abs(f),Math.abs(pe))&&Math.abs(m-ve)<=$e*Math.max(1,Math.abs(m),Math.abs(ve))&&Math.abs(v-Ne)<=$e*Math.max(1,Math.abs(v),Math.abs(Ne))&&Math.abs(w-nt)<=$e*Math.max(1,Math.abs(w),Math.abs(nt))&&Math.abs(A-et)<=$e*Math.max(1,Math.abs(A),Math.abs(et))&&Math.abs(P-st)<=$e*Math.max(1,Math.abs(P),Math.abs(st))&&Math.abs(O-wt)<=$e*Math.max(1,Math.abs(O),Math.abs(wt))&&Math.abs(B-mt)<=$e*Math.max(1,Math.abs(B),Math.abs(mt))&&Math.abs(F-Je)<=$e*Math.max(1,Math.abs(F),Math.abs(Je))&&Math.abs(G-He)<=$e*Math.max(1,Math.abs(G),Math.abs(He))&&Math.abs(q-Mt)<=$e*Math.max(1,Math.abs(q),Math.abs(Mt))&&Math.abs(Z-Et)<=$e*Math.max(1,Math.abs(Z),Math.abs(Et))&&Math.abs(J-Lt)<=$e*Math.max(1,Math.abs(J),Math.abs(Lt))},E.cl=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},E.cm=i=>i.type==="symbol",E.cn=i=>i.type==="circle",E.co=i=>i.type==="heatmap",E.cp=i=>i.type==="line",E.cq=i=>i.type==="fill",E.cr=i=>i.type==="fill-extrusion",E.cs=i=>i.type==="hillshade",E.ct=i=>i.type==="color-relief",E.cu=i=>i.type==="background",E.cv=i=>i.type==="custom",E.cw=At,E.cx=function(i,e,n){if(e<=0)return i;const s=1/e;return n===void 0||Math.abs(n)<1e-10?Math.round(i*s)/s:(n>0?Math.ceil(i*s-1e-9):Math.floor(i*s+1e-10))/s},E.cy=function(i,e,n){const s=ft(e.x-n.x,e.y-n.y),u=ft(i.x-n.x,i.y-n.y);var f,m;return Dr(Math.atan2(s[0]*u[1]-s[1]*u[0],(f=s)[0]*(m=u)[0]+f[1]*m[1]))},E.cz=Ut,E.d=Be,E.d0=function(i,e,n,s,u){return l(this,void 0,void 0,(function*(){if(Ue())try{return yield va(i,e,n,s,u)}catch{}return(function(f,m,v,w,A){const P=f.width,O=f.height;zr&&Ga||(zr=new OffscreenCanvas(P,O),Ga=zr.getContext("2d",{willReadFrequently:!0})),zr.width=P,zr.height=O,Ga.drawImage(f,0,0,P,O);const B=Ga.getImageData(m,v,w,A);return Ga.clearRect(0,0,P,O),B.data})(i,e,n,s,u)}))},E.d1=vh,E.d2=X,E.d3=class{constructor(i,e){this.layers={[Jd]:this},this.name=Jd,this.version=e?e.version:1,this.extent=e?e.extent:4096,this.length=i.length,this.features=i}feature(i){return new y_(this.features[i],this.extent)}},E.d4=rc,E.d5=za,E.e=fn,E.f=i=>l(void 0,void 0,void 0,(function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(e)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),E.g=Y,E.h=i=>new Promise(((e,n)=>{const s=new Image;s.onload=()=>{e(s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame((()=>{s.src=ea}))},s.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const u=new Blob([new Uint8Array(i)],{type:"image/png"});s.src=i.byteLength?URL.createObjectURL(u):ea})),E.i=Nn,E.j=(i,e)=>Ie(fn(i,{type:"json"}),e),E.k=Ke,E.l=lt,E.m=Ie,E.n=(i,e)=>Ie(fn(i,{type:"arrayBuffer"}),e),E.o=function(i){return new np(i).readFields(Yg,[])},E.p=Sm,E.q=function(i){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(i))},E.r=_d,E.s=jo,E.t=Li,E.u=Me,E.v=hu,E.w=Pn,E.x=ph,E.y=Xa,E.z=Qo})),R("worker",["./shared"],(function(E){class l{constructor(H,Y){this.keyCache={},H&&this.replace(H,Y)}replace(H,Y){this._layerConfigs={},this._layers={},this.update(H,[],Y)}update(H,Y,K){for(const be of H){this._layerConfigs[be.id]=be;const Ie=this._layers[be.id]=E.bT(be,K);Ie._featureFilter=E.aj(Ie.filter,K),this.keyCache[be.id]&&delete this.keyCache[be.id]}for(const be of Y)delete this.keyCache[be],delete this._layerConfigs[be],delete this._layers[be];this.familiesBySource={};const me=E.cM(Object.values(this._layerConfigs),this.keyCache);for(const be of me){const Ie=be.map((ht=>this._layers[ht.id])),Be=Ie[0];if(Be.isHidden())continue;const Re=Be.source||"";let ke=this.familiesBySource[Re];ke||(ke=this.familiesBySource[Re]={});const lt=Be.sourceLayer||E.ai;let Ke=ke[lt];Ke||(Ke=ke[lt]=[]),Ke.push(Ie)}}}class N{constructor(H){const Y={},K=[];for(const Be in H){const Re=H[Be],ke=Y[Be]={};for(const lt in Re){const Ke=Re[+lt];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const ht={x:0,y:0,w:Ke.bitmap.width+2,h:Ke.bitmap.height+2};K.push(ht),ke[lt]={rect:ht,metrics:Ke.metrics}}}const{w:me,h:be}=E.p(K),Ie=new E.r({width:me||1,height:be||1});for(const Be in H){const Re=H[Be];for(const ke in Re){const lt=Re[+ke];if(!lt||lt.bitmap.width===0||lt.bitmap.height===0)continue;const Ke=Y[Be][ke].rect;E.r.copy(lt.bitmap,Ie,{x:0,y:0},{x:Ke.x+1,y:Ke.y+1},lt.bitmap)}}this.image=Ie,this.positions=Y}}E.cN("GlyphAtlas",N);class X{constructor(H){this.tileID=new E.a2(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId,this.inFlightDependencies=[]}parse(H,Y,K,me,be){return E._(this,void 0,void 0,(function*(){this.status="parsing",this.data=H,this.collisionBoxArray=new E.ag;const Ie=new E.cO(Object.keys(H.layers).sort()),Be=new E.cP(this.tileID,this.promoteId);Be.bucketLayerIDs=[];const Re={},ke={featureIndex:Be,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:K,subdivisionGranularity:be},lt=Y.familiesBySource[this.source];for(const ot in lt){const Pi=H.layers[ot];if(!Pi)continue;Pi.version===1&&E.w(`Vector tile source "${this.source}" layer "${ot}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Pr=Ie.encode(ot),jr=[];for(let vn=0;vn<Pi.length;vn++){const gt=Pi.feature(vn),Qt=Be.getId(gt,ot);jr.push({feature:gt,id:Qt,index:vn,sourceLayerIndex:Pr})}for(const vn of lt[ot]){const gt=vn[0];gt.source!==this.source&&E.w(`layer.source = ${gt.source} does not equal this.source = ${this.source}`),gt.isHidden(this.zoom,!0)||(Q(vn,this.zoom,K),(Re[gt.id]=gt.createBucket({index:Be.bucketLayerIDs.length,layers:vn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Pr,sourceID:this.source})).populate(jr,ke,this.tileID.canonical),Be.bucketLayerIDs.push(vn.map((Qt=>Qt.id))))}}const Ke=E.bY(ke.glyphDependencies,(ot=>Object.keys(ot).map(Number)));this.inFlightDependencies.forEach((ot=>ot?.abort())),this.inFlightDependencies=[];let ht=Promise.resolve({});if(Object.keys(Ke).length){const ot=new AbortController;this.inFlightDependencies.push(ot),ht=me.sendAsync({type:"GG",data:{stacks:Ke,source:this.source,tileID:this.tileID,type:"glyphs"}},ot)}const Me=Object.keys(ke.iconDependencies);let Wt=Promise.resolve({});if(Me.length){const ot=new AbortController;this.inFlightDependencies.push(ot),Wt=me.sendAsync({type:"GI",data:{icons:Me,source:this.source,tileID:this.tileID,type:"icons"}},ot)}const Rn=Object.keys(ke.patternDependencies);let kt=Promise.resolve({});if(Rn.length){const ot=new AbortController;this.inFlightDependencies.push(ot),kt=me.sendAsync({type:"GI",data:{icons:Rn,source:this.source,tileID:this.tileID,type:"patterns"}},ot)}const jt=ke.dashDependencies;let an=Promise.resolve({});if(Object.keys(jt).length){const ot=new AbortController;this.inFlightDependencies.push(ot),an=me.sendAsync({type:"GDA",data:{dashes:jt}},ot)}const[ei,ti,Xi,Yi]=yield Promise.all([ht,Wt,kt,an]),pi=new N(ei),Fi=new E.cQ(ti,Xi);for(const ot in Re){const Pi=Re[ot];Pi instanceof E.ah?(Q(Pi.layers,this.zoom,K),E.cR({bucket:Pi,glyphMap:ei,glyphPositions:pi.positions,imageMap:ti,imagePositions:Fi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ke.subdivisionGranularity})):Pi.hasDependencies&&(Pi instanceof E.cS||Pi instanceof E.cT||Pi instanceof E.cU)&&(Q(Pi.layers,this.zoom,K),Pi.addFeatures(ke,this.tileID.canonical,Fi.patternPositions,Yi))}return this.status="done",{buckets:Object.values(Re).filter((ot=>!ot.isEmpty())),featureIndex:Be,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:pi.image,imageAtlas:Fi,dashPositions:Yi,glyphMap:this.returnDependencies?ei:null,iconMap:this.returnDependencies?ti:null,glyphPositions:this.returnDependencies?pi.positions:null}}))}}function Q(De,H,Y){const K=new E.H(H);for(const me of De)me.recalculate(K,Y)}class ee{constructor(H,Y,K,me,be){this.type=H,this.properties=K||{},this.extent=be,this.pointsArray=Y,this.id=me}loadGeometry(){return this.pointsArray.map((H=>H.map((Y=>new E.P(Y.x,Y.y)))))}}class le{constructor(H,Y,K){this.version=2,this._myFeatures=H,this.name=Y,this.length=H.length,this.extent=K}feature(H){return this._myFeatures[H]}}class ce{constructor(){this.layers={}}addLayer(H){this.layers[H.name]=H}}function Ce(De){let H=E.cV(De);return H.byteOffset===0&&H.byteLength===H.buffer.byteLength||(H=new Uint8Array(H)),{vectorTile:De,rawData:H.buffer}}function xe(De,H,Y){const{extent:K}=De,me=Math.pow(2,Y.z-H.z),be=(Y.x-H.x*me)*K,Ie=(Y.y-H.y*me)*K,Be=[];for(let Re=0;Re<De.length;Re++){const ke=De.feature(Re);let lt=ke.loadGeometry();for(const ht of lt)for(const Me of ht)Me.x=Me.x*me-be,Me.y=Me.y*me-Ie;const Ke=128;lt=E.cW(lt,ke.type,-Ke,-Ke,K+Ke,K+Ke),lt.length!==0&&Be.push(new ee(ke.type,lt,ke.properties,ke.id,K))}return new le(Be,De.name,K)}class ie{constructor(H,Y,K){this.actor=H,this.layerIndex=Y,this.availableImages=K,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new E.cX(1e3)}loadVectorTile(H,Y){return E._(this,void 0,void 0,(function*(){const K=yield E.n(H.request,Y);try{return{vectorTile:H.encoding!=="mlt"?new E.cY(new E.cZ(K.data)):new E.c_(K.data),rawData:K.data,cacheControl:K.cacheControl,expires:K.expires}}catch(me){const be=new Uint8Array(K.data);let Ie=`Unable to parse the tile at ${H.request.url}, `;throw Ie+=be[0]===31&&be[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${me.message}`,new Error(Ie)}}))}loadTile(H){return E._(this,void 0,void 0,(function*(){const{uid:Y,overzoomParameters:K}=H;K&&(H.request=K.overzoomRequest);const me=!!(H&&H.request&&H.request.collectResourceTiming)&&new E.c$(H.request),be=new X(H);this.loading[Y]=be;const Ie=new AbortController;be.abort=Ie;try{const Be=yield this.loadVectorTile(H,Ie);if(delete this.loading[Y],!Be)return null;if(K){const ht=this._getOverzoomTile(H,Be.vectorTile);Be.rawData=ht.rawData,Be.vectorTile=ht.vectorTile}const Re=Be.rawData,ke={};Be.expires&&(ke.expires=Be.expires),Be.cacheControl&&(ke.cacheControl=Be.cacheControl);const lt={};if(me){const ht=me.finish();ht&&(lt.resourceTiming=JSON.parse(JSON.stringify(ht)))}be.vectorTile=Be.vectorTile;const Ke=be.parse(Be.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity);this.loaded[Y]=be,this.fetching[Y]={rawTileData:Re,cacheControl:ke,resourceTiming:lt};try{const ht=yield Ke;return E.e({rawTileData:Re.slice(0),encoding:H.encoding},ht,ke,lt)}finally{delete this.fetching[Y]}}catch(Be){throw delete this.loading[Y],be.status="done",this.loaded[Y]=be,Be}}))}_getOverzoomTile(H,Y){const{tileID:K,source:me,overzoomParameters:be}=H,{maxZoomTileID:Ie}=be,Be=`${Ie.key}_${K.key}`,Re=this.overzoomedTileResultCache.get(Be);if(Re)return Re;const ke=new ce,lt=this.layerIndex.familiesBySource[me];for(const ht in lt){const Me=Y.layers[ht];if(!Me)continue;const Wt=xe(Me,Ie,K.canonical);Wt.length>0&&ke.addLayer(Wt)}const Ke=Ce(ke);return this.overzoomedTileResultCache.set(Be,Ke),Ke}reloadTile(H){return E._(this,void 0,void 0,(function*(){const Y=H.uid;if(!this.loaded||!this.loaded[Y])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const K=this.loaded[Y];if(K.showCollisionBoxes=H.showCollisionBoxes,K.status==="parsing"){const me=yield K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity);let be;if(this.fetching[Y]){const{rawTileData:Ie,cacheControl:Be,resourceTiming:Re}=this.fetching[Y];delete this.fetching[Y],be=E.e({rawTileData:Ie.slice(0),encoding:H.encoding},me,Be,Re)}else be=me;return be}if(K.status==="done"&&K.vectorTile)return K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity)}))}abortTile(H){return E._(this,void 0,void 0,(function*(){const Y=this.loading,K=H.uid;Y&&Y[K]&&Y[K].abort&&(Y[K].abort.abort(),delete Y[K])}))}removeTile(H){return E._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[H.uid]&&delete this.loaded[H.uid]}))}}class Ue{constructor(){this.loaded={}}loadTile(H){return E._(this,void 0,void 0,(function*(){const{uid:Y,encoding:K,rawImageData:me,redFactor:be,greenFactor:Ie,blueFactor:Be,baseShift:Re}=H,ke=me.width+2,lt=me.height+2,Ke=E.b(me)?new E.R({width:ke,height:lt},yield E.d0(me,-1,-1,ke,lt)):me,ht=new E.d1(Y,Ke,K,be,Ie,Be,Re);return this.loaded=this.loaded||{},this.loaded[Y]=ht,ht}))}removeTile(H){const Y=this.loaded,K=H.uid;Y&&Y[K]&&delete Y[K]}}var $e,Le,Ye=(function(){if(Le)return $e;function De(Y,K){if(Y.length!==0){H(Y[0],K);for(var me=1;me<Y.length;me++)H(Y[me],!K)}}function H(Y,K){for(var me=0,be=0,Ie=0,Be=Y.length,Re=Be-1;Ie<Be;Re=Ie++){var ke=(Y[Ie][0]-Y[Re][0])*(Y[Re][1]+Y[Ie][1]),lt=me+ke;be+=Math.abs(me)>=Math.abs(ke)?me-lt+ke:ke-lt+me,me=lt}me+be>=0!=!!K&&Y.reverse()}return Le=1,$e=function Y(K,me){var be,Ie=K&&K.type;if(Ie==="FeatureCollection")for(be=0;be<K.features.length;be++)Y(K.features[be],me);else if(Ie==="GeometryCollection")for(be=0;be<K.geometries.length;be++)Y(K.geometries[be],me);else if(Ie==="Feature")Y(K.geometry,me);else if(Ie==="Polygon")De(K.coordinates,me);else if(Ie==="MultiPolygon")for(be=0;be<K.coordinates.length;be++)De(K.coordinates[be],me);return K}})(),it=E.d2(Ye);const pt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:De=>De},Qe=Math.fround||(_t=new Float32Array(1),De=>(_t[0]=+De,_t[0]));var _t;class Pt{constructor(H){this.options=Object.assign(Object.create(pt),H),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(H){const{log:Y,minZoom:K,maxZoom:me}=this.options;Y&&console.time("total time");const be=`prepare ${H.length} points`;Y&&console.time(be),this.points=H;const Ie=[];for(let Re=0;Re<H.length;Re++){const ke=H[Re];if(!ke.geometry)continue;const[lt,Ke]=ke.geometry.coordinates,ht=Qe(Ot(lt)),Me=Qe(Vt(Ke));Ie.push(ht,Me,1/0,Re,-1,1),this.options.reduce&&Ie.push(0)}let Be=this.trees[me+1]=this._createTree(Ie);Y&&console.timeEnd(be);for(let Re=me;Re>=K;Re--){const ke=+Date.now();Be=this.trees[Re]=this._createTree(this._cluster(Be,Re)),Y&&console.log("z%d: %d clusters in %dms",Re,Be.numItems,+Date.now()-ke)}return Y&&console.timeEnd("total time"),this}getClusters(H,Y){let K=((H[0]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,H[1]));let be=H[2]===180?180:((H[2]+180)%360+360)%360-180;const Ie=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)K=-180,be=180;else if(K>be){const Ke=this.getClusters([K,me,180,Ie],Y),ht=this.getClusters([-180,me,be,Ie],Y);return Ke.concat(ht)}const Be=this.trees[this._limitZoom(Y)],Re=Be.range(Ot(K),Vt(Ie),Ot(be),Vt(me)),ke=Be.data,lt=[];for(const Ke of Re){const ht=this.stride*Ke;lt.push(ke[ht+5]>1?Rt(ke,ht,this.clusterProps):this.points[ke[ht+3]])}return lt}getChildren(H){const Y=this._getOriginId(H),K=this._getOriginZoom(H),me="No cluster with the specified id.",be=this.trees[K];if(!be)throw new Error(me);const Ie=be.data;if(Y*this.stride>=Ie.length)throw new Error(me);const Be=this.options.radius/(this.options.extent*Math.pow(2,K-1)),Re=be.within(Ie[Y*this.stride],Ie[Y*this.stride+1],Be),ke=[];for(const lt of Re){const Ke=lt*this.stride;Ie[Ke+4]===H&&ke.push(Ie[Ke+5]>1?Rt(Ie,Ke,this.clusterProps):this.points[Ie[Ke+3]])}if(ke.length===0)throw new Error(me);return ke}getLeaves(H,Y,K){const me=[];return this._appendLeaves(me,H,Y=Y||10,K=K||0,0),me}getTile(H,Y,K){const me=this.trees[this._limitZoom(H)],be=Math.pow(2,H),{extent:Ie,radius:Be}=this.options,Re=Be/Ie,ke=(K-Re)/be,lt=(K+1+Re)/be,Ke={features:[]};return this._addTileFeatures(me.range((Y-Re)/be,ke,(Y+1+Re)/be,lt),me.data,Y,K,be,Ke),Y===0&&this._addTileFeatures(me.range(1-Re/be,ke,1,lt),me.data,be,K,be,Ke),Y===be-1&&this._addTileFeatures(me.range(0,ke,Re/be,lt),me.data,-1,K,be,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(H){let Y=this._getOriginZoom(H)-1;for(;Y<=this.options.maxZoom;){const K=this.getChildren(H);if(Y++,K.length!==1)break;H=K[0].properties.cluster_id}return Y}_appendLeaves(H,Y,K,me,be){const Ie=this.getChildren(Y);for(const Be of Ie){const Re=Be.properties;if(Re&&Re.cluster?be+Re.point_count<=me?be+=Re.point_count:be=this._appendLeaves(H,Re.cluster_id,K,me,be):be<me?be++:H.push(Be),H.length===K)break}return be}_createTree(H){const Y=new E.aT(H.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<H.length;K+=this.stride)Y.add(H[K],H[K+1]);return Y.finish(),Y.data=H,Y}_addTileFeatures(H,Y,K,me,be,Ie){for(const Be of H){const Re=Be*this.stride,ke=Y[Re+5]>1;let lt,Ke,ht;if(ke)lt=Zt(Y,Re,this.clusterProps),Ke=Y[Re],ht=Y[Re+1];else{const Rn=this.points[Y[Re+3]];lt=Rn.properties;const[kt,jt]=Rn.geometry.coordinates;Ke=Ot(kt),ht=Vt(jt)}const Me={type:1,geometry:[[Math.round(this.options.extent*(Ke*be-K)),Math.round(this.options.extent*(ht*be-me))]],tags:lt};let Wt;Wt=ke||this.options.generateId?Y[Re+3]:this.points[Y[Re+3]].id,Wt!==void 0&&(Me.id=Wt),Ie.features.push(Me)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,Y){const{radius:K,extent:me,reduce:be,minPoints:Ie}=this.options,Be=K/(me*Math.pow(2,Y)),Re=H.data,ke=[],lt=this.stride;for(let Ke=0;Ke<Re.length;Ke+=lt){if(Re[Ke+2]<=Y)continue;Re[Ke+2]=Y;const ht=Re[Ke],Me=Re[Ke+1],Wt=H.within(Re[Ke],Re[Ke+1],Be),Rn=Re[Ke+5];let kt=Rn;for(const jt of Wt){const an=jt*lt;Re[an+2]>Y&&(kt+=Re[an+5])}if(kt>Rn&&kt>=Ie){let jt,an=ht*Rn,ei=Me*Rn,ti=-1;const Xi=(Ke/lt<<5)+(Y+1)+this.points.length;for(const Yi of Wt){const pi=Yi*lt;if(Re[pi+2]<=Y)continue;Re[pi+2]=Y;const Fi=Re[pi+5];an+=Re[pi]*Fi,ei+=Re[pi+1]*Fi,Re[pi+4]=Xi,be&&(jt||(jt=this._map(Re,Ke,!0),ti=this.clusterProps.length,this.clusterProps.push(jt)),be(jt,this._map(Re,pi)))}Re[Ke+4]=Xi,ke.push(an/kt,ei/kt,1/0,Xi,-1,kt),be&&ke.push(ti)}else{for(let jt=0;jt<lt;jt++)ke.push(Re[Ke+jt]);if(kt>1)for(const jt of Wt){const an=jt*lt;if(!(Re[an+2]<=Y)){Re[an+2]=Y;for(let ei=0;ei<lt;ei++)ke.push(Re[an+ei])}}}}return ke}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,Y,K){if(H[Y+5]>1){const Ie=this.clusterProps[H[Y+6]];return K?Object.assign({},Ie):Ie}const me=this.points[H[Y+3]].properties,be=this.options.map(me);return K&&be===me?Object.assign({},be):be}}function Rt(De,H,Y){return{type:"Feature",id:De[H+3],properties:Zt(De,H,Y),geometry:{type:"Point",coordinates:[(K=De[H],360*(K-.5)),Ft(De[H+1])]}};var K}function Zt(De,H,Y){const K=De[H+5],me=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,be=De[H+6],Ie=be===-1?{}:Object.assign({},Y[be]);return Object.assign(Ie,{cluster:!0,cluster_id:De[H+3],point_count:K,point_count_abbreviated:me})}function Ot(De){return De/360+.5}function Vt(De){const H=Math.sin(De*Math.PI/180),Y=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return Y<0?0:Y>1?1:Y}function Ft(De){const H=(180-360*De)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function Ht(De,H,Y,K){let me=K;const be=H+(Y-H>>1);let Ie,Be=Y-H;const Re=De[H],ke=De[H+1],lt=De[Y],Ke=De[Y+1];for(let ht=H+3;ht<Y;ht+=3){const Me=Pe(De[ht],De[ht+1],Re,ke,lt,Ke);if(Me>me)Ie=ht,me=Me;else if(Me===me){const Wt=Math.abs(ht-be);Wt<Be&&(Ie=ht,Be=Wt)}}me>K&&(Ie-H>3&&Ht(De,H,Ie,K),De[Ie+2]=me,Y-Ie>3&&Ht(De,Ie,Y,K))}function Pe(De,H,Y,K,me,be){let Ie=me-Y,Be=be-K;if(Ie!==0||Be!==0){const Re=((De-Y)*Ie+(H-K)*Be)/(Ie*Ie+Be*Be);Re>1?(Y=me,K=be):Re>0&&(Y+=Ie*Re,K+=Be*Re)}return Ie=De-Y,Be=H-K,Ie*Ie+Be*Be}function Xe(De,H,Y,K){const me={type:H,geom:Y},be={id:De??null,type:me.type,geometry:me.geom,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};switch(me.type){case"Point":case"MultiPoint":case"LineString":ft(be,me.geom);break;case"Polygon":ft(be,me.geom[0]);break;case"MultiLineString":for(const Ie of me.geom)ft(be,Ie);break;case"MultiPolygon":for(const Ie of me.geom)ft(be,Ie[0])}return be}function ft(De,H){for(let Y=0;Y<H.length;Y+=3)De.minX=Math.min(De.minX,H[Y]),De.minY=Math.min(De.minY,H[Y+1]),De.maxX=Math.max(De.maxX,H[Y]),De.maxY=Math.max(De.maxY,H[Y+1])}function yt(De,H){const Y=[];switch(De.type){case"FeatureCollection":for(let K=0;K<De.features.length;K++)It(Y,De.features[K],H,K);break;case"Feature":It(Y,De,H);break;default:It(Y,{geometry:De,properties:void 0},H)}return Y}function It(De,H,Y,K){if(!H.geometry)return;if(H.geometry.type==="GeometryCollection"){for(const Be of H.geometry.geometries)It(De,{id:H.id,geometry:Be,properties:H.properties},Y,K);return}if(!H.geometry.coordinates?.length)return;const be=Math.pow(Y.tolerance/((1<<Y.maxZoom)*Y.extent),2);let Ie=H.id;switch(Y.promoteId?Ie=H.properties?.[Y.promoteId]:Y.generateId&&(Ie=K||0),H.geometry.type){case"Point":{const Be=[];return Ee(H.geometry.coordinates,Be),void De.push(Xe(Ie,H.geometry.type,Be,H.properties))}case"MultiPoint":{const Be=[];for(const Re of H.geometry.coordinates)Ee(Re,Be);return void De.push(Xe(Ie,H.geometry.type,Be,H.properties))}case"LineString":{const Be=[];return rt(H.geometry.coordinates,Be,be,!1),void De.push(Xe(Ie,H.geometry.type,Be,H.properties))}case"MultiLineString":{if(Y.lineMetrics){for(const Re of H.geometry.coordinates){const ke=[];rt(Re,ke,be,!1),De.push(Xe(Ie,"LineString",ke,H.properties))}return}const Be=[];return Tt(H.geometry.coordinates,Be,be,!1),void De.push(Xe(Ie,H.geometry.type,Be,H.properties))}case"Polygon":{const Be=[];return Tt(H.geometry.coordinates,Be,be,!0),void De.push(Xe(Ie,H.geometry.type,Be,H.properties))}case"MultiPolygon":{const Be=[];for(const Re of H.geometry.coordinates){const ke=[];Tt(Re,ke,be,!0),Be.push(ke)}return void De.push(Xe(Ie,H.geometry.type,Be,H.properties))}default:throw new Error("Input data is not a valid GeoJSON object.")}}function Ee(De,H){H.push(At(De[0]),Ut(De[1]),0)}function rt(De,H,Y,K){let me,be,Ie=0;for(let Re=0;Re<De.length;Re++){const ke=At(De[Re][0]),lt=Ut(De[Re][1]);H.push(ke,lt,0),Re>0&&(Ie+=K?(me*lt-ke*be)/2:Math.sqrt(Math.pow(ke-me,2)+Math.pow(lt-be,2))),me=ke,be=lt}const Be=H.length-3;H[2]=1,Y>0&&Ht(H,0,Be,Y),H[Be+2]=1,H.size=Math.abs(Ie),H.start=0,H.end=H.size}function Tt(De,H,Y,K){for(let me=0;me<De.length;me++){const be=[];rt(De[me],be,Y,K),H.push(be)}}function At(De){return De/360+.5}function Ut(De){const H=Math.sin(De*Math.PI/180),Y=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return Y<0?0:Y>1?1:Y}function Nt(De,H,Y,K,me,be,Ie,Be){if(K/=H,be>=(Y/=H)&&Ie<K)return De;if(Ie<Y||be>=K)return null;const Re=[];for(const ke of De){const lt=me===0?ke.minX:ke.minY,Ke=me===0?ke.maxX:ke.maxY;if(lt>=Y&&Ke<K)Re.push(ke);else if(!(Ke<Y||lt>=K))switch(ke.type){case"Point":case"MultiPoint":{const ht=[];if(tn(ke.geometry,ht,Y,K,me),!ht.length)continue;Re.push(Xe(ke.id,ht.length===3?"Point":"MultiPoint",ht,ke.tags));continue}case"LineString":{const ht=[];if(fn(ke.geometry,ht,Y,K,me,!1,Be.lineMetrics),!ht.length)continue;if(Be.lineMetrics){for(const Me of ht)Re.push(Xe(ke.id,ke.type,Me,ke.tags));continue}if(ht.length>1){Re.push(Xe(ke.id,"MultiLineString",ht,ke.tags));continue}Re.push(Xe(ke.id,ke.type,ht[0],ke.tags));continue}case"MultiLineString":{const ht=[];if($i(ke.geometry,ht,Y,K,me,!1),!ht.length)continue;if(ht.length===1){Re.push(Xe(ke.id,"LineString",ht[0],ke.tags));continue}Re.push(Xe(ke.id,ke.type,ht,ke.tags));continue}case"Polygon":{const ht=[];if($i(ke.geometry,ht,Y,K,me,!0),!ht.length)continue;Re.push(Xe(ke.id,ke.type,ht,ke.tags));continue}case"MultiPolygon":{const ht=[];for(const Me of ke.geometry){const Wt=[];$i(Me,Wt,Y,K,me,!0),Wt.length&&ht.push(Wt)}if(!ht.length)continue;Re.push(Xe(ke.id,ke.type,ht,ke.tags));continue}}}return Re.length?Re:null}function tn(De,H,Y,K,me){for(let be=0;be<De.length;be+=3){const Ie=De[be+me];Ie>=Y&&Ie<=K&&Fn(H,De[be],De[be+1],De[be+2])}}function fn(De,H,Y,K,me,be,Ie){let Be=_n(De);const Re=me===0?vi:ya;let ke,lt,Ke=De.start;for(let kt=0;kt<De.length-3;kt+=3){const jt=De[kt],an=De[kt+1],ei=De[kt+2],ti=De[kt+3],Xi=De[kt+4],Yi=me===0?jt:an,pi=me===0?ti:Xi;let Fi=!1;Ie&&(ke=Math.sqrt(Math.pow(jt-ti,2)+Math.pow(an-Xi,2))),Yi<Y?pi>Y&&(lt=Re(Be,jt,an,ti,Xi,Y),Ie&&(Be.start=Ke+ke*lt)):Yi>K?pi<K&&(lt=Re(Be,jt,an,ti,Xi,K),Ie&&(Be.start=Ke+ke*lt)):Fn(Be,jt,an,ei),pi<Y&&Yi>=Y&&(lt=Re(Be,jt,an,ti,Xi,Y),Fi=!0),pi>K&&Yi<=K&&(lt=Re(Be,jt,an,ti,Xi,K),Fi=!0),!be&&Fi&&(Ie&&(Be.end=Ke+ke*lt),H.push(Be),Be=_n(De)),Ie&&(Ke+=ke)}let ht=De.length-3;const Me=De[ht],Wt=De[ht+1],Rn=me===0?Me:Wt;Rn>=Y&&Rn<=K&&Fn(Be,Me,Wt,De[ht+2]),ht=Be.length-3,be&&ht>=3&&(Be[ht]!==Be[0]||Be[ht+1]!==Be[1])&&Fn(Be,Be[0],Be[1],Be[2]),Be.length&&H.push(Be)}function _n(De){const H=[];return H.size=De.size,H.start=De.start,H.end=De.end,H}function $i(De,H,Y,K,me,be){for(const Ie of De)fn(Ie,H,Y,K,me,be,!1)}function Fn(De,H,Y,K){De.push(H,Y,K)}function vi(De,H,Y,K,me,be){const Ie=(be-H)/(K-H);return Fn(De,be,Y+(me-Y)*Ie,1),Ie}function ya(De,H,Y,K,me,be){const Ie=(be-Y)/(me-Y);return Fn(De,H+(K-H)*Ie,be,1),Ie}function Pn(De,H){const Y=H.buffer/H.extent;let K=De;const me=Nt(De,1,-1-Y,Y,0,-1,2,H),be=Nt(De,1,1-Y,2+Y,0,-1,2,H);return(me||be)&&(K=Nt(De,1,-Y,1+Y,0,-1,2,H)||[],me&&(K=Zi(me,1).concat(K)),be&&(K=K.concat(Zi(be,-1)))),K}function Zi(De,H){const Y=[];for(const K of De)switch(K.type){case"Point":case"MultiPoint":case"LineString":{const me=Nn(K.geometry,H);Y.push(Xe(K.id,K.type,me,K.tags));continue}case"MultiLineString":case"Polygon":{const me=[];for(const be of K.geometry)me.push(Nn(be,H));Y.push(Xe(K.id,K.type,me,K.tags));continue}case"MultiPolygon":{const me=[];for(const be of K.geometry){const Ie=[];for(const Be of be)Ie.push(Nn(Be,H));me.push(Ie)}Y.push(Xe(K.id,K.type,me,K.tags));continue}}return Y}function Nn(De,H){const Y=[];Y.size=De.size,De.start!==void 0&&(Y.start=De.start,Y.end=De.end);for(let K=0;K<De.length;K+=3)Y.push(De[K]+H,De[K+1],De[K+2]);return Y}function Zn(De,H){if(De.transformed)return De;const Y=1<<De.z,K=De.x,me=De.y;for(const be of De.features){if(be.type===1){const Be=[];for(let Re=0;Re<be.geometry.length;Re+=2)Be.push(Ar(be.geometry[Re],be.geometry[Re+1],H,Y,K,me));be.geometry=Be;continue}const Ie=[];for(const Be of be.geometry){const Re=[];for(let ke=0;ke<Be.length;ke+=2)Re.push(Ar(Be[ke],Be[ke+1],H,Y,K,me));Ie.push(Re)}be.geometry=Ie}return De.transformed=!0,De}function Ar(De,H,Y,K,me,be){return[Math.round(Y*(De*K-me)),Math.round(Y*(H*K-be))]}function ea(De,H,Y,K,me){const be=H===me.maxZoom?0:me.tolerance/((1<<H)*me.extent),Ie={features:[],numPoints:0,numSimplified:0,numFeatures:De.length,source:null,x:Y,y:K,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Be of De)va(Ie,Be,be,me);return Ie}function va(De,H,Y,K){De.minX=Math.min(De.minX,H.minX),De.minY=Math.min(De.minY,H.minY),De.maxX=Math.max(De.maxX,H.maxX),De.maxY=Math.max(De.maxY,H.maxY);let me,be=H.tags||null;switch(H.type){case"Point":case"MultiPoint":{const Ie=[];for(let Be=0;Be<H.geometry.length;Be+=3)Ie.push(H.geometry[Be],H.geometry[Be+1]),De.numPoints++,De.numSimplified++;if(!Ie.length)return;me={type:1,tags:be,geometry:Ie};break}case"LineString":{const Ie=[];if(zr(Ie,H.geometry,De,Y,!1,!1),!Ie.length)return;if(K.lineMetrics){be={};for(const Be in H.tags)be[Be]=H.tags[Be];be.mapbox_clip_start=H.geometry.start/H.geometry.size,be.mapbox_clip_end=H.geometry.end/H.geometry.size}me={type:2,tags:be,geometry:Ie};break}case"MultiLineString":case"Polygon":{const Ie=[];for(let Be=0;Be<H.geometry.length;Be++)zr(Ie,H.geometry[Be],De,Y,H.type==="Polygon",Be===0);if(!Ie.length)return;me={type:H.type==="Polygon"?3:2,tags:be,geometry:Ie};break}case"MultiPolygon":{const Ie=[];for(let Be=0;Be<H.geometry.length;Be++){const Re=H.geometry[Be];for(let ke=0;ke<Re.length;ke++)zr(Ie,Re[ke],De,Y,!0,ke===0)}if(!Ie.length)return;me={type:3,tags:be,geometry:Ie};break}}H.id!==null&&(me.id=H.id),De.features.push(me)}function zr(De,H,Y,K,me,be){const Ie=K*K;if(K>0&&H.size<(me?Ie:K))return void(Y.numPoints+=H.length/3);const Be=[];for(let Re=0;Re<H.length;Re+=3)(K===0||H[Re+2]>Ie)&&(Y.numSimplified++,Be.push(H[Re],H[Re+1])),Y.numPoints++;me&&(function(Re,ke){let lt=0;for(let Ke=0,ht=Re.length,Me=ht-2;Ke<ht;Me=Ke,Ke+=2)lt+=(Re[Ke]-Re[Me])*(Re[Ke+1]+Re[Me+1]);if(lt>0===ke)for(let Ke=0,ht=Re.length;Ke<ht/2;Ke+=2){const Me=Re[Ke],Wt=Re[Ke+1];Re[Ke]=Re[ht-2-Ke],Re[Ke+1]=Re[ht-1-Ke],Re[ht-2-Ke]=Me,Re[ht-1-Ke]=Wt}})(Be,be),De.push(Be)}function Ga(De,H,Y){const K=!!H.newGeometry,me=H.removeAllProperties||H.removeProperties?.length>0||H.addOrUpdateProperties?.length>0;if(K){let be=yt({type:"FeatureCollection",features:[{type:"Feature",id:De.id,geometry:H.newGeometry,properties:me?jo(De.tags,H):De.tags}]},Y);return be=Pn(be,Y),be[0]}if(me){const be={...De};return be.tags=jo(be.tags,H),be}return null}function jo(De,H){if(H.removeAllProperties)return{};const Y={...De||{}};if(H.removeProperties)for(const K of H.removeProperties)delete Y[K];if(H.addOrUpdateProperties)for(const{key:K,value:me}of H.addOrUpdateProperties)Y[K]=me;return Y}const Hi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,updateable:!1,debug:0};class Dr{options;tiles;tileCoords;stats={};total=0;source;constructor(H,Y){const K=(Y=this.options=Object.assign({},Hi,Y)).debug;if(K&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");let me=yt(H,Y);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),me=Pn(me,Y),me.length&&this.splitTile(me,0,0,0),Y.updateable&&(this.source=me),K&&(me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(H,Y,K,me,be,Ie,Be){const Re=[H,Y,K,me],ke=this.options,lt=ke.debug;for(;Re.length;){me=Re.pop(),K=Re.pop(),Y=Re.pop(),H=Re.pop();const Ke=1<<Y,ht=xa(Y,K,me);let Me=this.tiles[ht];if(!Me&&(lt>1&&console.time("creation"),Me=this.tiles[ht]=ea(H,Y,K,me,ke),this.tileCoords.push({z:Y,x:K,y:me,id:ht}),lt)){lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,K,me,Me.numFeatures,Me.numPoints,Me.numSimplified),console.timeEnd("creation"));const Fi=`z${Y}`;this.stats[Fi]=(this.stats[Fi]||0)+1,this.total++}if(Me.source=H,be==null){if(Y===ke.indexMaxZoom||Me.numPoints<=ke.indexMaxPoints)continue}else{if(Y===ke.maxZoom||Y===be)continue;if(be!=null){const Fi=be-Y;if(K!==Ie>>Fi||me!==Be>>Fi)continue}}if(Me.source=null,!H.length)continue;lt>1&&console.time("clipping");const Wt=.5*ke.buffer/ke.extent,Rn=.5-Wt,kt=.5+Wt,jt=1+Wt;let an=null,ei=null,ti=null,Xi=null;const Yi=Nt(H,Ke,K-Wt,K+kt,0,Me.minX,Me.maxX,ke),pi=Nt(H,Ke,K+Rn,K+jt,0,Me.minX,Me.maxX,ke);Yi&&(an=Nt(Yi,Ke,me-Wt,me+kt,1,Me.minY,Me.maxY,ke),ei=Nt(Yi,Ke,me+Rn,me+jt,1,Me.minY,Me.maxY,ke)),pi&&(ti=Nt(pi,Ke,me-Wt,me+kt,1,Me.minY,Me.maxY,ke),Xi=Nt(pi,Ke,me+Rn,me+jt,1,Me.minY,Me.maxY,ke)),lt>1&&console.timeEnd("clipping"),Re.push(an||[],Y+1,2*K,2*me),Re.push(ei||[],Y+1,2*K,2*me+1),Re.push(ti||[],Y+1,2*K+1,2*me),Re.push(Xi||[],Y+1,2*K+1,2*me+1)}}getTile(H,Y,K){H=+H,Y=+Y,K=+K;const me=this.options,{extent:be,debug:Ie}=me;if(H<0||H>24)return null;const Be=1<<H,Re=xa(H,Y=Y+Be&Be-1,K);if(this.tiles[Re])return Zn(this.tiles[Re],be);Ie>1&&console.log("drilling down to z%d-%d-%d",H,Y,K);let ke,lt=H,Ke=Y,ht=K;for(;!ke&&lt>0;)lt--,Ke>>=1,ht>>=1,ke=this.tiles[xa(lt,Ke,ht)];return ke?.source?(Ie>1&&(console.log("found parent tile z%d-%d-%d",lt,Ke,ht),console.time("drilling down")),this.splitTile(ke.source,lt,Ke,ht,H,Y,K),Ie>1&&console.timeEnd("drilling down"),this.tiles[Re]?Zn(this.tiles[Re],be):null):null}invalidateTiles(H){const Y=this.options,{debug:K}=Y;let me=1/0,be=-1/0,Ie=1/0,Be=-1/0;for(const lt of H)me=Math.min(me,lt.minX),be=Math.max(be,lt.maxX),Ie=Math.min(Ie,lt.minY),Be=Math.max(Be,lt.maxY);const Re=Y.buffer/Y.extent,ke=new Set;for(const lt in this.tiles){const Ke=this.tiles[lt],ht=1<<Ke.z,Me=(Ke.x-Re)/ht,Wt=(Ke.x+1+Re)/ht,Rn=(Ke.y-Re)/ht,kt=(Ke.y+1+Re)/ht;if(be<Me||me>=Wt||Be<Rn||Ie>=kt)continue;let jt=!1;for(const an of H)if(an.maxX>=Me&&an.minX<Wt&&an.maxY>=Rn&&an.minY<kt){jt=!0;break}if(jt){if(K){K>1&&console.log("invalidate tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ke.z,Ke.x,Ke.y,Ke.numFeatures,Ke.numPoints,Ke.numSimplified);const an=`z${Ke.z}`;this.stats[an]=(this.stats[an]||0)-1,this.total--}delete this.tiles[lt],ke.add(lt)}}ke.size&&(this.tileCoords=this.tileCoords.filter((lt=>!ke.has(lt.id))))}updateData(H){const Y=this.options,K=Y.debug;if(!Y.updateable)throw new Error("to update tile geojson `updateable` option must be set to true");const{affected:me,source:be}=(function(Ke,ht,Me){const Wt=(function(kt){return kt?{removeAll:kt.removeAll,remove:new Set(kt.remove||[]),add:new Map(kt.add?.map((jt=>[jt.id,jt]))),update:new Map(kt.update?.map((jt=>[jt.id,jt])))}:{remove:new Set,add:new Map,update:new Map}})(ht);let Rn=[];if(Wt.removeAll&&(Rn=Ke,Ke=[]),Wt.remove.size||Wt.add.size){const kt=[];for(const jt of Ke){const{id:an}=jt;(Wt.remove.has(an)||Wt.add.has(an))&&kt.push(jt)}if(kt.length){Rn.push(...kt);const jt=new Set(kt.map((an=>an.id)));Ke=Ke.filter((an=>!jt.has(an.id)))}if(Wt.add.size){let jt=yt({type:"FeatureCollection",features:Array.from(Wt.add.values())},Me);jt=Pn(jt,Me),Rn.push(...jt),Ke.push(...jt)}}if(Wt.update.size)for(const[kt,jt]of Wt.update){const an=Ke.findIndex((Xi=>Xi.id===kt));if(an===-1)continue;const ei=Ke[an],ti=Ga(ei,jt,Me);ti&&(Rn.push(ei,ti),Ke[an]=ti)}return{affected:Rn,source:Ke}})(this.source,H,Y);if(!me.length)return;this.source=be,K>1&&(console.log("invalidating tiles"),console.time("invalidating")),this.invalidateTiles(me),K>1&&console.timeEnd("invalidating");const[Ie,Be,Re]=[0,0,0],ke=ea(this.source,Ie,Be,Re,this.options);ke.source=this.source;const lt=xa(Ie,Be,Re);if(this.tiles[lt]=ke,this.tileCoords.push({z:Ie,x:Be,y:Re,id:lt}),K){const Ke=`z${Ie}`;this.stats[Ke]=(this.stats[Ke]||0)+1,this.total++}}}function xa(De,H,Y){return 32*((1<<De)*Y+H)+De}class xi extends ie{constructor(H,Y,K,me=qa){super(H,Y,K),this._dataUpdateable=new Map,this._createGeoJSONIndex=me}loadVectorTile(H,Y){return E._(this,void 0,void 0,(function*(){const K=H.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const me=this._geoJSONIndex.getTile(K.z,K.x,K.y);return me?Ce(new E.d3(me.features,{version:2,extent:E.a5})):null}))}loadData(H){return E._(this,void 0,void 0,(function*(){var Y;(Y=this._pendingRequest)===null||Y===void 0||Y.abort();const K=this._startPerformance(H);this._pendingRequest=new AbortController;try{(!this._pendingData||H.request||H.data||H.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(H,this._pendingRequest));const me=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(me,H),this.loaded={};const be={};return H.request&&(be.data=me),this._finishPerformance(K,H,be),be}catch(me){if(delete this._pendingRequest,E.Z(me))return{abandoned:!0};throw me}}))}_startPerformance(H){var Y;if(!((Y=H?.request)===null||Y===void 0)&&Y.collectResourceTiming)return new E.c$(H.request)}_finishPerformance(H,Y,K){if(!H)return;const me=H.finish();me&&(K.resourceTiming={},K.resourceTiming[Y.source]=JSON.parse(JSON.stringify(me)))}getData(){return E._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(H){const Y=this.loaded;return Y&&Y[H.uid]?super.reloadTile(H):this.loadTile(H)}loadAndProcessGeoJSON(H,Y){return E._(this,void 0,void 0,(function*(){let K;if(H.request?K=yield this.loadGeoJSONFromUrl(H.request,H.promoteId,Y):H.data?K=this._loadGeoJSONFromObject(H.data,H.promoteId):H.dataDiff&&(K=this._loadGeoJSONFromDiff(H.dataDiff,H.promoteId,H.source)),delete this._pendingRequest,typeof K!="object")throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`);return it(K,!0),H.filter&&(K=this._filterGeoJSON(K,H.filter)),K}))}loadGeoJSONFromUrl(H,Y,K){return E._(this,void 0,void 0,(function*(){const me=yield E.j(H,K);return this._dataUpdateable=E.a7(me.data,Y),me.data}))}_loadGeoJSONFromObject(H,Y){return this._dataUpdateable=E.a7(H,Y),H}_loadGeoJSONFromDiff(H,Y,K){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${K}`);E.a8(this._dataUpdateable,H,Y);const me=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(me)}_filterGeoJSON(H,Y){const K=E.d4(Y,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(K.result==="error")throw new Error(K.value.map((be=>`${be.key}: ${be.message}`)).join(", "));const me=H.features.filter((be=>K.value.evaluate({zoom:0},be)));return this._toFeatureCollection(me)}_toFeatureCollection(H){return{type:"FeatureCollection",features:H}}removeSource(H){return E._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(H){return this._geoJSONIndex.getClusterExpansionZoom(H.clusterId)}getClusterChildren(H){return this._geoJSONIndex.getChildren(H.clusterId)}getClusterLeaves(H){return this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset)}}function qa(De,H){return H.cluster?new Pt((function({superclusterOptions:Y,clusterProperties:K}){if(!K||!Y)return Y;const me={},be={},Ie={accumulated:null,zoom:0},Be={properties:null},Re=Object.keys(K);for(const ke of Re){const[lt,Ke]=K[ke],ht=E.d4(Ke),Me=E.d4(typeof lt=="string"?[lt,["accumulated"],["get",ke]]:lt);me[ke]=ht.value,be[ke]=Me.value}return Y.map=ke=>{Be.properties=ke;const lt={};for(const Ke of Re)lt[Ke]=me[Ke].evaluate(Ie,Be);return lt},Y.reduce=(ke,lt)=>{Be.properties=lt;for(const Ke of Re)Ie.accumulated=ke[Ke],ke[Ke]=be[Ke].evaluate(Ie,Be)},Y})(H)).load(De.features):(function(Y,K){return new Dr(Y,K)})(De,H.geojsonVtOptions)}class fs{constructor(H){this.self=H,this.actor=new E.L(H),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(Y,K)=>{if(this.externalWorkerSourceTypes[Y])throw new Error(`Worker source with name "${Y}" already registered.`);this.externalWorkerSourceTypes[Y]=K},this.self.addProtocol=E.cK,this.self.removeProtocol=E.cL,this.self.registerRTLTextPlugin=Y=>{E.d5.setMethods(Y)},this.actor.registerMessageHandler("LDT",((Y,K)=>this._getDEMWorkerSource(Y,K.source).loadTile(K))),this.actor.registerMessageHandler("RDT",((Y,K)=>E._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(Y,K.source).removeTile(K)})))),this.actor.registerMessageHandler("GCEZ",((Y,K)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(Y,K.type,K.source).getClusterExpansionZoom(K)})))),this.actor.registerMessageHandler("GCC",((Y,K)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(Y,K.type,K.source).getClusterChildren(K)})))),this.actor.registerMessageHandler("GCL",((Y,K)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(Y,K.type,K.source).getClusterLeaves(K)})))),this.actor.registerMessageHandler("LD",((Y,K)=>this._getWorkerSource(Y,K.type,K.source).loadData(K))),this.actor.registerMessageHandler("GD",((Y,K)=>this._getWorkerSource(Y,K.type,K.source).getData())),this.actor.registerMessageHandler("LT",((Y,K)=>this._getWorkerSource(Y,K.type,K.source).loadTile(K))),this.actor.registerMessageHandler("RT",((Y,K)=>this._getWorkerSource(Y,K.type,K.source).reloadTile(K))),this.actor.registerMessageHandler("AT",((Y,K)=>this._getWorkerSource(Y,K.type,K.source).abortTile(K))),this.actor.registerMessageHandler("RMT",((Y,K)=>this._getWorkerSource(Y,K.type,K.source).removeTile(K))),this.actor.registerMessageHandler("RS",((Y,K)=>E._(this,void 0,void 0,(function*(){if(!this.workerSources[Y]||!this.workerSources[Y][K.type]||!this.workerSources[Y][K.type][K.source])return;const me=this.workerSources[Y][K.type][K.source];delete this.workerSources[Y][K.type][K.source],me.removeSource!==void 0&&me.removeSource(K)})))),this.actor.registerMessageHandler("RM",(Y=>E._(this,void 0,void 0,(function*(){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y],this.globalStates.delete(Y)})))),this.actor.registerMessageHandler("SR",((Y,K)=>E._(this,void 0,void 0,(function*(){this.referrer=K})))),this.actor.registerMessageHandler("SRPS",((Y,K)=>this._syncRTLPluginState(Y,K))),this.actor.registerMessageHandler("IS",((Y,K)=>E._(this,void 0,void 0,(function*(){this.self.importScripts(K)})))),this.actor.registerMessageHandler("SI",((Y,K)=>this._setImages(Y,K))),this.actor.registerMessageHandler("UL",((Y,K)=>E._(this,void 0,void 0,(function*(){this._getLayerIndex(Y).update(K.layers,K.removedIds,this._getGlobalState(Y))})))),this.actor.registerMessageHandler("UGS",((Y,K)=>E._(this,void 0,void 0,(function*(){const me=this._getGlobalState(Y);for(const be in K)me[be]=K[be]})))),this.actor.registerMessageHandler("SL",((Y,K)=>E._(this,void 0,void 0,(function*(){this._getLayerIndex(Y).replace(K,this._getGlobalState(Y))}))))}_getGlobalState(H){let Y=this.globalStates.get(H);return Y||(Y={},this.globalStates.set(H,Y)),Y}_setImages(H,Y){return E._(this,void 0,void 0,(function*(){this.availableImages[H]=Y;for(const K in this.workerSources[H]){const me=this.workerSources[H][K];for(const be in me)me[be].availableImages=Y}}))}_syncRTLPluginState(H,Y){return E._(this,void 0,void 0,(function*(){return yield E.d5.syncState(Y,this.self.importScripts)}))}_getAvailableImages(H){let Y=this.availableImages[H];return Y||(Y=[]),Y}_getLayerIndex(H){let Y=this.layerIndexes[H];return Y||(Y=this.layerIndexes[H]=new l),Y}_getWorkerSource(H,Y,K){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][Y]||(this.workerSources[H][Y]={}),!this.workerSources[H][Y][K]){const me={sendAsync:(be,Ie)=>(be.targetMapId=H,this.actor.sendAsync(be,Ie))};switch(Y){case"vector":this.workerSources[H][Y][K]=new ie(me,this._getLayerIndex(H),this._getAvailableImages(H));break;case"geojson":this.workerSources[H][Y][K]=new xi(me,this._getLayerIndex(H),this._getAvailableImages(H));break;default:this.workerSources[H][Y][K]=new this.externalWorkerSourceTypes[Y](me,this._getLayerIndex(H),this._getAvailableImages(H))}}return this.workerSources[H][Y][K]}_getDEMWorkerSource(H,Y){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][Y]||(this.demWorkerSources[H][Y]=new Ue),this.demWorkerSources[H][Y]}}return E.i(self)&&(self.worker=new fs(self)),fs})),R("index",["exports","./shared"],(function(E,l){var N="5.17.0";function X(){var g=new l.A(4);return l.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}let Q,ee,le;const ce={frame(g,t,a,c){const d=c||window,y=d.requestAnimationFrame((C=>{x(),t(C)})),{unsubscribe:x}=l.s(g.signal,"abort",(()=>{x(),d.cancelAnimationFrame(y),a(new l.a(g.signal.reason))}),!1)},frameAsync(g,t){return new Promise(((a,c)=>{this.frame(g,a,c,t)}))},getImageData(g,t=0){return this.getImageCanvasContext(g).getImageData(-t,-t,g.width+2*t,g.height+2*t)},getImageCanvasContext(g){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=g.width,t.height=g.height,a.drawImage(g,0,0,g.width,g.height),a},resolveURL:g=>(Q||(Q=document.createElement("a")),Q.href=g,Q.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return le!==void 0?le:!!matchMedia&&(ee==null&&(ee=matchMedia("(prefers-reduced-motion: reduce)")),ee.matches)},set prefersReducedMotion(g){le=g}},Ce=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(g){this._frozenAt=g}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function xe(){return Ce.getCurrentTime()}class ie{static testProp(t){if(!ie.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in ie.docStyle)return t[a];return t[0]}static create(t,a,c){const d=window.document.createElement(t);return a!==void 0&&(d.className=a),c&&c.appendChild(d),d}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){ie.docStyle&&ie.selectProp&&(ie.userSelect=ie.docStyle[ie.selectProp],ie.docStyle[ie.selectProp]="none")}static enableDrag(){ie.docStyle&&ie.selectProp&&(ie.docStyle[ie.selectProp]=ie.userSelect)}static setTransform(t,a){t.style[ie.transformProp]=a}static addEventListener(t,a,c,d={}){t.addEventListener(a,c,"passive"in d?d:d.capture)}static removeEventListener(t,a,c,d={}){t.removeEventListener(a,c,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",ie.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ie.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",ie.suppressClickInternal,!0)}),0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,c){const d=a.boundingClientRect;return new l.P((c.clientX-d.left)/a.x-t.clientLeft,(c.clientY-d.top)/a.y-t.clientTop)}static mousePos(t,a){const c=ie.getScale(t);return ie.getPoint(t,c,a)}static touchPos(t,a){const c=[],d=ie.getScale(t);for(let y=0;y<a.length;y++)c.push(ie.getPoint(t,d,a[y]));return c}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const a=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),c=a.querySelectorAll("script");for(const d of c)d.remove();return ie.clean(a),a.innerHTML}static isPossiblyDangerous(t,a){const c=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!c.includes("javascript:")&&!c.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const a=t.children;for(const c of a)ie.removeAttributes(c),ie.clean(c)}static removeAttributes(t){for(const{name:a,value:c}of t.attributes)ie.isPossiblyDangerous(a,c)&&t.removeAttribute(a)}}ie.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ie.selectProp=ie.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ie.transformProp=ie.testProp(["transform","WebkitTransform"]);const Ue={supported:!1,testSupport:function(g){!Ye&&Le&&(it?pt(g):$e=g)}};let $e,Le,Ye=!1,it=!1;function pt(g){const t=g.createTexture();g.bindTexture(g.TEXTURE_2D,t);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,Le),g.isContextLost())return;Ue.supported=!0}catch{}g.deleteTexture(t),Ye=!0}var Qe;typeof document<"u"&&(Le=document.createElement("img"),Le.onload=()=>{$e&&pt($e),$e=null,it=!0},Le.onerror=()=>{Ye=!0,$e=null},Le.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(g){let t,a,c,d;g.resetRequestQueue=()=>{t=[],a=0,c=0,d={}},g.addThrottleControl=z=>{const L=c++;return d[L]=z,L},g.removeThrottleControl=z=>{delete d[z],x()},g.getImage=(z,L,k=!0)=>new Promise(((V,j)=>{Ue.supported&&(z.headers||(z.headers={}),z.headers.accept="image/webp,*/*"),l.e(z,{type:"image"}),t.push({abortController:L,requestParameters:z,supportImageRefresh:k,state:"queued",onError:$=>{j($)},onSuccess:$=>{V($)}}),x()}));const y=z=>l._(this,void 0,void 0,(function*(){z.state="running";const{requestParameters:L,supportImageRefresh:k,onError:V,onSuccess:j,abortController:$}=z,W=k===!1&&!l.i(self)&&!l.g(L.url)&&(!L.headers||Object.keys(L.headers).reduce(((oe,fe)=>oe&&fe==="accept"),!0));a++;const ae=W?C(L,$):l.m(L,$);try{const oe=yield ae;delete z.abortController,z.state="completed",oe.data instanceof HTMLImageElement||l.b(oe.data)?j(oe):oe.data&&j({data:yield(se=oe.data,typeof createImageBitmap=="function"?l.f(se):l.h(se)),cacheControl:oe.cacheControl,expires:oe.expires})}catch(oe){delete z.abortController,V(oe)}finally{a--,x()}var se})),x=()=>{const z=(()=>{for(const L of Object.keys(d))if(d[L]())return!0;return!1})()?l.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let L=a;L<z&&t.length>0;L++){const k=t.shift();k.abortController.signal.aborted?L--:y(k)}},C=(z,L)=>new Promise(((k,V)=>{const j=new Image,$=z.url,W=z.credentials;W&&W==="include"?j.crossOrigin="use-credentials":(W&&W==="same-origin"||!l.d($))&&(j.crossOrigin="anonymous"),L.signal.addEventListener("abort",(()=>{j.src="",V(new l.a(L.signal.reason))})),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,k({data:j})},j.onerror=()=>{j.onerror=j.onload=null,L.signal.aborted||V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=$}))})(Qe||(Qe={})),Qe.resetRequestQueue();class _t{constructor(t){this._transformRequestFn=t??null}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Pt(g){const t=[];if(typeof g=="string")t.push({id:"default",url:g});else if(g&&g.length>0){const a=[];for(const{id:c,url:d}of g){const y=`${c}${d}`;a.indexOf(y)===-1&&(a.push(y),t.push({id:c,url:d}))}}return t}function Rt(g,t,a){try{const c=new URL(g);return c.pathname+=`${t}${a}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${g}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Zt(g){const{userImage:t}=g;return!!(t&&t.render&&t.render())&&(g.data.replace(new Uint8Array(t.data.buffer)),!0)}class Ot extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const t of Object.keys(this.images))this.removeImage(t);this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:c}of this.requestors)c(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const c=a.spriteData;a.data=new l.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let c=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(a.content,a)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,a){if(!t)return!0;let c=0;for(const d of t){if(d[0]<c||d[1]<d[0]||a<d[1])return!1;c=d[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const c=a.spriteData,d=c&&c.width||a.data.width,y=c&&c.height||a.data.height;return!(t[0]<0||d<t[0]||t[1]<0||y<t[1]||t[2]<0||d<t[2]||t[3]<0||y<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,c=!0){const d=this.getImage(t);if(c&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((a,c)=>{let d=!0;if(!this.isLoaded())for(const y of t)this.images[y]||(d=!1);this.isLoaded()||d?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})}))}_getImagesForIds(t){const a={};for(const c of t){let d=this.getImage(c);d||(this.fire(new l.l("styleimagemissing",{id:c})),d=this.getImage(c)),d?a[c]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:l.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],c=this.getImage(t);if(!c)return null;if(a&&a.position.version===c.version)return a.position;if(a)a.position.version=c.version;else{const d={w:c.data.width+2,h:c.data.height+2,x:0,y:0},y=new l.I(d,c);this.patterns[t]={bin:d,position:y}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.T(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const y in this.patterns)t.push(this.patterns[y].bin);const{w:a,h:c}=l.p(t),d=this.atlasImage;d.resize({width:a||1,height:c||1});for(const y in this.patterns){const{bin:x}=this.patterns[y],C=x.x+1,z=x.y+1,L=this.getImage(y).data,k=L.width,V=L.height;l.R.copy(L,d,{x:0,y:0},{x:C,y:z},{width:k,height:V}),l.R.copy(L,d,{x:0,y:V-1},{x:C,y:z-1},{width:k,height:1}),l.R.copy(L,d,{x:0,y:0},{x:C,y:z+V},{width:k,height:1}),l.R.copy(L,d,{x:k-1,y:0},{x:C-1,y:z},{width:1,height:V}),l.R.copy(L,d,{x:0,y:0},{x:C+k,y:z},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const c=this.getImage(a);c||l.w(`Image with ID: "${a}" was not found`),Zt(c)&&this.updateImage(a,c)}}cloneImages(){const t={};for(const a in this.images){const c=this.images[a];t[a]=Object.assign(Object.assign({},c),{data:c.data?c.data.clone():null})}return t}}const Vt=1e20;function Ft(g,t,a,c,d,y,x,C,z){for(let L=t;L<t+c;L++)Ht(g,a*y+L,y,d,x,C,z);for(let L=a;L<a+d;L++)Ht(g,L*y+t,1,c,x,C,z)}function Ht(g,t,a,c,d,y,x){y[0]=0,x[0]=-Vt,x[1]=Vt,d[0]=g[t];for(let C=1,z=0,L=0;C<c;C++){d[C]=g[t+C*a];const k=C*C;do{const V=y[z];L=(d[C]-d[V]+k-V*V)/(C-V)/2}while(L<=x[z]&&--z>-1);z++,y[z]=C,x[z]=L,x[z+1]=Vt}for(let C=0,z=0;C<c;C++){for(;x[z+1]<C;)z++;const L=y[z],k=C-L;g[t+C*a]=d[L]+k*k}}const Pe=l.v.layout_symbol["text-font"].default.join(",");class Xe{constructor(t,a,c){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={},this.lang=c}setURL(t){this.url=t}getGlyphs(t){return l._(this,void 0,void 0,(function*(){const a=[];for(const y in t)for(const x of t[y])a.push(this._getAndCacheGlyphsPromise(y,x));const c=yield Promise.all(a),d={};for(const{stack:y,id:x,glyph:C}of c)d[y]||(d[y]={}),d[y][x]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return d}))}_getAndCacheGlyphsPromise(t,a){return l._(this,void 0,void 0,(function*(){let c=this.entries[t];c||(c=this.entries[t]={glyphs:{},requests:{},ranges:{}});let d=c.glyphs[a];return d!==void 0?{stack:t,id:a,glyph:d}:!this.url||this._charUsesLocalIdeographFontFamily(a)?(d=c.glyphs[a]=this._drawGlyph(c,t,a),{stack:t,id:a,glyph:d}):yield this._downloadAndCacheRangePromise(t,a)}))}_downloadAndCacheRangePromise(t,a){return l._(this,void 0,void 0,(function*(){const c=this.entries[t],d=Math.floor(a/256);if(c.ranges[d])return{stack:t,id:a,glyph:null};if(!c.requests[d]){const y=Xe.loadGlyphRange(t,d,this.url,this.requestManager);c.requests[d]=y}try{const y=yield c.requests[d];for(const x in y)c.glyphs[+x]=y[+x];return c.ranges[d]=!0,{stack:t,id:a,glyph:y[a]||null}}catch(y){const x=c.glyphs[a]=this._drawGlyph(c,t,a);return this._warnOnMissingGlyphRange(x,d,a,y),{stack:t,id:a,glyph:x}}}))}_warnOnMissingGlyphRange(t,a,c,d){const y=256*a,x=y+255,C=c.toString(16).padStart(4,"0").toUpperCase();l.w(`Unable to load glyph range ${a}, ${y}-${x}. Rendering codepoint U+${C} locally instead. ${d}`)}_charUsesLocalIdeographFontFamily(t){return!!this.localIdeographFontFamily&&l.q(t)}_drawGlyph(t,a,c){const d=a===Pe&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(c),y=d?"ideographTinySDF":"tinySDF";t[y]||(t[y]=this._createTinySDF(d?this.localIdeographFontFamily:a));const x=t[y].draw(String.fromCodePoint(c)),C=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(c));return{id:c,bitmap:new l.r({width:x.width||60,height:x.height||60},x.data),metrics:{width:C?0:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:C?0:x.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(t){const a=t?t.split(","):[];a.push("sans-serif");const c=a.map((d=>/[-\w]+/.test(d)?d:`'${CSS.escape(d)}'`)).join(",");return new Xe.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:c,fontWeight:this._fontWeight(a[0]),fontStyle:this._fontStyle(a[0]),lang:this.lang})}_fontStyle(t){return/italic/i.test(t)?"italic":/oblique/i.test(t)?"oblique":"normal"}_fontWeight(t){const a={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let c;for(const[d,y]of Object.entries(a))new RegExp(`\\b${d}\\b`,"i").test(t)&&(c=`${y}`);return c}destroy(){for(const t in this.entries){const a=this.entries[t];a.tinySDF&&(a.tinySDF=null),a.ideographTinySDF&&(a.ideographTinySDF=null),a.glyphs={},a.requests={},a.ranges={}}this.entries={}}}Xe.loadGlyphRange=function(g,t,a,c){return l._(this,void 0,void 0,(function*(){const d=256*t,y=d+255,x=c.transformRequest(a.replace("{fontstack}",g).replace("{range}",`${d}-${y}`),"Glyphs"),C=yield l.n(x,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${t}, ${d}-${y}`);const z={};for(const L of l.o(C.data))z[L.id]=L;return z}))},Xe.TinySDF=class{constructor({fontSize:g=24,buffer:t=3,radius:a=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:y="normal",fontStyle:x="normal",lang:C=null}={}){this.buffer=t,this.cutoff=c,this.radius=a,this.lang=C;const z=this.size=g+4*t,L=this._createCanvas(z),k=this.ctx=L.getContext("2d",{willReadFrequently:!0});k.font=`${x} ${y} ${g}px ${d}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(z*z),this.gridInner=new Float64Array(z*z),this.f=new Float64Array(z),this.z=new Float64Array(z+1),this.v=new Uint16Array(z)}_createCanvas(g){const t=document.createElement("canvas");return t.width=t.height=g,t}draw(g){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:y}=this.ctx.measureText(g),x=Math.ceil(a),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-d))),z=Math.min(this.size-this.buffer,x+Math.ceil(c)),L=C+2*this.buffer,k=z+2*this.buffer,V=Math.max(L*k,0),j=new Uint8ClampedArray(V),$={data:j,width:L,height:k,glyphWidth:C,glyphHeight:z,glyphTop:x,glyphLeft:0,glyphAdvance:t};if(C===0||z===0)return $;const{ctx:W,buffer:ae,gridInner:se,gridOuter:oe}=this;this.lang&&(W.lang=this.lang),W.clearRect(ae,ae,C,z),W.fillText(g,ae,ae+x);const fe=W.getImageData(ae,ae,C,z);oe.fill(Vt,0,V),se.fill(0,0,V);for(let ye=0;ye<z;ye++)for(let he=0;he<C;he++){const _e=fe.data[4*(ye*C+he)+3]/255;if(_e===0)continue;const we=(ye+ae)*L+he+ae;if(_e===1)oe[we]=0,se[we]=Vt;else{const ge=.5-_e;oe[we]=ge>0?ge*ge:0,se[we]=ge<0?ge*ge:0}}Ft(oe,0,0,L,k,L,this.f,this.v,this.z),Ft(se,ae,ae,C,z,L,this.f,this.v,this.z);for(let ye=0;ye<V;ye++){const he=Math.sqrt(oe[ye])-Math.sqrt(se[ye]);j[ye]=Math.round(255-255*(he/this.radius+this.cutoff))}return $}};class ft{constructor(){this.specification=l.u.light.position}possiblyEvaluate(t,a){return l.F(t.expression.evaluate(a))}interpolate(t,a,c){return{x:l.G.number(t.x,a.x,c),y:l.G.number(t.y,a.y,c),z:l.G.number(t.z,a.z,c)}}}let yt;class It extends l.E{constructor(t){super(),yt=yt||new l.t({anchor:new l.D(l.u.light.anchor),position:new ft,color:new l.D(l.u.light.color),intensity:new l.D(l.u.light.intensity)}),this._transitionable=new l.x(yt,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(l.y,t,a))for(const c in t){const d=t[c];c.endsWith(l.z)?this._transitionable.setTransition(c.slice(0,-l.z.length),d):this._transitionable.setValue(c,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,c){return(!c||c.validate!==!1)&&l.B(this,t.call(l.C,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:l.u}))}}const Ee=new l.t({"sky-color":new l.D(l.u.sky["sky-color"]),"horizon-color":new l.D(l.u.sky["horizon-color"]),"fog-color":new l.D(l.u.sky["fog-color"]),"fog-ground-blend":new l.D(l.u.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.u.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.u.sky["atmosphere-blend"])});class rt extends l.E{constructor(t){super(),this._transitionable=new l.x(Ee,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.H(0))}setSky(t,a={}){if(!this._validate(l.J,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in t){const d=t[c];c.endsWith(l.z)?this._transitionable.setTransition(c.slice(0,-l.z.length),d):this._transitionable.setValue(c,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,c={}){return c?.validate!==!1&&l.B(this,t.call(l.C,l.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:l.u})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Tt{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const c=t.join(",")+String(a);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,a)),this.dashEntry[c]}getDashRanges(t,a,c){const d=[];let y=t.length%2==1?-t[t.length-1]*c:0,x=t[0]*c,C=!0;d.push({left:y,right:x,isDash:C,zeroLength:t[0]===0});let z=t[0];for(let L=1;L<t.length;L++){C=!C;const k=t[L];y=z*c,z+=k,x=z*c,d.push({left:y,right:x,isDash:C,zeroLength:k===0})}return d}addRoundDash(t,a,c){const d=a/2;for(let y=-c;y<=c;y++){const x=this.width*(this.nextRow+c+y);let C=0,z=t[C];for(let L=0;L<this.width;L++){L/z.right>1&&(z=t[++C]);const k=Math.abs(L-z.left),V=Math.abs(L-z.right),j=Math.min(k,V);let $;const W=y/c*(d+1);if(z.isDash){const ae=d-Math.abs(W);$=Math.sqrt(j*j+ae*ae)}else $=d-Math.sqrt(j*j+W*W);this.data[x+L]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(t){for(let C=t.length-1;C>=0;--C){const z=t[C],L=t[C+1];z.zeroLength?t.splice(C,1):L&&L.isDash===z.isDash&&(L.left=z.left,t.splice(C,1))}const a=t[0],c=t[t.length-1];a.isDash===c.isDash&&(a.left=c.left-this.width,c.right=a.right+this.width);const d=this.width*this.nextRow;let y=0,x=t[y];for(let C=0;C<this.width;C++){C/x.right>1&&(x=t[++y]);const z=Math.abs(C-x.left),L=Math.abs(C-x.right),k=Math.min(z,L);this.data[d+C]=Math.max(0,Math.min(255,(x.isDash?k:-k)+128))}}addDash(t,a){const c=a?7:0,d=2*c+1;if(this.nextRow+d>this.height)return l.w("LineAtlas out of space"),null;let y=0;for(let C=0;C<t.length;C++)y+=t[C];if(y!==0){const C=this.width/y,z=this.getDashRanges(t,this.width,C);a?this.addRoundDash(z,C,c):this.addRegularDash(z)}const x={y:this.nextRow+c,height:2*c,width:y};return this.nextRow+=d,this.dirty=!0,x}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const At="maplibre_preloaded_worker_pool";class Ut{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Ut.workerCount;)this.workers.push(new Worker(l.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[At]}numActive(){return Object.keys(this.active).length}}const Nt=Math.floor(ce.hardwareConcurrency/2);let tn,fn;function _n(){return tn||(tn=new Ut),tn}Ut.workerCount=l.K(globalThis)?Math.max(Math.min(Nt,3),1):1;class $i{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const c=this.workerPool.acquire(a);for(let d=0;d<c.length;d++){const y=new l.L(c[d],a);y.name=`Worker ${d}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const c=[];for(const d of this.actors)c.push(d.sendAsync({type:t,data:a}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const c of this.actors)c.registerMessageHandler(t,a)}unregisterMessageHandler(t){for(const a of this.actors)a.unregisterMessageHandler(t)}}function Fn(){return fn||(fn=new $i(_n(),l.M),fn.registerMessageHandler("GR",((g,t,a)=>l.m(t,a)))),fn}function vi(g,t){const a=l.N();return l.O(a,a,[1,1,0]),l.Q(a,a,[.5*g.width,.5*g.height,1]),g.calculatePosMatrix?l.S(a,a,g.calculatePosMatrix(t.toUnwrapped())):a}function ya(g,t,a,c,d,y,x){var C;const z=(function(j,$,W){if(j)for(const ae of j){const se=$[ae];if(se&&se.source===W&&se.type==="fill-extrusion")return!0}else for(const ae in $){const se=$[ae];if(se.source===W&&se.type==="fill-extrusion")return!0}return!1})((C=d?.layers)!==null&&C!==void 0?C:null,t,g.id),L=y.maxPitchScaleFactor(),k=g.tilesIn(c,L,z);k.sort(Pn);const V=[];for(const j of k)V.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(t,a,g.getState(),j.queryGeometry,j.cameraQueryGeometry,j.scale,d,y,L,vi(y,j.tileID),x?($,W)=>x(j.tileID,$,W):void 0)});return(function(j,$){for(const W in j)for(const ae of j[W])Zi(ae,$);return j})((function(j){const $={},W={};for(const ae of j){const se=ae.queryResults,oe=ae.wrappedTileID,fe=W[oe]=W[oe]||{};for(const ye in se){const he=se[ye],_e=fe[ye]=fe[ye]||{},we=$[ye]=$[ye]||[];for(const ge of he)_e[ge.featureIndex]||(_e[ge.featureIndex]=!0,we.push(ge))}}return $})(V),g)}function Pn(g,t){const a=g.tileID,c=t.tileID;return a.overscaledZ-c.overscaledZ||a.canonical.y-c.canonical.y||a.wrap-c.wrap||a.canonical.x-c.canonical.x}function Zi(g,t){const a=g.feature,c=t.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=c}function Nn(g,t,a,c){return l._(this,void 0,void 0,(function*(){let d=g;if(g.url?d=(yield l.j(t.transformRequest(g.url,"Source"),a)).data:yield ce.frameAsync(a,c),!d)return null;const y=l.U(l.e(d,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(y.vectorLayerIds=d.vector_layers.map((x=>x.id))),y}))}class Zn{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof l.V?new l.V(t.lng,t.lat):l.V.convert(t),this}setSouthWest(t){return this._sw=t instanceof l.V?new l.V(t.lng,t.lat):l.V.convert(t),this}extend(t){const a=this._sw,c=this._ne;let d,y;if(t instanceof l.V)d=t,y=t;else{if(!(t instanceof Zn))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Zn.convert(t)):this.extend(l.V.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(l.V.convert(t)):this;if(d=t._sw,y=t._ne,!d||!y)return this}return a||c?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),c.lng=Math.max(y.lng,c.lng),c.lat=Math.max(y.lat,c.lat)):(this._sw=new l.V(d.lng,d.lat),this._ne=new l.V(y.lng,y.lat)),this}getCenter(){return new l.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.V(this.getWest(),this.getNorth())}getSouthEast(){return new l.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:c}=l.V.convert(t);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}intersects(t){if(!((t=Zn.convert(t)).getNorth()>=this.getSouth()&&t.getSouth()<=this.getNorth()))return!1;const a=Math.abs(this.getEast()-this.getWest()),c=Math.abs(t.getEast()-t.getWest());if(a>=360||c>=360)return!0;const d=l.W(this.getWest(),-180,180),y=l.W(this.getEast(),-180,180),x=l.W(t.getWest(),-180,180),C=l.W(t.getEast(),-180,180),z=d>=y,L=x>=C;return!(!z||!L)||(z?C>=d||x<=y:L?y>=x||d<=C:x<=y&&C>=d)}static convert(t){return t instanceof Zn?t:t&&new Zn(t)}static fromLngLat(t,a=0){const c=360*a/40075017,d=c/Math.cos(Math.PI/180*t.lat);return new Zn(new l.V(t.lng-d,t.lat-c),new l.V(t.lng+d,t.lat+c))}adjustAntiMeridian(){const t=new l.V(this._sw.lng,this._sw.lat),a=new l.V(this._ne.lng,this._ne.lat);return new Zn(t,t.lng>a.lng?new l.V(a.lng+360,a.lat):a)}}class Ar{constructor(t,a,c){this.bounds=Zn.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),c=Math.floor(l.Y(this.bounds.getWest())*a),d=Math.floor(l.X(this.bounds.getNorth())*a),y=Math.ceil(l.Y(this.bounds.getEast())*a),x=Math.ceil(l.X(this.bounds.getSouth())*a);return t.x>=c&&t.x<y&&t.y>=d&&t.y<x}}class ea extends l.E{constructor(t,a,c,d){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.U(a,["url","scheme","tileSize","promoteId","encoding"])),this._options=l.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Nn(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),t&&(l.e(this,t),t.bounds&&(this.tileBounds=new Ar(t.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,l.Z(t)||this.fire(new l.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(t){return l._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(t)};c.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((y,x)=>{t.reloadPromise={resolve:y,reject:x}}))}else t.actor=this.dispatcher.getActor(),d="LT";t.abortController=new AbortController;try{const y=yield t.actor.sendAsync({type:d,data:c},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,y)}catch(y){if(delete t.abortController,t.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(t,null)}}))}_getOverzoomParameters(t){if(t.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const a=t.tileID.scaledTo(this.maxzoom).canonical,c=a.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:a,overzoomRequest:this.map._requestManager.transformRequest(c,"Tile")}}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const c=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(c.resolve).catch(c.reject)}}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class va extends l.E{constructor(t,a,c,d){super(),this.id=t,this.dispatcher=c,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},a),l.e(this,l.U(a,["url","scheme","tileSize"]))}load(){return l._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield Nn(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,a&&(l.e(this,a),a.bounds&&(this.tileBounds=new Ar(a.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,l.Z(a)||this.fire(new l.k(a))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return l.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return l._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const c=yield Qe.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&(c.cacheControl||c.expires)&&t.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const d=this.map.painter.context,y=d.gl,x=c.data;t.texture=this.map.painter.getTileTexture(x.width),t.texture?t.texture.update(x,{useMipmap:!0}):(t.texture=new l.T(d,x,y.RGBA,{useMipmap:!0}),t.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(c){if(delete t.abortController,t.aborted)t.state="unloaded";else if(c)throw t.state="errored",c}}))}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class zr extends va{constructor(t,a,c,d){super(t,a,c,d),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return l._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const d=yield Qe.getImage(c,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){const y=d.data;this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const x=l.b(y)&&l.$()?y:yield this.readImageNow(y),C={type:this.type,uid:t.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const z=yield t.actor.sendAsync({type:"LDT",data:C});t.dem=z,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}}))}readImageNow(t){return l._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&l.a0()){const a=t.width+2,c=t.height+2;try{return new l.R({width:a,height:c},yield l.a1(t,-1,-1,a,c))}catch{}}return ce.getImageData(t,1)}))}_getNeighboringTiles(t){const a=t.canonical,c=Math.pow(2,a.z),d=(a.x-1+c)%c,y=a.x===0?t.wrap-1:t.wrap,x=(a.x+1+c)%c,C=a.x+1===c?t.wrap+1:t.wrap,z={};return z[new l.a2(t.overscaledZ,y,a.z,d,a.y).key]={backfilled:!1},z[new l.a2(t.overscaledZ,C,a.z,x,a.y).key]={backfilled:!1},a.y>0&&(z[new l.a2(t.overscaledZ,y,a.z,d,a.y-1).key]={backfilled:!1},z[new l.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},z[new l.a2(t.overscaledZ,C,a.z,x,a.y-1).key]={backfilled:!1}),a.y+1<c&&(z[new l.a2(t.overscaledZ,y,a.z,d,a.y+1).key]={backfilled:!1},z[new l.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},z[new l.a2(t.overscaledZ,C,a.z,x,a.y+1).key]={backfilled:!1}),z}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}function Ga(g){return g.type==="GeometryCollection"?g.geometries.map((t=>t.coordinates)).flat(1/0):g.coordinates.flat(1/0)}function jo(g){const t=new Zn;let a;switch(g.type){case"FeatureCollection":a=g.features.map((c=>Ga(c.geometry))).flat(1/0);break;case"Feature":a=Ga(g.geometry);break;default:a=Ga(g)}if(a.length==0)return t;for(let c=0;c<a.length-1;c+=2)t.extend([a[c],a[c+1]]);return t}class Hi extends l.E{constructor(t,a,c,d){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=c.getActor(),this.setEventedParent(d),this._data=typeof a.data=="string"?{url:a.data}:{geojson:a.data},this._options=l.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&l.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=l.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:l.a5,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:l.a5,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(t){return t*(l.a5/this.tileSize)}_getClusterMaxZoom(t){const a=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||l.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${a}"`),a}load(){return l._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t,a){this._data=typeof t=="string"?{url:t}:{geojson:t},this._pendingWorkerUpdate={data:t};const c=this._updateWorkerData();return a?c:this}updateData(t,a){this._pendingWorkerUpdate.diff=l.a6(this._pendingWorkerUpdate.diff,t);const c=this._updateWorkerData();return a?c:this}getData(){return l._(this,void 0,void 0,(function*(){const t=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getBounds(){return l._(this,void 0,void 0,(function*(){return jo(yield this.getData())}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:c}})}_updateWorkerData(){return l._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void l.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:t,diff:a}=this._pendingWorkerUpdate,c=this._getLoadGeoJSONParameters(t,a);t!==void 0?this._pendingWorkerUpdate.data=void 0:a&&(this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,yield this._dispatchWorkerUpdate(c)}))}_getLoadGeoJSONParameters(t,a){const c=l.e({type:this.type},this.workerOptions);return typeof t=="string"?(c.request=this.map._requestManager.transformRequest(ce.resolveURL(t),"Source"),c.request.collectResourceTiming=this._collectResourceTiming,c):t!==void 0?(c.data=t,c):(a&&(c.dataDiff=a),c)}_dispatchWorkerUpdate(t){return l._(this,void 0,void 0,(function*(){this._isUpdatingWorker=!0,this.fire(new l.l("dataloading",{dataType:"source"}));try{const a=yield this.actor.sendAsync({type:"LD",data:t});if(this._isUpdatingWorker=!1,this._removed||a.abandoned)return void this.fire(new l.l("dataabort",{dataType:"source"}));a.data&&(this._data={geojson:a.data});const c=this._applyDiffToSource(t.dataDiff),d=this._getShouldReloadTileOptions(c),y={dataType:"source"};this._applyResourceTiming(y,a),this.fire(new l.l("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new l.l("data",Object.assign(Object.assign({},y),{sourceDataType:"content",shouldReloadTileOptions:d})))}catch(a){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new l.l("dataabort",{dataType:"source"}));this.fire(new l.k(a))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyResourceTiming(t,a){var c;if(!this._collectResourceTiming)return;const d=(c=a.resourceTiming)===null||c===void 0?void 0:c[this.id];if(!d)return;const y=d.slice(0);y?.length&&l.e(t,{resourceTiming:y})}_applyDiffToSource(t){if(!t)return;const a=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const d=l.a7(this._data.geojson,a);if(!d)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:d}}if(!this._data.updateable)return;const c=l.a8(this._data.updateable,t,a);return t.removeAll||this._options.cluster?void 0:c}_getShouldReloadTileOptions(t){if(t)return{affectedBounds:t.filter(Boolean).map((a=>jo(a)))}}shouldReloadTile(t,{affectedBounds:a}){if(t.state==="loading")return!0;if(t.state==="unloaded")return!1;const{buffer:c,extent:d}=this.workerOptions.geojsonVtOptions,y=(function({x,y:C,z},L=0){const k=l.a3((x-L)/Math.pow(2,z)),V=l.a4((C+1+L)/Math.pow(2,z)),j=l.a3((x+1+L)/Math.pow(2,z)),$=l.a4((C-L)/Math.pow(2,z));return new Zn([k,V],[j,$])})(t.tileID.canonical,c/d);for(const x of a)if(y.intersects(x))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(t){return l._(this,void 0,void 0,(function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const c={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const d=yield this.actor.sendAsync({type:a,data:c},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(d,this.map.painter,a==="RT")}))}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Dr extends l.E{constructor(t,a,c,d){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=c,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}load(t){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield Qe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,l.Z(a)||this.fire(new l.k(a))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(l.a9.fromLngLat);var c;return this.tileID=(function(d){const y=l.aa.fromPoints(d),x=y.width(),C=y.height(),z=Math.max(x,C),L=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),k=Math.pow(2,L);return new l.ac(L,Math.floor((y.minX+y.maxX)/2*k),Math.floor((y.minY+y.maxY)/2*k))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((d=>this.tileID.getTilePoint(d)._round())),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.texture||(this.texture=new l.T(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let c=!1;for(const d in this.tiles){const y=this.tiles[d];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return l._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:a,minY:c,maxX:d,maxY:y}=l.aa.fromPoints(t),x={};for(let C=0;C<=l.ab;C++){const z=Math.pow(2,C),L=Math.floor(a*z),k=Math.floor(c*z),V=Math.floor(d*z),j=Math.floor(y*z),$=(L%z+z)%z,W=V%z,ae=Math.floor(L/z),se=Math.floor(V/z);x[C]={minWrap:ae,maxWrap:se,minTileXWrapped:$,maxTileXWrapped:W,minTileY:k,maxTileY:j}}return x}}class xa extends Dr{constructor(t,a,c,d){super(t,a,c,d),this.roundZoom=!0,this.type="video",this.options=a}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield l.ad(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new l.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new l.k(new l.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new l.T(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let c=!1;for(const d in this.tiles){const y=this.tiles[d];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class xi extends Dr{constructor(t,a,c,d){super(t,a,c,d),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((y=>!Array.isArray(y)||y.length!==2||y.some((x=>typeof x!="number"))))||this.fire(new l.k(new l.ae(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.k(new l.ae(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new l.k(new l.ae(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new l.k(new l.ae(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.k(new l.ae(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,c=a.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new l.T(a,this.canvas,c.RGBA,{premultiply:!0}),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let d=!1;for(const y in this.tiles){const x=this.tiles[y];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,d=!0)}d&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const qa={},fs=g=>{switch(g){case"geojson":return Hi;case"image":return Dr;case"raster":return va;case"raster-dem":return zr;case"vector":return ea;case"video":return xa;case"canvas":return xi}return qa[g]},De="RTLPluginLoaded";class H extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Fn()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return l._(this,arguments,void 0,(function*(a,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ce.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return l._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.l(De))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Y=null;function K(){return Y||(Y=new H),Y}var me,be;(function(g){g[g.Base=0]="Base",g[g.Parent=1]="Parent"})(me||(me={})),(function(g){g[g.Departing=0]="Departing",g[g.Incoming=1]="Incoming"})(be||(be={}));class Ie{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=l.af(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:a,fadingParentID:c,fadeEndTime:d}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=a,this.fadingParentID=c,this.fadeEndTime=d}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=xe(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData,this.latestFeatureIndex.encoding=t.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(d,y){const x={};if(!y)return x;for(const C of d){const z=C.layerIds.map((L=>y.getLayer(L))).filter(Boolean);if(z.length!==0){C.layers=z,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map((L=>z.filter((k=>k.id===L))[0])));for(const L of z)x[L.id]=C}}return x})(t.buckets,a?.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const y=this.buckets[d];if(y instanceof l.ah){if(this.hasSymbolBuckets=!0,!c)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const y=this.buckets[d];if(y instanceof l.ah&&y.hasRTLText){this.hasRTLText=!0,K().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const y=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(y))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new l.ag}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new l.T(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new l.T(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,c,d,y,x,C,z,L,k,V){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:y,scale:x,tileSize:this.tileSize,pixelPosMatrix:k,transform:z,params:C,queryPadding:this.queryPadding*L,getElevation:V},t,a,c):{}}querySourceFeatures(t,a){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),y=a&&a.sourceLayer?a.sourceLayer:"",x=d[l.ai]||d[y];if(!x)return;const C=l.aj(a?.filter,a?.globalState),{z,x:L,y:k}=this.tileID.canonical,V={z,x:L,y:k};for(let j=0;j<x.length;j++){const $=x.feature(j);if(C.needGeometry){const se=l.ak($,!0);if(!C.filter(new l.H(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!C.filter(new l.H(this.tileID.overscaledZ),$))continue;const W=c.getId($,y),ae=new l.al($,z,L,k,W);ae.tile=V,t.push(ae)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const c=l.am(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const y=this.expirationTime-a;y?this.expirationTime=c+Math.max(y,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const y=this.buckets[d],x=y.layers[0].sourceLayer||l.ai,C=c[x],z=t[x];if(!C||!z||Object.keys(z).length===0)continue;y.update(z,C,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const L=a&&a.style&&a.style.getLayer(d);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(y)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<xe()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=xe()+t}setDependencies(t,a){const c={};for(const d of a)c[d]=!0;this.dependencies[t]=c}hasDependency(t,a){for(const c of t){const d=this.dependencies[c];if(d){for(const y of a)if(d[y])return!0}}return!1}}class Be{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,c){const d=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},l.e(this.stateChanges[t][d],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const y in this.state[t])y!==d&&(this.deletedStates[t][y]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const y in this.state[t][d])c[y]||(this.deletedStates[t][d][y]=null)}else for(const y in c)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][y]===null&&delete this.deletedStates[t][d][y]}removeFeatureState(t,a,c){if(this.deletedStates[t]===null)return;const d=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&a!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][c]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(c in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][c]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,a){const c=String(a),d=l.e({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const y=this.deletedStates[t][a];if(y===null)return{};for(const x in y)delete d[x]}return d}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const y={};for(const x in this.stateChanges[d])this.state[d][x]||(this.state[d][x]={}),l.e(this.state[d][x],this.stateChanges[d][x]),y[x]=this.state[d][x];c[d]=y}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const y={};if(this.deletedStates[d]===null)for(const x in this.state[d])y[x]={},this.state[d][x]={};else for(const x in this.deletedStates[d]){if(this.deletedStates[d][x]===null)this.state[d][x]={};else for(const C of Object.keys(this.deletedStates[d][x]))delete this.state[d][x][C];y[x]=this.state[d][x]}c[d]=c[d]||{},l.e(c[d],y)}this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0&&t.setFeatureState(c,a)}}const Re=89.25;function ke(g,t){const a=l.an(t.lat,-l.ao,l.ao);return new l.P(l.Y(t.lng)*g,l.X(a)*g)}function lt(g,t){return new l.a9(t.x/g,t.y/g).toLngLat()}function Ke(g){return g.cameraToCenterDistance*Math.min(.85*Math.tan(l.ap(90-g.pitch)),Math.tan(l.ap(Re-g.pitch)))}function ht(g,t){const a=g.canonical,c=t/l.aq(a.z),d=a.x+Math.pow(2,a.z)*g.wrap,y=l.ar(new Float64Array(16));return l.O(y,y,[d*c,a.y*c,0]),l.Q(y,y,[c/l.a5,c/l.a5,1]),y}function Me(g,t,a,c,d){const y=l.a9.fromLngLat(g,t),x=d*l.as(1,g.lat),{x:C,y:z,z:L}=Wt(a,c);return new l.a9(y.x+x*-C,y.y+x*-z,y.z+x*-L)}function Wt(g,t){const a=l.ap(g),c=l.ap(t),d=Math.cos(-a),y=Math.sin(a);return{x:y*Math.sin(c),y:-y*Math.cos(c),z:d}}function Rn(g,t,a){const c=t.intersectsFrustum(g);if(!a||c===0)return c;const d=t.intersectsPlane(a);return d===0?0:c===2&&d===2?2:1}function kt(g,t,a){let c=0;const d=(a-t)/10;for(let y=0;y<10;y++)c+=d*Math.pow(Math.cos(t+(y+.5)/10*(a-t)),g);return c}function jt(g,t){return function(a,c,d,y,x){const C=2*((g-1)/l.at(Math.cos(l.ap(Re-x))/Math.cos(l.ap(Re)))-1),z=Math.acos(d/y),L=2*kt(C-1,0,l.ap(x/2)),k=Math.min(l.ap(Re),z+l.ap(x/2)),V=kt(C-1,Math.min(k,z-l.ap(x/2)),k),j=Math.atan(c/d),$=Math.hypot(c,d);let W=a;return W+=l.at(y/$/Math.max(.5,Math.cos(l.ap(x/2)))),W+=C*l.at(Math.cos(j))/2,W-=l.at(Math.max(1,V/L/t))/2,W}}const an=jt(9.314,3);function ei(g,t){const a=(t.roundZoom?Math.round:Math.floor)(g.zoom+l.at(g.tileSize/t.tileSize));return Math.max(0,a)}function ti(g,t){const a=g.getCameraFrustum(),c=g.getClippingPlane(),d=g.screenPointToMercatorCoordinate(g.getCameraPoint()),y=l.a9.fromLngLat(g.center,g.elevation);d.z=y.z+Math.cos(g.pitchInRadians)*g.cameraToCenterDistance/g.worldSize;const x=g.getCoveringTilesDetailsProvider(),C=x.allowVariableZoom(g,t),z=ei(g,t),L=t.minzoom||0,k=t.maxzoom!==void 0?t.maxzoom:g.maxZoom,V=Math.min(Math.max(0,z),k),j=Math.pow(2,V),$=[j*d.x,j*d.y,0],W=[j*y.x,j*y.y,0],ae=Math.hypot(y.x-d.x,y.y-d.y),se=Math.abs(y.z-d.z),oe=Math.hypot(ae,se),fe=_e=>({zoom:0,x:0,y:0,wrap:_e,fullyVisible:!1}),ye=[],he=[];if(g.renderWorldCopies&&x.allowWorldCopies())for(let _e=1;_e<=3;_e++)ye.push(fe(-_e)),ye.push(fe(_e));for(ye.push(fe(0));ye.length>0;){const _e=ye.pop(),we=_e.x,ge=_e.y;let Ae=_e.fullyVisible;const Ge={x:we,y:ge,z:_e.zoom},Fe=x.getTileBoundingVolume(Ge,_e.wrap,g.elevation,t);if(!Ae){const xt=Rn(a,Fe,c);if(xt===0)continue;Ae=xt===2}const je=x.distanceToTile2d(d.x,d.y,Ge,Fe);let Ve=z;C&&(Ve=(t.calculateTileZoom||an)(g.zoom+l.at(g.tileSize/t.tileSize),je,se,oe,g.fov)),Ve=(t.roundZoom?Math.round:Math.floor)(Ve),Ve=Math.max(0,Ve);const vt=Math.min(Ve,k);if(_e.wrap=x.getWrap(y,Ge,_e.wrap),_e.zoom>=vt){if(_e.zoom<L)continue;const xt=V-_e.zoom,ct=$[0]-.5-(we<<xt),St=$[1]-.5-(ge<<xt),en=t.reparseOverscaled?Math.max(_e.zoom,Ve):_e.zoom;he.push({tileID:new l.a2(_e.zoom===k?en:_e.zoom,_e.wrap,_e.zoom,we,ge),distanceSq:l.au([W[0]-.5-we,W[1]-.5-ge]),tileDistanceToCamera:Math.sqrt(ct*ct+St*St)})}else for(let xt=0;xt<4;xt++)ye.push({zoom:_e.zoom+1,x:(we<<1)+xt%2,y:(ge<<1)+(xt>>1),wrap:_e.wrap,fullyVisible:Ae})}return he.sort(((_e,we)=>_e.distanceSq-we.distanceSq)).map((_e=>_e.tileID))}const Xi=l.aa.fromPoints([new l.P(0,0),new l.P(l.a5,l.a5)]);function Yi(g){return g==="raster"||g==="image"||g==="video"}function pi(g,t,a,c,d,y,x){if(!t.hasData())return!1;const{tileID:C,fadingRole:z,fadingDirection:L,fadingParentID:k}=t;if(z===me.Base&&L===be.Incoming&&k)return a[k.key]=k,!0;const V=Math.max(C.overscaledZ-d,y);for(let j=C.overscaledZ-1;j>=V;j--){const $=C.scaledTo(j),W=g.getLoadedTile($);if(W)return t.setCrossFadeLogic({fadingRole:me.Base,fadingDirection:be.Incoming,fadingParentID:W.tileID,fadeEndTime:c+x}),W.setCrossFadeLogic({fadingRole:me.Parent,fadingDirection:be.Departing,fadeEndTime:c+x}),a[$.key]=$,!0}return!1}function Fi(g,t,a,c,d,y){if(!t.hasData())return!1;const x=t.tileID.children(d);let C=ot(g,t,x,a,c,d,y);if(C)return!0;for(const z of x)ot(g,t,z.children(d),a,c,d,y)&&(C=!0);return C}function ot(g,t,a,c,d,y,x){if(a[0].overscaledZ>=y)return!1;let C=!1;for(const z of a){const L=g.getLoadedTile(z);if(!L)continue;const{fadingRole:k,fadingDirection:V,fadingParentID:j}=L;k===me.Base&&V===be.Departing&&j||(L.setCrossFadeLogic({fadingRole:me.Base,fadingDirection:be.Departing,fadingParentID:t.tileID,fadeEndTime:d+x}),t.setCrossFadeLogic({fadingRole:me.Parent,fadingDirection:be.Incoming,fadeEndTime:d+x})),c[z.key]=z,C=!0}return C}function Pi(g,t,a,c){const d=g.tileID;return!!g.selfFading||!g.hasData()&&!!t.has(d)&&(g.setSelfFadeLogic(a+c),!0)}function Pr(g,t){var a;g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let c=t.tileID.canonical.x-g.tileID.canonical.x;const d=t.tileID.canonical.y-g.tileID.canonical.y,y=Math.pow(2,g.tileID.canonical.z),x=t.tileID.key;c===0&&d===0||Math.abs(d)>1||(Math.abs(c)>1&&(Math.abs(c+y)===1?c+=y:Math.abs(c-y)===1&&(c-=y)),t.dem&&g.dem&&(g.dem.backfillBorder(t.dem,c,d),!((a=g.neighboringTiles)===null||a===void 0)&&a[x]&&(g.neighboringTiles[x].backfilled=!0)))}class jr{constructor(){this._tiles={}}handleWrapJump(t){const a={};for(const c in this._tiles){const d=this._tiles[c];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+t),a[d.tileID.key]=d}this._tiles=a}setFeatureState(t,a){for(const c in this._tiles)this._tiles[c].setFeatureState(t,a)}getAllTiles(){return Object.values(this._tiles)}getAllIds(t=!1){return t?Object.values(this._tiles).map((a=>a.tileID)).sort(l.aw).map((a=>a.key)):Object.keys(this._tiles)}getTileById(t){return this._tiles[t]}setTile(t,a){this._tiles[t]=a}deleteTileById(t){delete this._tiles[t]}getLoadedTile(t){const a=this.getTileById(t.key);return a?.hasData()?a:null}isIdRenderable(t,a=!1){var c;return(c=this.getTileById(t))===null||c===void 0?void 0:c.isRenderable(a)}getRenderableIds(t=0,a){const c=[];for(const d of this.getAllIds())this.isIdRenderable(d,a)&&c.push(this.getTileById(d));return a?c.sort(((d,y)=>{const x=d.tileID,C=y.tileID,z=new l.P(x.canonical.x,x.canonical.y)._rotate(-t),L=new l.P(C.canonical.x,C.canonical.y)._rotate(-t);return x.overscaledZ-C.overscaledZ||L.y-z.y||L.x-z.x})).map((d=>d.tileID.key)):c.map((d=>d.tileID)).sort(l.aw).map((d=>d.key))}}class vn extends l.E{constructor(t,a,c){super(),this.id=t,this.dispatcher=c,this.on("data",(d=>this._dataHandler(d))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((d,y,x,C)=>{const z=new(fs(y.type))(d,y,x,C);if(z.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${z.id}`);return z})(t,a,c,this),this._inViewTiles=new jr,this._outOfViewCache=new l.ax(0,(d=>this._unloadTile(d))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Be,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){for(const a of this._inViewTiles.getAllTiles())a.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t),this._inViewTiles=new jr}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,c){return l._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,c)}catch(d){t.state="errored",d.status!==404?this._source.fire(new l.k(d,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new l.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const a of this._inViewTiles.getAllTiles())a.upload(t),a.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(t){var a;return this._inViewTiles.getRenderableIds((a=this.transform)===null||a===void 0?void 0:a.bearingInRadians,t)}hasRenderableParent(t){const a=t.overscaledZ-1;if(a>=this._source.minzoom){const c=this.getLoadedTile(t.scaledTo(a));if(c)return this._inViewTiles.isIdRenderable(c.tileID.key)}return!1}reload(t,a=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const c of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(c);a&&!this._source.shouldReloadTile(d,a)||(t?this._reloadTile(c,"expired"):d.state!=="errored"&&this._reloadTile(c,"reloading"))}}}_reloadTile(t,a){return l._(this,void 0,void 0,(function*(){const c=this._inViewTiles.getTileById(t);c&&(c.state!=="loading"&&(c.state=a),yield this._loadTile(c,t,a))}))}_tileLoaded(t,a,c){t.timeAdded=xe(),t.selfFading&&(t.fadeEndTime=t.timeAdded+this._rasterFadeDuration),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&(function(d,y){var x,C;const z=y.getRenderableIds();for(const L of z){if(!d.neighboringTiles||!d.neighboringTiles[L])continue;const k=y.getTileById(L);d.neighboringTiles[L].backfilled||Pr(d,k),!((C=(x=k.neighboringTiles)===null||x===void 0?void 0:x[d.tileID.key])===null||C===void 0)&&C.backfilled||Pr(k,d)}})(t,this._inViewTiles),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.l("data",{dataType:"source",tile:t,coord:t.tileID}))}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._inViewTiles.getTileById(t)}_retainLoadedChildren(t,a){const c=this._getLoadedDescendents(a),d=new Set;for(const y of a){const x=c[y.key];if(!x?.length){d.add(y);continue}const C=y.overscaledZ+vn.maxOverzooming,z=x.filter((V=>V.tileID.overscaledZ<=C));if(!z.length){d.add(y);continue}const L=Math.min(...z.map((V=>V.tileID.overscaledZ))),k=z.filter((V=>V.tileID.overscaledZ===L)).map((V=>V.tileID));for(const V of k)t[V.key]=V;this._areDescendentsComplete(k,L,y.overscaledZ)||d.add(y)}return d}_getLoadedDescendents(t){var a;const c={};for(const d of this._inViewTiles.getAllTiles().filter((y=>y.hasData())))for(const y of t)d.tileID.isChildOf(y)&&(c[a=y.key]||(c[a]=[])).push(d);return c}_areDescendentsComplete(t,a,c){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===a:Math.pow(4,a-c)===t.length}getLoadedTile(t){return this._inViewTiles.getLoadedTile(t)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(a*c*(this._maxTileCacheZoomLevels===null?l.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._outOfViewCache.setMaxSize(y)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);this._prevLng=t,a&&(this._inViewTiles.handleWrapJump(a),this._resetTileReloadTimers())}update(t,a){if(!this._sourceLoaded||this._paused)return;let c;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((z=>new l.a2(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y))):(c=ti(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?t.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter((z=>this._source.hasTile(z))))):c=[],this.usedForTerrain&&(c=this._addTerrainIdealTiles(c));const d=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,d&&this.fire(new l.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const y=ei(t,this._source),x=this._updateRetainedTiles(c,y),C=Yi(this._source.type);C&&this._rasterFadeDuration>0&&!a&&(function(z,L,k,V,j,$,W){const ae=xe(),se=l.av(L);for(const oe of L){const fe=z.getTileById(oe.key);fe.fadingDirection!==be.Departing&&fe.fadeOpacity!==0||fe.resetFadeLogic(),pi(z,fe,k,ae,V,j,W)||Fi(z,fe,k,ae,$,W)||Pi(fe,se,ae,W)||fe.resetFadeLogic()}})(this._inViewTiles,c,x,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),C?this._cleanUpRasterTiles(x):this._cleanUpVectorTiles(x)}_cleanUpRasterTiles(t){for(const a of this._inViewTiles.getAllIds())t[a]||this._removeTile(a)}_cleanUpVectorTiles(t){for(const a of this._inViewTiles.getAllIds()){const c=this._inViewTiles.getTileById(a);t[a]?c.clearSymbolFadeHold():c.hasSymbolBuckets?c.holdingForSymbolFade()?c.symbolFadeFinished()&&this._removeTile(a):c.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(a)}}_addTerrainIdealTiles(t){const a=[];for(const c of t)if(c.canonical.z>this._source.minzoom){const d=c.scaledTo(c.canonical.z-1);a.push(d);const y=c.scaledTo(Math.max(this._source.minzoom,Math.min(c.canonical.z,5)));a.push(y)}return t.concat(a)}releaseSymbolFadeTiles(){for(const t of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(t).holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var c;const d=new Set;for(const L of t)this._addTile(L).hasData()||d.add(L);const y=t.reduce(((L,k)=>(L[k.key]=k,L)),{}),x=this._retainLoadedChildren(y,d),C={},z=Math.max(a-vn.maxUnderzooming,this._source.minzoom);for(const L of x){let k=this._inViewTiles.getTileById(L.key),V=k?.wasRequested();for(let j=L.overscaledZ-1;j>=z;--j){const $=L.scaledTo(j);if(C[$.key])break;if(C[$.key]=!0,k=this.getTile($),!k&&V&&(k=this._addTile($)),k){const W=k.hasData();if((W||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||V)&&(y[$.key]=$),V=k.wasRequested(),W)break}}}return y}_addTile(t){let a=this._inViewTiles.getTileById(t.key);if(a)return a;a=this._outOfViewCache.getAndRemove(t),a&&(a.resetFadeLogic(),this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null));const c=a;return a||(a=new Ie(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._inViewTiles.setTile(t.key,a),c||this._source.fire(new l.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){this._clearTileReloadTimer(t);const c=a.getExpiryTimeout();c&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),c))}_clearTileReloadTimer(t){const a=this._timers[t];a&&(clearTimeout(a),delete this._timers[t])}_resetTileReloadTimers(){for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t of this._inViewTiles.getAllIds()){const a=this._inViewTiles.getTileById(t);this._setTileReloadTimer(t,a)}}refreshTiles(t){for(const a of this._inViewTiles.getAllIds()){const c=this._inViewTiles.getTileById(a);(this._inViewTiles.isIdRenderable(a)||c.state=="errored")&&t.some((d=>d.equals(c.tileID.canonical)))&&this._reloadTile(a,"expired")}}_removeTile(t){const a=this._inViewTiles.getTileById(t);a&&(a.uses--,this._inViewTiles.deleteTileById(t),this._clearTileReloadTimer(t),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._outOfViewCache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged,t.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t of this._inViewTiles.getAllIds())this._removeTile(t);this._outOfViewCache.reset()}tilesIn(t,a,c){const d=[],y=this.transform;if(!y)return d;const x=y.getCoveringTilesDetailsProvider().allowWorldCopies(),C=c?y.getCameraQueryGeometry(t):t,z=$=>y.screenPointToMercatorCoordinate($,this.terrain),L=this.transformBbox(t,z,!x),k=this.transformBbox(C,z,!x),V=this.getIds(),j=l.aa.fromPoints(k);for(let $=0;$<V.length;$++){const W=this._inViewTiles.getTileById(V[$]);if(W.holdingForSymbolFade())continue;const ae=x?[W.tileID]:[W.tileID.unwrapTo(-1),W.tileID.unwrapTo(0)],se=Math.pow(2,y.zoom-W.tileID.overscaledZ),oe=a*W.queryPadding*l.a5/W.tileSize/se;for(const fe of ae){const ye=j.map((he=>fe.getTilePoint(new l.a9(he.x,he.y))));if(ye.expandBy(oe),ye.intersects(Xi)){const he=L.map((we=>fe.getTilePoint(we))),_e=k.map((we=>fe.getTilePoint(we)));d.push({tile:W,tileID:x?fe:fe.unwrapTo(0),queryGeometry:he,cameraQueryGeometry:_e,scale:se})}}}return d}transformBbox(t,a,c){let d=t.map(a);if(c){const y=l.aa.fromPoints(t);y.shrinkBy(.001*Math.min(y.width(),y.height()));const x=y.map(a);l.aa.fromPoints(d).covers(x)||(d=d.map((C=>C.x>.5?new l.a9(C.x-1,C.y,C.z):C)))}return d}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map((c=>this._inViewTiles.getTileById(c).tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){return!!this._source.hasTransition()||!(!Yi(this._source.type)||!(function(t,a){if(a<=0)return!1;const c=xe();for(const d of t.getAllTiles())if(d.fadeEndTime>=c)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,a,c){this._state.updateState(t=t||l.ai,a,c)}removeFeatureState(t,a,c){this._state.removeFeatureState(t=t||l.ai,a,c)}getFeatureState(t,a){return this._state.getState(t=t||l.ai,a)}setDependencies(t,a,c){const d=this._inViewTiles.getTileById(t);d&&d.setDependencies(a,c)}reloadTilesForDependencies(t,a){for(const c of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(c).hasDependency(t,a)&&this._reloadTile(c,"reloading");this._outOfViewCache.filter((c=>!c.hasDependency(t,a)))}areTilesLoaded(){for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}}vn.maxUnderzooming=10,vn.maxOverzooming=3;class gt{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.an(t,0,1);let a=1,c=this._distances[a];const d=t*this.paddedLength+this.padding;for(;c<d&&a<this._distances.length;)c=this._distances[++a];const y=a-1,x=this._distances[y],C=c-x,z=C>0?(d-x)/C:0;return this.points[y].mult(1-z).add(this.points[a].mult(z))}}function Qt(g,t){let a=!0;return g==="always"||g!=="never"&&t!=="never"||(a=!1),a}class cn{constructor(t,a,c){const d=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(a/c);for(let x=0;x<this.xCellCount*this.yCellCount;x++)d.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,c,d,y){this._forEachCell(a,c,d,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(y)}insertCircle(t,a,c,d){this._forEachCell(a-d,c-d,a+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(c),this.circles.push(d)}_insertBoxCell(t,a,c,d,y,x){this.boxCells[y].push(x)}_insertCircleCell(t,a,c,d,y,x){this.circleCells[y].push(x)}_query(t,a,c,d,y,x,C){if(c<0||t>this.width||d<0||a>this.height)return[];const z=[];if(t<=0&&a<=0&&this.width<=c&&this.height<=d){if(y)return[{key:null,x1:t,y1:a,x2:c,y2:d}];for(let L=0;L<this.boxKeys.length;L++)z.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const k=this.circles[3*L],V=this.circles[3*L+1],j=this.circles[3*L+2];z.push({key:this.circleKeys[L],x1:k-j,y1:V-j,x2:k+j,y2:V+j})}}else this._forEachCell(t,a,c,d,this._queryCell,z,{hitTest:y,overlapMode:x,seenUids:{box:{},circle:{}}},C);return z}query(t,a,c,d){return this._query(t,a,c,d,!1,null)}hitTest(t,a,c,d,y,x){return this._query(t,a,c,d,!0,y,x).length>0}hitTestCircle(t,a,c,d,y){const x=t-c,C=t+c,z=a-c,L=a+c;if(C<0||x>this.width||L<0||z>this.height)return!1;const k=[];return this._forEachCell(x,z,C,L,this._queryCellCircle,k,{hitTest:!0,overlapMode:d,circle:{x:t,y:a,radius:c},seenUids:{box:{},circle:{}}},y),k.length>0}_queryCell(t,a,c,d,y,x,C,z){const{seenUids:L,hitTest:k,overlapMode:V}=C,j=this.boxCells[y];if(j!==null){const W=this.bboxes;for(const ae of j)if(!L.box[ae]){L.box[ae]=!0;const se=4*ae,oe=this.boxKeys[ae];if(t<=W[se+2]&&a<=W[se+3]&&c>=W[se+0]&&d>=W[se+1]&&(!z||z(oe))&&(!k||!Qt(V,oe.overlapMode))&&(x.push({key:oe,x1:W[se],y1:W[se+1],x2:W[se+2],y2:W[se+3]}),k))return!0}}const $=this.circleCells[y];if($!==null){const W=this.circles;for(const ae of $)if(!L.circle[ae]){L.circle[ae]=!0;const se=3*ae,oe=this.circleKeys[ae];if(this._circleAndRectCollide(W[se],W[se+1],W[se+2],t,a,c,d)&&(!z||z(oe))&&(!k||!Qt(V,oe.overlapMode))){const fe=W[se],ye=W[se+1],he=W[se+2];if(x.push({key:oe,x1:fe-he,y1:ye-he,x2:fe+he,y2:ye+he}),k)return!0}}}return!1}_queryCellCircle(t,a,c,d,y,x,C,z){const{circle:L,seenUids:k,overlapMode:V}=C,j=this.boxCells[y];if(j!==null){const W=this.bboxes;for(const ae of j)if(!k.box[ae]){k.box[ae]=!0;const se=4*ae,oe=this.boxKeys[ae];if(this._circleAndRectCollide(L.x,L.y,L.radius,W[se+0],W[se+1],W[se+2],W[se+3])&&(!z||z(oe))&&!Qt(V,oe.overlapMode))return x.push(!0),!0}}const $=this.circleCells[y];if($!==null){const W=this.circles;for(const ae of $)if(!k.circle[ae]){k.circle[ae]=!0;const se=3*ae,oe=this.circleKeys[ae];if(this._circlesCollide(W[se],W[se+1],W[se+2],L.x,L.y,L.radius)&&(!z||z(oe))&&!Qt(V,oe.overlapMode))return x.push(!0),!0}}}_forEachCell(t,a,c,d,y,x,C,z){const L=this._convertToXCellCoord(t),k=this._convertToYCellCoord(a),V=this._convertToXCellCoord(c),j=this._convertToYCellCoord(d);for(let $=L;$<=V;$++)for(let W=k;W<=j;W++)if(y.call(this,t,a,c,d,this.xCellCount*W+$,x,C,z))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,c,d,y,x){const C=d-t,z=y-a,L=c+x;return L*L>C*C+z*z}_circleAndRectCollide(t,a,c,d,y,x,C){const z=(x-d)/2,L=Math.abs(t-(d+z));if(L>z+c)return!1;const k=(C-y)/2,V=Math.abs(a-(y+k));if(V>k+c)return!1;if(L<=z||V<=k)return!0;const j=L-z,$=V-k;return j*j+$*$<=c*c}}function ta(g,t,a){const c=l.N();if(!g){const{vecSouth:V,vecEast:j}=uo(t),$=X();$[0]=j[0],$[1]=j[1],$[2]=V[0],$[3]=V[1],d=$,(k=(x=(y=$)[0])*(L=y[3])-(z=y[2])*(C=y[1]))&&(d[0]=L*(k=1/k),d[1]=-C*k,d[2]=-z*k,d[3]=x*k),c[0]=$[0],c[1]=$[1],c[4]=$[2],c[5]=$[3]}var d,y,x,C,z,L,k;return l.Q(c,c,[1/a,1/a,1]),c}function Vu(g,t,a,c){if(g){const d=l.N();if(!t){const{vecSouth:y,vecEast:x}=uo(a);d[0]=x[0],d[1]=x[1],d[4]=y[0],d[5]=y[1]}return l.Q(d,d,[c,c,1]),d}return a.pixelsToClipSpaceMatrix}function uo(g){const t=Math.cos(g.rollInRadians),a=Math.sin(g.rollInRadians),c=Math.cos(g.pitchInRadians),d=Math.cos(g.bearingInRadians),y=Math.sin(g.bearingInRadians),x=l.aC();x[0]=-d*c*a-y*t,x[1]=-y*c*a+d*t;const C=l.aD(x);C<1e-9?l.aE(x):l.aF(x,x,1/C);const z=l.aC();z[0]=d*c*t-y*a,z[1]=y*c*t+d*a;const L=l.aD(z);return L<1e-9?l.aE(z):l.aF(z,z,1/L),{vecEast:z,vecSouth:x}}function nn(g,t,a,c){let d;c?(d=[g,t,c(g,t),1],l.aH(d,d,a)):(d=[g,t,0,1],ba(d,d,a));const y=d[3];return{point:new l.P(d[0]/y,d[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function Hs(g,t){return .5+g/t*.5}function ho(g,t){return g.x>=-t[0]&&g.x<=t[0]&&g.y>=-t[1]&&g.y<=t[1]}function Vo(g,t,a,c,d,y,x,C,z,L,k,V,j){const $=a?g.textSizeData:g.iconSizeData,W=l.ay($,t.transform.zoom),ae=[256/t.width*2+1,256/t.height*2+1],se=a?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;se.clear();const oe=g.lineVertexArray,fe=a?g.text.placedSymbolArray:g.icon.placedSymbolArray,ye=t.transform.width/t.transform.height;let he=!1;for(let _e=0;_e<fe.length;_e++){const we=fe.get(_e);if(we.hidden||we.writingMode===l.az.vertical&&!he){mo(we.numGlyphs,se);continue}he=!1;const ge=new l.P(we.anchorX,we.anchorY),Ae={getElevation:j,pitchedLabelPlaneMatrix:c,lineVertexArray:oe,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:ge,unwrappedTileID:z,width:L,height:k,translation:V},Ge=ql(we.anchorX,we.anchorY,Ae);if(!ho(Ge.point,ae)){mo(we.numGlyphs,se);continue}const Fe=Hs(t.transform.cameraToCenterDistance,Ge.signedDistanceFromCamera),je=l.aA($,W,we),Ve=y?je*t.transform.getPitchedTextCorrection(we.anchorX,we.anchorY,z)/Fe:je*Fe,vt=bi({projectionContext:Ae,pitchedLabelPlaneMatrixInverse:d,symbol:we,fontSize:Ve,flip:!1,keepUpright:x,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:ye,rotateToLine:C});he=vt.useVertical,(vt.notEnoughRoom||he||vt.needsFlipping&&bi({projectionContext:Ae,pitchedLabelPlaneMatrixInverse:d,symbol:we,fontSize:Ve,flip:!0,keepUpright:x,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:ye,rotateToLine:C}).notEnoughRoom)&&mo(we.numGlyphs,se)}a?g.text.dynamicLayoutVertexBuffer.updateData(se):g.icon.dynamicLayoutVertexBuffer.updateData(se)}function fo(g,t,a,c,d,y,x,C){const z=y.glyphStartIndex+y.numGlyphs,L=y.lineStartIndex,k=y.lineStartIndex+y.lineLength,V=t.getoffsetX(y.glyphStartIndex),j=t.getoffsetX(z-1),$=$a(g*V,a,c,d,y.segment,L,k,C,x);if(!$)return null;const W=$a(g*j,a,c,d,y.segment,L,k,C,x);return W?C.projectionCache.anyProjectionOccluded?null:{first:$,last:W}:null}function po(g,t,a,c){return g===l.az.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*c?{useVertical:!0}:(g===l.az.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function bi(g){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:a,symbol:c,fontSize:d,flip:y,keepUpright:x,glyphOffsetArray:C,dynamicLayoutVertexArray:z,aspectRatio:L,rotateToLine:k}=g,V=d/24,j=c.lineOffsetX*V,$=c.lineOffsetY*V;let W;if(c.numGlyphs>1){const ae=c.glyphStartIndex+c.numGlyphs,se=c.lineStartIndex,oe=c.lineStartIndex+c.lineLength,fe=fo(V,C,j,$,y,c,k,t);if(!fe)return{notEnoughRoom:!0};const ye=Uo(fe.first.point.x,fe.first.point.y,t,a),he=Uo(fe.last.point.x,fe.last.point.y,t,a);if(x&&!y){const _e=po(c.writingMode,ye,he,L);if(_e)return _e}W=[fe.first];for(let _e=c.glyphStartIndex+1;_e<ae-1;_e++){const we=$a(V*C.getoffsetX(_e),j,$,y,c.segment,se,oe,t,k);if(!we)return{notEnoughRoom:!0};W.push(we)}W.push(fe.last)}else{if(x&&!y){const se=bn(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,oe=c.lineStartIndex+c.segment+1,fe=new l.P(t.lineVertexArray.getx(oe),t.lineVertexArray.gety(oe)),ye=bn(fe.x,fe.y,t),he=ye.signedDistanceFromCamera>0?ye.point:Gl(t.tileAnchorPoint,fe,se,1,t),_e=Uo(se.x,se.y,t,a),we=Uo(he.x,he.y,t,a),ge=po(c.writingMode,_e,we,L);if(ge)return ge}const ae=$a(V*C.getoffsetX(c.glyphStartIndex),j,$,y,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,t,k);if(!ae||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};W=[ae]}for(const ae of W)l.aG(z,ae.point,ae.angle);return{}}function Gl(g,t,a,c,d){const y=g.add(g.sub(t)._unit()),x=bn(y.x,y.y,d).point,C=a.sub(x);return a.add(C._mult(c/C.mag()))}function br(g,t,a){const c=t.projectionCache;if(c.projections[g])return c.projections[g];const d=new l.P(t.lineVertexArray.getx(g),t.lineVertexArray.gety(g)),y=bn(d.x,d.y,t);if(y.signedDistanceFromCamera>0)return c.projections[g]=y.point,c.anyProjectionOccluded=c.anyProjectionOccluded||y.isOccluded,y.point;const x=g-a.direction;return Gl(a.distanceFromAnchor===0?t.tileAnchorPoint:new l.P(t.lineVertexArray.getx(x),t.lineVertexArray.gety(x)),d,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function bn(g,t,a){const c=g+a.translation[0],d=t+a.translation[1];let y;return a.pitchWithMap?(y=nn(c,d,a.pitchedLabelPlaneMatrix,a.getElevation),y.isOccluded=!1):(y=a.transform.projectTileCoordinates(c,d,a.unwrappedTileID,a.getElevation),y.point.x=(.5*y.point.x+.5)*a.width,y.point.y=(.5*-y.point.y+.5)*a.height),y}function Uo(g,t,a,c){if(a.pitchWithMap){const d=[g,t,0,1];return l.aH(d,d,c),a.transform.projectTileCoordinates(d[0]/d[3],d[1]/d[3],a.unwrappedTileID,a.getElevation).point}return{x:g/a.width*2-1,y:1-t/a.height*2}}function ql(g,t,a){return a.transform.projectTileCoordinates(g,t,a.unwrappedTileID,a.getElevation)}function $l(g,t,a){return g._unit()._perp()._mult(t*a)}function ps(g,t,a,c,d,y,x,C,z){if(C.projectionCache.offsets[g])return C.projectionCache.offsets[g];const L=a.add(t);if(g+z.direction<c||g+z.direction>=d)return C.projectionCache.offsets[g]=L,L;const k=br(g+z.direction,C,z),V=$l(k.sub(a),x,z.direction),j=a.add(V),$=k.add(V);return C.projectionCache.offsets[g]=l.aI(y,L,j,$)||L,C.projectionCache.offsets[g]}function $a(g,t,a,c,d,y,x,C,z){const L=c?g-t:g+t;let k=L>0?1:-1,V=0;c&&(k*=-1,V=Math.PI),k<0&&(V+=Math.PI);let j,$=k>0?y+d:y+d+1;C.projectionCache.cachedAnchorPoint?j=C.projectionCache.cachedAnchorPoint:(j=bn(C.tileAnchorPoint.x,C.tileAnchorPoint.y,C).point,C.projectionCache.cachedAnchorPoint=j);let W,ae,se=j,oe=j,fe=0,ye=0;const he=Math.abs(L),_e=[];let we;for(;fe+ye<=he;){if($+=k,$<y||$>=x)return null;fe+=ye,oe=se,ae=W;const Ge={absOffsetX:he,direction:k,distanceFromAnchor:fe,previousVertex:oe};if(se=br($,C,Ge),a===0)_e.push(oe),we=se.sub(oe);else{let Fe;const je=se.sub(oe);Fe=je.mag()===0?$l(br($+k,C,Ge).sub(se),a,k):$l(je,a,k),ae||(ae=oe.add(Fe)),W=ps($,Fe,se,y,x,ae,a,C,Ge),_e.push(ae),we=W.sub(ae)}ye=we.mag()}const ge=we._mult((he-fe)/ye)._add(ae||oe),Ae=V+Math.atan2(se.y-oe.y,se.x-oe.x);return _e.push(ge),{point:ge,angle:z?Ae:0,path:_e}}const Nc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function mo(g,t){for(let a=0;a<g;a++){const c=t.length;t.resize(c+4),t.float32.set(Nc,3*c)}}function ba(g,t,a){const c=t[0],d=t[1];return g[0]=a[0]*c+a[4]*d+a[12],g[1]=a[1]*c+a[5]*d+a[13],g[3]=a[3]*c+a[7]*d+a[15],g}const Mn=100;class Hh{constructor(t,a=new cn(t.width+200,t.height+200,25),c=new cn(t.width+200,t.height+200,25)){this.transform=t,this.grid=a,this.ignoredGrid=c,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Mn,this.screenBottomBoundary=t.height+Mn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,c,d,y,x,C,z,L,k,V,j){const $=this.projectAndGetPerspectiveRatio(t.anchorPointX+z[0],t.anchorPointY+z[1],y,k,j),W=c*$.perspectiveRatio;let ae;if(x||C)ae=this._projectCollisionBox(t,W,d,y,x,C,z,$,k,V,j);else{const we=$.x+(V?V.x*W:0),ge=$.y+(V?V.y*W:0);ae={allPointsOccluded:!1,box:[we+t.x1*W,ge+t.y1*W,we+t.x2*W,ge+t.y2*W]}}const[se,oe,fe,ye]=ae.box,he=x?ae.allPointsOccluded:$.isOccluded;let _e=he;return _e||(_e=$.perspectiveRatio<this.perspectiveRatioCutoff),_e||(_e=!this.isInsideGrid(se,oe,fe,ye)),_e||a!=="always"&&this.grid.hitTest(se,oe,fe,ye,a,L)?{box:[se,oe,fe,ye],placeable:!1,offscreen:!1,occluded:he}:{box:[se,oe,fe,ye],placeable:!0,offscreen:this.isOffscreen(se,oe,fe,ye),occluded:he}}placeCollisionCircles(t,a,c,d,y,x,C,z,L,k,V,j,$,W){const ae=[],se=new l.P(a.anchorX,a.anchorY),oe=this.getPerspectiveRatio(se.x,se.y,x,W),fe=(L?y*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,x)/oe:y*oe)/l.aM,ye={getElevation:W,pitchedLabelPlaneMatrix:C,lineVertexArray:c,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:se,unwrappedTileID:x,width:this.transform.width,height:this.transform.height,translation:$},he=fo(fe,d,a.lineOffsetX*fe,a.lineOffsetY*fe,!1,a,!1,ye);let _e=!1,we=!1,ge=!0;if(he){const Ae=.5*V*oe+j,Ge=new l.P(-100,-100),Fe=new l.P(this.screenRightBoundary,this.screenBottomBoundary),je=new gt,Ve=he.first,vt=he.last;let xt=[];for(let en=Ve.path.length-1;en>=1;en--)xt.push(Ve.path[en]);for(let en=1;en<vt.path.length;en++)xt.push(vt.path[en]);const ct=2.5*Ae;if(L){const en=this.projectPathToScreenSpace(xt,ye);xt=en.some((Ln=>Ln.signedDistanceFromCamera<=0))?[]:en.map((Ln=>Ln.point))}let St=[];if(xt.length>0){const en=xt[0].clone(),Ln=xt[0].clone();for(let Jn=1;Jn<xt.length;Jn++)en.x=Math.min(en.x,xt[Jn].x),en.y=Math.min(en.y,xt[Jn].y),Ln.x=Math.max(Ln.x,xt[Jn].x),Ln.y=Math.max(Ln.y,xt[Jn].y);St=en.x>=Ge.x&&Ln.x<=Fe.x&&en.y>=Ge.y&&Ln.y<=Fe.y?[xt]:Ln.x<Ge.x||en.x>Fe.x||Ln.y<Ge.y||en.y>Fe.y?[]:l.aJ([xt],Ge.x,Ge.y,Fe.x,Fe.y)}for(const en of St){je.reset(en,.25*Ae);let Ln=0;Ln=je.length<=.5*Ae?1:Math.ceil(je.paddedLength/ct)+1;for(let Jn=0;Jn<Ln;Jn++){const Yn=Jn/Math.max(Ln-1,1),ai=je.lerp(Yn),Vn=ai.x+Mn,_i=ai.y+Mn;ae.push(Vn,_i,Ae,0);const oi=Vn-Ae,sr=_i-Ae,Ei=Vn+Ae,Ci=_i+Ae;if(ge=ge&&this.isOffscreen(oi,sr,Ei,Ci),we=we||this.isInsideGrid(oi,sr,Ei,Ci),t!=="always"&&this.grid.hitTestCircle(Vn,_i,Ae,t,k)&&(_e=!0,!z))return{circles:[],offscreen:!1,collisionDetected:_e}}}}return{circles:!z&&_e||!we||oe<this.perspectiveRatioCutoff?[]:ae,offscreen:ge,collisionDetected:_e}}projectPathToScreenSpace(t,a){const c=(function(d,y){const x=l.N();return l.aB(x,y.pitchedLabelPlaneMatrix),d.map((C=>{const z=nn(C.x,C.y,x,y.getElevation),L=y.transform.projectTileCoordinates(z.point.x,z.point.y,y.unwrappedTileID,y.getElevation);return L.point.x=(.5*L.point.x+.5)*y.width,L.point.y=(.5*-L.point.y+.5)*y.height,L}))})(t,a);return(function(d){let y=0,x=0,C=0,z=0;for(let L=0;L<d.length;L++)d[L].isOccluded?(C=L+1,z=0):(z++,z>x&&(x=z,y=C));return d.slice(y,y+x)})(c)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],c=new l.aa;for(const V of t){const j=new l.P(V.x+Mn,V.y+Mn);c.extend(j),a.push(j)}const{minX:d,minY:y,maxX:x,maxY:C}=c,z=this.grid.query(d,y,x,C).concat(this.ignoredGrid.query(d,y,x,C)),L={},k={};for(const V of z){const j=V.key;if(L[j.bucketInstanceId]===void 0&&(L[j.bucketInstanceId]={}),L[j.bucketInstanceId][j.featureIndex])continue;const $=[new l.P(V.x1,V.y1),new l.P(V.x2,V.y1),new l.P(V.x2,V.y2),new l.P(V.x1,V.y2)];l.aK(a,$)&&(L[j.bucketInstanceId][j.featureIndex]=!0,k[j.bucketInstanceId]===void 0&&(k[j.bucketInstanceId]=[]),k[j.bucketInstanceId].push(j.featureIndex))}return k}insertCollisionBox(t,a,c,d,y,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:y,collisionGroupID:x,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,c,d,y,x){const C=c?this.ignoredGrid:this.grid,z={bucketInstanceId:d,featureIndex:y,collisionGroupID:x,overlapMode:a};for(let L=0;L<t.length;L+=4)C.insertCircle(z,t[L],t[L+1],t[L+2])}projectAndGetPerspectiveRatio(t,a,c,d,y){if(y){let x;d?(x=[t,a,d(t,a),1],l.aH(x,x,y)):(x=[t,a,0,1],ba(x,x,y));const C=x[3];return{x:(x[0]/C+1)/2*this.transform.width+Mn,y:(-x[1]/C+1)/2*this.transform.height+Mn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/C*.5,isOccluded:!1,signedDistanceFromCamera:C}}{const x=this.transform.projectTileCoordinates(t,a,c,d);return{x:(x.point.x+1)/2*this.transform.width+Mn,y:(1-x.point.y)/2*this.transform.height+Mn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5,isOccluded:x.isOccluded,signedDistanceFromCamera:x.signedDistanceFromCamera}}}getPerspectiveRatio(t,a,c,d){const y=this.transform.projectTileCoordinates(t,a,c,d);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(t,a,c,d){return c<Mn||t>=this.screenRightBoundary||d<Mn||a>this.screenBottomBoundary}isInsideGrid(t,a,c,d){return c>=0&&t<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=l.ar([]);return l.O(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,c,d,y,x,C,z,L,k,V){let j=1,$=0,W=0,ae=1;const se=t.anchorPointX+C[0],oe=t.anchorPointY+C[1];if(x&&!y){const xt=this.projectAndGetPerspectiveRatio(se+1,oe,d,L,V),ct=xt.x-z.x,St=Math.atan((xt.y-z.y)/ct)+(ct<0?Math.PI:0),en=Math.sin(St),Ln=Math.cos(St);j=Ln,$=en,W=-en,ae=Ln}else if(!x&&y){const xt=uo(this.transform);j=xt.vecEast[0],$=xt.vecEast[1],W=xt.vecSouth[0],ae=xt.vecSouth[1]}let fe=z.x,ye=z.y,he=a;y&&(fe=se,ye=oe,he=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),he*=this.transform.getPitchedTextCorrection(se,oe,d),k||(he*=l.an(.5+z.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(fe+=j*k.x*he+W*k.y*he,ye+=$*k.x*he+ae*k.y*he);const _e=t.x1*he,we=t.x2*he,ge=(_e+we)/2,Ae=t.y1*he,Ge=t.y2*he,Fe=(Ae+Ge)/2,je=[{offsetX:_e,offsetY:Ae},{offsetX:ge,offsetY:Ae},{offsetX:we,offsetY:Ae},{offsetX:we,offsetY:Fe},{offsetX:we,offsetY:Ge},{offsetX:ge,offsetY:Ge},{offsetX:_e,offsetY:Ge},{offsetX:_e,offsetY:Fe}];let Ve=[];for(const{offsetX:xt,offsetY:ct}of je)Ve.push(new l.P(fe+j*xt+W*ct,ye+$*xt+ae*ct));let vt=!1;if(y){const xt=Ve.map((ct=>this.projectAndGetPerspectiveRatio(ct.x,ct.y,d,L,V)));vt=xt.some((ct=>!ct.isOccluded)),Ve=xt.map((ct=>new l.P(ct.x,ct.y)))}else vt=!0;return{box:l.aL(Ve),allPointsOccluded:!vt}}}class pf{constructor(t,a,c,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):d&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class Xs{constructor(t,a,c,d,y){this.text=new pf(t?t.text:null,a,c,y),this.icon=new pf(t?t.icon:null,a,d,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Xh{constructor(t,a,c){this.text=t,this.icon=a,this.skipFade=c}}class jc{constructor(t,a,c,d,y){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=y}}class mf{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:c=>c.collisionGroupID===a}}return this.collisionGroups[t]}}function Rr(g,t,a,c,d){const{horizontalAlign:y,verticalAlign:x}=l.aS(g);return new l.P(-(y-.5)*t+c[0]*d,-(x-.5)*a+c[1]*d)}class Vc{constructor(t,a,c,d,y){this.transform=t.clone(),this.terrain=a,this.collisionIndex=new Hh(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new mf(d),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(c,d)=>a.getElevation(t,c,d):null}getBucketParts(t,a,c,d){const y=c.getBucket(a),x=c.latestFeatureIndex;if(!y||!x||a.id!==y.layerIds[0])return;const C=c.collisionBoxArray,z=y.layers[0].layout,L=y.layers[0].paint,k=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),V=c.tileSize/l.a5,j=c.tileID.toUnwrapped(),$=z.get("text-rotation-alignment")==="map",W=l.aN(c,1,this.transform.zoom),ae=l.aO(this.collisionIndex.transform,c,L.get("text-translate"),L.get("text-translate-anchor")),se=l.aO(this.collisionIndex.transform,c,L.get("icon-translate"),L.get("icon-translate-anchor")),oe=ta($,this.transform,W);this.retainedQueryData[y.bucketInstanceId]=new jc(y.bucketInstanceId,x,y.sourceLayerIndex,y.index,c.tileID);const fe={bucket:y,layout:z,translationText:ae,translationIcon:se,unwrappedTileID:j,pitchedLabelPlaneMatrix:oe,scale:k,textPixelRatio:V,holdingForFade:c.holdingForSymbolFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:l.ay(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(d)for(const ye of y.sortKeyRanges){const{sortKey:he,symbolInstanceStart:_e,symbolInstanceEnd:we}=ye;t.push({sortKey:he,symbolInstanceStart:_e,symbolInstanceEnd:we,parameters:fe})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:fe})}attemptAnchorPlacement(t,a,c,d,y,x,C,z,L,k,V,j,$,W,ae,se,oe,fe,ye,he){const _e=l.aP[t.textAnchor],we=[t.textOffset0,t.textOffset1],ge=Rr(_e,c,d,we,y),Ae=this.collisionIndex.placeCollisionBox(a,j,z,L,k,C,x,se,V.predicate,ye,ge,he);if((!fe||this.collisionIndex.placeCollisionBox(fe,j,z,L,k,C,x,oe,V.predicate,ye,ge,he).placeable)&&Ae.placeable){let Ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:we,width:c,height:d,anchor:_e,textBoxScale:y,prevAnchor:Ge},this.markUsedJustification(W,_e,$,ae),W.allowVerticalPlacement&&(this.markUsedOrientation(W,ae,$),this.placedOrientations[$.crossTileID]=ae),{shift:ge,placedGlyphBoxes:Ae}}}placeLayerBucketPart(t,a,c){const{bucket:d,layout:y,translationText:x,translationIcon:C,unwrappedTileID:z,pitchedLabelPlaneMatrix:L,textPixelRatio:k,holdingForFade:V,collisionBoxArray:j,partiallyEvaluatedTextSize:$,collisionGroup:W}=t.parameters,ae=y.get("text-optional"),se=y.get("icon-optional"),oe=l.aQ(y,"text-overlap","text-allow-overlap"),fe=oe==="always",ye=l.aQ(y,"icon-overlap","icon-allow-overlap"),he=ye==="always",_e=y.get("text-rotation-alignment")==="map",we=y.get("text-pitch-alignment")==="map",ge=y.get("icon-text-fit")!=="none",Ae=y.get("symbol-z-order")==="viewport-y",Ge=fe&&(he||!d.hasIconData()||se),Fe=he&&(fe||!d.hasTextData()||ae);!d.collisionArrays&&j&&d.deserializeCollisionBoxes(j);const je=this.retainedQueryData[d.bucketInstanceId].tileID,Ve=this._getTerrainElevationFunc(je),vt=this.transform.getFastPathSimpleProjectionMatrix(je),xt=(ct,St,en)=>{var Ln,Jn;if(a[ct.crossTileID])return;if(V)return void(this.placements[ct.crossTileID]=new Xh(!1,!1,!1));let Yn=!1,ai=!1,Vn=!0,_i=null,oi={box:null,placeable:!1,offscreen:null,occluded:!1},sr={placeable:!1},Ei=null,Ci=null,lr=null,Lo=0,Oo=0,eo=0;St.textFeatureIndex?Lo=St.textFeatureIndex:ct.useRuntimeCollisionCircles&&(Lo=ct.featureIndex),St.verticalTextFeatureIndex&&(Oo=St.verticalTextFeatureIndex);const Zr=St.textBox;if(Zr){const Hr=kn=>{let Wn=l.az.horizontal;if(d.allowVerticalPlacement&&!kn&&this.prevPlacement){const Vi=this.prevPlacement.placedOrientations[ct.crossTileID];Vi&&(this.placedOrientations[ct.crossTileID]=Vi,Wn=Vi,this.markUsedOrientation(d,Wn,ct))}return Wn},da=(kn,Wn)=>{if(d.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&St.verticalTextBox){for(const Vi of d.writingModes)if(Vi===l.az.vertical?(oi=Wn(),sr=oi):oi=kn(),oi&&oi.placeable)break}else oi=kn()},Ra=ct.textAnchorOffsetStartIndex,Ia=ct.textAnchorOffsetEndIndex;if(Ia===Ra){const kn=(Wn,Vi)=>{const Ki=this.collisionIndex.placeCollisionBox(Wn,oe,k,je,z,we,_e,x,W.predicate,Ve,void 0,vt);return Ki&&Ki.placeable&&(this.markUsedOrientation(d,Vi,ct),this.placedOrientations[ct.crossTileID]=Vi),Ki};da((()=>kn(Zr,l.az.horizontal)),(()=>{const Wn=St.verticalTextBox;return d.allowVerticalPlacement&&ct.numVerticalGlyphVertices>0&&Wn?kn(Wn,l.az.vertical):{box:null,offscreen:null}})),Hr(oi&&oi.placeable)}else{let kn=l.aP[(Jn=(Ln=this.prevPlacement)===null||Ln===void 0?void 0:Ln.variableOffsets[ct.crossTileID])===null||Jn===void 0?void 0:Jn.anchor];const Wn=(Ki,mh,gh)=>{const Ls=Ki.x2-Ki.x1,If=Ki.y2-Ki.y1,Os=ct.textBoxScale,_h=ge&&ye==="never"?mh:null;let ns=null,is=oe==="never"?1:2,no="never";kn&&is++;for(let yh=0;yh<is;yh++){for(let Su=Ra;Su<Ia;Su++){const Tu=d.textAnchorOffsets.get(Su);if(kn&&Tu.textAnchor!==kn)continue;const Eu=this.attemptAnchorPlacement(Tu,Ki,Ls,If,Os,_e,we,k,je,z,W,no,ct,d,gh,x,C,_h,Ve);if(Eu&&(ns=Eu.placedGlyphBoxes,ns&&ns.placeable))return Yn=!0,_i=Eu.shift,ns}kn?kn=null:no=oe}return c&&!ns&&(ns={box:this.collisionIndex.placeCollisionBox(Zr,"always",k,je,z,we,_e,x,W.predicate,Ve,void 0,vt).box,offscreen:!1,placeable:!1,occluded:!1}),ns};da((()=>Wn(Zr,St.iconBox,l.az.horizontal)),(()=>{const Ki=St.verticalTextBox;return d.allowVerticalPlacement&&(!oi||!oi.placeable)&&ct.numVerticalGlyphVertices>0&&Ki?Wn(Ki,St.verticalIconBox,l.az.vertical):{box:null,occluded:!0,offscreen:null}})),oi&&(Yn=oi.placeable,Vn=oi.offscreen);const Vi=Hr(oi&&oi.placeable);if(!Yn&&this.prevPlacement){const Ki=this.prevPlacement.variableOffsets[ct.crossTileID];Ki&&(this.variableOffsets[ct.crossTileID]=Ki,this.markUsedJustification(d,Ki.anchor,ct,Vi))}}}if(Ei=oi,Yn=Ei&&Ei.placeable,Vn=Ei&&Ei.offscreen,ct.useRuntimeCollisionCircles&&ct.centerJustifiedTextSymbolIndex>=0){const Hr=d.text.placedSymbolArray.get(ct.centerJustifiedTextSymbolIndex),da=l.aA(d.textSizeData,$,Hr),Ra=y.get("text-padding");Ci=this.collisionIndex.placeCollisionCircles(oe,Hr,d.lineVertexArray,d.glyphOffsetArray,da,z,L,c,we,W.predicate,ct.collisionCircleDiameter,Ra,x,Ve),Ci.circles.length&&Ci.collisionDetected&&!c&&l.w("Collisions detected, but collision boxes are not shown"),Yn=fe||Ci.circles.length>0&&!Ci.collisionDetected,Vn=Vn&&Ci.offscreen}if(St.iconFeatureIndex&&(eo=St.iconFeatureIndex),St.iconBox){const Hr=da=>this.collisionIndex.placeCollisionBox(da,ye,k,je,z,we,_e,C,W.predicate,Ve,ge&&_i?_i:void 0,vt);sr&&sr.placeable&&St.verticalIconBox?(lr=Hr(St.verticalIconBox),ai=lr.placeable):(lr=Hr(St.iconBox),ai=lr.placeable),Vn=Vn&&lr.offscreen}const yl=ae||ct.numHorizontalGlyphVertices===0&&ct.numVerticalGlyphVertices===0,pc=se||ct.numIconVertices===0;yl||pc?pc?yl||(ai=ai&&Yn):Yn=ai&&Yn:ai=Yn=ai&&Yn;const to=ai&&lr.placeable;if(Yn&&Ei.placeable&&this.collisionIndex.insertCollisionBox(Ei.box,oe,y.get("text-ignore-placement"),d.bucketInstanceId,sr&&sr.placeable&&Oo?Oo:Lo,W.ID),to&&this.collisionIndex.insertCollisionBox(lr.box,ye,y.get("icon-ignore-placement"),d.bucketInstanceId,eo,W.ID),Ci&&Yn&&this.collisionIndex.insertCollisionCircles(Ci.circles,oe,y.get("text-ignore-placement"),d.bucketInstanceId,Lo,W.ID),c&&this.storeCollisionData(d.bucketInstanceId,en,St,Ei,lr,Ci),ct.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ct.crossTileID]=new Xh((Yn||Ge)&&!Ei?.occluded,(ai||Fe)&&!lr?.occluded,Vn||d.justReloaded),a[ct.crossTileID]=!0};if(Ae){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ct=d.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let St=ct.length-1;St>=0;--St){const en=ct[St];xt(d.symbolInstances.get(en),d.collisionArrays[en],en)}}else for(let ct=t.symbolInstanceStart;ct<t.symbolInstanceEnd;ct++)xt(d.symbolInstances.get(ct),d.collisionArrays[ct],ct);d.justReloaded=!1}storeCollisionData(t,a,c,d,y,x){if(c.textBox||c.iconBox){let C,z;this.collisionBoxArrays.has(t)?C=this.collisionBoxArrays.get(t):(C=new Map,this.collisionBoxArrays.set(t,C)),C.has(a)?z=C.get(a):(z={text:null,icon:null},C.set(a,z)),c.textBox&&(z.text=d.box),c.iconBox&&(z.icon=y.box)}if(x){let C=this.collisionCircleArrays[t];C===void 0&&(C=this.collisionCircleArrays[t]=[]);for(let z=0;z<x.circles.length;z+=4)C.push(x.circles[z+0]-Mn),C.push(x.circles[z+1]-Mn),C.push(x.circles[z+2]),C.push(x.collisionDetected?1:0)}}markUsedJustification(t,a,c,d){let y;y=d===l.az.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[l.aR(a)];const x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const C of x)C>=0&&(t.text.placedSymbolArray.get(C).crossTileID=y>=0&&C!==y?0:c.crossTileID)}markUsedOrientation(t,a,c){const d=a===l.az.horizontal||a===l.az.horizontalOnly?a:0,y=a===l.az.vertical?a:0,x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const C of x)t.text.placedSymbolArray.get(C).placedOrientation=d;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let c=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(t):1,y=a?a.opacities:{},x=a?a.variableOffsets:{},C=a?a.placedOrientations:{};for(const z in this.placements){const L=this.placements[z],k=y[z];k?(this.opacities[z]=new Xs(k,d,L.text,L.icon),c=c||L.text!==k.text.placed||L.icon!==k.icon.placed):(this.opacities[z]=new Xs(null,d,L.text,L.icon,L.skipFade),c=c||L.text||L.icon)}for(const z in y){const L=y[z];if(!this.opacities[z]){const k=new Xs(L,d,!1,!1);k.isHidden()||(this.opacities[z]=k,c=c||L.text.placed||L.icon.placed)}}for(const z in x)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=x[z]);for(const z in C)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=C[z]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const c={};for(const d of a){const y=d.getBucket(t);y&&d.latestFeatureIndex&&t.id===y.layerIds[0]&&this.updateBucketOpacities(y,d.tileID,c,d.collisionBoxArray)}}updateBucketOpacities(t,a,c,d){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const y=t.layers[0],x=y.layout,C=new Xs(null,0,!1,!1,!0),z=x.get("text-allow-overlap"),L=x.get("icon-allow-overlap"),k=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),V=x.get("text-rotation-alignment")==="map",j=x.get("text-pitch-alignment")==="map",$=x.get("icon-text-fit")!=="none",W=new Xs(null,0,z&&(L||!t.hasIconData()||x.get("icon-optional")),L&&(z||!t.hasTextData()||x.get("text-optional")),!0);!t.collisionArrays&&d&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(d);const ae=(oe,fe,ye)=>{for(let he=0;he<fe/4;he++)oe.opacityVertexArray.emplaceBack(ye);oe.hasVisibleVertices=oe.hasVisibleVertices||ye!==Ws},se=this.collisionBoxArrays.get(t.bucketInstanceId);for(let oe=0;oe<t.symbolInstances.length;oe++){const fe=t.symbolInstances.get(oe),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:he,crossTileID:_e}=fe;let we=this.opacities[_e];c[_e]?we=C:we||(we=W,this.opacities[_e]=we),c[_e]=!0;const ge=fe.numIconVertices>0,Ae=this.placedOrientations[fe.crossTileID],Ge=Ae===l.az.vertical,Fe=Ae===l.az.horizontal||Ae===l.az.horizontalOnly;if(ye>0||he>0){const Ve=Gu(we.text);ae(t.text,ye,Ge?Ws:Ve),ae(t.text,he,Fe?Ws:Ve);const vt=we.text.isHidden();[fe.rightJustifiedTextSymbolIndex,fe.centerJustifiedTextSymbolIndex,fe.leftJustifiedTextSymbolIndex].forEach((St=>{St>=0&&(t.text.placedSymbolArray.get(St).hidden=vt||Ge?1:0)})),fe.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(fe.verticalPlacedTextSymbolIndex).hidden=vt||Fe?1:0);const xt=this.variableOffsets[fe.crossTileID];xt&&this.markUsedJustification(t,xt.anchor,fe,Ae);const ct=this.placedOrientations[fe.crossTileID];ct&&(this.markUsedJustification(t,"left",fe,ct),this.markUsedOrientation(t,ct,fe))}if(ge){const Ve=Gu(we.icon),vt=!($&&fe.verticalPlacedIconSymbolIndex&&Ge);fe.placedIconSymbolIndex>=0&&(ae(t.icon,fe.numIconVertices,vt?Ve:Ws),t.icon.placedSymbolArray.get(fe.placedIconSymbolIndex).hidden=we.icon.isHidden()),fe.verticalPlacedIconSymbolIndex>=0&&(ae(t.icon,fe.numVerticalIconVertices,vt?Ws:Ve),t.icon.placedSymbolArray.get(fe.verticalPlacedIconSymbolIndex).hidden=we.icon.isHidden())}const je=se&&se.has(oe)?se.get(oe):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ve=t.collisionArrays[oe];if(Ve){let vt=new l.P(0,0);if(Ve.textBox||Ve.verticalTextBox){let xt=!0;if(k){const ct=this.variableOffsets[_e];ct?(vt=Rr(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textBoxScale),V&&vt._rotate(j?-this.transform.bearingInRadians:this.transform.bearingInRadians)):xt=!1}if(Ve.textBox||Ve.verticalTextBox){let ct;Ve.textBox&&(ct=Ge),Ve.verticalTextBox&&(ct=Fe),Uu(t.textCollisionBox.collisionVertexArray,we.text.placed,!xt||ct,je.text,vt.x,vt.y)}}if(Ve.iconBox||Ve.verticalIconBox){const xt=!!(!Fe&&Ve.verticalIconBox);let ct;Ve.iconBox&&(ct=xt),Ve.verticalIconBox&&(ct=!xt),Uu(t.iconCollisionBox.collisionVertexArray,we.icon.placed,ct,je.icon,$?vt.x:0,$?vt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const c=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function Uu(g,t,a,c,d,y){c&&c.length!==0||(c=[0,0,0,0]);const x=c[0]-Mn,C=c[1]-Mn,z=c[2]-Mn,L=c[3]-Mn;g.emplaceBack(t?1:0,a?1:0,d||0,y||0,x,C),g.emplaceBack(t?1:0,a?1:0,d||0,y||0,z,C),g.emplaceBack(t?1:0,a?1:0,d||0,y||0,z,L),g.emplaceBack(t?1:0,a?1:0,d||0,y||0,x,L)}const Uc=Math.pow(2,25),ms=Math.pow(2,24),gf=Math.pow(2,17),Zl=Math.pow(2,16),Go=Math.pow(2,9),_f=Math.pow(2,8),Ys=Math.pow(2,1);function Gu(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const t=g.placed?1:0,a=Math.floor(127*g.opacity);return a*Uc+t*ms+a*gf+t*Zl+a*Go+t*_f+a*Ys+t}const Ws=0;class gs{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,c,d,y){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(x,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort(((C,z)=>C.sortKey-z.sortKey)));this._currentPartIndex<x.length;)if(a.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,y())return!0;return!1}}class Hl{constructor(t,a,c,d,y,x,C,z){this.placement=new Vc(t,a,x,C,z),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(t,a,c){const d=xe(),y=()=>!this._forceFullPlacement&&xe()-d>2;for(;this._currentPlacementIndex>=0;){const x=a[t[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=C)&&(!x.maxzoom||x.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new gs(x)),this._inProgressLayer.continuePlacement(c[x.source],this.placement,this._showCollisionBoxes,x,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const sn=512/l.a5/2;class Za{constructor(t,a,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const d=new Map;for(let y=0;y<a.length;y++){const x=a.get(y),C=x.key,z=d.get(C);z?z.push(x):d.set(C,[x])}for(const[y,x]of d){const C={positions:x.map((z=>({x:Math.floor(z.anchorX*sn),y:Math.floor(z.anchorY*sn)}))),crossTileIDs:x.map((z=>z.crossTileID))};if(C.positions.length>128){const z=new l.aT(C.positions.length,16,Uint16Array);for(const{x:L,y:k}of C.positions)z.add(L,k);z.finish(),delete C.positions,C.index=z}this._symbolsByKey[y]=C}}getScaledCoordinates(t,a){const{x:c,y:d,z:y}=this.tileID.canonical,{x,y:C,z}=a.canonical,L=sn/Math.pow(2,z-y),k=(C*l.a5+t.anchorY)*L,V=d*l.a5*sn;return{x:Math.floor((x*l.a5+t.anchorX)*L-c*l.a5*sn),y:Math.floor(k-V)}}findMatches(t,a,c){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let y=0;y<t.length;y++){const x=t.get(y);if(x.crossTileID)continue;const C=this._symbolsByKey[x.key];if(!C)continue;const z=this.getScaledCoordinates(x,a);if(C.index){const L=C.index.range(z.x-d,z.y-d,z.x+d,z.y+d).sort();for(const k of L){const V=C.crossTileIDs[k];if(!c[V]){c[V]=!0,x.crossTileID=V;break}}}else if(C.positions)for(let L=0;L<C.positions.length;L++){const k=C.positions[L],V=C.crossTileIDs[L];if(Math.abs(k.x-z.x)<=d&&Math.abs(k.y-z.y)<=d&&!c[V]){c[V]=!0,x.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class Yh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Gc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const c in this.indexes){const d=this.indexes[c],y={};for(const x in d){const C=d[x];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+a),y[C.tileID.key]=C}this.indexes[c]=y}this.lng=t}addBucket(t,a,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let y=0;y<a.symbolInstances.length;y++)a.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const y in this.indexes){const x=this.indexes[y];if(Number(y)>t.overscaledZ)for(const C in x){const z=x[C];z.tileID.isChildOf(t)&&z.findMatches(a.symbolInstances,t,d)}else{const C=x[t.scaledTo(Number(y)).key];C&&C.findMatches(a.symbolInstances,t,d)}}for(let y=0;y<a.symbolInstances.length;y++){const x=a.symbolInstances.get(y);x.crossTileID||(x.crossTileID=c.generate(),d[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Za(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const c of a.getCrossTileIDsLists())for(const d of c)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let a=!1;for(const c in this.indexes){const d=this.indexes[c];for(const y in d)t[d[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[y]),delete d[y],a=!0)}return a}}class er{constructor(){this.layerIndexes={},this.crossTileIDs=new Yh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,c){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new Gc);let y=!1;const x={};d.handleWrapJump(c);for(const C of a){const z=C.getBucket(t);z&&t.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(C.tileID,z,this.crossTileIDs)&&(y=!0),x[z.bucketInstanceId]=!0)}return d.removeStaleBuckets(x)&&(y=!0),y}pruneUnusedLayers(t){const a={};t.forEach((c=>{a[c]=!0}));for(const c in this.layerIndexes)a[c]||delete this.layerIndexes[c]}}var Ni="void main() {fragColor=vec4(1.0);}";const si={prelude:Yt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Yt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Yt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Yt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Yt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Yt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Yt(Ni,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Yt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Yt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Yt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Yt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Yt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Yt(Ni,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Yt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Yt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Yt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Yt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Yt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Yt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Yt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Yt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Yt(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:Yt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:Yt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Yt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Yt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Yt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Yt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Yt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Yt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Yt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Yt(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Yt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Yt(g,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/in ([\w]+) ([\w]+)/g),d=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=y?y.concat(d):d,C={};return{fragmentSource:g=g.replace(a,((z,L,k,V,j)=>(C[j]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${j}
in ${k} ${V} ${j};
#else
uniform ${k} ${V} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${k} ${V} ${j} = u_${j};
#endif
`))),vertexSource:t=t.replace(a,((z,L,k,V,j)=>{const $=V==="float"?"vec2":"vec4",W=j.match(/color/)?"color":$;return C[j]?L==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${k} ${$} a_${j};
out ${k} ${V} ${j};
#else
uniform ${k} ${V} u_${j};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${k} ${V} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${W}(a_${j}, u_${j}_t);
#else
    ${k} ${V} ${j} = u_${j};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${k} ${$} a_${j};
#else
uniform ${k} ${V} u_${j};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${k} ${V} ${j} = a_${j};
#else
    ${k} ${V} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${k} ${V} ${j} = unpack_mix_${W}(a_${j}, u_${j}_t);
#else
    ${k} ${V} ${j} = u_${j};
#endif
`})),staticAttributes:c,staticUniforms:x}}class Hn{constructor(t,a,c){this.vertexBuffer=t,this.indexBuffer=a,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var wa=l.aU([{name:"a_pos",type:"Int16",components:2}]);const wi="#define PROJECTION_MERCATOR",Ir="mercator";class tr{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ir}get shaderDefine(){return wi}get shaderPreludeCode(){return si.projectionMercator}get vertexShaderPreludeCode(){return si.projectionMercator.vertexSource}get subdivisionGranularity(){return l.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,a,c,d,y){if(this._cachedMesh)return this._cachedMesh;const x=new l.aW;x.emplaceBack(0,0),x.emplaceBack(l.a5,0),x.emplaceBack(0,l.a5),x.emplaceBack(l.a5,l.a5);const C=t.createVertexBuffer(x,wa.members),z=l.aX.simpleSegment(0,0,4,2),L=new l.aY;L.emplaceBack(1,0,2),L.emplaceBack(1,2,3);const k=t.createIndexBuffer(L);return this._cachedMesh=new Hn(C,k,z),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class na{constructor(t=0,a=0,c=0,d=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(c)||c<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=c,this.right=d}interpolate(t,a,c){return a.top!=null&&t.top!=null&&(this.top=l.G.number(t.top,a.top,c)),a.bottom!=null&&t.bottom!=null&&(this.bottom=l.G.number(t.bottom,a.bottom,c)),a.left!=null&&t.left!=null&&(this.left=l.G.number(t.left,a.left,c)),a.right!=null&&t.right!=null&&(this.right=l.G.number(t.right,a.right,c)),this}getCenter(t,a){const c=l.an((this.left+t-this.right)/2,0,t),d=l.an((this.top+a-this.bottom)/2,0,a);return new l.P(c,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new na(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function go(g,t){if(!g.renderWorldCopies||g.lngRange)return;const a=t.lng-g.center.lng;t.lng+=a>180?-360:a<-180?360:0}function li(g){return Math.max(0,Math.floor(g))}class _s{constructor(t,a){var c;this.applyConstrain=(d,y)=>this._constrainOverride!==null?this._constrainOverride(d,y):this._callbacks.defaultConstrain(d,y),this._callbacks=t,this._tileSize=512,this._renderWorldCopies=a?.renderWorldCopies===void 0||!!a?.renderWorldCopies,this._minZoom=a?.minZoom||0,this._maxZoom=a?.maxZoom||22,this._minPitch=a?.minPitch==null?0:a?.minPitch,this._maxPitch=a?.maxPitch==null?60:a?.maxPitch,this._constrainOverride=(c=a?.constrainOverride)!==null&&c!==void 0?c:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new l.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=li(this._zoom),this._scale=l.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new na,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,a,c){this._constrainOverride=t.constrainOverride,this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=li(this._zoom),this._scale=l.aq(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new na(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!c&&t.autoCalculateNearFarZ,a&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get constrainOverride(){return this._constrainOverride}setConstrainOverride(t){t===void 0&&(t=null),this._constrainOverride!==t&&(this._constrainOverride=t,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const a=l.W(t,-180,180)*Math.PI/180;var c,d,y,x,C,z,L,k,V;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=X(),c=this._rotationMatrix,y=-this._bearingInRadians,x=(d=this._rotationMatrix)[0],C=d[1],z=d[2],L=d[3],k=Math.sin(y),V=Math.cos(y),c[0]=x*V+z*k,c[1]=C*V+L*k,c[2]=x*-k+z*V,c[3]=C*-k+L*V)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const a=l.an(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const a=t/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return l.aZ(this._fovInRadians)}setFov(t){t=l.an(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=l.ap(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const a=this.applyConstrain(this._center,t).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=l.aq(a),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,a){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,c){this._unmodified=!1,this._edgeInsets.interpolate(t,a,c),this.constrainInternal(),this._calcMatrices()}resize(t,a,c=!0){this._width=t,this._height=a,c&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Zn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-l.ao,l.ao])}getCameraQueryGeometry(t,a){if(a.length===1)return[a[0],t];{const{minX:c,minY:d,maxX:y,maxY:x}=l.aa.fromPoints(a).extend(t);return[new l.P(c,d),new l.P(y,d),new l.P(y,x),new l.P(c,x),new l.P(c,d)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:c}=this.applyConstrain(this.center,this.zoom);this.setCenter(a),this.setZoom(c),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=l.ar(new Float64Array(16));l.Q(t,t,[this._width/2,-this._height/2,1]),l.O(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=l.ar(new Float64Array(16)),l.Q(t,t,[1,-1,1]),l.O(t,t,[-1,-1,0]),l.Q(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,a,c,d){const y=c!==void 0?c:this.bearing,x=d=d!==void 0?d:this.pitch,{distanceToCenter:C,clampedElevation:z}=this._distanceToCenterFromAltElevationPitch(a,this.elevation,x),{x:L,y:k}=Wt(x,y),V=l.a9.fromLngLat(t,a);let j,$,W=l.a_(1,V.y),ae=0;do{if(ae+=1,ae>10)break;$=C/W,j=new l.a9(V.x+L*$,V.y+k*$),W=1/j.meterInMercatorCoordinateUnits()}while(Math.abs(C-$*W)>1e-12);return{center:j.toLngLat(),elevation:z,zoom:l.at(this.height/2/Math.tan(this.fovInRadians/2)/$/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const a=1/this.worldSize,c=l.as(1,this.center.lat)*this.worldSize,d=l.a9.fromLngLat(this.center,this.elevation),y=d.x/a,x=d.y/a,C=d.z/a,z=this.pitch,L=this.bearing,{x:k,y:V,z:j}=Wt(z,L),$=this.cameraToCenterDistance,W=y+$*-k,ae=x+$*-V,se=C+$*j,{distanceToCenter:oe,clampedElevation:fe}=this._distanceToCenterFromAltElevationPitch(se/c,t,z),ye=oe*c,he=new l.a9((W+k*ye)*a,(ae+V*ye)*a,0).toLngLat(),_e=l.as(1,he.lat),we=l.at(this.height/2/Math.tan(this.fovInRadians/2)/oe/_e/this.tileSize);this._elevation=fe,this._center=he,this.setZoom(we)}_distanceToCenterFromAltElevationPitch(t,a,c){const d=-Math.cos(l.ap(c)),y=t-a;let x,C=a;return d*y>=0||Math.abs(d)<.1?(x=1e4,C=t+x*d):x=-y/d,{distanceToCenter:x,clampedElevation:C}}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=l.as(1,this.center.lat)*this.worldSize;return Me(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const a=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/a,t.canonical.y/a,1/a/l.a5,1/a/l.a5]}}class ia{constructor(t,a){this.min=t,this.max=a,this.center=l.a$([],l.b0([],this.min,this.max),.5)}quadrant(t){const a=[t%2==0,t<2],c=l.b1(this.min),d=l.b1(this.max);for(let y=0;y<a.length;y++)c[y]=a[y]?this.min[y]:this.center[y],d[y]=a[y]?this.center[y]:this.max[y];return d[2]=this.max[2],new ia(c,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let a=!0;for(let c=0;c<t.planes.length;c++){const d=this.intersectsPlane(t.planes[c]);if(d===0)return 0;d===1&&(a=!1)}return a?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let a=t[3],c=t[3];for(let d=0;d<3;d++)t[d]>0?(a+=t[d]*this.min[d],c+=t[d]*this.max[d]):(c+=t[d]*this.min[d],a+=t[d]*this.max[d]);return a>=0?2:c<0?0:1}}class Ks{distanceToTile2d(t,a,c,d){const y=d.distanceX([t,a]),x=d.distanceY([t,a]);return Math.hypot(y,x)}getWrap(t,a,c){return c}getTileBoundingVolume(t,a,c,d){var y,x;let C=0,z=0;if(d?.terrain){const k=new l.a2(t.z,a,t.z,t.x,t.y),V=d.terrain.getMinMaxElevation(k);C=(y=V.minElevation)!==null&&y!==void 0?y:Math.min(0,c),z=(x=V.maxElevation)!==null&&x!==void 0?x:Math.max(0,c)}const L=1<<t.z;return new ia([a+t.x/L,t.y/L,C],[a+(t.x+1)/L,(t.y+1)/L,z])}allowVariableZoom(t,a){const c=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,d=l.an(78.5-c/2,0,60);return!!a.terrain||t.pitch>d}allowWorldCopies(){return!0}prepareNextFrame(){}}class Lr{constructor(t,a,c){this.points=t,this.planes=a,this.aabb=c}static fromInvProjectionMatrix(t,a=1,c=0,d,y){const x=y?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],C=Math.pow(2,c),z=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((j=>(function($,W,ae,se){const oe=l.aH([],$,W),fe=1/oe[3]/ae*se;return l.b6(oe,oe,[fe,fe,1/oe[3],fe])})(j,t,a,C)));d&&(function(j,$,W,ae){const se=ae?4:0,oe=ae?0:4;let fe=0;const ye=[],he=[];for(let ge=0;ge<4;ge++){const Ae=l.b2([],j[ge+oe],j[ge+se]),Ge=l.b7(Ae);l.a$(Ae,Ae,1/Ge),ye.push(Ge),he.push(Ae)}for(let ge=0;ge<4;ge++){const Ae=l.b8(j[ge+se],he[ge],W);fe=Ae!==null&&Ae>=0?Math.max(fe,Ae):Math.max(fe,ye[ge])}const _e=(function(ge,Ae){const Ge=l.b2([],ge[Ae[0]],ge[Ae[1]]),Fe=l.b2([],ge[Ae[2]],ge[Ae[1]]),je=[0,0,0,0];return l.b3(je,l.b4([],Ge,Fe)),je[3]=-l.b5(je,ge[Ae[0]]),je})(j,$),we=(function(ge,Ae){const Ge=l.b9(ge),Fe=l.ba([],ge,1/Ge),je=l.b2([],Ae,l.a$([],Fe,l.b5(Ae,Fe))),Ve=l.b9(je);if(Ve>0){const vt=Math.sqrt(1-Fe[3]*Fe[3]),xt=l.a$([],Fe,-Fe[3]),ct=l.b0([],xt,l.a$([],je,vt/Ve));return l.bb(Ae,ct)}return null})(W,_e);if(we!==null){const ge=we/l.b5(he[0],_e);fe=Math.min(fe,ge)}for(let ge=0;ge<4;ge++){const Ae=Math.min(fe,ye[ge]);j[ge+oe]=[j[ge+se][0]+he[ge][0]*Ae,j[ge+se][1]+he[ge][1]*Ae,j[ge+se][2]+he[ge][2]*Ae,1]}})(z,x[0],d,y);const L=x.map((j=>{const $=l.b2([],z[j[0]],z[j[1]]),W=l.b2([],z[j[2]],z[j[1]]),ae=l.b3([],l.b4([],$,W)),se=-l.b5(ae,z[j[1]]);return ae.concat(se)})),k=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],V=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const j of z)for(let $=0;$<3;$++)k[$]=Math.min(k[$],j[$]),V[$]=Math.max(V[$],j[$]);return new Lr(z,L,new ia(k,V))}}class Wi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,c){return this._helper.interpolatePadding(t,a,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,c=!0){this._helper.resize(t,a,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,a){}constructor(t){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(a,c)=>{c=l.an(+c,this.minZoom,this.maxZoom);const d={center:new l.V(a.lng,a.lat),zoom:c};let y=this._helper._lngRange;if(!this._helper._renderWorldCopies&&y===null){const he=179.9999999999;y=[-he,he]}const x=this.tileSize*l.aq(d.zoom);let C=0,z=x,L=0,k=x,V=0,j=0;const{x:$,y:W}=this.size;if(this._helper._latRange){const he=this._helper._latRange;C=l.X(he[1])*x,z=l.X(he[0])*x,z-C<W&&(V=W/(z-C))}y&&(L=l.W(l.Y(y[0])*x,0,x),k=l.W(l.Y(y[1])*x,0,x),k<L&&(k+=x),k-L<$&&(j=$/(k-L)));const{x:ae,y:se}=ke(x,a);let oe,fe;const ye=Math.max(j||0,V||0);if(ye){const he=new l.P(j?(k+L)/2:ae,V?(z+C)/2:se);return d.center=lt(x,he).wrap(),d.zoom+=l.at(ye),d}if(this._helper._latRange){const he=W/2;se-he<C&&(fe=C+he),se+he>z&&(fe=z-he)}if(y){const he=(L+k)/2;let _e=ae;this._helper._renderWorldCopies&&(_e=l.W(ae,he-x/2,he+x/2));const we=$/2;_e-we<L&&(oe=L+we),_e+we>k&&(oe=k-we)}if(oe!==void 0||fe!==void 0){const he=new l.P(oe??ae,fe??se);d.center=lt(x,he).wrap()}return d},this.applyConstrain=(a,c)=>this._helper.applyConstrain(a,c),this._helper=new _s({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,c)=>this.defaultConstrain(a,c)},t),this._coveringTilesDetailsProvider=new Ks}clone(){const t=new Wi;return t.apply(this,!1),t}apply(t,a,c){this._helper.apply(t,a,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const a=[new l.bc(0,t)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new l.P(0,0)),d=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,this._helper._height)),x=this.screenPointToMercatorCoordinate(new l.P(0,this._helper._height)),C=Math.floor(Math.min(c.x,d.x,y.x,x.x)),z=Math.floor(Math.max(c.x,d.x,y.x,x.x)),L=1;for(let k=C-L;k<=z+L;k++)k!==0&&a.push(new l.bc(k,t))}return a}getCameraFrustum(){return Lr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const a=this.screenPointToLocation(this.centerPoint,t),c=t?t.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(t,a){const c=l.as(this.elevation,this.center.lat),d=this.screenPointToMercatorCoordinateAtZ(a,c),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),x=l.a9.fromLngLat(t),C=new l.a9(x.x-(d.x-y.x),x.y-(d.y-y.y));this.setCenter(C?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,a){return a?this.coordinatePoint(l.a9.fromLngLat(t),a.getElevationForLngLat(t,this),this._pixelMatrix3D):this.coordinatePoint(l.a9.fromLngLat(t))}screenPointToLocation(t,a){var c;return(c=this.screenPointToMercatorCoordinate(t,a))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(t,a){if(a){const c=a.pointCoordinate(t);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,a){const c=a||0,d=[t.x,t.y,0,1],y=[t.x,t.y,1,1];l.aH(d,d,this._pixelMatrixInverse),l.aH(y,y,this._pixelMatrixInverse);const x=d[3],C=y[3],z=d[1]/x,L=y[1]/C,k=d[2]/x,V=y[2]/C,j=k===V?0:(c-k)/(V-k);return new l.a9(l.G.number(d[0]/x,y[0]/C,j)/this.worldSize,l.G.number(z,L,j)/this.worldSize,c)}coordinatePoint(t,a=0,c=this._pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,a,1];return l.aH(d,d,c),new l.P(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Ke(this));return new Zn().extend(this.screenPointToLocation(new l.P(0,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new l.P(0,this._helper._height)))}isPointOnMapSurface(t,a){return a?a.pointCoordinate(t)!=null:t.y>this.height/2-Ke(this)}calculatePosMatrix(t,a=!1,c){var d;const y=(d=t.key)!==null&&d!==void 0?d:l.bd(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),x=a?this._alignedPosMatrixCache:this._posMatrixCache;if(x.has(y)){const L=x.get(y);return c?L.f32:L.f64}const C=ht(t,this.worldSize);l.S(C,a?this._alignedProjMatrix:this._viewProjMatrix,C);const z={f64:C,f32:new Float32Array(C)};return x.set(y,z),c?z.f32:z.f64}calculateFogMatrix(t){const a=t.key,c=this._fogMatrixCacheF32;if(c.has(a))return c.get(a);const d=ht(t,this.worldSize);return l.S(d,this._fogMatrix,d),c.set(a,new Float32Array(d)),c.get(a)}calculateCenterFromCameraLngLatAlt(t,a,c,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,c,d)}_calculateNearFarZIfNeeded(t,a,c){if(!this._helper.autoCalculateNearFarZ)return;const d=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=t-d*this._helper._pixelPerMeter/Math.cos(a),x=d<0?y:t,C=Math.PI/2+this.pitchInRadians,z=l.ap(this.fov)*(Math.abs(Math.cos(l.ap(this.roll)))*this.height+Math.abs(Math.sin(l.ap(this.roll)))*this.width)/this.height*(.5+c.y/this.height),L=Math.sin(z)*x/Math.sin(l.an(Math.PI-C-z,.01,Math.PI-.01)),k=Ke(this),V=Math.atan(k/this._helper.cameraToCenterDistance),j=l.ap(.75),$=V>j?2*V*(.5+c.y/(2*k)):j,W=Math.sin($)*x/Math.sin(l.an(Math.PI-C-$,.01,Math.PI-.01)),ae=Math.min(L,W);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*ae+x),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,a=ke(this.worldSize,this.center),c=a.x,d=a.y;this._helper._pixelPerMeter=l.as(1,this.center.lat)*this.worldSize;const y=l.ap(Math.min(this.pitch,Re)),x=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let C;this._calculateNearFarZIfNeeded(x,y,t),C=new Float64Array(16),l.be(C,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),l.aB(this._invProjMatrix,C),C[8]=2*-t.x/this._helper._width,C[9]=2*t.y/this._helper._height,this._projectionMatrix=l.bf(C),l.Q(C,C,[1,-1,1]),l.O(C,C,[0,0,-this._helper.cameraToCenterDistance]),l.bg(C,C,-this.rollInRadians),l.bh(C,C,this.pitchInRadians),l.bg(C,C,-this.bearingInRadians),l.O(C,C,[-c,-d,0]),this._mercatorMatrix=l.Q([],C,[this.worldSize,this.worldSize,this.worldSize]),l.Q(C,C,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=l.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,C),l.O(C,C,[0,0,-this.elevation]),this._viewProjMatrix=C,this._invViewProjMatrix=l.aB([],C);const z=[0,0,-1,1];l.aH(z,z,this._invViewProjMatrix),this._cameraPosition=[z[0]/z[3],z[1]/z[3],z[2]/z[3]],this._fogMatrix=new Float64Array(16),l.be(this._fogMatrix,this.fovInRadians,this.width/this.height,x,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,l.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),l.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),l.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),l.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),l.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),l.O(this._fogMatrix,this._fogMatrix,[-c,-d,0]),l.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),l.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=l.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,C);const L=this._helper._width%2/2,k=this._helper._height%2/2,V=Math.cos(this.bearingInRadians),j=Math.sin(-this.bearingInRadians),$=c-Math.round(c)+V*L+j*k,W=d-Math.round(d)+V*k+j*L,ae=new Float64Array(C);if(l.O(ae,ae,[$>.5?$-1:$,W>.5?W-1:W,0]),this._alignedProjMatrix=ae,C=l.aB(new Float64Array(16),this._pixelMatrix),!C)throw new Error("failed to invert matrix");this._pixelMatrixInverse=C,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new l.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.aH(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=l.as(1,this.center.lat)*this.worldSize;return Me(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,a){const c=l.a9.fromLngLat(t),d=[c.x*this.worldSize,c.y*this.worldSize,a,1];return l.aH(d,d,this._viewProjMatrix),d[2]/d[3]}getProjectionData(t){const{overscaledTileID:a,aligned:c,applyTerrainMatrix:d}=t,y=this._helper.getMercatorTileCoordinates(a),x=a?this.calculatePosMatrix(a,c,!0):null;let C;return C=a&&a.terrainRttPosMatrix32f&&d?a.terrainRttPosMatrix32f:x||l.bi(),{mainMatrix:C,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:C}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,a,c){return 1}transformLightDirection(t){return l.b1(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,a,c,d){const y=this.calculatePosMatrix(c);let x;d?(x=[t,a,d(t,a),1],l.aH(x,x,y)):(x=[t,a,0,1],ba(x,x,y));const C=x[3];return{point:new l.P(x[0]/C,x[1]/C),signedDistanceFromCamera:C,isOccluded:!1}}populateCache(t){for(const a of t)this.calculatePosMatrix(a)}getMatrixForModel(t,a){const c=l.a9.fromLngLat(t,a),d=c.meterInMercatorCoordinateUnits(),y=l.bj();return l.O(y,y,[c.x,c.y,c.z]),l.bg(y,y,Math.PI),l.bh(y,y,Math.PI/2),l.Q(y,y,[-d,d,d]),y}getProjectionDataForCustomLayer(t=!0){const a=new l.a2(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:t}),d=ht(a,this.worldSize);l.S(d,this._viewProjMatrix,d),c.tileMercatorCoords=[0,0,1,1];const y=[l.a5,l.a5,this.worldSize/this._helper.pixelsPerMeter],x=l.bk();return l.Q(x,d,y),c.fallbackMatrix=x,c.mainMatrix=x,c}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function Or(){l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function qc(g){if(g.useSlerp)if(g.k<1){const t=l.bl(g.startEulerAngles.roll,g.startEulerAngles.pitch,g.startEulerAngles.bearing),a=l.bl(g.endEulerAngles.roll,g.endEulerAngles.pitch,g.endEulerAngles.bearing),c=new Float64Array(4);l.bm(c,t,a,g.k);const d=l.bn(c);g.tr.setRoll(d.roll),g.tr.setPitch(d.pitch),g.tr.setBearing(d.bearing)}else g.tr.setRoll(g.endEulerAngles.roll),g.tr.setPitch(g.endEulerAngles.pitch),g.tr.setBearing(g.endEulerAngles.bearing);else g.tr.setRoll(l.G.number(g.startEulerAngles.roll,g.endEulerAngles.roll,g.k)),g.tr.setPitch(l.G.number(g.startEulerAngles.pitch,g.endEulerAngles.pitch,g.k)),g.tr.setBearing(l.G.number(g.startEulerAngles.bearing,g.endEulerAngles.bearing,g.k))}function Qs(g,t,a,c,d){const y=d.padding,x=ke(d.worldSize,a.getNorthWest()),C=ke(d.worldSize,a.getNorthEast()),z=ke(d.worldSize,a.getSouthEast()),L=ke(d.worldSize,a.getSouthWest()),k=l.ap(-c),V=x.rotate(k),j=C.rotate(k),$=z.rotate(k),W=L.rotate(k),ae=new l.P(Math.max(V.x,j.x,W.x,$.x),Math.max(V.y,j.y,W.y,$.y)),se=new l.P(Math.min(V.x,j.x,W.x,$.x),Math.min(V.y,j.y,W.y,$.y)),oe=ae.sub(se),fe=(d.width-(y.left+y.right+t.left+t.right))/oe.x,ye=(d.height-(y.top+y.bottom+t.top+t.bottom))/oe.y;if(ye<0||fe<0)return void Or();const he=Math.min(l.at(d.scale*Math.min(fe,ye)),g.maxZoom),_e=l.P.convert(g.offset),we=new l.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(l.ap(c)),ge=_e.add(we).mult(d.scale/l.aq(he));return{center:lt(d.worldSize,x.add(z).div(2).sub(ge)),zoom:he,bearing:c}}class Js{get useGlobeControls(){return!1}handlePanInertia(t,a){const c=t.mag(),d=Math.abs(Ke(a));return{easingOffset:t.mult(Math.min(.75*d/c,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(t,a){t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta),t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta)}handleMapControlsPan(t,a,c){t.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(c,t.around)}cameraForBoxAndBearing(t,a,c,d,y){return Qs(t,a,c,d,y)}handleJumpToCenterZoom(t,a){t.zoom!==(a.zoom!==void 0?+a.zoom:t.zoom)&&t.setZoom(+a.zoom),a.center!==void 0&&t.setCenter(l.V.convert(a.center))}handleEaseTo(t,a){const c=t.zoom,d=t.padding,y={roll:t.roll,pitch:t.pitch,bearing:t.bearing},x={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},C=a.zoom!==void 0,z=!t.isPaddingEqual(a.padding);let L=!1;const k=C?+a.zoom:t.zoom;let V=t.centerPoint.add(a.offsetAsPoint);const j=t.screenPointToLocation(V),{center:$,zoom:W}=t.applyConstrain(l.V.convert(a.center||j),k??c);go(t,$);const ae=ke(t.worldSize,j),se=ke(t.worldSize,$).sub(ae),oe=l.aq(W-c);return L=W!==c,{easeFunc:fe=>{if(L&&t.setZoom(l.G.number(c,W,fe)),l.bo(y,x)||qc({startEulerAngles:y,endEulerAngles:x,tr:t,k:fe,useSlerp:y.roll!=x.roll}),z&&(t.interpolatePadding(d,a.padding,fe),V=t.centerPoint.add(a.offsetAsPoint)),a.around)t.setLocationAtPoint(a.around,a.aroundPoint);else{const ye=l.aq(t.zoom-c),he=W>c?Math.min(2,oe):Math.max(.5,oe),_e=Math.pow(he,1-fe),we=lt(t.worldSize,ae.add(se.mult(fe*_e)).mult(ye));t.setLocationAtPoint(t.renderWorldCopies?we.wrap():we,V)}},isZooming:L,elevationCenter:$}}handleFlyTo(t,a){const c=a.zoom!==void 0,d=t.zoom,y=t.applyConstrain(l.V.convert(a.center||a.locationAtOffset),c?+a.zoom:d),x=y.center,C=y.zoom;go(t,x);const z=ke(t.worldSize,a.locationAtOffset),L=ke(t.worldSize,x).sub(z),k=L.mag(),V=l.aq(C-d);let j;if(a.minZoom!==void 0){const $=Math.min(+a.minZoom,d,C),W=t.applyConstrain(x,$).zoom;j=l.aq(W-d)}return{easeFunc:($,W,ae,se)=>{t.setZoom($===1?C:d+l.at(W));const oe=$===1?x:lt(t.worldSize,z.add(L.mult(ae)).mult(W));t.setLocationAtPoint(t.renderWorldCopies?oe.wrap():oe,se)},scaleOfZoom:V,targetCenter:x,scaleOfMinZoom:j,pixelPathLength:k}}}class jn{constructor(t,a,c){this.blendFunction=t,this.blendColor=a,this.mask=c}}jn.Replace=[1,0],jn.disabled=new jn(jn.Replace,l.bp.transparent,[!1,!1,!1,!1]),jn.unblended=new jn(jn.Replace,l.bp.transparent,[!0,!0,!0,!0]),jn.alphaBlended=new jn([1,771],l.bp.transparent,[!0,!0,!0,!0]);const ys=2305;class pn{constructor(t,a,c){this.enable=t,this.mode=a,this.frontFace=c}}pn.disabled=new pn(!1,1029,ys),pn.backCCW=new pn(!0,1029,ys),pn.frontCCW=new pn(!0,1028,ys);class rn{constructor(t,a,c){this.func=t,this.mask=a,this.range=c}}rn.ReadOnly=!1,rn.ReadWrite=!0,rn.disabled=new rn(519,rn.ReadOnly,[0,1]);const el=7680;class wn{constructor(t,a,c,d,y,x){this.test=t,this.ref=a,this.mask=c,this.fail=d,this.depthFail=y,this.pass=x}}wn.disabled=new wn({func:519,mask:0},0,0,el,el,el);const $c=new WeakMap;function Sa(g){var t;if($c.has(g))return $c.get(g);{const a=(t=g.getParameter(g.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return $c.set(g,a),a}}class vs{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const a=t.context,c=a.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const d=new l.aW;d.emplaceBack(-1,-1),d.emplaceBack(2,-1),d.emplaceBack(-1,2);const y=new l.aY;y.emplaceBack(0,1,2),this._fullscreenTriangle=new Hn(a.createVertexBuffer(d,wa.members),a.createIndexBuffer(y),l.aX.simpleSegment(0,0,d.length,y.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(c.TEXTURE1);const x=c.createTexture();c.bindTexture(c.TEXTURE_2D,x),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(x),Sa(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,a){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,a=t.gl;t.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,a){const c=this._cachedRenderContext.context,d=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:l.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,d.TRIANGLES,rn.disabled,wn.disabled,jn.unblended,pn.disabled,((y,x)=>({u_input:y,u_output_expected:x}))(t,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Sa(d)){d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.readBuffer(d.COLOR_ATTACHMENT0),d.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),d.bindBuffer(d.PIXEL_PACK_BUFFER,null);const y=d.fenceSync(d.SYNC_GPU_COMMANDS_COMPLETE,0);d.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Sa(t)){const a=t.clientWaitSync(this._readbackQueue.sync,0,0);if(a===t.WAIT_FAILED)return l.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=vs._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let a=0;return a+=t[0]/256,a+=t[1]/65536,a+=t[2]/16777216,t[3]<127&&(a=-a),a/128}}const xs=l.a5/128;function yf(g,t){const a=g.granularity!==void 0?Math.max(g.granularity,1):1,c=a+(g.generateBorders?2:0),d=a+(g.extendToNorthPole||g.generateBorders?1:0)+(g.extendToSouthPole||g.generateBorders?1:0),y=c+1,x=d+1,C=g.generateBorders?-1:0,z=g.generateBorders||g.extendToNorthPole?-1:0,L=a+(g.generateBorders?1:0),k=a+(g.generateBorders||g.extendToSouthPole?1:0),V=y*x,j=c*d*6,$=y*x>65536;if($&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const W=$||t==="32bit",ae=new Int16Array(2*V);let se=0;for(let ye=z;ye<=k;ye++)for(let he=C;he<=L;he++){let _e=he/a*l.a5;he===-1&&(_e=-xs),he===a+1&&(_e=l.a5+xs);let we=ye/a*l.a5;ye===-1&&(we=g.extendToNorthPole?l.br:-xs),ye===a+1&&(we=g.extendToSouthPole?l.bs:l.a5+xs),ae[se++]=_e,ae[se++]=we}const oe=W?new Uint32Array(j):new Uint16Array(j);let fe=0;for(let ye=0;ye<d;ye++)for(let he=0;he<c;he++){const _e=he+1+ye*y,we=he+(ye+1)*y,ge=he+1+(ye+1)*y;oe[fe++]=he+ye*y,oe[fe++]=we,oe[fe++]=_e,oe[fe++]=_e,oe[fe++]=we,oe[fe++]=ge}return{vertices:ae.buffer.slice(0),indices:oe.buffer.slice(0),uses32bitIndices:W}}const Zc=new l.aV({fill:new l.bt(128,2),line:new l.bt(512,0),tile:new l.bt(128,32),stencil:new l.bt(128,1),circle:3});class Wh{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return si.projectionGlobe}get vertexShaderPreludeCode(){return si.projectionMercator.vertexSource}get subdivisionGranularity(){return Zc}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new vs(t));const a=l.X(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,d=this._errorMeasurement.updateErrorLoop(a,c),y=xe();d!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=d,this._errorMeasurementLastChangeTime=y);const x=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=l.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,l.bv(x))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,a,c,d,y){const x=(y==="stencil"?Zc.stencil:Zc.tile).getGranularityForZoomLevel(a.z);return this._getMesh(t,{granularity:x,generateBorders:c,extendToNorthPole:a.y===0&&d,extendToSouthPole:a.y===(1<<a.z)-1&&d})}_getMesh(t,a){const c=this._getMeshKey(a);if(c in this._tileMeshCache)return this._tileMeshCache[c];const d=(function(y,x){const C=yf(x,"16bit"),z=l.aW.deserialize({arrayBuffer:C.vertices,length:C.vertices.byteLength/2/2}),L=l.aY.deserialize({arrayBuffer:C.indices,length:C.indices.byteLength/2/3});return new Hn(y.createVertexBuffer(z,wa.members),y.createIndexBuffer(L),l.aX.simpleSegment(0,0,z.length,L.length))})(t,a);return this._tileMeshCache[c]=d,d}recalculate(t){}hasTransition(){const t=xe();let a=!1;return a=a||(t-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const em=new l.t({type:new l.D(l.u.projection.type)});class Kh extends l.E{constructor(t){super(),this._transitionable=new l.x(em,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.H(0)),this._mercatorProjection=new tr,this._verticalPerspectiveProjection=new Wh}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof l.bw){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,a,c,d,y){return this.currentProjection.getMeshFromTileID(t,a,c,d,y)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function kr(g){const t=tl(g.worldSize,g.center.lat);return 2*Math.PI*t}function _o(g,t,a,c,d){const y=1/(1<<d),x=t/l.a5*y+c*y,C=l.bz((g/l.a5*y+a*y)*Math.PI*2+Math.PI,2*Math.PI),z=2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI,L=Math.cos(z),k=new Float64Array(3);return k[0]=Math.sin(C)*L,k[1]=Math.sin(z),k[2]=Math.cos(C)*L,k}function ci(g){return(function(t,a){const c=Math.cos(a),d=new Float64Array(3);return d[0]=Math.sin(t)*c,d[1]=Math.sin(a),d[2]=Math.cos(t)*c,d})(g.lng*Math.PI/180,g.lat*Math.PI/180)}function tl(g,t){return g/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Hc(g){const t=Math.asin(g[1])/Math.PI*180,a=Math.sqrt(g[0]*g[0]+g[2]*g[2]);if(a>1e-6){const c=g[0]/a,d=Math.acos(g[2]/a),y=(c>0?d:-d)/Math.PI*180;return new l.V(l.W(y,-180,180),t)}return new l.V(0,t)}function Xc(g){return Math.cos(g*Math.PI/180)}function Si(g,t){const a=Xc(g),c=Xc(t);return l.at(c/a)}function vf(g,t){const a=g.rotate(t.bearingInRadians),c=t.zoom+Si(t.center.lat,0),d=l.bu(1/Xc(t.center.lat),1/Xc(Math.min(Math.abs(t.center.lat),60)),l.bx(c,7,3,0,1)),y=360/kr({worldSize:t.worldSize,center:{lat:t.center.lat}});return new l.V(t.center.lng-a.x*y*d,l.an(t.center.lat+a.y*y,-l.ao,l.ao))}function qu(g){const t=.5*g,a=Math.sin(t),c=Math.cos(t);return Math.log(a+c)-Math.log(c-a)}function xf(g,t,a,c){const d=g.lat+a*c;if(Math.abs(a)>1){const y=(Math.sign(g.lat+a)!==Math.sign(g.lat)?-Math.abs(g.lat):Math.abs(g.lat))*Math.PI/180,x=Math.abs(g.lat+a)*Math.PI/180,C=qu(y+c*(x-y)),z=qu(y),L=qu(x);return new l.V(g.lng+t*((C-z)/(L-z)),d)}return new l.V(g.lng+t*c,d)}class tm{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,a,c,d){const y=`${t.z}_${t.x}_${t.y}_${d?.terrain?"t":""}`,x=this._cache.get(y);if(x)return x;const C=this._cachePrevious.get(y);if(C)return this._cache.set(y,C),C;const z=this._boundingVolumeFactory(t,a,c,d);return this._cache.set(y,z),this._hadAnyChanges=!0,z}}class Xl{constructor(t,a,c,d){this.min=c,this.max=d,this.points=t,this.planes=a}static fromAabb(t,a){const c=[];for(let d=0;d<8;d++)c.push([1&~d?t[0]:a[0],(d>>1&1)==1?a[1]:t[1],(d>>2&1)==1?a[2]:t[2]]);return new Xl(c,[[-1,0,0,a[0]],[1,0,0,-t[0]],[0,-1,0,a[1]],[0,1,0,-t[1]],[0,0,-1,a[2]],[0,0,1,-t[2]]],t,a)}static fromCenterSizeAngles(t,a,c){const d=l.bB([],c[0],c[1],c[2]),y=l.bC([],[a[0],0,0],d),x=l.bC([],[0,a[1],0],d),C=l.bC([],[0,0,a[2]],d),z=[...t],L=[...t];for(let V=0;V<8;V++)for(let j=0;j<3;j++){const $=t[j]+y[j]*(1&~V?-1:1)+x[j]*((V>>1&1)==1?1:-1)+C[j]*((V>>2&1)==1?1:-1);z[j]=Math.min(z[j],$),L[j]=Math.max(L[j],$)}const k=[];for(let V=0;V<8;V++){const j=[...t];l.b0(j,j,l.a$([],y,1&~V?-1:1)),l.b0(j,j,l.a$([],x,(V>>1&1)==1?1:-1)),l.b0(j,j,l.a$([],C,(V>>2&1)==1?1:-1)),k.push(j)}return new Xl(k,[[...y,-l.b5(y,k[0])],[...x,-l.b5(x,k[0])],[...C,-l.b5(C,k[0])],[-y[0],-y[1],-y[2],-l.b5(y,k[7])],[-x[0],-x[1],-x[2],-l.b5(x,k[7])],[-C[0],-C[1],-C[2],-l.b5(C,k[7])]],z,L)}intersectsFrustum(t){let a=!0;const c=this.points.length,d=this.planes.length,y=t.planes.length,x=t.points.length;for(let C=0;C<y;C++){const z=t.planes[C];let L=0;for(let k=0;k<c;k++){const V=this.points[k];z[0]*V[0]+z[1]*V[1]+z[2]*V[2]+z[3]>=0&&L++}if(L===0)return 0;L<c&&(a=!1)}if(a)return 2;for(let C=0;C<d;C++){const z=this.planes[C];let L=0;for(let k=0;k<x;k++){const V=t.points[k];z[0]*V[0]+z[1]*V[1]+z[2]*V[2]+z[3]>=0&&L++}if(L===0)return 0}return 1}intersectsPlane(t){const a=this.points.length;let c=0;for(let d=0;d<a;d++){const y=this.points[d];t[0]*y[0]+t[1]*y[1]+t[2]*y[2]+t[3]>=0&&c++}return c===a?2:c===0?0:1}}function $u(g,t,a){const c=g-t;return c<0?-c:Math.max(0,c-a)}function Yl(g,t,a,c,d){const y=g-a;let x;return x=y<0?Math.min(-y,1+y-d):y>1?Math.min(Math.max(y-d,0),1-y):0,Math.max(x,$u(t,c,d))}class Qh{constructor(){this._boundingVolumeCache=new tm(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,a,c,d){const y=1<<c.z,x=1/y,C=c.x/y,z=c.y/y;let L=2;return L=Math.min(L,Yl(t,a,C,z,x)),L=Math.min(L,Yl(t,a,C+.5,-z-x,x)),L=Math.min(L,Yl(t,a,C+.5,2-z-x,x)),L}getWrap(t,a,c){const d=1<<a.z,y=1/d,x=a.x/d,C=$u(t.x,x,y),z=$u(t.x,x-1,y),L=$u(t.x,x+1,y),k=Math.min(C,z,L);return k===L?1:k===z?-1:0}allowVariableZoom(t,a){return ei(t,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,a,c,d){return this._boundingVolumeCache.getTileBoundingVolume(t,a,c,d)}_computeTileBoundingVolume(t,a,c,d){var y,x;let C=0,z=0;if(d?.terrain){const L=new l.a2(t.z,a,t.z,t.x,t.y),k=d.terrain.getMinMaxElevation(L);C=(y=k.minElevation)!==null&&y!==void 0?y:Math.min(0,c),z=(x=k.maxElevation)!==null&&x!==void 0?x:Math.max(0,c)}if(C/=l.bE,z/=l.bE,C+=1,z+=1,t.z<=0)return Xl.fromAabb([-z,-z,-z],[z,z,z]);if(t.z===1)return Xl.fromAabb([t.x===0?-z:0,t.y===0?0:-z,-z],[t.x===0?0:z,t.y===0?z:0,z]);{const L=[_o(0,0,t.x,t.y,t.z),_o(l.a5,0,t.x,t.y,t.z),_o(l.a5,l.a5,t.x,t.y,t.z),_o(0,l.a5,t.x,t.y,t.z)],k=[];for(const je of L)k.push(l.a$([],je,z));if(z!==C)for(const je of L)k.push(l.a$([],je,C));t.y===0&&k.push([0,1,0]),t.y===(1<<t.z)-1&&k.push([0,-1,0]);const V=[1,1,1],j=[-1,-1,-1];for(const je of k)for(let Ve=0;Ve<3;Ve++)V[Ve]=Math.min(V[Ve],je[Ve]),j[Ve]=Math.max(j[Ve],je[Ve]);const $=_o(l.a5/2,l.a5/2,t.x,t.y,t.z),W=l.b4([],[0,1,0],$);l.b3(W,W);const ae=l.b4([],$,W);l.b3(ae,ae);const se=l.b4([],L[2],L[1]);l.b3(se,se);const oe=l.b4([],L[0],L[3]);l.b3(oe,oe),k.push(l.a$([],$,z)),t.y>=(1<<t.z)/2&&k.push(l.a$([],_o(l.a5/2,0,t.x,t.y,t.z),z)),t.y<(1<<t.z)/2&&k.push(l.a$([],_o(l.a5/2,l.a5,t.x,t.y,t.z),z));const fe=Yc($,k),ye=Yc(ae,k),he=[-$[0],-$[1],-$[2],fe.max],_e=[$[0],$[1],$[2],-fe.min],we=[-ae[0],-ae[1],-ae[2],ye.max],ge=[ae[0],ae[1],ae[2],-ye.min],Ae=[...se,0],Ge=[...oe,0],Fe=[];return t.y===0?Fe.push(l.bD(Ge,Ae,he),l.bD(Ge,Ae,_e)):Fe.push(l.bD(we,Ae,he),l.bD(we,Ae,_e),l.bD(we,Ge,he),l.bD(we,Ge,_e)),t.y===(1<<t.z)-1?Fe.push(l.bD(Ge,Ae,he),l.bD(Ge,Ae,_e)):Fe.push(l.bD(ge,Ae,he),l.bD(ge,Ae,_e),l.bD(ge,Ge,he),l.bD(ge,Ge,_e)),new Xl(Fe,[he,_e,we,ge,Ae,Ge],V,j)}}}function Yc(g,t){let a=1/0,c=-1/0;for(const d of t){const y=l.b5(g,d);a=Math.min(a,y),c=Math.max(c,y)}return{min:a,max:c}}class Wl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,c){return this._helper.interpolatePadding(t,a,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a){this._helper.resize(t,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(t){this._cachedClippingPlane=l.bF(),this._projectionMatrix=l.bj(),this._globeViewProjMatrix32f=l.bi(),this._globeViewProjMatrixNoCorrection=l.bj(),this._globeViewProjMatrixNoCorrectionInverted=l.bj(),this._globeProjMatrixInverted=l.bj(),this._cameraPosition=l.bA(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(a,c)=>{const d=l.an(a.lat,-l.ao,l.ao),y=l.an(+c,this.minZoom+Si(0,d),this.maxZoom);return{center:new l.V(a.lng,d),zoom:y}},this.applyConstrain=(a,c)=>this._helper.applyConstrain(a,c),this._helper=new _s({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,c)=>this.defaultConstrain(a,c)},t),this._coveringTilesDetailsProvider=new Qh}clone(){const t=new Wl;return t.apply(this,!1),t}apply(t,a,c){this._globeLatitudeErrorCorrectionRadians=c||0,this._helper.apply(t,a)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=l.bA();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:a,applyGlobeMatrix:c}=t,d=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:d,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const a=this.pitchInRadians,c=this.cameraToCenterDistance/t,d=Math.sin(a)*c,y=Math.cos(a)*c+1,x=1/Math.sqrt(d*d+y*y)*1;let C=-d,z=y;const L=Math.sqrt(C*C+z*z);C/=L,z/=L;const k=[0,C,z];l.bG(k,k,[0,0,0],-this.bearingInRadians),l.bH(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),l.bI(k,k,[0,0,0],this.center.lng*Math.PI/180);const V=1/l.b7(k);return l.a$(k,k,V),[...k,-x*V]}isLocationOccluded(t){return!this.isSurfacePointVisible(ci(t))}transformLightDirection(t){const a=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,d=Math.cos(c),y=[Math.sin(a)*d,Math.sin(c),Math.cos(a)*d],x=[y[2],0,-y[0]],C=[0,0,0];l.b4(C,x,y),l.b3(x,x),l.b3(C,C);const z=[0,0,0];return l.b3(z,[x[0]*t[0]+C[0]*t[1]+y[0]*t[2],x[1]*t[0]+C[1]*t[1]+y[1]*t[2],x[2]*t[0]+C[2]*t[1]+y[2]*t[2]]),z}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,a,c){const d=(function(C,z,L){const k=1/(1<<L.z);return new l.a9(C/l.a5*k+L.x*k,z/l.a5*k+L.y*k)})(t,a,c.canonical),y=(x=d.y,[l.bz(d.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI]);var x;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(t,a,c,d){const y=c.canonical,x=_o(t,a,y.x,y.y,y.z),C=1+(d?d(t,a):0)/l.bE,z=[x[0]*C,x[1]*C,x[2]*C,1];l.aH(z,z,this._globeViewProjMatrixNoCorrection);const L=this._cachedClippingPlane,k=L[0]*x[0]+L[1]*x[1]+L[2]*x[2]+L[3]<0;return{point:new l.P(z[0]/z[3],z[1]/z[3]),signedDistanceFromCamera:z[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=tl(this.worldSize,this.center.lat),a=l.bk(),c=l.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),l.be(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const d=this.centerOffset;a[8]=2*-d.x/this._helper._width,a[9]=2*d.y/this._helper._height,this._projectionMatrix=l.bf(a),this._globeProjMatrixInverted=l.bk(),l.aB(this._globeProjMatrixInverted,a),l.O(a,a,[0,0,-this.cameraToCenterDistance]),l.bg(a,a,this.rollInRadians),l.bh(a,a,-this.pitchInRadians),l.bg(a,a,this.bearingInRadians),l.O(a,a,[0,0,-t]);const y=l.bA();y[0]=t,y[1]=t,y[2]=t,l.bh(c,a,this.center.lat*Math.PI/180),l.bJ(c,c,-this.center.lng*Math.PI/180),l.Q(c,c,y),this._globeViewProjMatrixNoCorrection=c,l.bh(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),l.bJ(a,a,-this.center.lng*Math.PI/180),l.Q(a,a,y),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=l.bk(),l.aB(this._globeViewProjMatrixNoCorrectionInverted,c);const x=l.bA();this._cameraPosition=l.bA(),this._cameraPosition[2]=this.cameraToCenterDistance/t,l.bG(this._cameraPosition,this._cameraPosition,x,-this.rollInRadians),l.bH(this._cameraPosition,this._cameraPosition,x,this.pitchInRadians),l.bG(this._cameraPosition,this._cameraPosition,x,-this.bearingInRadians),l.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),l.bH(this._cameraPosition,this._cameraPosition,x,-this.center.lat*Math.PI/180),l.bI(this._cameraPosition,this._cameraPosition,x,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const C=l.bf(this._globeViewProjMatrixNoCorrectionInverted);l.Q(C,C,[1,1,-1]),this._cachedFrustum=Lr.fromInvProjectionMatrix(C,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){l.w("calculateFogMatrix is not supported on globe projection.");const a=l.bk();return l.ar(a),a}getVisibleUnwrappedCoordinates(t){return[new l.bc(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&l.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=ci(t);l.a$(c,c,1+a/l.bE);const d=l.bF();return l.aH(d,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),d[2]/d[3]}populateCache(t){}getBounds(){const t=.5*this.width,a=.5*this.height,c=[new l.P(0,0),new l.P(t,0),new l.P(this.width,0),new l.P(this.width,a),new l.P(this.width,this.height),new l.P(t,this.height),new l.P(0,this.height),new l.P(0,a)],d=[];for(const V of c)d.push(this.unprojectScreenPoint(V));let y=0,x=0,C=0,z=0;const L=this.center;for(const V of d){const j=l.bK(L.lng,V.lng),$=l.bK(L.lat,V.lat);j<x&&(x=j),j>y&&(y=j),$<z&&(z=$),$>C&&(C=$)}const k=[L.lng+x,L.lat+z,L.lng+y,L.lat+C];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new Zn(k)}calculateCenterFromCameraLngLatAlt(t,a,c,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,c,d)}setLocationAtPoint(t,a){const c=ci(this.unprojectScreenPoint(a)),d=ci(t),y=l.bA();l.bL(y);const x=l.bA();l.bI(x,c,y,-this.center.lng*Math.PI/180),l.bH(x,x,y,this.center.lat*Math.PI/180);const C=d[0]*d[0]+d[2]*d[2],z=x[0]*x[0];if(C<z)return;const L=Math.sqrt(C-z),k=-L,V=l.bM(d[0],d[2],x[0],L),j=l.bM(d[0],d[2],x[0],k),$=l.bA();l.bI($,d,y,-V);const W=l.bM($[1],$[2],x[1],x[2]),ae=l.bA();l.bI(ae,d,y,-j);const se=l.bM(ae[1],ae[2],x[1],x[2]),oe=.5*Math.PI,fe=W>=-oe&&W<=oe,ye=se>=-oe&&se<=oe;let he,_e;if(fe&&ye){const Ge=this.center.lng*Math.PI/180,Fe=this.center.lat*Math.PI/180;l.bN(V,Ge)+l.bN(W,Fe)<l.bN(j,Ge)+l.bN(se,Fe)?(he=V,_e=W):(he=j,_e=se)}else if(fe)he=V,_e=W;else{if(!ye)return;he=j,_e=se}const we=he/Math.PI*180,ge=_e/Math.PI*180,Ae=this.center.lat;this.setCenter(new l.V(we,l.an(ge,-90,90))),this.setZoom(this.zoom+Si(Ae,this.center.lat))}locationToScreenPoint(t,a){const c=ci(t);if(a){const d=a.getElevationForLngLatZoom(t,this._helper._tileZoom);l.a$(c,c,1+d/l.bE)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(t){const a=l.bF();return l.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new l.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,a){if(a){const c=a.pointCoordinate(t);if(c)return c}return l.a9.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,a){var c;return(c=this.screenPointToMercatorCoordinate(t,a))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(t,a){const c=this._cameraPosition,d=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(c,d)}getRayDirectionFromPixel(t){const a=l.bF();a[0]=t.x/this.width*2-1,a[1]=-1*(t.y/this.height*2-1),a[2]=1,a[3]=1,l.aH(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const c=l.bA();c[0]=a[0]-this._cameraPosition[0],c[1]=a[1]-this._cameraPosition[1],c[2]=a[2]-this._cameraPosition[2];const d=l.bA();return l.b3(d,c),d}isSurfacePointVisible(t){const a=this._cachedClippingPlane;return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const a=l.bF();return l.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(t,a){const c=l.b5(t,a),d=l.bA(),y=l.bA();l.a$(y,a,c),l.b2(d,t,y);const x=1-l.b5(d,d);if(x<0)return null;const C=l.b5(t,t)-1,z=-c+(c<0?1:-1)*Math.sqrt(x),L=C/z,k=z;return{tMin:Math.min(L,k),tMax:Math.max(L,k)}}unprojectScreenPoint(t){const a=this._cameraPosition,c=this.getRayDirectionFromPixel(t),d=this.rayPlanetIntersection(a,c);if(d){const k=l.bA();l.b0(k,a,[c[0]*d.tMin,c[1]*d.tMin,c[2]*d.tMin]);const V=l.bA();return l.b3(V,k),Hc(V)}const y=this._cachedClippingPlane,x=y[0]*c[0]+y[1]*c[1]+y[2]*c[2],C=-l.bb(y,a)/x,z=l.bA();if(C>0)l.b0(z,a,[c[0]*C,c[1]*C,c[2]*C]);else{const k=l.bA();l.b0(k,a,[2*c[0],2*c[1],2*c[2]]);const V=l.bb(this._cachedClippingPlane,k);l.b2(z,k,[this._cachedClippingPlane[0]*V,this._cachedClippingPlane[1]*V,this._cachedClippingPlane[2]*V])}const L=(function(k){const V=l.bA();return V[0]=k[0]*-k[3],V[1]=k[1]*-k[3],V[2]=k[2]*-k[3],{center:V,radius:Math.sqrt(1-k[3]*k[3])}})(y);return Hc((function(k,V,j){const $=l.bA();l.b2($,j,k);const W=l.bA();return l.by(W,k,$,V/l.b9($)),W})(L.center,L.radius,z))}getMatrixForModel(t,a){const c=l.V.convert(t),d=1/l.bE,y=l.bj();return l.bJ(y,y,c.lng/180*Math.PI),l.bh(y,y,-c.lat/180*Math.PI),l.O(y,y,[0,0,1+a/l.bE]),l.bh(y,y,.5*Math.PI),l.Q(y,y,[d,d,d]),y}getProjectionDataForCustomLayer(t=!0){const a=this.getProjectionData({overscaledTileID:new l.a2(0,0,0,0,0),applyGlobeMatrix:t});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(t){}}class Kl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,c){return this._helper.interpolatePadding(t,a,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,c=!0){this._helper.resize(t,a,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,a){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(t){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(a,c)=>this.currentTransform.defaultConstrain(a,c),this.applyConstrain=(a,c)=>this._helper.applyConstrain(a,c),this._helper=new _s({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,c)=>this.defaultConstrain(a,c)},t),this._globeness=1,this._mercatorTransform=new Wi,this._verticalPerspectiveTransform=new Wl}clone(){const t=new Kl;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this,!1),t}apply(t,a){this._helper.apply(t,a),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const a=this._mercatorTransform.getProjectionData(t),c=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:a.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return l.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return l.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,a,c){const d=this._mercatorTransform.getPitchedTextCorrection(t,a,c),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,a,c);return l.bu(d,y,this._globeness)}projectTileCoordinates(t,a,c,d){return this.currentTransform.projectTileCoordinates(t,a,c,d)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){return this.currentTransform.lngLatToCameraDepth(t,a)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(t,a,c,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,c,d)}setLocationAtPoint(t,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,a),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(t,a),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(t,a){return this.currentTransform.locationToScreenPoint(t,a)}screenPointToMercatorCoordinate(t,a){return this.currentTransform.screenPointToMercatorCoordinate(t,a)}screenPointToLocation(t,a){return this.currentTransform.screenPointToLocation(t,a)}isPointOnMapSurface(t,a){return this.currentTransform.isPointOnMapSurface(t,a)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,a){return this.currentTransform.getMatrixForModel(t,a)}getProjectionDataForCustomLayer(t=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return a;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return c.fallbackMatrix=a.mainMatrix,c}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Ri{get useGlobeControls(){return!0}handlePanInertia(t,a){const c=vf(t,a);return Math.abs(c.lng-a.center.lng)>180&&(c.lng=a.center.lng+179.5*Math.sign(c.lng-a.center.lng)),{easingCenter:c,easingOffset:new l.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,a){const c=t.around,d=a.screenPointToLocation(c);t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta);const y=a.zoom;t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta);const x=a.zoom-y;if(x===0)return;const C=l.bK(a.center.lng,d.lng),z=C/(Math.abs(C/180)+1),L=l.bK(a.center.lat,d.lat),k=a.getRayDirectionFromPixel(c),V=a.cameraPosition,j=-1*l.b5(V,k),$=l.bA();l.b0($,V,[k[0]*j,k[1]*j,k[2]*j]);const W=l.b7($)-1,ae=Math.exp(.5*-Math.max(W-.3,0)),se=tl(a.worldSize,a.center.lat)/Math.min(a.width,a.height),oe=l.bx(se,.9,.5,1,.25),fe=(1-l.aq(-x))*Math.min(ae,oe),ye=a.center.lat,he=a.zoom,_e=new l.V(a.center.lng+z*fe,l.an(a.center.lat+L*fe,-l.ao,l.ao));a.setLocationAtPoint(d,c);const we=a.center,ge=l.bx(Math.abs(C),45,85,0,1),Ae=l.bx(se,.75,.35,0,1),Ge=Math.pow(Math.max(ge,Ae),.25),Fe=l.bK(we.lng,_e.lng),je=l.bK(we.lat,_e.lat);a.setCenter(new l.V(we.lng+Fe*Ge,we.lat+je*Ge).wrap()),a.setZoom(he+Si(ye,a.center.lat))}handleMapControlsPan(t,a,c){if(!t.panDelta)return;const d=a.center.lat,y=a.zoom;a.setCenter(vf(t.panDelta,a).wrap()),a.setZoom(y+Si(d,a.center.lat))}cameraForBoxAndBearing(t,a,c,d,y){const x=Qs(t,a,c,d,y),C=a.left/y.width*2-1,z=(y.width-a.right)/y.width*2-1,L=a.top/y.height*-2+1,k=(y.height-a.bottom)/y.height*-2+1,V=l.bK(c.getWest(),c.getEast())<0,j=V?c.getEast():c.getWest(),$=V?c.getWest():c.getEast(),W=Math.max(c.getNorth(),c.getSouth()),ae=Math.min(c.getNorth(),c.getSouth()),se=j+.5*l.bK(j,$),oe=W+.5*l.bK(W,ae),fe=y.clone();fe.setCenter(x.center),fe.setBearing(x.bearing),fe.setPitch(0),fe.setRoll(0),fe.setZoom(x.zoom);const ye=fe.modelViewProjectionMatrix,he=[ci(c.getNorthWest()),ci(c.getNorthEast()),ci(c.getSouthWest()),ci(c.getSouthEast()),ci(new l.V($,oe)),ci(new l.V(j,oe)),ci(new l.V(se,W)),ci(new l.V(se,ae))],_e=ci(x.center);let we=Number.POSITIVE_INFINITY;for(const ge of he)C<0&&(we=Ri.getLesserNonNegativeNonNull(we,Ri.solveVectorScale(ge,_e,ye,"x",C))),z>0&&(we=Ri.getLesserNonNegativeNonNull(we,Ri.solveVectorScale(ge,_e,ye,"x",z))),L>0&&(we=Ri.getLesserNonNegativeNonNull(we,Ri.solveVectorScale(ge,_e,ye,"y",L))),k<0&&(we=Ri.getLesserNonNegativeNonNull(we,Ri.solveVectorScale(ge,_e,ye,"y",k)));if(Number.isFinite(we)&&we!==0)return x.zoom=fe.zoom+l.at(we),x;Or()}handleJumpToCenterZoom(t,a){const c=t.center.lat,d=t.applyConstrain(a.center?l.V.convert(a.center):t.center,t.zoom).center;t.setCenter(d.wrap());const y=a.zoom!==void 0?+a.zoom:t.zoom+Si(c,d.lat);t.zoom!==y&&t.setZoom(y)}handleEaseTo(t,a){const c=t.zoom,d=t.center,y=t.padding,x={roll:t.roll,pitch:t.pitch,bearing:t.bearing},C={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},z=a.zoom!==void 0,L=!t.isPaddingEqual(a.padding);let k=!1;const V=a.center?l.V.convert(a.center):d,j=t.applyConstrain(V,c).center;go(t,j);const $=t.clone();$.setCenter(j),$.setZoom(z?+a.zoom:c+Si(d.lat,V.lat)),$.setBearing(a.bearing);const W=new l.P(l.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),l.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));$.setLocationAtPoint(j,W);const ae=(a.offset&&a.offsetAsPoint.mag())>0?$.center:j,se=z?+a.zoom:c+Si(d.lat,ae.lat),oe=c+Si(d.lat,0),fe=se+Si(ae.lat,0),ye=l.bK(d.lng,ae.lng),he=l.bK(d.lat,ae.lat),_e=l.aq(fe-oe);return k=se!==c,{easeFunc:we=>{if(l.bo(x,C)||qc({startEulerAngles:x,endEulerAngles:C,tr:t,k:we,useSlerp:x.roll!=C.roll}),L&&t.interpolatePadding(y,a.padding,we),a.around)l.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(a.around,a.aroundPoint);else{const ge=fe>oe?Math.min(2,_e):Math.max(.5,_e),Ae=Math.pow(ge,1-we),Ge=xf(d,ye,he,we*Ae);t.setCenter(Ge.wrap())}if(k){const ge=l.G.number(oe,fe,we)+Si(0,t.center.lat);t.setZoom(ge)}},isZooming:k,elevationCenter:ae}}handleFlyTo(t,a){const c=a.zoom!==void 0,d=t.center,y=t.zoom,x=t.padding,C=!t.isPaddingEqual(a.padding),z=t.applyConstrain(l.V.convert(a.center||a.locationAtOffset),y).center,L=c?+a.zoom:t.zoom+Si(t.center.lat,z.lat),k=t.clone();k.setCenter(z),k.setZoom(L),k.setBearing(a.bearing);const V=new l.P(l.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),l.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));k.setLocationAtPoint(z,V);const j=k.center;go(t,j);const $=(function(he,_e,we){const ge=ci(_e),Ae=ci(we),Ge=l.b5(ge,Ae),Fe=Math.acos(Ge),je=kr(he);return Fe/(2*Math.PI)*je})(t,d,j),W=y+Si(d.lat,0),ae=L+Si(j.lat,0),se=l.aq(ae-W);let oe;if(typeof a.minZoom=="number"){const he=+a.minZoom+Si(j.lat,0),_e=Math.min(he,W,ae)+Si(0,j.lat),we=t.applyConstrain(j,_e).zoom+Si(j.lat,0);oe=l.aq(we-W)}const fe=l.bK(d.lng,j.lng),ye=l.bK(d.lat,j.lat);return{easeFunc:(he,_e,we,ge)=>{const Ae=xf(d,fe,ye,we);C&&t.interpolatePadding(x,a.padding,he);const Ge=he===1?j:Ae;t.setCenter(Ge.wrap());const Fe=W+l.at(_e);t.setZoom(he===1?L:Fe+Si(0,Ge.lat))},scaleOfZoom:se,targetCenter:j,scaleOfMinZoom:oe,pixelPathLength:$}}static solveVectorScale(t,a,c,d,y){const x=d==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],C=[c[3],c[7],c[11],c[15]],z=t[0]*x[0]+t[1]*x[1]+t[2]*x[2],L=t[0]*C[0]+t[1]*C[1]+t[2]*C[2],k=a[0]*x[0]+a[1]*x[1]+a[2]*x[2],V=a[0]*C[0]+a[1]*C[1]+a[2]*C[2];return k+y*L===z+y*V||C[3]*(z-k)+x[3]*(V-L)+z*V==k*L?null:(k+x[3]-y*V-y*C[3])/(k-z-y*V+y*L)}static getLesserNonNegativeNonNull(t,a){return a!==null&&a>=0&&a<t?a:t}}class Ql{constructor(t){this._globe=t,this._mercatorCameraHelper=new Js,this._verticalPerspectiveCameraHelper=new Ri}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,a){return this.currentHelper.handlePanInertia(t,a)}handleMapControlsRollPitchBearingZoom(t,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,a)}handleMapControlsPan(t,a,c){this.currentHelper.handleMapControlsPan(t,a,c)}cameraForBoxAndBearing(t,a,c,d,y){return this.currentHelper.cameraForBoxAndBearing(t,a,c,d,y)}handleJumpToCenterZoom(t,a){this.currentHelper.handleJumpToCenterZoom(t,a)}handleEaseTo(t,a){return this.currentHelper.handleEaseTo(t,a)}handleFlyTo(t,a){return this.currentHelper.handleFlyTo(t,a)}}const Jl=(g,t)=>l.B(g,t&&t.filter((a=>a.identifier!=="source.canvas"))),ec=l.bO();class bs extends l.E{constructor(t,a={}){var c,d;super(),this._rtlPluginLoaded=()=>{for(const x in this.tileManagers){const C=this.tileManagers[x].getSource().type;C!=="vector"&&C!=="geojson"||this.tileManagers[x].reload()}},this.map=t,this.dispatcher=new $i(_n(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((x,C)=>this.getGlyphs(x,C))),this.dispatcher.registerMessageHandler("GI",((x,C)=>this.getImages(x,C))),this.dispatcher.registerMessageHandler("GDA",((x,C)=>this.getDashes(x,C))),this.imageManager=new Ot,this.imageManager.setEventedParent(this);const y=((c=t._container)===null||c===void 0?void 0:c.lang)||typeof document<"u"&&((d=document.documentElement)===null||d===void 0?void 0:d.lang)||void 0;this.glyphManager=new Xe(t._requestManager,a.localIdeographFontFamily,y),this.lineAtlas=new Tt(256,512),this.crossTileSymbolIndex=new er,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",l.bP()),K().on(De,this._rtlPluginLoaded),this.on("data",(x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const C=this.tileManagers[x.sourceId];if(!C)return;const z=C.getSource();if(z&&z.vectorLayerIds)for(const L in this._layers){const k=this._layers[L];k.source===z.id&&this._validateLayer(k)}}))}_setInitialValues(){var t;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new l.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((t=this.crossTileSymbolIndex)===null||t===void 0?void 0:t.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(t,a){var c,d,y;this._checkLoaded();const x=a===null?(y=(d=(c=this.stylesheet.state)===null||c===void 0?void 0:c[t])===null||d===void 0?void 0:d.default)!==null&&y!==void 0?y:null:a;if(l.bR(x,this._globalState[t]))return this;this._globalState[t]=x,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const a=[];for(const c in t)!l.bR(this._globalState[c],t[c].default)&&(a.push(c),this._globalState[c]=t[c].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(t){if(t.length===0)return;const a=new Set,c={};for(const d of t){c[d]=this._globalState[d];for(const y in this._layers){const x=this._layers[y],C=x.getLayoutAffectingGlobalStateRefs(),z=x.getPaintAffectingGlobalStateRefs(),L=x.getVisibilityAffectingGlobalStateRefs();if(C.has(d)&&a.add(x.source),z.has(d))for(const{name:k,value:V}of z.get(d))this._updatePaintProperty(x,k,V);L?.has(d)&&(x.recalculateVisibility(),this._updateLayer(x))}}this.dispatcher.broadcast("UGS",c);for(const d in this.tileManagers)a.has(d)&&(this._reloadSource(d),this._changed=!0)}loadURL(t,a={},c){this.fire(new l.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;l.j(d,this._loadStyleRequest).then((x=>{this._loadStyleRequest=null,this._load(x.data,a,c)})).catch((x=>{this._loadStyleRequest=null,x&&!y.signal.aborted&&this.fire(new l.k(x))}))}loadJSON(t,a={},c){this.fire(new l.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ce.frameAsync(this._frameRequest,this.map._ownerWindow).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,c)})).catch((()=>{}))}loadEmpty(){this.fire(new l.l("dataloading",{dataType:"style"})),this._load(ec,{validate:!1})}_load(t,a,c){var d,y;let x=a.transformStyle?a.transformStyle(c,t):t;if(!a.validate||!Jl(this,l.C(x))){x=Object.assign({},x),this._loaded=!0,this.stylesheet=x;for(const C in x.sources)this.addSource(C,x.sources[C],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new It(this.stylesheet.light),this._setProjectionInternal(((d=this.stylesheet.projection)===null||d===void 0?void 0:d.type)||"mercator"),this.sky=new rt(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new l.l("data",{dataType:"style"})),this.fire(new l.l("style.load"))}}_createLayers(){var t,a,c;const d=l.bS(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",d),this._order=d.map((y=>y.id)),this._layers={},this._serializedLayers=null;for(const y of d){const x=l.bT(y,this._globalState);if(x.setEventedParent(this,{layer:{id:y.id}}),this._layers[y.id]=x,l.bU(x)&&this.tileManagers[x.source]){const C=(c=(a=y.paint)===null||a===void 0?void 0:a["raster-fade-duration"])!==null&&c!==void 0?c:x.paint.get("raster-fade-duration");this.tileManagers[x.source].setRasterFadeDuration(C)}}}_loadSprite(t,a=!1,c=void 0){this.imageManager.setLoaded(!1);const d=new AbortController;let y;this._spriteRequest=d,(function(x,C,z,L){return l._(this,void 0,void 0,(function*(){const k=Pt(x),V=z>1?"@2x":"",j={},$={};for(const{id:W,url:ae}of k){const se=C.transformRequest(Rt(ae,V,".json"),"SpriteJSON");j[W]=l.j(se,L);const oe=C.transformRequest(Rt(ae,V,".png"),"SpriteImage");$[W]=Qe.getImage(oe,L)}return yield Promise.all([...Object.values(j),...Object.values($)]),(function(W,ae){return l._(this,void 0,void 0,(function*(){const se={};for(const oe in W){se[oe]={};const fe=ce.getImageCanvasContext((yield ae[oe]).data),ye=(yield W[oe]).data;for(const he in ye){const{width:_e,height:we,x:ge,y:Ae,sdf:Ge,pixelRatio:Fe,stretchX:je,stretchY:Ve,content:vt,textFitWidth:xt,textFitHeight:ct}=ye[he];se[oe][he]={data:null,pixelRatio:Fe,sdf:Ge,stretchX:je,stretchY:Ve,content:vt,textFitWidth:xt,textFitHeight:ct,spriteData:{width:_e,height:we,x:ge,y:Ae,context:fe}}}}return se}))})(j,$)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((x=>{if(this._spriteRequest=null,x)for(const C in x){this._spritesImagesIds[C]=[];const z=this._spritesImagesIds[C]?this._spritesImagesIds[C].filter((L=>!(L in x))):[];for(const L of z)this.imageManager.removeImage(L),this._changedImages[L]=!0;for(const L in x[C]){const k=C==="default"?L:`${C}:${L}`;this._spritesImagesIds[C].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,x[C][L],!1):this.imageManager.addImage(k,x[C][L]),a&&(this._changedImages[k]=!0)}}})).catch((x=>{this._spriteRequest=null,y=x,d.signal.aborted||this.fire(new l.k(y))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"})),c&&c(y)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}_validateLayer(t){const a=this.tileManagers[t.source];if(!a)return;const c=t.sourceLayer;if(!c)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(c)===-1)&&this.fire(new l.k(new Error(`Source layer "${c}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.tileManagers)if(!this.tileManagers[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const c=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?l.bV(c):c);const d=[];for(const y of t)if(c[y]){const x=a?l.bV(c[y]):c[y];d.push(x)}return d}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const c of a){const d=this._layers[c];d.type!=="custom"&&(t[c]=d.serialize())}return t}hasTransitions(){var t,a,c;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const d in this.tileManagers)if(this.tileManagers[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const d=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(d.length||y.length)&&this._updateWorkerLayers(d,y);for(const x in this._updatedSources){const C=this._updatedSources[x];if(C==="reload")this._reloadSource(x);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const c={};for(const d in this.tileManagers){const y=this.tileManagers[d];c[d]=y.used,y.used=!1}for(const d of this._order){const y=this._layers[d];y.recalculate(t,this._availableImages),!y.isHidden(t.zoom)&&y.source&&(this.tileManagers[y.source].used=!0)}for(const d in c){const y=this.tileManagers[d];!!c[d]!=!!y.used&&y.fire(new l.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,a&&this.fire(new l.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.tileManagers)this.tileManagers[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var c;this._checkLoaded();const d=this.serialize();if(t=a.transformStyle?a.transformStyle(d,t):t,((c=a.validate)===null||c===void 0||c)&&Jl(this,l.C(t)))return!1;(t=l.bV(t)).layers=l.bS(t.layers);const y=l.bW(d,t),x=this._getOperationsToPerform(y);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const C of x.operations)C();return this.stylesheet=t,this._serializedLayers=null,this.fire(new l.l("style.load",{style:this})),!0}_getOperationsToPerform(t){const a=[],c=[];for(const d of t)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,d.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,d.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,d.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,d.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,d.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,d.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,d.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,d.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,d.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,d.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,d.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,d.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,d.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,d.args)));break;case"setProjection":this.setProjection.apply(this,d.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,d.args)));break;case"setTransition":a.push((()=>{}));break;default:c.push(d.command)}return{operations:a,unimplemented:c}}addImage(t,a){if(this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,c={}){if(this._checkLoaded(),this.tileManagers[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(l.C.source,`sources.${t}`,a,null,c))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.tileManagers[t]=new vn(t,a,this.dispatcher);d.style=this,d.setEventedParent(this,(()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t}))),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new l.k(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const a=this.tileManagers[t];delete this.tileManagers[t],delete this._updatedSources[t],a.fire(new l.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.tileManagers[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(a),this._changed=!0}getSource(t){return this.tileManagers[t]&&this.tileManagers[t].getSource()}addLayer(t,a,c={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new l.k(new Error(`Layer "${d}" already exists on this map.`)));let y;if(t.type==="custom"){if(Jl(this,l.bX(t)))return;y=l.bT(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=l.bV(t),t=l.e(t,{source:d})),this._validate(l.C.layer,`layers.${d}`,t,{arrayIndex:-1},c))return;y=l.bT(t,this._globalState),this._validateLayer(y),y.setEventedParent(this,{layer:{id:d}})}const x=a?this._order.indexOf(a):this._order.length;if(a&&x===-1)this.fire(new l.k(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=y,this._removedLayers[d]&&y.source&&y.type!=="custom"){const C=this._removedLayers[d];delete this._removedLayers[d],C.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.tileManagers[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const c=this._order.indexOf(t);this._order.splice(c,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new l.k(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new l.k(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,c){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===a&&d.maxzoom===c||(a!=null&&(d.minzoom=a),c!=null&&(d.maxzoom=c),this._updateLayer(d)):this.fire(new l.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,c={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!l.bR(d.filter,a))return a==null?(d.setFilter(void 0),void this._updateLayer(d)):void(this._validate(l.C.filter,`layers.${d.id}.filter`,a,null,c)||(d.setFilter(l.bV(a)),this._updateLayer(d)))}else this.fire(new l.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.bV(this.getLayer(t).filter)}setLayoutProperty(t,a,c,d={}){this._checkLoaded();const y=this.getLayer(t);y?l.bR(y.getLayoutProperty(a),c)||(y.setLayoutProperty(a,c,d),this._updateLayer(y)):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const c=this.getLayer(t);if(c)return c.getLayoutProperty(a);this.fire(new l.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,c,d={}){this._checkLoaded();const y=this.getLayer(t);y?l.bR(y.getPaintProperty(a),c)||this._updatePaintProperty(y,a,c,d):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,a,c,d={}){t.setPaintProperty(a,c,d)&&this._updateLayer(t),l.bU(t)&&a==="raster-fade-duration"&&this.tileManagers[t.source].setRasterFadeDuration(c),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const c=t.source,d=t.sourceLayer,y=this.tileManagers[c];if(y===void 0)return void this.fire(new l.k(new Error(`The source '${c}' does not exist in the map's style.`)));const x=y.getSource().type;x==="geojson"&&d?this.fire(new l.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),y.setFeatureState(d,t.id,a)):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const c=t.source,d=this.tileManagers[c];if(d===void 0)return void this.fire(new l.k(new Error(`The source '${c}' does not exist in the map's style.`)));const y=d.getSource().type,x=y==="vector"?t.sourceLayer:void 0;y!=="vector"||x?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.k(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,t.id,a):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,c=t.sourceLayer,d=this.tileManagers[a];if(d!==void 0)return d.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),d.getFeatureState(c,t.id)):void this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=l.bY(this.tileManagers,(y=>y.serialize())),a=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,d=this.stylesheet;return l.bZ({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,projection:d.projection,sources:t,layers:a,terrain:c},(y=>y!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.tileManagers[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.tileManagers[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=x=>this._layers[x].type==="fill-extrusion",c={},d=[];for(let x=this._order.length-1;x>=0;x--){const C=this._order[x];if(a(C)){c[C]=x;for(const z of t){const L=z[C];if(L)for(const k of L)d.push(k)}}}d.sort(((x,C)=>C.intersectionZ-x.intersectionZ));const y=[];for(let x=this._order.length-1;x>=0;x--){const C=this._order[x];if(a(C))for(let z=d.length-1;z>=0;z--){const L=d[z].feature;if(c[L.layer.id]<x)break;y.push(L),d.pop()}else for(const z of t){const L=z[C];if(L)for(const k of L)y.push(k.feature)}}return y}queryRenderedFeatures(t,a,c){a&&a.filter&&this._validate(l.C.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new l.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const L of a.layers){const k=this._layers[L];if(!k)return this.fire(new l.k(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];d[k.source]=!0}}const y=[];a.availableImages=this._availableImages;const x=this._serializedAllLayers(),C=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,z=Object.assign(Object.assign({},a),{layers:C,globalState:this._globalState});for(const L in this.tileManagers)a.layers&&!d[L]||y.push(ya(this.tileManagers[L],this._layers,x,t,z,c,this.map.terrain?(k,V,j)=>this.map.terrain.getElevation(k,V,j):void 0));return this.placement&&y.push((function(L,k,V,j,$,W,ae){const se={},oe=W.queryRenderedSymbols(j),fe=[];for(const ye of Object.keys(oe).map(Number))fe.push(ae[ye]);fe.sort(Pn);for(const ye of fe){const he=ye.featureIndex.lookupSymbolFeatures(oe[ye.bucketInstanceId],k,ye.bucketIndex,ye.sourceLayerIndex,{filterSpec:$.filter,globalState:$.globalState},$.layers,$.availableImages,L);for(const _e in he){const we=se[_e]=se[_e]||[],ge=he[_e];ge.sort(((Ae,Ge)=>{const Fe=ye.featureSortOrder;if(Fe){const je=Fe.indexOf(Ae.featureIndex);return Fe.indexOf(Ge.featureIndex)-je}return Ge.featureIndex-Ae.featureIndex}));for(const Ae of ge)we.push(Ae)}}return(function(ye,he,_e){for(const we in ye)for(const ge of ye[we])Zi(ge,_e[he[we].source]);return ye})(se,L,V)})(this._layers,x,this.tileManagers,t,z,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(t,a){a?.filter&&this._validate(l.C.filter,"querySourceFeatures.filter",a.filter,null,a);const c=this.tileManagers[t];return c?(function(d,y){const x=d.getRenderableIds().map((L=>d.getTileByID(L))),C=[],z={};for(let L=0;L<x.length;L++){const k=x[L],V=k.tileID.canonical.key;z[V]||(z[V]=!0,k.querySourceFeatures(C,y))}return C})(c,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const c=this.light.getLight();let d=!1;for(const x in t)if(!l.bR(t[x],c[x])){d=!0;break}if(!d)return;const y={now:xe(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(y)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){this._checkLoaded();const c=this.getSky();let d=!1;if(!t&&!c)return;if(t&&!c)d=!0;else if(!t&&c)d=!0;else for(const x in t)if(!l.bR(t[x],c[x])){d=!0;break}if(!d)return;const y={now:xe(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(y)}_setProjectionInternal(t){const a=(function(c,d){const y={constrainOverride:d};if(Array.isArray(c)){const x=new Kh({type:c});return{projection:x,transform:new Kl(y),cameraHelper:new Ql(x)}}switch(c){case"mercator":return{projection:new tr,transform:new Wi(y),cameraHelper:new Js};case"globe":{const x=new Kh({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:x,transform:new Kl(y),cameraHelper:new Ql(x)}}case"vertical-perspective":return{projection:new Wh,transform:new Wl(y),cameraHelper:new Ri};default:return l.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new tr,transform:new Wi(y),cameraHelper:new Js}}})(t,this.map.transformConstrain);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const c in this.tileManagers)this.tileManagers[c].reload()}_validate(t,a,c,d,y={}){return(!y||y.validate!==!1)&&Jl(this,t.call(l.C,l.e({key:a,style:this.serialize(),value:c,styleSpec:l.u},d)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),K().off(De,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.tileManagers){const c=this.tileManagers[a];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.tileManagers[t].clearTiles()}_reloadSource(t){this.tileManagers[t].resume(),this.tileManagers[t].reload()}_updateSources(t){for(const a in this.tileManagers)this.tileManagers[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.tileManagers)this._reloadSource(t)}_updatePlacement(t,a,c,d,y=!1){let x=!1,C=!1;const z={};for(const L of this._order){const k=this._layers[L];if(k.type!=="symbol")continue;if(!z[k.source]){const j=this.tileManagers[k.source];z[k.source]=j.getRenderableIds(!0).map(($=>j.getTileByID($))).sort((($,W)=>W.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(W.tileID)?-1:1)))}const V=this.crossTileSymbolIndex.addLayer(k,z[k.source],t.center.lng);x=x||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(xe(),t.zoom))&&(this.pauseablePlacement=new Hl(t,this.map.terrain,this._order,y,a,c,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(xe()),C=!0),x&&this.pauseablePlacement.placement.setStale()),C||x)for(const L of this._order){const k=this._layers[L];k.type==="symbol"&&this.placement.updateLayerOpacities(k,z[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(xe())}_releaseSymbolFadeTiles(){for(const t in this.tileManagers)this.tileManagers[t].releaseSymbolFadeTiles()}getImages(t,a){return l._(this,void 0,void 0,(function*(){const c=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const d=this.tileManagers[a.source];return d&&d.setDependencies(a.tileID.key,a.type,a.icons),c}))}getGlyphs(t,a){return l._(this,void 0,void 0,(function*(){const c=yield this.glyphManager.getGlyphs(a.stacks),d=this.tileManagers[a.source];return d&&d.setDependencies(a.tileID.key,a.type,[""]),c}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(l.C.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,a){return l._(this,void 0,void 0,(function*(){const c={};for(const[d,y]of Object.entries(a.dashes))c[d]=this.lineAtlas.getDash(y.dasharray,y.round);return c}))}addSprite(t,a,c={},d){this._checkLoaded();const y=[{id:t,url:a}],x=[...Pt(this.stylesheet.sprite),...y];this._validate(l.C.sprite,"sprite",x,null,c)||(this.stylesheet.sprite=x,this._loadSprite(y,!0,d))}removeSprite(t){this._checkLoaded();const a=Pt(this.stylesheet.sprite);if(a.find((c=>c.id===t))){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;a.splice(a.findIndex((c=>c.id===t)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}else this.fire(new l.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Pt(this.stylesheet.sprite)}setSprite(t,a={},c){this._checkLoaded(),t&&this._validate(l.C.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const t in this.tileManagers){const a=this.tileManagers[t];a.setEventedParent(null),a.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const t in this._layers){const a=this._layers[t];a.setEventedParent(null),a.onRemove&&a.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var bf=l.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Wc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,c,d,y,x,C,z,L){this.context=t;let k=this.boundPaintVertexBuffers.length!==d.length;for(let V=0;!k&&V<d.length;V++)this.boundPaintVertexBuffers[V]!==d[V]&&(k=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==c||k||this.boundIndexBuffer!==y||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==z||this.boundDynamicVertexBuffer3!==L?this.freshBind(a,c,d,y,x,C,z,L):(t.bindVertexArray.set(this.vao),C&&C.bind(),y&&y.dynamicDraw&&y.bind(),z&&z.bind(),L&&L.bind())}freshBind(t,a,c,d,y,x,C,z){const L=t.numAttributes,k=this.context,V=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=z,a.enableAttributes(V,t);for(const j of c)j.enableAttributes(V,t);x&&x.enableAttributes(V,t),C&&C.enableAttributes(V,t),z&&z.enableAttributes(V,t),a.bind(),a.setVertexAttribPointers(V,t,y);for(const j of c)j.bind(),j.setVertexAttribPointers(V,t,y);x&&(x.bind(),x.setVertexAttribPointers(V,t,y)),d&&d.bind(),C&&(C.bind(),C.setVertexAttribPointers(V,t,y)),z&&(z.bind(),z.setVertexAttribPointers(V,t,y)),k.currentNumAttributes=L}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const wf=(g,t,a,c,d)=>({u_texture:0,u_ele_delta:g,u_fog_matrix:t,u_fog_color:a?a.properties.get("fog-color"):l.bp.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?0:a?a.calculateFogBlendOpacity(c):0,u_horizon_color:a?a.properties.get("horizon-color"):l.bp.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:d?1:0}),Ha={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Zu(g){const t=[];for(let a=0;a<g.length;a++){if(g[a]===null)continue;const c=g[a].split(" ");t.push(c.pop())}return t}class Sf{constructor(t,a,c,d,y,x,C,z,L=[]){const k=t.gl;this.program=k.createProgram();const V=Zu(a.staticAttributes),j=c?c.getBinderAttributes():[],$=V.concat(j),W=si.prelude.staticUniforms?Zu(si.prelude.staticUniforms):[],ae=C.staticUniforms?Zu(C.staticUniforms):[],se=a.staticUniforms?Zu(a.staticUniforms):[],oe=c?c.getBinderUniforms():[],fe=W.concat(ae).concat(se).concat(oe),ye=[];for(const Fe of fe)ye.indexOf(Fe)<0&&ye.push(Fe);const he=c?c.defines():[];Sa(k)&&he.unshift("#version 300 es"),y&&he.push("#define OVERDRAW_INSPECTOR;"),x&&he.push("#define TERRAIN3D;"),z&&he.push(z),L&&he.push(...L);let _e=he.concat(si.prelude.fragmentSource,C.fragmentSource,a.fragmentSource).join(`
`),we=he.concat(si.prelude.vertexSource,C.vertexSource,a.vertexSource).join(`
`);Sa(k)||(_e=(function(Fe){return Fe.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(_e),we=(function(Fe){return Fe.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(we));const ge=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(ge,_e),k.compileShader(ge),!k.getShaderParameter(ge,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(ge)}`);k.attachShader(this.program,ge);const Ae=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(Ae,we),k.compileShader(Ae),!k.getShaderParameter(Ae,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(Ae)}`);k.attachShader(this.program,Ae),this.attributes={};const Ge={};this.numAttributes=$.length;for(let Fe=0;Fe<this.numAttributes;Fe++)$[Fe]&&(k.bindAttribLocation(this.program,Fe,$[Fe]),this.attributes[$[Fe]]=Fe);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(Ae),k.deleteShader(ge);for(let Fe=0;Fe<ye.length;Fe++){const je=ye[Fe];if(je&&!Ge[je]){const Ve=k.getUniformLocation(this.program,je);Ve&&(Ge[je]=Ve)}}this.fixedUniforms=d(t,Ge),this.terrainUniforms=((Fe,je)=>({u_depth:new l.b_(Fe,je.u_depth),u_terrain:new l.b_(Fe,je.u_terrain),u_terrain_dim:new l.bq(Fe,je.u_terrain_dim),u_terrain_matrix:new l.c0(Fe,je.u_terrain_matrix),u_terrain_unpack:new l.c1(Fe,je.u_terrain_unpack),u_terrain_exaggeration:new l.bq(Fe,je.u_terrain_exaggeration)}))(t,Ge),this.projectionUniforms=((Fe,je)=>({u_projection_matrix:new l.c0(Fe,je.u_projection_matrix),u_projection_tile_mercator_coords:new l.c1(Fe,je.u_projection_tile_mercator_coords),u_projection_clipping_plane:new l.c1(Fe,je.u_projection_clipping_plane),u_projection_transition:new l.bq(Fe,je.u_projection_transition),u_projection_fallback_matrix:new l.c0(Fe,je.u_projection_fallback_matrix)}))(t,Ge),this.binderUniforms=c?c.getUniforms(t,Ge):[]}draw(t,a,c,d,y,x,C,z,L,k,V,j,$,W,ae,se,oe,fe,ye){const he=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(d),t.setColorMode(y),t.setCullFace(x),z){t.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,z.depthTexture),t.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,z.texture);for(const we in this.terrainUniforms)this.terrainUniforms[we].set(z[we])}if(L)for(const we in L)this.projectionUniforms[Ha[we]].set(L[we]);if(C)for(const we in this.fixedUniforms)this.fixedUniforms[we].set(C[we]);se&&se.setUniforms(t,this.binderUniforms,W,{zoom:ae});let _e=0;switch(a){case he.LINES:_e=2;break;case he.TRIANGLES:_e=3;break;case he.LINE_STRIP:_e=1}for(const we of $.get()){const ge=we.vaos||(we.vaos={});(ge[k]||(ge[k]=new Wc)).bind(t,this,V,se?se.getPaintVertexBuffers():[],j,we.vertexOffset,oe,fe,ye),he.drawElements(a,we.primitiveLength*_e,he.UNSIGNED_SHORT,we.primitiveOffset*_e*2)}}}function Tf(g,t,a){const c=1/l.aN(a,1,t.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),y=a.tileSize*Math.pow(2,t.transform.tileZoom)/d,x=y*(a.tileID.canonical.x+a.tileID.wrap*d),C=y*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[c,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[x>>16,C>>16],u_pixel_coord_lower:[65535&x,65535&C]}}const Hu=(g,t,a,c)=>{const d=g.style.light,y=d.properties.get("position"),x=[y.x,y.y,y.z],C=l.c4();d.properties.get("anchor")==="viewport"&&l.c5(C,g.transform.bearingInRadians),l.c6(x,x,C);const z=g.transform.transformLightDirection(x),L=d.properties.get("color");return{u_lightpos:x,u_lightpos_globe:z,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+t,u_opacity:a,u_fill_translate:c}},Xu=(g,t,a,c,d,y,x)=>l.e(Hu(g,t,a,c),Tf(y,g,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8}),nl=(g,t,a,c)=>l.e(Tf(t,g,a),{u_fill_translate:c}),tc=(g,t)=>({u_world:g,u_fill_translate:t}),Ef=(g,t,a,c,d)=>l.e(nl(g,t,a,d),{u_world:c}),Kc=(g,t,a,c,d)=>{const y=g.transform;let x,C,z=0;if(a.paint.get("circle-pitch-alignment")==="map"){const L=l.aN(t,1,y.zoom);x=!0,C=[L,L],z=L/(l.a5*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*d}else x=!1,C=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+x,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:C,u_globe_extrude_scale:z,u_translate:c}},ws=g=>({u_pixel_extrude_scale:[1/g.width,1/g.height]}),Jh=g=>({u_viewport_size:[g.width,g.height]}),Qc=(g,t=1)=>({u_color:g,u_overlay:0,u_overlay_scale:t}),Ss=(g,t,a,c)=>{const d=l.aN(g,1,t)/(l.a5*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:l.aN(g,1,t),u_intensity:a,u_globe_extrude_scale:d}},ed=(g,t,a,c)=>{const d=l.N();l.c7(d,0,g.width,g.height,0,0,1);const y=g.context.gl;return{u_matrix:d,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:a,u_color_ramp:c,u_opacity:t.paint.get("heatmap-opacity")}},Jc=(g,t,a)=>{const c=a.paint.get("hillshade-accent-color");let d;switch(a.paint.get("hillshade-method")){case"basic":d=4;break;case"combined":d=1;break;case"igor":d=2;break;case"multidirectional":d=3;break;default:d=0}const y=a.getIlluminationProperties();for(let x=0;x<y.directionRadians.length;x++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(y.directionRadians[x]+=g.transform.bearingInRadians);return{u_image:0,u_latrange:nm(0,t.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:y.altitudeRadians,u_azimuths:y.directionRadians,u_accent:c,u_method:d,u_highlights:y.highlightColor,u_shadows:y.shadowColor}},Cf=(g,t)=>{const a=t.stride,c=l.N();return l.c7(c,0,l.a5,-l.a5,0,0,1),l.O(c,c,[0,-l.a5,0]),{u_matrix:c,u_image:1,u_dimension:[a,a],u_zoom:g.overscaledZ,u_unpack:t.getUnpackVector()}};function nm(g,t){const a=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new l.a9(0,c/a).toLngLat().lat,new l.a9(0,(c+1)/a).toLngLat().lat]}const Mf=(g,t,a=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:g.paint.get("color-relief-opacity")}),eu=(g,t,a,c)=>{const d=g.transform;return{u_translation:tu(g,t,a),u_ratio:c/l.aN(t,1,d.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Af=(g,t,a,c,d)=>l.e(eu(g,t,a,c),{u_image:0,u_image_height:d}),td=(g,t,a,c,d)=>{const y=g.transform,x=Ta(t,y);return{u_translation:tu(g,t,a),u_texsize:t.imageAtlasTexture.size,u_ratio:c/l.aN(t,1,y.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[x,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Vr=(g,t,a,c,d)=>{const y=Ta(t,g.transform);return l.e(eu(g,t,a,c),{u_tileratio:y,u_crossfade_from:d.fromScale,u_crossfade_to:d.toScale,u_image:0,u_mix:d.t,u_lineatlas_width:g.lineAtlas.width,u_lineatlas_height:g.lineAtlas.height})},Ts=(g,t,a,c,d,y)=>{const x=Ta(t,g.transform);return l.e(eu(g,t,a,c),{u_image:0,u_image_height:y,u_tileratio:x,u_crossfade_from:d.fromScale,u_crossfade_to:d.toScale,u_image_dash:1,u_mix:d.t,u_lineatlas_width:g.lineAtlas.width,u_lineatlas_height:g.lineAtlas.height})};function Ta(g,t){return 1/l.aN(g,1,t.tileZoom)}function tu(g,t,a){return l.aO(g.transform,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Yu=(g,t,a,c,d)=>{return{u_tl_parent:g,u_scale_parent:t,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(x=c.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(y=c.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Wu(c.paint.get("raster-hue-rotate")),u_coords_top:[d[0].x,d[0].y,d[1].x,d[1].y],u_coords_bottom:[d[3].x,d[3].y,d[2].x,d[2].y]};var y,x};function Wu(g){g*=Math.PI/180;const t=Math.sin(g),a=Math.cos(g);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const nu=(g,t,a,c,d,y,x,C,z,L,k,V,j)=>{const $=x.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:$.width/$.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_label_plane_matrix:C,u_coord_matrix:z,u_is_text:+k,u_pitch_with_map:+c,u_is_along_line:d,u_is_variable_anchor:y,u_texsize:V,u_texture:0,u_translation:L,u_pitched_scale:j}},Ku=(g,t,a,c,d,y,x,C,z,L,k,V,j,$)=>{const W=x.transform;return l.e(nu(g,t,a,c,d,y,x,C,z,L,k,V,$),{u_gamma_scale:c?Math.cos(W.pitch*Math.PI/180)*W.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:1})},Ea=(g,t,a,c,d,y,x,C,z,L,k,V,j)=>l.e(Ku(g,t,a,c,d,y,x,C,z,L,!0,k,0,j),{u_texsize_icon:V,u_texture_icon:1}),iu=(g,t)=>({u_opacity:g,u_color:t}),ru=(g,t,a,c,d)=>l.e((function(y,x,C,z){const L=C.imageManager.getPattern(y.from.toString()),k=C.imageManager.getPattern(y.to.toString()),{width:V,height:j}=C.imageManager.getPixelSize(),$=Math.pow(2,z.tileID.overscaledZ),W=z.tileSize*Math.pow(2,C.transform.tileZoom)/$,ae=W*(z.tileID.canonical.x+z.tileID.wrap*$),se=W*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[V,j],u_mix:x.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/l.aN(z,1,C.transform.tileZoom),u_pixel_coord_upper:[ae>>16,se>>16],u_pixel_coord_lower:[65535&ae,65535&se]}})(a,d,t,c),{u_opacity:g}),Qu=(g,t)=>{},zf={fillExtrusion:(g,t)=>({u_lightpos:new l.c2(g,t.u_lightpos),u_lightpos_globe:new l.c2(g,t.u_lightpos_globe),u_lightintensity:new l.bq(g,t.u_lightintensity),u_lightcolor:new l.c2(g,t.u_lightcolor),u_vertical_gradient:new l.bq(g,t.u_vertical_gradient),u_opacity:new l.bq(g,t.u_opacity),u_fill_translate:new l.c3(g,t.u_fill_translate)}),fillExtrusionPattern:(g,t)=>({u_lightpos:new l.c2(g,t.u_lightpos),u_lightpos_globe:new l.c2(g,t.u_lightpos_globe),u_lightintensity:new l.bq(g,t.u_lightintensity),u_lightcolor:new l.c2(g,t.u_lightcolor),u_vertical_gradient:new l.bq(g,t.u_vertical_gradient),u_height_factor:new l.bq(g,t.u_height_factor),u_opacity:new l.bq(g,t.u_opacity),u_fill_translate:new l.c3(g,t.u_fill_translate),u_image:new l.b_(g,t.u_image),u_texsize:new l.c3(g,t.u_texsize),u_pixel_coord_upper:new l.c3(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.c3(g,t.u_pixel_coord_lower),u_scale:new l.c2(g,t.u_scale),u_fade:new l.bq(g,t.u_fade)}),fill:(g,t)=>({u_fill_translate:new l.c3(g,t.u_fill_translate)}),fillPattern:(g,t)=>({u_image:new l.b_(g,t.u_image),u_texsize:new l.c3(g,t.u_texsize),u_pixel_coord_upper:new l.c3(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.c3(g,t.u_pixel_coord_lower),u_scale:new l.c2(g,t.u_scale),u_fade:new l.bq(g,t.u_fade),u_fill_translate:new l.c3(g,t.u_fill_translate)}),fillOutline:(g,t)=>({u_world:new l.c3(g,t.u_world),u_fill_translate:new l.c3(g,t.u_fill_translate)}),fillOutlinePattern:(g,t)=>({u_world:new l.c3(g,t.u_world),u_image:new l.b_(g,t.u_image),u_texsize:new l.c3(g,t.u_texsize),u_pixel_coord_upper:new l.c3(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.c3(g,t.u_pixel_coord_lower),u_scale:new l.c2(g,t.u_scale),u_fade:new l.bq(g,t.u_fade),u_fill_translate:new l.c3(g,t.u_fill_translate)}),circle:(g,t)=>({u_camera_to_center_distance:new l.bq(g,t.u_camera_to_center_distance),u_scale_with_map:new l.b_(g,t.u_scale_with_map),u_pitch_with_map:new l.b_(g,t.u_pitch_with_map),u_extrude_scale:new l.c3(g,t.u_extrude_scale),u_device_pixel_ratio:new l.bq(g,t.u_device_pixel_ratio),u_globe_extrude_scale:new l.bq(g,t.u_globe_extrude_scale),u_translate:new l.c3(g,t.u_translate)}),collisionBox:(g,t)=>({u_pixel_extrude_scale:new l.c3(g,t.u_pixel_extrude_scale)}),collisionCircle:(g,t)=>({u_viewport_size:new l.c3(g,t.u_viewport_size)}),debug:(g,t)=>({u_color:new l.b$(g,t.u_color),u_overlay:new l.b_(g,t.u_overlay),u_overlay_scale:new l.bq(g,t.u_overlay_scale)}),depth:Qu,clippingMask:Qu,heatmap:(g,t)=>({u_extrude_scale:new l.bq(g,t.u_extrude_scale),u_intensity:new l.bq(g,t.u_intensity),u_globe_extrude_scale:new l.bq(g,t.u_globe_extrude_scale)}),heatmapTexture:(g,t)=>({u_matrix:new l.c0(g,t.u_matrix),u_world:new l.c3(g,t.u_world),u_image:new l.b_(g,t.u_image),u_color_ramp:new l.b_(g,t.u_color_ramp),u_opacity:new l.bq(g,t.u_opacity)}),hillshade:(g,t)=>({u_image:new l.b_(g,t.u_image),u_latrange:new l.c3(g,t.u_latrange),u_exaggeration:new l.bq(g,t.u_exaggeration),u_altitudes:new l.c9(g,t.u_altitudes),u_azimuths:new l.c9(g,t.u_azimuths),u_accent:new l.b$(g,t.u_accent),u_method:new l.b_(g,t.u_method),u_shadows:new l.c8(g,t.u_shadows),u_highlights:new l.c8(g,t.u_highlights)}),hillshadePrepare:(g,t)=>({u_matrix:new l.c0(g,t.u_matrix),u_image:new l.b_(g,t.u_image),u_dimension:new l.c3(g,t.u_dimension),u_zoom:new l.bq(g,t.u_zoom),u_unpack:new l.c1(g,t.u_unpack)}),colorRelief:(g,t)=>({u_image:new l.b_(g,t.u_image),u_unpack:new l.c1(g,t.u_unpack),u_dimension:new l.c3(g,t.u_dimension),u_elevation_stops:new l.b_(g,t.u_elevation_stops),u_color_stops:new l.b_(g,t.u_color_stops),u_color_ramp_size:new l.b_(g,t.u_color_ramp_size),u_opacity:new l.bq(g,t.u_opacity)}),line:(g,t)=>({u_translation:new l.c3(g,t.u_translation),u_ratio:new l.bq(g,t.u_ratio),u_device_pixel_ratio:new l.bq(g,t.u_device_pixel_ratio),u_units_to_pixels:new l.c3(g,t.u_units_to_pixels)}),lineGradient:(g,t)=>({u_translation:new l.c3(g,t.u_translation),u_ratio:new l.bq(g,t.u_ratio),u_device_pixel_ratio:new l.bq(g,t.u_device_pixel_ratio),u_units_to_pixels:new l.c3(g,t.u_units_to_pixels),u_image:new l.b_(g,t.u_image),u_image_height:new l.bq(g,t.u_image_height)}),linePattern:(g,t)=>({u_translation:new l.c3(g,t.u_translation),u_texsize:new l.c3(g,t.u_texsize),u_ratio:new l.bq(g,t.u_ratio),u_device_pixel_ratio:new l.bq(g,t.u_device_pixel_ratio),u_image:new l.b_(g,t.u_image),u_units_to_pixels:new l.c3(g,t.u_units_to_pixels),u_scale:new l.c2(g,t.u_scale),u_fade:new l.bq(g,t.u_fade)}),lineSDF:(g,t)=>({u_translation:new l.c3(g,t.u_translation),u_ratio:new l.bq(g,t.u_ratio),u_device_pixel_ratio:new l.bq(g,t.u_device_pixel_ratio),u_units_to_pixels:new l.c3(g,t.u_units_to_pixels),u_image:new l.b_(g,t.u_image),u_mix:new l.bq(g,t.u_mix),u_tileratio:new l.bq(g,t.u_tileratio),u_crossfade_from:new l.bq(g,t.u_crossfade_from),u_crossfade_to:new l.bq(g,t.u_crossfade_to),u_lineatlas_width:new l.bq(g,t.u_lineatlas_width),u_lineatlas_height:new l.bq(g,t.u_lineatlas_height)}),lineGradientSDF:(g,t)=>({u_translation:new l.c3(g,t.u_translation),u_ratio:new l.bq(g,t.u_ratio),u_device_pixel_ratio:new l.bq(g,t.u_device_pixel_ratio),u_units_to_pixels:new l.c3(g,t.u_units_to_pixels),u_image:new l.b_(g,t.u_image),u_image_height:new l.bq(g,t.u_image_height),u_tileratio:new l.bq(g,t.u_tileratio),u_crossfade_from:new l.bq(g,t.u_crossfade_from),u_crossfade_to:new l.bq(g,t.u_crossfade_to),u_image_dash:new l.b_(g,t.u_image_dash),u_mix:new l.bq(g,t.u_mix),u_lineatlas_width:new l.bq(g,t.u_lineatlas_width),u_lineatlas_height:new l.bq(g,t.u_lineatlas_height)}),raster:(g,t)=>({u_tl_parent:new l.c3(g,t.u_tl_parent),u_scale_parent:new l.bq(g,t.u_scale_parent),u_buffer_scale:new l.bq(g,t.u_buffer_scale),u_fade_t:new l.bq(g,t.u_fade_t),u_opacity:new l.bq(g,t.u_opacity),u_image0:new l.b_(g,t.u_image0),u_image1:new l.b_(g,t.u_image1),u_brightness_low:new l.bq(g,t.u_brightness_low),u_brightness_high:new l.bq(g,t.u_brightness_high),u_saturation_factor:new l.bq(g,t.u_saturation_factor),u_contrast_factor:new l.bq(g,t.u_contrast_factor),u_spin_weights:new l.c2(g,t.u_spin_weights),u_coords_top:new l.c1(g,t.u_coords_top),u_coords_bottom:new l.c1(g,t.u_coords_bottom)}),symbolIcon:(g,t)=>({u_is_size_zoom_constant:new l.b_(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.b_(g,t.u_is_size_feature_constant),u_size_t:new l.bq(g,t.u_size_t),u_size:new l.bq(g,t.u_size),u_camera_to_center_distance:new l.bq(g,t.u_camera_to_center_distance),u_pitch:new l.bq(g,t.u_pitch),u_rotate_symbol:new l.b_(g,t.u_rotate_symbol),u_aspect_ratio:new l.bq(g,t.u_aspect_ratio),u_fade_change:new l.bq(g,t.u_fade_change),u_label_plane_matrix:new l.c0(g,t.u_label_plane_matrix),u_coord_matrix:new l.c0(g,t.u_coord_matrix),u_is_text:new l.b_(g,t.u_is_text),u_pitch_with_map:new l.b_(g,t.u_pitch_with_map),u_is_along_line:new l.b_(g,t.u_is_along_line),u_is_variable_anchor:new l.b_(g,t.u_is_variable_anchor),u_texsize:new l.c3(g,t.u_texsize),u_texture:new l.b_(g,t.u_texture),u_translation:new l.c3(g,t.u_translation),u_pitched_scale:new l.bq(g,t.u_pitched_scale)}),symbolSDF:(g,t)=>({u_is_size_zoom_constant:new l.b_(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.b_(g,t.u_is_size_feature_constant),u_size_t:new l.bq(g,t.u_size_t),u_size:new l.bq(g,t.u_size),u_camera_to_center_distance:new l.bq(g,t.u_camera_to_center_distance),u_pitch:new l.bq(g,t.u_pitch),u_rotate_symbol:new l.b_(g,t.u_rotate_symbol),u_aspect_ratio:new l.bq(g,t.u_aspect_ratio),u_fade_change:new l.bq(g,t.u_fade_change),u_label_plane_matrix:new l.c0(g,t.u_label_plane_matrix),u_coord_matrix:new l.c0(g,t.u_coord_matrix),u_is_text:new l.b_(g,t.u_is_text),u_pitch_with_map:new l.b_(g,t.u_pitch_with_map),u_is_along_line:new l.b_(g,t.u_is_along_line),u_is_variable_anchor:new l.b_(g,t.u_is_variable_anchor),u_texsize:new l.c3(g,t.u_texsize),u_texture:new l.b_(g,t.u_texture),u_gamma_scale:new l.bq(g,t.u_gamma_scale),u_device_pixel_ratio:new l.bq(g,t.u_device_pixel_ratio),u_is_halo:new l.b_(g,t.u_is_halo),u_translation:new l.c3(g,t.u_translation),u_pitched_scale:new l.bq(g,t.u_pitched_scale)}),symbolTextAndIcon:(g,t)=>({u_is_size_zoom_constant:new l.b_(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.b_(g,t.u_is_size_feature_constant),u_size_t:new l.bq(g,t.u_size_t),u_size:new l.bq(g,t.u_size),u_camera_to_center_distance:new l.bq(g,t.u_camera_to_center_distance),u_pitch:new l.bq(g,t.u_pitch),u_rotate_symbol:new l.b_(g,t.u_rotate_symbol),u_aspect_ratio:new l.bq(g,t.u_aspect_ratio),u_fade_change:new l.bq(g,t.u_fade_change),u_label_plane_matrix:new l.c0(g,t.u_label_plane_matrix),u_coord_matrix:new l.c0(g,t.u_coord_matrix),u_is_text:new l.b_(g,t.u_is_text),u_pitch_with_map:new l.b_(g,t.u_pitch_with_map),u_is_along_line:new l.b_(g,t.u_is_along_line),u_is_variable_anchor:new l.b_(g,t.u_is_variable_anchor),u_texsize:new l.c3(g,t.u_texsize),u_texsize_icon:new l.c3(g,t.u_texsize_icon),u_texture:new l.b_(g,t.u_texture),u_texture_icon:new l.b_(g,t.u_texture_icon),u_gamma_scale:new l.bq(g,t.u_gamma_scale),u_device_pixel_ratio:new l.bq(g,t.u_device_pixel_ratio),u_is_halo:new l.b_(g,t.u_is_halo),u_translation:new l.c3(g,t.u_translation),u_pitched_scale:new l.bq(g,t.u_pitched_scale)}),background:(g,t)=>({u_opacity:new l.bq(g,t.u_opacity),u_color:new l.b$(g,t.u_color)}),backgroundPattern:(g,t)=>({u_opacity:new l.bq(g,t.u_opacity),u_image:new l.b_(g,t.u_image),u_pattern_tl_a:new l.c3(g,t.u_pattern_tl_a),u_pattern_br_a:new l.c3(g,t.u_pattern_br_a),u_pattern_tl_b:new l.c3(g,t.u_pattern_tl_b),u_pattern_br_b:new l.c3(g,t.u_pattern_br_b),u_texsize:new l.c3(g,t.u_texsize),u_mix:new l.bq(g,t.u_mix),u_pattern_size_a:new l.c3(g,t.u_pattern_size_a),u_pattern_size_b:new l.c3(g,t.u_pattern_size_b),u_scale_a:new l.bq(g,t.u_scale_a),u_scale_b:new l.bq(g,t.u_scale_b),u_pixel_coord_upper:new l.c3(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.c3(g,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.bq(g,t.u_tile_units_to_pixels)}),terrain:(g,t)=>({u_texture:new l.b_(g,t.u_texture),u_ele_delta:new l.bq(g,t.u_ele_delta),u_fog_matrix:new l.c0(g,t.u_fog_matrix),u_fog_color:new l.b$(g,t.u_fog_color),u_fog_ground_blend:new l.bq(g,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.bq(g,t.u_fog_ground_blend_opacity),u_horizon_color:new l.b$(g,t.u_horizon_color),u_horizon_fog_blend:new l.bq(g,t.u_horizon_fog_blend),u_is_globe_mode:new l.bq(g,t.u_is_globe_mode)}),terrainDepth:(g,t)=>({u_ele_delta:new l.bq(g,t.u_ele_delta)}),terrainCoords:(g,t)=>({u_texture:new l.b_(g,t.u_texture),u_terrain_coords_id:new l.bq(g,t.u_terrain_coords_id),u_ele_delta:new l.bq(g,t.u_ele_delta)}),projectionErrorMeasurement:(g,t)=>({u_input:new l.bq(g,t.u_input),u_output_expected:new l.bq(g,t.u_output_expected)}),atmosphere:(g,t)=>({u_sun_pos:new l.c2(g,t.u_sun_pos),u_atmosphere_blend:new l.bq(g,t.u_atmosphere_blend),u_globe_position:new l.c2(g,t.u_globe_position),u_globe_radius:new l.bq(g,t.u_globe_radius),u_inv_proj_matrix:new l.c0(g,t.u_inv_proj_matrix)}),sky:(g,t)=>({u_sky_color:new l.b$(g,t.u_sky_color),u_horizon_color:new l.b$(g,t.u_horizon_color),u_horizon:new l.c3(g,t.u_horizon),u_horizon_normal:new l.c3(g,t.u_horizon_normal),u_sky_horizon_blend:new l.bq(g,t.u_sky_horizon_blend),u_sky_blend:new l.bq(g,t.u_sky_blend)})};class il{constructor(t,a,c){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const rl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class nd{constructor(t,a,c,d){this.length=a.length,this.attributes=c,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=t;const y=t.gl;this.buffer=y.createBuffer(),t.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let c=0;c<this.attributes.length;c++){const d=a.attributes[this.attributes[c].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,a,c){for(let d=0;d<this.attributes.length;d++){const y=this.attributes[d],x=a.attributes[y.name];x!==void 0&&t.vertexAttribPointer(x,y.components,t[rl[y.type]],!1,this.itemSize,y.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class An{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class yo extends An{getDefault(){return l.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class au extends An{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class ou extends An{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ju extends An{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class al extends An{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class su extends An{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class nc extends An{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class ra extends An{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class id extends An{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class eh extends An{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class aa extends An{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class vo extends An{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Br extends An{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class qo extends An{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ol extends An{getDefault(){return l.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class sl extends An{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class lu extends An{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class Es extends An{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Ca extends An{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class rd extends An{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class ic extends An{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class on extends An{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class th extends An{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class oa extends An{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class nh extends An{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class sa extends An{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Df extends An{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ih extends An{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const c=this.gl;Sa(c)?c.bindVertexArray(t):(a=c.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Cs extends An{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class ad extends An{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class rh extends An{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Ms extends An{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class rc extends Ms{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Fr extends Ms{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class As extends Ms{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const zs="Framebuffer is not complete";class ll{constructor(t,a,c,d,y){this.context=t,this.width=a,this.height=c;const x=t.gl,C=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new rc(t,C),d)this.depthAttachment=y?new As(t,C):new Fr(t,C);else if(y)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error(zs)}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class Ds{constructor(t){var a,c;if(this.gl=t,this.clearColor=new yo(this),this.clearDepth=new au(this),this.clearStencil=new ou(this),this.colorMask=new Ju(this),this.depthMask=new al(this),this.stencilMask=new su(this),this.stencilFunc=new nc(this),this.stencilOp=new ra(this),this.stencilTest=new id(this),this.depthRange=new eh(this),this.depthTest=new aa(this),this.depthFunc=new vo(this),this.blend=new Br(this),this.blendFunc=new qo(this),this.blendColor=new ol(this),this.blendEquation=new sl(this),this.cullFace=new lu(this),this.cullFaceSide=new Es(this),this.frontFace=new Ca(this),this.program=new rd(this),this.activeTexture=new ic(this),this.viewport=new on(this),this.bindFramebuffer=new th(this),this.bindRenderbuffer=new oa(this),this.bindTexture=new nh(this),this.bindVertexBuffer=new sa(this),this.bindElementBuffer=new Df(this),this.bindVertexArray=new ih(this),this.pixelStoreUnpack=new Cs(this),this.pixelStoreUnpackPremultiplyAlpha=new ad(this),this.pixelStoreUnpackFlipY=new rh(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Sa(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:d?.RGBA16F_EXT,this.RGB16F=(c=t.RGB16F)!==null&&c!==void 0?c:d?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new il(this,t,a)}createVertexBuffer(t,a,c){return new nd(this,t,a,c)}createRenderbuffer(t,a,c){const d=this.gl,y=d.createRenderbuffer();return this.bindRenderbuffer.set(y),d.renderbufferStorage(d.RENDERBUFFER,t,a,c),this.bindRenderbuffer.set(null),y}createFramebuffer(t,a,c,d){return new ll(this,t,a,c,d)}clear({color:t,depth:a,stencil:c}){const d=this.gl;let y=0;t&&(y|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(y|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),c!==void 0&&(y|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),d.clear(y)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){l.bR(t.blendFunction,jn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Sa(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return Sa(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let nr;function ar(g,t,a,c,d){const y=g.context,x=g.transform,C=y.gl,z=g.useProgram("collisionBox"),L=[];let k=0,V=0;for(let oe=0;oe<c.length;oe++){const fe=c[oe],ye=t.getTile(fe).getBucket(a);if(!ye)continue;const he=d?ye.textCollisionBox:ye.iconCollisionBox,_e=ye.collisionCircleArray;_e.length>0&&(L.push({circleArray:_e,circleOffset:V,coord:fe}),k+=_e.length/4,V=k),he&&z.draw(y,C.LINES,rn.disabled,wn.disabled,g.colorModeForRenderPass(),pn.disabled,ws(g.transform),g.style.map.terrain&&g.style.map.terrain.getTerrainData(fe),x.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,g.transform.zoom,null,null,he.collisionVertexBuffer)}if(!d||!L.length)return;const j=g.useProgram("collisionCircle"),$=new l.ca;$.resize(4*k),$._trim();let W=0;for(const oe of L)for(let fe=0;fe<oe.circleArray.length/4;fe++){const ye=4*fe,he=oe.circleArray[ye+0],_e=oe.circleArray[ye+1],we=oe.circleArray[ye+2],ge=oe.circleArray[ye+3];$.emplace(W++,he,_e,we,ge,0),$.emplace(W++,he,_e,we,ge,1),$.emplace(W++,he,_e,we,ge,2),$.emplace(W++,he,_e,we,ge,3)}(!nr||nr.length<2*k)&&(nr=(function(oe){const fe=2*oe,ye=new l.cc;ye.resize(fe),ye._trim();for(let he=0;he<fe;he++){const _e=6*he;ye.uint16[_e+0]=4*he+0,ye.uint16[_e+1]=4*he+1,ye.uint16[_e+2]=4*he+2,ye.uint16[_e+3]=4*he+2,ye.uint16[_e+4]=4*he+3,ye.uint16[_e+5]=4*he+0}return ye})(k));const ae=y.createIndexBuffer(nr,!0),se=y.createVertexBuffer($,l.cb.members,!0);for(const oe of L){const fe=Jh(g.transform);j.draw(y,C.TRIANGLES,rn.disabled,wn.disabled,g.colorModeForRenderPass(),pn.disabled,fe,g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe.coord),null,a.id,se,ae,l.aX.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,g.transform.zoom,null,null,null)}se.destroy(),ae.destroy()}const xo=l.ar(new Float32Array(16));function bo(g,t,a,c,d,y){const{horizontalAlign:x,verticalAlign:C}=l.aS(g);return new l.P((-(x-.5)*t/d+c[0])*y,(-(C-.5)*a/d+c[1])*y)}function Ur(g,t,a,c,d,y){const x=t.tileAnchorPoint.add(new l.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let C=c.mult(y);a||(C=C.rotate(-d));const z=x.add(C);return nn(z.x,z.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(a){const C=bn(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(g),z=Math.atan(C.y/C.x)+(C.x<0?Math.PI:0);return g.add(c.rotate(z))}return g.add(c)}function $o(g,t,a,c,d,y,x,C,z,L,k,V){const j=g.text.placedSymbolArray,$=g.text.dynamicLayoutVertexArray,W=g.icon.dynamicLayoutVertexArray,ae={};$.clear();for(let se=0;se<j.length;se++){const oe=j.get(se),fe=oe.hidden||!oe.crossTileID||g.allowVerticalPlacement&&!oe.placedOrientation?null:c[oe.crossTileID];if(fe){const ye=new l.P(oe.anchorX,oe.anchorY),he={getElevation:V,width:d.width,height:d.height,pitchedLabelPlaneMatrix:y,pitchWithMap:a,transform:d,tileAnchorPoint:ye,translation:L,unwrappedTileID:k},_e=a?ql(ye.x,ye.y,he):bn(ye.x,ye.y,he),we=Hs(d.cameraToCenterDistance,_e.signedDistanceFromCamera);let ge=l.aA(g.textSizeData,C,oe)*we/l.aM;a&&(ge*=g.tilePixelRatio/x);const{width:Ae,height:Ge,anchor:Fe,textOffset:je,textBoxScale:Ve}=fe,vt=bo(Fe,Ae,Ge,je,Ve,ge),xt=d.getPitchedTextCorrection(ye.x+L[0],ye.y+L[1],k),ct=Ur(_e.point,he,t,vt,-d.bearingInRadians,xt),St=g.allowVerticalPlacement&&oe.placedOrientation===l.az.vertical?Math.PI/2:0;for(let en=0;en<oe.numGlyphs;en++)l.aG($,ct,St);z&&oe.associatedIconIndex>=0&&(ae[oe.associatedIconIndex]={shiftedAnchor:ct,angle:St})}else mo(oe.numGlyphs,$)}if(z){W.clear();const se=g.icon.placedSymbolArray;for(let oe=0;oe<se.length;oe++){const fe=se.get(oe);if(fe.hidden)mo(fe.numGlyphs,W);else{const ye=ae[oe];if(ye)for(let he=0;he<fe.numGlyphs;he++)l.aG(W,ye.shiftedAnchor,ye.angle);else mo(fe.numGlyphs,W)}}g.icon.dynamicLayoutVertexBuffer.updateData(W)}g.text.dynamicLayoutVertexBuffer.updateData($)}function od(g,t,a){return a.iconsInText&&t?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function cl(g,t,a,c,d,y,x,C,z,L,k,V,j){const $=g.context,W=$.gl,ae=g.transform,se=C==="map",oe=z==="map",fe=C!=="viewport"&&a.layout.get("symbol-placement")!=="point",ye=se&&!oe&&!fe,he=!a.layout.get("symbol-sort-key").isConstant();let _e=!1;const we=g.getDepthModeForSublayer(0,rn.ReadOnly),ge=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ae=[],Ge=ae.getCircleRadiusCorrection();for(const Fe of c){const je=t.getTile(Fe),Ve=je.getBucket(a);if(!Ve)continue;const vt=d?Ve.text:Ve.icon;if(!vt||!vt.segments.get().length||!vt.hasVisibleVertices)continue;const xt=vt.programConfigurations.get(a.id),ct=d||Ve.sdfIcons,St=d?Ve.textSizeData:Ve.iconSizeData,en=oe||ae.pitch!==0,Ln=g.useProgram(od(ct,d,Ve),xt),Jn=l.ay(St,ae.zoom),Yn=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Fe);let ai,Vn,_i,oi,sr=[0,0],Ei=null;if(d)Vn=je.glyphAtlasTexture,_i=W.LINEAR,ai=je.glyphAtlasTexture.size,Ve.iconsInText&&(sr=je.imageAtlasTexture.size,Ei=je.imageAtlasTexture,oi=en||g.options.rotating||g.options.zooming||St.kind==="composite"||St.kind==="camera"?W.LINEAR:W.NEAREST);else{const kn=a.layout.get("icon-size").constantOr(0)!==1||Ve.iconsNeedLinear;Vn=je.imageAtlasTexture,_i=ct||g.options.rotating||g.options.zooming||kn||en?W.LINEAR:W.NEAREST,ai=je.imageAtlasTexture.size}const Ci=l.aN(je,1,g.transform.zoom),lr=ta(se,g.transform,Ci),Lo=l.N();l.aB(Lo,lr);const Oo=Vu(oe,se,g.transform,Ci),eo=l.aO(ae,je,y,x),Zr=ae.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),yl=ge&&Ve.hasTextData(),pc=a.layout.get("icon-text-fit")!=="none"&&yl&&Ve.hasIconData();if(fe){const kn=g.style.map.terrain?(Vi,Ki)=>g.style.map.terrain.getElevation(Fe,Vi,Ki):null,Wn=a.layout.get("text-rotation-alignment")==="map";Vo(Ve,g,d,lr,Lo,oe,L,Wn,Fe.toUnwrapped(),ae.width,ae.height,eo,kn)}const to=d&&ge||pc,Hr=fe||to?xo:oe?lr:g.transform.clipSpaceToPixelsMatrix,da=ct&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ra;Ra=ct?Ve.iconsInText?Ea(St.kind,Jn,ye,oe,fe,to,g,Hr,Oo,eo,ai,sr,Ge):Ku(St.kind,Jn,ye,oe,fe,to,g,Hr,Oo,eo,d,ai,0,Ge):nu(St.kind,Jn,ye,oe,fe,to,g,Hr,Oo,eo,d,ai,Ge);const Ia={program:Ln,buffers:vt,uniformValues:Ra,projectionData:Zr,atlasTexture:Vn,atlasTextureIcon:Ei,atlasInterpolation:_i,atlasInterpolationIcon:oi,isSDF:ct,hasHalo:da};if(he&&Ve.canOverlap){_e=!0;const kn=vt.segments.get();for(const Wn of kn)Ae.push({segments:new l.aX([Wn]),sortKey:Wn.sortKey,state:Ia,terrainData:Yn})}else Ae.push({segments:vt.segments,sortKey:0,state:Ia,terrainData:Yn})}_e&&Ae.sort(((Fe,je)=>Fe.sortKey-je.sortKey));for(const Fe of Ae){const je=Fe.state;if($.activeTexture.set(W.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,W.CLAMP_TO_EDGE),je.atlasTextureIcon&&($.activeTexture.set(W.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,W.CLAMP_TO_EDGE)),je.isSDF){const Ve=je.uniformValues;je.hasHalo&&(Ve.u_is_halo=1,ac(je.buffers,Fe.segments,a,g,je.program,we,k,V,Ve,je.projectionData,Fe.terrainData)),Ve.u_is_halo=0}ac(je.buffers,Fe.segments,a,g,je.program,we,k,V,je.uniformValues,je.projectionData,Fe.terrainData)}}function ac(g,t,a,c,d,y,x,C,z,L,k){const V=c.context;d.draw(V,V.gl.TRIANGLES,y,x,C,pn.backCCW,z,k,L,a.id,g.layoutVertexBuffer,g.indexBuffer,t,a.paint,c.transform.zoom,g.programConfigurations.get(a.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function sd(g,t,a,c,d){const y=g.context,x=y.gl,C=wn.disabled,z=new jn([x.ONE,x.ONE],l.bp.transparent,[!0,!0,!0,!0]),L=t.getBucket(a);if(!L)return;const k=c.key;let V=a.heatmapFbos.get(k);V||(V=Xn(y,t.tileSize,t.tileSize),a.heatmapFbos.set(k,V)),y.bindFramebuffer.set(V.framebuffer),y.viewport.set([0,0,t.tileSize,t.tileSize]),y.clear({color:l.bp.transparent});const j=L.programConfigurations.get(a.id),$=g.useProgram("heatmap",j,!d),W=g.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ae=g.style.map.terrain.getTerrainData(c);$.draw(y,x.TRIANGLES,rn.disabled,C,z,pn.disabled,Ss(t,g.transform.zoom,a.paint.get("heatmap-intensity"),1),ae,W,a.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,a.paint,g.transform.zoom,j)}function or(g,t,a,c,d){const y=g.context,x=y.gl,C=g.transform;y.setColorMode(g.colorModeForRenderPass());const z=xn(y,t),L=a.key,k=t.heatmapFbos.get(L);if(!k)return;y.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,k.colorAttachment.get()),y.activeTexture.set(x.TEXTURE1),z.bind(x.LINEAR,x.CLAMP_TO_EDGE);const V=C.getProjectionData({overscaledTileID:a,applyTerrainMatrix:d,applyGlobeMatrix:!c});g.useProgram("heatmapTexture").draw(y,x.TRIANGLES,rn.disabled,wn.disabled,g.colorModeForRenderPass(),pn.disabled,ed(g,t,0,1),null,V,t.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,t.paint,C.zoom),k.destroy(),t.heatmapFbos.delete(L)}function Xn(g,t,a){var c,d;const y=g.gl,x=y.createTexture();y.bindTexture(y.TEXTURE_2D,x),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const C=(c=g.HALF_FLOAT)!==null&&c!==void 0?c:y.UNSIGNED_BYTE,z=(d=g.RGBA16F)!==null&&d!==void 0?d:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,z,t,a,0,y.RGBA,C,null);const L=g.createFramebuffer(t,a,!1,!1);return L.colorAttachment.set(x),L}function xn(g,t){return t.colorRampTexture||(t.colorRampTexture=new l.T(g,t.colorRamp,g.gl.RGBA)),t.colorRampTexture}function Zo(g,t,a,c,d,y,x,C){let z=256;if(d.stepInterpolant){const L=t.getSource().maxzoom,k=x.canonical.z===L?Math.ceil(1<<g.transform.maxZoom-x.canonical.z):1;z=l.an(l.ce(y.maxLineLength/l.a5*1024*k),256,a.maxTextureSize)}return C.gradient=l.cf({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:z,image:C.gradient||void 0,clips:y.lineClipsArray}),C.texture?C.texture.update(C.gradient):C.texture=new l.T(a,C.gradient,c.RGBA),C.version=d.gradientVersion,C.texture}function la(g,t,a,c,d){g.activeTexture.set(t.TEXTURE0),a.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),c.updatePaintBuffers(d)}function mi(g,t,a,c,d,y){(d||g.lineAtlas.dirty)&&(t.activeTexture.set(a.TEXTURE0),g.lineAtlas.bind(t)),c.updatePaintBuffers(y)}function Gr(g,t,a,c,d,y,x){const C=y.gradients[d.id];let z=C.texture;d.gradientVersion!==C.version&&(z=Zo(g,t,a,c,d,y,x,C)),a.activeTexture.set(c.TEXTURE0),z.bind(d.stepInterpolant?c.NEAREST:c.LINEAR,c.CLAMP_TO_EDGE)}function qr(g,t,a,c,d,y,x,C,z){const L=y.gradients[d.id];let k=L.texture;d.gradientVersion!==L.version&&(k=Zo(g,t,a,c,d,y,x,L)),a.activeTexture.set(c.TEXTURE0),k.bind(d.stepInterpolant?c.NEAREST:c.LINEAR,c.CLAMP_TO_EDGE),a.activeTexture.set(c.TEXTURE1),g.lineAtlas.bind(a),C.updatePaintBuffers(z)}function cu(g,t,a,c,d){if(!a||!c||!c.imageAtlas)return;const y=c.imageAtlas.patternPositions;let x=y[a.to.toString()],C=y[a.from.toString()];if(!x&&C&&(x=C),!C&&x&&(C=x),!x||!C){const z=d.getPaintProperty(t);x=y[z],C=y[z]}x&&C&&g.setConstantPatternPositions(x,C)}function wo(g,t,a,c,d,y,x,C){const z=g.context.gl,L="fill-pattern",k=a.paint.get(L),V=k&&k.constantOr(1),j=a.getCrossfadeParameters();let $,W,ae,se,oe;const fe=g.transform,ye=a.paint.get("fill-translate"),he=a.paint.get("fill-translate-anchor");x?(W=V&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=z.LINES):(W=V?"fillPattern":"fill",$=z.TRIANGLES);const _e=k.constantOr(null);for(const we of c){const ge=t.getTile(we);if(V&&!ge.patternsLoaded())continue;const Ae=ge.getBucket(a);if(!Ae)continue;const Ge=Ae.programConfigurations.get(a.id),Fe=g.useProgram(W,Ge),je=g.style.map.terrain&&g.style.map.terrain.getTerrainData(we);V&&(g.context.activeTexture.set(z.TEXTURE0),ge.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Ge.updatePaintBuffers(j)),cu(Ge,L,_e,ge,a);const Ve=fe.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!C,applyTerrainMatrix:!0}),vt=l.aO(fe,ge,ye,he);if(x){se=Ae.indexBuffer2,oe=Ae.segments2;const ct=[z.drawingBufferWidth,z.drawingBufferHeight];ae=W==="fillOutlinePattern"&&V?Ef(g,j,ge,ct,vt):tc(ct,vt)}else se=Ae.indexBuffer,oe=Ae.segments,ae=V?nl(g,j,ge,vt):{u_fill_translate:vt};const xt=g.stencilModeForClipping(we);Fe.draw(g.context,$,d,xt,y,pn.backCCW,ae,je,Ve,a.id,Ae.layoutVertexBuffer,se,oe,a.paint,g.transform.zoom,Ge)}}function So(g,t,a,c,d,y,x,C){const z=g.context,L=z.gl,k="fill-extrusion-pattern",V=a.paint.get(k),j=V.constantOr(1),$=a.getCrossfadeParameters(),W=a.paint.get("fill-extrusion-opacity"),ae=V.constantOr(null),se=g.transform;for(const oe of c){const fe=t.getTile(oe),ye=fe.getBucket(a);if(!ye)continue;const he=g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe),_e=ye.programConfigurations.get(a.id),we=g.useProgram(j?"fillExtrusionPattern":"fillExtrusion",_e);j&&(g.context.activeTexture.set(L.TEXTURE0),fe.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),_e.updatePaintBuffers($));const ge=se.getProjectionData({overscaledTileID:oe,applyGlobeMatrix:!C,applyTerrainMatrix:!0});cu(_e,k,ae,fe,a);const Ae=l.aO(se,fe,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ge=a.paint.get("fill-extrusion-vertical-gradient"),Fe=j?Xu(g,Ge,W,Ae,oe,$,fe):Hu(g,Ge,W,Ae);we.draw(z,z.gl.TRIANGLES,d,y,x,pn.backCCW,Fe,he,ge,a.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,a.paint,g.transform.zoom,_e,g.style.map.terrain&&ye.centroidVertexBuffer)}}function To(g,t,a,c,d,y,x,C,z){var L;const k=g.style.projection,V=g.context,j=g.transform,$=V.gl,W=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],ae=g.useProgram("hillshade",null,!1,W),se=!g.options.moving;for(const oe of c){const fe=t.getTile(oe),ye=fe.fbo;if(!ye)continue;const he=k.getMeshFromTileID(V,oe.canonical,C,!0,"raster"),_e=(L=g.style.map.terrain)===null||L===void 0?void 0:L.getTerrainData(oe);V.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,ye.colorAttachment.get());const we=j.getProjectionData({overscaledTileID:oe,aligned:se,applyGlobeMatrix:!z,applyTerrainMatrix:!0});ae.draw(V,$.TRIANGLES,y,d[oe.overscaledZ],x,pn.backCCW,Jc(g,fe,a),_e,we,a.id,he.vertexBuffer,he.indexBuffer,he.segments)}}function Ho(g,t,a,c,d,y,x,C,z){var L;const k=g.style.projection,V=g.context,j=g.transform,$=V.gl,W=g.useProgram("colorRelief"),ae=!g.options.moving;let se=!0,oe=0;for(const fe of c){const ye=t.getTile(fe),he=ye.dem;if(se){const Fe=$.getParameter($.MAX_TEXTURE_SIZE),{elevationTexture:je,colorTexture:Ve}=a.getColorRampTextures(V,Fe,he.getUnpackVector());V.activeTexture.set($.TEXTURE1),je.bind($.NEAREST,$.CLAMP_TO_EDGE),V.activeTexture.set($.TEXTURE4),Ve.bind($.LINEAR,$.CLAMP_TO_EDGE),se=!1,oe=je.size[0]}if(!he||!he.data)continue;const _e=he.stride,we=he.getPixels();if(V.activeTexture.set($.TEXTURE0),V.pixelStoreUnpackPremultiplyAlpha.set(!1),ye.demTexture=ye.demTexture||g.getTileTexture(_e),ye.demTexture){const Fe=ye.demTexture;Fe.update(we,{premultiply:!1}),Fe.bind($.LINEAR,$.CLAMP_TO_EDGE)}else ye.demTexture=new l.T(V,we,$.RGBA,{premultiply:!1}),ye.demTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const ge=k.getMeshFromTileID(V,fe.canonical,C,!0,"raster"),Ae=(L=g.style.map.terrain)===null||L===void 0?void 0:L.getTerrainData(fe),Ge=j.getProjectionData({overscaledTileID:fe,aligned:ae,applyGlobeMatrix:!z,applyTerrainMatrix:!0});W.draw(V,$.TRIANGLES,y,d[fe.overscaledZ],x,pn.backCCW,Mf(a,ye.dem,oe),Ae,Ge,a.id,ge.vertexBuffer,ge.indexBuffer,ge.segments)}}const Xo=[new l.P(0,0),new l.P(l.a5,0),new l.P(l.a5,l.a5),new l.P(0,l.a5)];function Ma(g,t,a,c,d,y,x,C,z=!1,L=!1){const k=c[c.length-1].overscaledZ,V=g.context,j=V.gl,$=g.useProgram("raster"),W=g.transform,ae=g.style.projection,se=g.colorModeForRenderPass(),oe=!g.options.moving,fe=a.paint.get("raster-opacity"),ye=a.paint.get("raster-resampling"),he=a.paint.get("raster-fade-duration"),_e=!!g.style.map.terrain;for(const we of c){const ge=g.getDepthModeForSublayer(we.overscaledZ-k,fe===1?rn.ReadWrite:rn.ReadOnly,j.LESS),Ae=t.getTile(we),Ge=ye==="nearest"?j.NEAREST:j.LINEAR;V.activeTexture.set(j.TEXTURE0),Ae.texture.bind(Ge,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),V.activeTexture.set(j.TEXTURE1);const{parentTile:Fe,parentScaleBy:je,parentTopLeft:Ve,fadeValues:vt}=Eo(Ae,t,he,_e);Ae.fadeOpacity=vt.tileOpacity,Fe?(Fe.fadeOpacity=vt.parentTileOpacity,Fe.texture.bind(Ge,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST)):Ae.texture.bind(Ge,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Ae.texture.useMipmap&&V.extTextureFilterAnisotropic&&g.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const xt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(we),ct=W.getProjectionData({overscaledTileID:we,aligned:oe,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),St=Yu(Ve,je,vt.fadeMix,a,C),en=ae.getMeshFromTileID(V,we.canonical,y,x,"raster");$.draw(V,j.TRIANGLES,ge,d?d[we.overscaledZ]:wn.disabled,se,z?pn.frontCCW:pn.backCCW,St,xt,ct,a.id,en.vertexBuffer,en.indexBuffer,en.segments)}}function Eo(g,t,a,c){const d={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(a===0||c)return d;if(g.fadingParentID){const y=t.getLoadedTile(g.fadingParentID);if(!y)return d;const x=Math.pow(2,y.tileID.overscaledZ-g.tileID.overscaledZ),C=[g.tileID.canonical.x*x%1,g.tileID.canonical.y*x%1],z=(function(L,k,V){const j=xe(),$=(j-k.timeAdded)/V,W=L.fadingDirection===be.Incoming,ae=l.an((j-L.timeAdded)/V,0,1),se=l.an(1-$,0,1),oe=W?ae:se;return{tileOpacity:oe,parentTileOpacity:W?se:ae,fadeMix:{opacity:1,mix:1-oe}}})(g,y,a);return{parentTile:y,parentScaleBy:x,parentTopLeft:C,fadeValues:z}}if(g.selfFading){const y=(function(x,C){const z=(xe()-x.timeAdded)/C,L=l.an(z,0,1);return{tileOpacity:L,fadeMix:{opacity:L,mix:0}}})(g,a);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:y}}return d}const Yo=new l.bp(1,0,0,1),Co=new l.bp(0,1,0,1),ah=new l.bp(0,0,1,1),oh=new l.bp(1,0,1,1),ca=new l.bp(0,1,1,1);function oc(g,t,a,c){ji(g,0,t+a/2,g.transform.width,a,c)}function Wo(g,t,a,c){ji(g,t-a/2,0,a,g.transform.height,c)}function ji(g,t,a,c,d,y){const x=g.context,C=x.gl;C.enable(C.SCISSOR_TEST),C.scissor(t*g.pixelRatio,a*g.pixelRatio,c*g.pixelRatio,d*g.pixelRatio),x.clear({color:y}),C.disable(C.SCISSOR_TEST)}function uu(g,t,a){const c=g.context,d=c.gl,y=g.useProgram("debug"),x=rn.disabled,C=wn.disabled,z=g.colorModeForRenderPass(),L="$debug",k=g.style.map.terrain&&g.style.map.terrain.getTerrainData(a);c.activeTexture.set(d.TEXTURE0);const V=t.getTileByID(a.key).latestRawTileData,j=Math.floor((V&&V.byteLength||0)/1024),$=t.getTile(a).tileSize,W=512/Math.min($,512)*(a.overscaledZ/g.transform.zoom)*.5;let ae=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ae+=` => ${a.overscaledZ}`),(function(oe,fe){oe.initDebugOverlayCanvas();const ye=oe.debugOverlayCanvas,he=oe.context.gl,_e=oe.debugOverlayCanvas.getContext("2d");_e.clearRect(0,0,ye.width,ye.height),_e.shadowColor="white",_e.shadowBlur=2,_e.lineWidth=1.5,_e.strokeStyle="white",_e.textBaseline="top",_e.font="bold 36px Open Sans, sans-serif",_e.fillText(fe,5,5),_e.strokeText(fe,5,5),oe.debugOverlayTexture.update(ye),oe.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)})(g,`${ae} ${j}kB`);const se=g.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(c,d.TRIANGLES,x,C,jn.alphaBlended,pn.disabled,Qc(l.bp.transparent,W),null,se,L,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),y.draw(c,d.LINE_STRIP,x,C,z,pn.disabled,Qc(l.bp.red),k,se,L,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function sh(g,t,a,c){const{isRenderingGlobe:d}=c,y=g.context,x=y.gl,C=g.transform,z=g.colorModeForRenderPass(),L=g.getDepthModeFor3D(),k=g.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,g.width,g.height]);for(const V of a){const j=t.getTerrainMesh(V.tileID),$=g.renderToTexture.getTexture(V),W=t.getTerrainData(V.tileID);y.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,$.texture);const ae=t.getMeshFrameDelta(C.zoom),se=C.calculateFogMatrix(V.tileID.toUnwrapped()),oe=wf(ae,se,g.style.sky,C.pitch,d),fe=C.getProjectionData({overscaledTileID:V.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(y,x.TRIANGLES,L,wn.disabled,z,pn.backCCW,oe,W,fe,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}function ld(g,t){if(!t.mesh){const a=new l.aW;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const c=new l.aY;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),t.mesh=new Hn(g.createVertexBuffer(a,wa.members),g.createIndexBuffer(c),l.aX.simpleSegment(0,0,a.length,c.length))}return t.mesh}class Pf{constructor(t,a){this.context=new Ds(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=vn.maxOverzooming+vn.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new er}resize(t,a,c){if(this.width=Math.floor(t*c),this.height=Math.floor(a*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,a=new l.aW;a.emplaceBack(0,0),a.emplaceBack(l.a5,0),a.emplaceBack(0,l.a5),a.emplaceBack(l.a5,l.a5),this.tileExtentBuffer=t.createVertexBuffer(a,wa.members),this.tileExtentSegments=l.aX.simpleSegment(0,0,4,2);const c=new l.aW;c.emplaceBack(0,0),c.emplaceBack(l.a5,0),c.emplaceBack(0,l.a5),c.emplaceBack(l.a5,l.a5),this.debugBuffer=t.createVertexBuffer(c,wa.members),this.debugSegments=l.aX.simpleSegment(0,0,4,5);const d=new l.ch;d.emplaceBack(0,0,0,0),d.emplaceBack(l.a5,0,l.a5,0),d.emplaceBack(0,l.a5,0,l.a5),d.emplaceBack(l.a5,l.a5,l.a5,l.a5),this.rasterBoundsBuffer=t.createVertexBuffer(d,bf.members),this.rasterBoundsSegments=l.aX.simpleSegment(0,0,4,2);const y=new l.aW;y.emplaceBack(0,0),y.emplaceBack(l.a5,0),y.emplaceBack(0,l.a5),y.emplaceBack(l.a5,l.a5),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(y,wa.members),this.rasterBoundsSegmentsPosOnly=l.aX.simpleSegment(0,0,4,5);const x=new l.aW;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(x,wa.members),this.viewportSegments=l.aX.simpleSegment(0,0,4,2);const C=new l.ci;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(C);const z=new l.aY;z.emplaceBack(1,0,2),z.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(z);const L=this.context.gl;this.stencilClearMode=new wn({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.tileExtentMesh=new Hn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=l.N();l.c7(c,0,this.width,this.height,0,0,1),l.Q(c,c,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const d={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(t,a.TRIANGLES,rn.disabled,this.stencilClearMode,jn.disabled,pn.disabled,null,null,d,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a,c){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source,this.nextStencilID+a.length>256&&this.clearStencil();const d=this.context;d.setColorMode(jn.disabled),d.setDepthMode(rn.disabled);const y={};for(const x of a)y[x.key]=this.nextStencilID++;this._renderTileMasks(y,a,c,!0),this._renderTileMasks(y,a,c,!1),this._tileClippingMaskIDs=y}_renderTileMasks(t,a,c,d){const y=this.context,x=y.gl,C=this.style.projection,z=this.transform,L=this.useProgram("clippingMask");for(const k of a){const V=t[k.key],j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),$=C.getMeshFromTileID(this.context,k.canonical,d,!0,"stencil"),W=z.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!c,applyTerrainMatrix:!0});L.draw(y,x.TRIANGLES,rn.disabled,new wn({func:x.ALWAYS,mask:0},V,255,x.KEEP,x.KEEP,x.REPLACE),jn.disabled,c?pn.disabled:pn.backCCW,null,j,W,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}_renderTilesDepthBuffer(){const t=this.context,a=t.gl,c=this.style.projection,d=this.transform,y=this.useProgram("depth"),x=this.getDepthModeFor3D(),C=ti(d,{tileSize:d.tileSize});for(const z of C){const L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(z),k=c.getMeshFromTileID(this.context,z.canonical,!0,!0,"raster"),V=d.getProjectionData({overscaledTileID:z,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(t,a.TRIANGLES,x,wn.disabled,jn.disabled,pn.backCCW,null,L,V,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new wn({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new wn({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const a=this.context.gl,c=t.sort(((x,C)=>C.overscaledZ-x.overscaledZ)),d=c[c.length-1].overscaledZ,y=c[0].overscaledZ-d+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const x={};for(let C=0;C<y;C++)x[C+d]=new wn({func:a.GEQUAL,mask:255},C+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=y,[x,c]}return[{[d]:wn.disabled},c]}stencilConfigForOverlapTwoPass(t){const a=this.context.gl,c=t.sort(((x,C)=>C.overscaledZ-x.overscaledZ)),d=c[c.length-1].overscaledZ,y=c[0].overscaledZ-d+1;if(this.clearStencil(),y>1){const x={},C={};for(let z=0;z<y;z++)x[z+d]=new wn({func:a.GREATER,mask:255},y+1+z,255,a.KEEP,a.KEEP,a.REPLACE),C[z+d]=new wn({func:a.GREATER,mask:255},1+z,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*y+1,[x,C,c]}return this.nextStencilID=3,[{[d]:new wn({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[d]:new wn({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new jn([t.CONSTANT_COLOR,t.ONE],new l.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?jn.unblended:jn.alphaBlended}getDepthModeForSublayer(t,a,c){if(!this.opaquePassEnabledForLayer())return rn.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new rn(c||this.context.gl.LEQUAL,a,[d,d])}getDepthModeFor3D(){return new rn(this.context.gl.LEQUAL,rn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){var c,d;this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(xe()),this.imageManager.beginFrame();const y=this.style._order,x=this.style.tileManagers,C={},z={},L={},k={isRenderingToTexture:!1,isRenderingGlobe:((c=t.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const j in x){const $=x[j];$.used&&$.prepare(this.context),C[j]=$.getVisibleCoordinates(!1),z[j]=C[j].slice().reverse(),L[j]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<y.length;j++)if(this.style._layers[y[j]].is3D()){this.opaquePassCutoff=j;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const j of y){const $=this.style._layers[j];if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const W=z[$.source];($.type==="custom"||W.length)&&this.renderLayer(this,x[$.source],$,W,k)}if((d=this.style.projection)===null||d===void 0||d.updateGPUdependent({context:this.context,useProgram:j=>this.useProgram(j)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?l.bp.black:l.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(j,$){const W=j.context,ae=W.gl,se=((we,ge,Ae)=>{const Ge=Math.cos(ge.rollInRadians),Fe=Math.sin(ge.rollInRadians),je=Ke(ge),Ve=ge.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:we.properties.get("sky-color"),u_horizon_color:we.properties.get("horizon-color"),u_horizon:[(ge.width/2-je*Fe)*Ae,(ge.height/2+je*Ge)*Ae],u_horizon_normal:[-Fe,Ge],u_sky_horizon_blend:we.properties.get("sky-horizon-blend")*ge.height/2*Ae,u_sky_blend:Ve}})($,j.style.map.transform,j.pixelRatio),oe=new rn(ae.LEQUAL,rn.ReadWrite,[0,1]),fe=wn.disabled,ye=j.colorModeForRenderPass(),he=j.useProgram("sky"),_e=ld(W,$);he.draw(W,ae.TRIANGLES,oe,fe,ye,pn.disabled,se,null,void 0,"sky",_e.vertexBuffer,_e.indexBuffer,_e.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[y[this.currentLayer]],$=x[j.source],W=C[j.source];this._renderTileClippingMasks(j,W,!1),this.renderLayer(this,$,j,W,k)}this.renderPass="translucent";let V=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const j=this.style._layers[y[this.currentLayer]],$=x[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j,k))continue;this.opaquePassEnabledForLayer()||V||(V=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const W=(j.type==="symbol"?L:z)[j.source];this._renderTileClippingMasks(j,C[j.source],!!this.renderToTexture),this.renderLayer(this,$,j,W,k)}if(k.isRenderingGlobe&&(function(j,$,W){const ae=j.context,se=ae.gl,oe=j.useProgram("atmosphere"),fe=new rn(se.LEQUAL,rn.ReadOnly,[0,1]),ye=j.transform,he=(function(Ve,vt){const xt=Ve.properties.get("position"),ct=[-xt.x,-xt.y,-xt.z],St=l.ar(new Float64Array(16));return Ve.properties.get("anchor")==="map"&&(l.bg(St,St,vt.rollInRadians),l.bh(St,St,-vt.pitchInRadians),l.bg(St,St,vt.bearingInRadians),l.bh(St,St,vt.center.lat*Math.PI/180),l.bJ(St,St,-vt.center.lng*Math.PI/180)),l.cg(ct,ct,St),ct})(W,j.transform),_e=ye.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),we=$.properties.get("atmosphere-blend")*_e.projectionTransition;if(we===0)return;const ge=tl(ye.worldSize,ye.center.lat),Ae=ye.inverseProjectionMatrix,Ge=new Float64Array(4);Ge[3]=1,l.aH(Ge,Ge,ye.modelViewProjectionMatrix),Ge[0]/=Ge[3],Ge[1]/=Ge[3],Ge[2]/=Ge[3],Ge[3]=1,l.aH(Ge,Ge,Ae),Ge[0]/=Ge[3],Ge[1]/=Ge[3],Ge[2]/=Ge[3],Ge[3]=1;const Fe=((Ve,vt,xt,ct,St)=>({u_sun_pos:Ve,u_atmosphere_blend:vt,u_globe_position:xt,u_globe_radius:ct,u_inv_proj_matrix:St}))(he,we,[Ge[0],Ge[1],Ge[2]],ge,Ae),je=ld(ae,$);oe.draw(ae,se.TRIANGLES,fe,wn.disabled,jn.alphaBlended,pn.disabled,Fe,null,null,"atmosphere",je.vertexBuffer,je.indexBuffer,je.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const j=(function($,W){let ae=null;const se=Object.values($._layers).flatMap((he=>he.source&&!he.isHidden(W)?[$.tileManagers[he.source]]:[])),oe=se.filter((he=>he.getSource().type==="vector")),fe=se.filter((he=>he.getSource().type!=="vector")),ye=he=>{(!ae||ae.getSource().maxzoom<he.getSource().maxzoom)&&(ae=he)};return oe.forEach((he=>ye(he))),ae||fe.forEach((he=>ye(he))),ae})(this.style,this.transform.zoom);j&&(function($,W,ae){for(let se=0;se<ae.length;se++)uu($,W,ae[se])})(this,j,j.getVisibleCoordinates())}this.options.showPadding&&(function(j){const $=j.transform.padding;oc(j,j.transform.height-($.top||0),3,Yo),oc(j,$.bottom||0,3,Co),Wo(j,$.left||0,3,ah),Wo(j,j.transform.width-($.right||0),3,oh);const W=j.transform.centerPoint;(function(ae,se,oe,fe){ji(ae,se-1,oe-10,2,20,fe),ji(ae,se-10,oe-1,20,2,fe)})(j,W.x,j.transform.height-W.y,ca)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=t?!l.cj(a,c):!l.ck(a,c)),d||(d=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),d&&(l.cl(a,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(y,x){const C=y.context,z=C.gl,L=y.transform,k=jn.unblended,V=new rn(z.LEQUAL,rn.ReadWrite,[0,1]),j=x.tileManager.getRenderableTiles(),$=y.useProgram("terrainDepth");C.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),C.clear({color:l.bp.transparent,depth:1});for(const W of j){const ae=x.getTerrainMesh(W.tileID),se=x.getTerrainData(W.tileID),oe=L.getProjectionData({overscaledTileID:W.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),fe={u_ele_delta:x.getMeshFrameDelta(L.zoom)};$.draw(C,z.TRIANGLES,V,wn.disabled,k,pn.backCCW,fe,se,oe,"terrain",ae.vertexBuffer,ae.indexBuffer,ae.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,y.width,y.height])})(this,this.style.map.terrain),(function(y,x){const C=y.context,z=C.gl,L=y.transform,k=jn.unblended,V=new rn(z.LEQUAL,rn.ReadWrite,[0,1]),j=x.getCoordsTexture(),$=x.tileManager.getRenderableTiles(),W=y.useProgram("terrainCoords");C.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),C.clear({color:l.bp.transparent,depth:1}),x.coordsIndex=[];for(const ae of $){const se=x.getTerrainMesh(ae.tileID),oe=x.getTerrainData(ae.tileID);C.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,j.texture);const fe={u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(L.zoom)},ye=L.getProjectionData({overscaledTileID:ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});W.draw(C,z.TRIANGLES,V,wn.disabled,k,pn.backCCW,fe,oe,ye,"terrain",se.vertexBuffer,se.indexBuffer,se.segments),x.coordsIndex.push(ae.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,y.width,y.height])})(this,this.style.map.terrain))}renderLayer(t,a,c,d,y){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(d||[]).length)&&(this.id=c.id,l.cm(c)?(function(x,C,z,L,k,V){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:j}=V,$=wn.disabled,W=x.colorModeForRenderPass();(z._unevaluatedLayout.hasValue("text-variable-anchor")||z._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ae,se,oe,fe,ye,he,_e,we,ge){const Ae=se.transform,Ge=se.style.map.terrain,Fe=ye==="map",je=he==="map";for(const Ve of ae){const vt=fe.getTile(Ve),xt=vt.getBucket(oe);if(!xt||!xt.text||!xt.text.segments.get().length)continue;const ct=l.ay(xt.textSizeData,Ae.zoom),St=l.aN(vt,1,se.transform.zoom),en=ta(Fe,se.transform,St),Ln=oe.layout.get("icon-text-fit")!=="none"&&xt.hasIconData();if(ct){const Jn=Math.pow(2,Ae.zoom-vt.tileID.overscaledZ),Yn=Ge?(ai,Vn)=>Ge.getElevation(Ve,ai,Vn):null;$o(xt,Fe,je,ge,Ae,en,Jn,ct,Ln,l.aO(Ae,vt,_e,we),Ve.toUnwrapped(),Yn)}}})(L,x,z,C,z.layout.get("text-rotation-alignment"),z.layout.get("text-pitch-alignment"),z.paint.get("text-translate"),z.paint.get("text-translate-anchor"),k),z.paint.get("icon-opacity").constantOr(1)!==0&&cl(x,C,z,L,!1,z.paint.get("icon-translate"),z.paint.get("icon-translate-anchor"),z.layout.get("icon-rotation-alignment"),z.layout.get("icon-pitch-alignment"),z.layout.get("icon-keep-upright"),$,W,j),z.paint.get("text-opacity").constantOr(1)!==0&&cl(x,C,z,L,!0,z.paint.get("text-translate"),z.paint.get("text-translate-anchor"),z.layout.get("text-rotation-alignment"),z.layout.get("text-pitch-alignment"),z.layout.get("text-keep-upright"),$,W,j),C.map.showCollisionBoxes&&(ar(x,C,z,L,!0),ar(x,C,z,L,!1))})(t,a,c,d,this.style.placement.variableOffsets,y):l.cn(c)?(function(x,C,z,L,k){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:V}=k,j=z.paint.get("circle-opacity"),$=z.paint.get("circle-stroke-width"),W=z.paint.get("circle-stroke-opacity"),ae=!z.layout.get("circle-sort-key").isConstant();if(j.constantOr(1)===0&&($.constantOr(1)===0||W.constantOr(1)===0))return;const se=x.context,oe=se.gl,fe=x.transform,ye=x.getDepthModeForSublayer(0,rn.ReadOnly),he=wn.disabled,_e=x.colorModeForRenderPass(),we=[],ge=fe.getCircleRadiusCorrection();for(let Ae=0;Ae<L.length;Ae++){const Ge=L[Ae],Fe=C.getTile(Ge),je=Fe.getBucket(z);if(!je)continue;const Ve=z.paint.get("circle-translate"),vt=z.paint.get("circle-translate-anchor"),xt=l.aO(fe,Fe,Ve,vt),ct=je.programConfigurations.get(z.id),St=x.useProgram("circle",ct),en=je.layoutVertexBuffer,Ln=je.indexBuffer,Jn=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ge),Yn={programConfiguration:ct,program:St,layoutVertexBuffer:en,indexBuffer:Ln,uniformValues:Kc(x,Fe,z,xt,ge),terrainData:Jn,projectionData:fe.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!V,applyTerrainMatrix:!0})};if(ae){const ai=je.segments.get();for(const Vn of ai)we.push({segments:new l.aX([Vn]),sortKey:Vn.sortKey,state:Yn})}else we.push({segments:je.segments,sortKey:0,state:Yn})}ae&&we.sort(((Ae,Ge)=>Ae.sortKey-Ge.sortKey));for(const Ae of we){const{programConfiguration:Ge,program:Fe,layoutVertexBuffer:je,indexBuffer:Ve,uniformValues:vt,terrainData:xt,projectionData:ct}=Ae.state;Fe.draw(se,oe.TRIANGLES,ye,he,_e,pn.backCCW,vt,xt,ct,z.id,je,Ve,Ae.segments,z.paint,x.transform.zoom,Ge)}})(t,a,c,d,y):l.co(c)?(function(x,C,z,L,k){if(z.paint.get("heatmap-opacity")===0)return;const V=x.context,{isRenderingToTexture:j,isRenderingGlobe:$}=k;if(x.style.map.terrain){for(const W of L){const ae=C.getTile(W);C.hasRenderableParent(W)||(x.renderPass==="offscreen"?sd(x,ae,z,W,$):x.renderPass==="translucent"&&or(x,z,W,j,$))}V.viewport.set([0,0,x.width,x.height])}else x.renderPass==="offscreen"?(function(W,ae,se,oe){const fe=W.context,ye=fe.gl,he=W.transform,_e=wn.disabled,we=new jn([ye.ONE,ye.ONE],l.bp.transparent,[!0,!0,!0,!0]);(function(ge,Ae,Ge){const Fe=ge.gl;ge.activeTexture.set(Fe.TEXTURE1),ge.viewport.set([0,0,Ae.width/4,Ae.height/4]);let je=Ge.heatmapFbos.get(l.cd);je?(Fe.bindTexture(Fe.TEXTURE_2D,je.colorAttachment.get()),ge.bindFramebuffer.set(je.framebuffer)):(je=Xn(ge,Ae.width/4,Ae.height/4),Ge.heatmapFbos.set(l.cd,je))})(fe,W,se),fe.clear({color:l.bp.transparent});for(let ge=0;ge<oe.length;ge++){const Ae=oe[ge];if(ae.hasRenderableParent(Ae))continue;const Ge=ae.getTile(Ae),Fe=Ge.getBucket(se);if(!Fe)continue;const je=Fe.programConfigurations.get(se.id),Ve=W.useProgram("heatmap",je),vt=he.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),xt=he.getCircleRadiusCorrection();Ve.draw(fe,ye.TRIANGLES,rn.disabled,_e,we,pn.backCCW,Ss(Ge,he.zoom,se.paint.get("heatmap-intensity"),xt),null,vt,se.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,se.paint,he.zoom,je)}fe.viewport.set([0,0,W.width,W.height])})(x,C,z,L):x.renderPass==="translucent"&&(function(W,ae){const se=W.context,oe=se.gl;se.setColorMode(W.colorModeForRenderPass());const fe=ae.heatmapFbos.get(l.cd);fe&&(se.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_2D,fe.colorAttachment.get()),se.activeTexture.set(oe.TEXTURE1),xn(se,ae).bind(oe.LINEAR,oe.CLAMP_TO_EDGE),W.useProgram("heatmapTexture").draw(se,oe.TRIANGLES,rn.disabled,wn.disabled,W.colorModeForRenderPass(),pn.disabled,ed(W,ae,0,1),null,null,ae.id,W.viewportBuffer,W.quadTriangleIndexBuffer,W.viewportSegments,ae.paint,W.transform.zoom))})(x,z)})(t,a,c,d,y):l.cp(c)?(function(x,C,z,L,k){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:V}=k,j=z.paint.get("line-opacity"),$=z.paint.get("line-width");if(j.constantOr(1)===0||$.constantOr(1)===0)return;const W=x.getDepthModeForSublayer(0,rn.ReadOnly),ae=x.colorModeForRenderPass(),se=z.paint.get("line-dasharray"),oe=se.constantOr(1),fe=z.paint.get("line-pattern"),ye=fe.constantOr(1),he=z.paint.get("line-gradient"),_e=z.getCrossfadeParameters();let we;we=ye?"linePattern":oe&&he?"lineGradientSDF":oe?"lineSDF":he?"lineGradient":"line";const ge=x.context,Ae=ge.gl,Ge=x.transform;let Fe=!0;for(const je of L){const Ve=C.getTile(je);if(ye&&!Ve.patternsLoaded())continue;const vt=Ve.getBucket(z);if(!vt)continue;const xt=vt.programConfigurations.get(z.id),ct=x.context.program.get(),St=x.useProgram(we,xt),en=Fe||St.program!==ct,Ln=x.style.map.terrain&&x.style.map.terrain.getTerrainData(je),Jn=fe.constantOr(null),Yn=se&&se.constantOr(null);if(Jn&&Ve.imageAtlas){const sr=Ve.imageAtlas,Ei=sr.patternPositions[Jn.to.toString()],Ci=sr.patternPositions[Jn.from.toString()];Ei&&Ci&&xt.setConstantPatternPositions(Ei,Ci)}else if(Yn){const sr=z.layout.get("line-cap")==="round",Ei=x.lineAtlas.getDash(Yn.to,sr),Ci=x.lineAtlas.getDash(Yn.from,sr);xt.setConstantDashPositions(Ei,Ci)}const ai=Ge.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),Vn=Ge.getPixelScale();let _i;ye?(_i=td(x,Ve,z,Vn,_e),la(ge,Ae,Ve,xt,_e)):oe&&he?(_i=Ts(x,Ve,z,Vn,_e,vt.lineClipsArray.length),qr(x,C,ge,Ae,z,vt,je,xt,_e)):oe?(_i=Vr(x,Ve,z,Vn,_e),mi(x,ge,Ae,xt,en,_e)):he?(_i=Af(x,Ve,z,Vn,vt.lineClipsArray.length),Gr(x,C,ge,Ae,z,vt,je)):_i=eu(x,Ve,z,Vn);const oi=x.stencilModeForClipping(je);St.draw(ge,Ae.TRIANGLES,W,oi,ae,pn.disabled,_i,Ln,ai,z.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,z.paint,x.transform.zoom,xt,vt.layoutVertexBuffer2),Fe=!1}})(t,a,c,d,y):l.cq(c)?(function(x,C,z,L,k){const V=z.paint.get("fill-color"),j=z.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const{isRenderingToTexture:$}=k,W=x.colorModeForRenderPass(),ae=z.paint.get("fill-pattern"),se=x.opaquePassEnabledForLayer()&&!ae.constantOr(1)&&V.constantOr(l.bp.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===se){const oe=x.getDepthModeForSublayer(1,x.renderPass==="opaque"?rn.ReadWrite:rn.ReadOnly);wo(x,C,z,L,oe,W,!1,$)}if(x.renderPass==="translucent"&&z.paint.get("fill-antialias")){const oe=x.getDepthModeForSublayer(z.getPaintProperty("fill-outline-color")?2:0,rn.ReadOnly);wo(x,C,z,L,oe,W,!0,$)}})(t,a,c,d,y):l.cr(c)?(function(x,C,z,L,k){const V=z.paint.get("fill-extrusion-opacity");if(V===0)return;const{isRenderingToTexture:j}=k;if(x.renderPass==="translucent"){const $=new rn(x.context.gl.LEQUAL,rn.ReadWrite,x.depthRangeFor3D);if(V!==1||z.paint.get("fill-extrusion-pattern").constantOr(1))So(x,C,z,L,$,wn.disabled,jn.disabled,j),So(x,C,z,L,$,x.stencilModeFor3D(),x.colorModeForRenderPass(),j);else{const W=x.colorModeForRenderPass();So(x,C,z,L,$,wn.disabled,W,j)}}})(t,a,c,d,y):l.cs(c)?(function(x,C,z,L,k){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const{isRenderingToTexture:V}=k,j=x.context,$=x.style.projection.useSubdivision,W=x.getDepthModeForSublayer(0,rn.ReadOnly),ae=x.colorModeForRenderPass();if(x.renderPass==="offscreen")(function(se,oe,fe,ye,he,_e,we){const ge=se.context,Ae=ge.gl;for(const Ge of fe){const Fe=oe.getTile(Ge),je=Fe.dem;if(!je||!je.data||!Fe.needsHillshadePrepare)continue;const Ve=je.dim,vt=je.stride,xt=je.getPixels();if(ge.activeTexture.set(Ae.TEXTURE1),ge.pixelStoreUnpackPremultiplyAlpha.set(!1),Fe.demTexture=Fe.demTexture||se.getTileTexture(vt),Fe.demTexture){const St=Fe.demTexture;St.update(xt,{premultiply:!1}),St.bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE)}else Fe.demTexture=new l.T(ge,xt,Ae.RGBA,{premultiply:!1}),Fe.demTexture.bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE);ge.activeTexture.set(Ae.TEXTURE0);let ct=Fe.fbo;if(!ct){const St=new l.T(ge,{width:Ve,height:Ve,data:null},Ae.RGBA);St.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),ct=Fe.fbo=ge.createFramebuffer(Ve,Ve,!0,!1),ct.colorAttachment.set(St.texture)}ge.bindFramebuffer.set(ct.framebuffer),ge.viewport.set([0,0,Ve,Ve]),se.useProgram("hillshadePrepare").draw(ge,Ae.TRIANGLES,he,_e,we,pn.disabled,Cf(Fe.tileID,je),null,null,ye.id,se.rasterBoundsBuffer,se.quadTriangleIndexBuffer,se.rasterBoundsSegments),Fe.needsHillshadePrepare=!1}})(x,C,L,z,W,wn.disabled,ae),j.viewport.set([0,0,x.width,x.height]);else if(x.renderPass==="translucent")if($){const[se,oe,fe]=x.stencilConfigForOverlapTwoPass(L);To(x,C,z,fe,se,W,ae,!1,V),To(x,C,z,fe,oe,W,ae,!0,V)}else{const[se,oe]=x.getStencilConfigForOverlapAndUpdateStencilID(L);To(x,C,z,oe,se,W,ae,!1,V)}})(t,a,c,d,y):l.ct(c)?(function(x,C,z,L,k){if(x.renderPass!=="translucent"||!L.length)return;const{isRenderingToTexture:V}=k,j=x.style.projection.useSubdivision,$=x.getDepthModeForSublayer(0,rn.ReadOnly),W=x.colorModeForRenderPass();if(j){const[ae,se,oe]=x.stencilConfigForOverlapTwoPass(L);Ho(x,C,z,oe,ae,$,W,!1,V),Ho(x,C,z,oe,se,$,W,!0,V)}else{const[ae,se]=x.getStencilConfigForOverlapAndUpdateStencilID(L);Ho(x,C,z,se,ae,$,W,!1,V)}})(t,a,c,d,y):l.bU(c)?(function(x,C,z,L,k){if(x.renderPass!=="translucent"||z.paint.get("raster-opacity")===0||!L.length)return;const{isRenderingToTexture:V}=k,j=C.getSource(),$=x.style.projection.useSubdivision;if(j instanceof Dr)Ma(x,C,z,L,null,!1,!1,j.tileCoords,j.flippedWindingOrder,V);else if($){const[W,ae,se]=x.stencilConfigForOverlapTwoPass(L);Ma(x,C,z,se,W,!1,!0,Xo,!1,V),Ma(x,C,z,se,ae,!0,!0,Xo,!1,V)}else{const[W,ae]=x.getStencilConfigForOverlapAndUpdateStencilID(L);Ma(x,C,z,ae,W,!1,!0,Xo,!1,V)}})(t,a,c,d,y):l.cu(c)?(function(x,C,z,L,k){const V=z.paint.get("background-color"),j=z.paint.get("background-opacity");if(j===0)return;const{isRenderingToTexture:$}=k,W=x.context,ae=W.gl,se=x.style.projection,oe=x.transform,fe=oe.tileSize,ye=z.paint.get("background-pattern");if(x.isPatternMissing(ye))return;const he=!ye&&V.a===1&&j===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==he)return;const _e=wn.disabled,we=x.getDepthModeForSublayer(0,he==="opaque"?rn.ReadWrite:rn.ReadOnly),ge=x.colorModeForRenderPass(),Ae=x.useProgram(ye?"backgroundPattern":"background"),Ge=L||ti(oe,{tileSize:fe,terrain:x.style.map.terrain});ye&&(W.activeTexture.set(ae.TEXTURE0),x.imageManager.bind(x.context));const Fe=z.getCrossfadeParameters();for(const je of Ge){const Ve=oe.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),vt=ye?ru(j,x,ye,{tileID:je,tileSize:fe},Fe):iu(j,V),xt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(je),ct=se.getMeshFromTileID(W,je.canonical,!1,!0,"raster");Ae.draw(W,ae.TRIANGLES,we,_e,ge,pn.backCCW,vt,xt,Ve,z.id,ct.vertexBuffer,ct.indexBuffer,ct.segments)}})(t,0,c,d,y):l.cv(c)&&(function(x,C,z,L){const{isRenderingGlobe:k}=L,V=x.context,j=z.implementation,$=x.style.projection,W=x.transform,ae=W.getProjectionDataForCustomLayer(k),se={farZ:W.farZ,nearZ:W.nearZ,fov:W.fov*Math.PI/180,modelViewProjectionMatrix:W.modelViewProjectionMatrix,projectionMatrix:W.projectionMatrix,shaderData:{variantName:$.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${$.shaderPreludeCode.vertexSource}`,define:$.shaderDefine},defaultProjectionData:ae},oe=j.renderingMode?j.renderingMode:"2d";if(x.renderPass==="offscreen"){const fe=j.prerender;fe&&(x.setCustomLayerDefaults(),V.setColorMode(x.colorModeForRenderPass()),fe.call(j,V.gl,se),V.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),V.setColorMode(x.colorModeForRenderPass()),V.setStencilMode(wn.disabled);const fe=oe==="3d"?x.getDepthModeFor3D():x.getDepthModeForSublayer(0,rn.ReadOnly);V.setDepthMode(fe),j.render(V.gl,se),V.setDirty(),x.setBaseState(),V.bindFramebuffer.set(null)}})(t,0,c,y))}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!a||!c}useProgram(t,a,c=!1,d=[]){this.cache=this.cache||{};const y=!!this.style.map.terrain,x=this.style.projection,C=c?si.projectionMercator:x.shaderPreludeCode,z=c?wi:x.shaderDefine,L=t+(a?a.cacheKey:"")+`/${c?Ir:x.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(y?"/terrain":"")+(d?`/${d.join("/")}`:"");return this.cache[L]||(this.cache[L]=new Sf(this.context,si[t],a,zf[t],this._showOverdrawInspector,y,C,z,d)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var t,a;if(this._tileTextures){for(const c in this._tileTextures){const d=this._tileTextures[c];if(d)for(const y of d)y.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((t=this.tileExtentMesh.vertexBuffer)===null||t===void 0||t.destroy()),this.tileExtentMesh&&((a=this.tileExtentMesh.indexBuffer)===null||a===void 0||a.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const c in this.cache){const d=this.cache[c];d&&d.program&&this.context.gl.deleteProgram(d.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}function cd(g,t){let a,c=!1,d=null,y=null;const x=()=>{d=null,c&&(g.apply(y,a),d=setTimeout(x,t),c=!1)};return(...C)=>(c=!0,y=this,a=C,d||x(),d)}class Ii{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let c;return a.split("&").map((d=>d.split("="))).forEach((d=>{d[0]===this._hashName&&(c=d)})),(c&&c[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:c,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const c=a.join("/");let d=c;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${c}`);let y=window.location.hash.replace(d,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let x=window.location.href.replace(/(#.+)?$/,y);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=cd(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,d),x=Math.round(a.lng*y)/y,C=Math.round(a.lat*y)/y,z=this._map.getBearing(),L=this._map.getPitch();let k="";if(k+=t?`/${x}/${C}/${c}`:`${c}/${C}/${x}`,(z||L)&&(k+="/"+Math.round(10*z)/10),L&&(k+=`/${Math.round(L)}`),this._hashName){const V=this._hashName;let j=!1;const $=window.location.hash.slice(1).split("&").map((W=>{const ae=W.split("=")[0];return ae===V?(j=!0,`${ae}=${k}`):W})).filter((W=>W));return j||$.push(`${V}=${k}`),`#${$.join("&")}`}return`#${k}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new l.V(+t[2],+t[1])}catch{return!1}const a=+t[0],c=+(t[3]||0),d=+(t[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&c>=-180&&c<=180&&d>=this._map.getMinPitch()&&d<=this._map.getMaxPitch()}}const Mo={linearity:.3,easing:l.cw(0,0,.3,1)},sc=l.e({deceleration:2500,maxSpeed:1400},Mo),wr=l.e({deceleration:20,maxSpeed:1400},Mo),ua=l.e({deceleration:1e3,maxSpeed:360},Mo),ul=l.e({deceleration:1e3,maxSpeed:90},Mo),Sr=l.e({deceleration:1e3,maxSpeed:360},Mo);class im{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:xe(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=xe();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)a.zoom+=y.zoomDelta||0,a.bearing+=y.bearingDelta||0,a.pitch+=y.pitchDelta||0,a.roll+=y.rollDelta||0,y.panDelta&&a.pan._add(y.panDelta),y.around&&(a.around=y.around),y.pinchAround&&(a.pinchAround=y.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const y=hu(a.pan.mag(),c,l.e({},sc,t||{})),x=a.pan.mult(y.amount/a.pan.mag()),C=this._map.cameraHelper.handlePanInertia(x,this._map.transform);d.center=C.easingCenter,d.offset=C.easingOffset,lc(d,y)}if(a.zoom){const y=hu(a.zoom,c,wr),x=l.cx(this._map.transform.zoom+y.amount,this._map.getZoomSnap(),y.amount);d.zoom=x,lc(d,y)}if(a.bearing){const y=hu(a.bearing,c,ua);d.bearing=this._map.transform.bearing+l.an(y.amount,-179,179),lc(d,y)}if(a.pitch){const y=hu(a.pitch,c,ul);d.pitch=this._map.transform.pitch+y.amount,lc(d,y)}if(a.roll){const y=hu(a.roll,c,Sr);d.roll=this._map.transform.roll+l.an(y.amount,-179,179),lc(d,y)}if(d.zoom||d.bearing){const y=a.pinchAround===void 0?a.around:a.pinchAround;d.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),l.e(d,{noMoveStart:!0})}}function lc(g,t){(!g.duration||g.duration<t.duration)&&(g.duration=t.duration,g.easing=t.easing)}function hu(g,t,a){const{maxSpeed:c,linearity:d,deceleration:y}=a,x=l.an(g*d/(t/1e3),-c,c),C=Math.abs(x)/(y*d);return{easing:a.easing,duration:1e3*C,amount:x*(C/2)}}class ir extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,c,d={}){c=c instanceof MouseEvent?c:new MouseEvent(t,c);const y=ie.mousePos(a.getCanvas(),c),x=a.unproject(y);super(t,l.e({point:y,lngLat:x,originalEvent:c},d)),this._defaultPrevented=!1,this.target=a}}class Xa extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,c){const d=t==="touchend"?c.changedTouches:c.touches,y=ie.touchPos(a.getCanvasContainer(),d),x=y.map((z=>a.unproject(z))),C=y.reduce(((z,L,k,V)=>z.add(L.div(V.length))),new l.P(0,0));super(t,{points:y,point:C,lngLats:x,lngLat:a.unproject(C),originalEvent:c}),this._defaultPrevented=!1}}class lh extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class ch{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new lh(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new ir(t.type,this._map,t))}mouseup(t){this._map.fire(new ir(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new ir(t.type,this._map,t))}dblclick(t){return this._firePreventable(new ir(t.type,this._map,t))}mouseover(t){this._map.fire(new ir(t.type,this._map,t))}mouseout(t){this._map.fire(new ir(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Xa(t.type,this._map,t))}touchmove(t){this._map.fire(new Xa(t.type,this._map,t))}touchend(t){this._map.fire(new Xa(t.type,this._map,t))}touchcancel(t){this._map.fire(new Xa(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rf{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new ir(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ir("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new ir(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ya{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(l.P.convert(t),this._map.terrain)}}class Ps{constructor(t,a){this._map=t,this._tr=new Ya(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(ie.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const c=a;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=c,this._box||(this._box=ie.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const y=Math.min(d.x,c.x),x=Math.max(d.x,c.x),C=Math.min(d.y,c.y),z=Math.max(d.y,c.y);ie.setTransform(this._box,`translate(${y}px,${C}px)`),this._box.style.width=x-y+"px",this._box.style.height=z-C+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const c=this._startPos,d=a;if(this.reset(),ie.suppressClick(),c.x!==d.x||c.y!==d.y)return this._map.fire(new l.l("boxzoomend",{originalEvent:t})),{cameraAnimation:y=>y.fitScreenCoordinates(c,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ie.remove(this._box),this._box=null),ie.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new l.l(t,{originalEvent:a}))}}function $r(g,t){if(g.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${t.length}`);const a={};for(let c=0;c<g.length;c++)a[g[c].identifier]=t[c];return a}class zt{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=(function(d){const y=new l.P(0,0);for(const x of d)y._add(x);return y.div(d.length)})(a),this.touches=$r(c,a)))}touchmove(t,a,c){if(this.aborted||!this.centroid)return;const d=$r(c,a);for(const y in this.touches){const x=d[y];(!x||x.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(t,a,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class du{constructor(t){this.singleTap=new zt(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,c){this.singleTap.touchstart(t,a,c)}touchmove(t,a,c){this.singleTap.touchmove(t,a,c)}touchend(t,a,c){const d=this.singleTap.touchend(t,a,c);if(d){const y=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(d)<30;if(y&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class uh{constructor(t){this._tr=new Ya(t),this._zoomIn=new du({numTouches:1,numTaps:2}),this._zoomOut=new du({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,c){this._zoomIn.touchstart(t,a,c),this._zoomOut.touchstart(t,a,c)}touchmove(t,a,c){this._zoomIn.touchmove(t,a,c),this._zoomOut.touchmove(t,a,c)}touchend(t,a,c){const d=this._zoomIn.touchend(t,a,c),y=this._zoomOut.touchend(t,a,c),x=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:l.cx(x.zoom+1,C.getZoomSnap()),around:x.unproject(d)},{originalEvent:t})}):y?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:l.cx(x.zoom-1,C.getZoomSnap()),around:x.unproject(y)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Aa{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=Array.isArray(a)?a[0]:a;return!this._moved&&d.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(c,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&ie.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Wa=0,cc=2,hh={[Wa]:1,[cc]:2};class Ao{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=ie.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(a,c){const d=hh[c];return a.buttons===void 0||(a.buttons&d)!==d})(t,this._eventButton)}isValidEndEvent(t){return ie.mouseButton(t)===this._eventButton}}class hl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class fu{constructor(t=new Ao({checkCorrectEvent:()=>!0}),a=new hl){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(t,a,c){return t instanceof MouseEvent?a(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?c(t):void 0}startMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const zo=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=t=>{t.preventDefault()}};class dh{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,c){return this._calculateTransform(t,a,c)}touchmove(t,a,c){if(this._active){if(!this._shouldBePrevented(c.length))return t.preventDefault(),this._calculateTransform(t,a,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,c){this._calculateTransform(t,a,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,c){c.length>0&&(this._active=!0);const d=$r(c,a),y=new l.P(0,0),x=new l.P(0,0);let C=0;for(const L in d){const k=d[L],V=this._touches[L];V&&(y._add(k),x._add(k.sub(V)),C++,d[L]=k)}if(this._touches=d,this._shouldBePrevented(C)||!x.mag())return;const z=x.div(C);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(C),panDelta:z}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,c){if(!this._firstTwoTouches)return;t.preventDefault();const[d,y]=this._firstTwoTouches,x=Do(c,a,d),C=Do(c,a,y);if(!x||!C)return;const z=this._aroundCenter?null:x.add(C).div(2);return this._move([x,C],z,t)}touchend(t,a,c){if(!this._firstTwoTouches)return;const[d,y]=this._firstTwoTouches,x=Do(c,a,d),C=Do(c,a,y);x&&C||(this._active&&ie.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Do(g,t,a){for(let c=0;c<g.length;c++)if(g[c].identifier===a)return t[c]}function ud(g,t){return Math.log(g/t)/Math.LN2}class Po extends pu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(ud(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ud(this._distance,c),pinchAround:a}}}function fh(g,t){return 180*g.angleWith(t)/Math.PI}class mu extends pu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,c){const d=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:fh(this._vector,d),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,c=fh(t,this._startVector);return Math.abs(c)<a}}function Ro(g){return Math.abs(g.y)>Math.abs(g.x)}class Ko extends pu{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,c){super.touchstart(t,a,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,Ro(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),y=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,y,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,c){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,y=a.mag()>=2;if(!d&&!y)return;if(!d||!y)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const x=t.y>0==a.y>0;return Ro(t)&&Ro(a)&&x}}const za={panStep:100,bearingStep:15,pitchStep:10};class On{constructor(t){this._tr=new Ya(t);const a=za;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,c=0,d=0,y=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),y=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),y=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(c=0,d=0),{cameraAnimation:C=>{const z=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:hd,zoom:a?l.cx(z.zoom+a*(t.shiftKey?2:1),C.getZoomSnap()):z.zoom,bearing:z.bearing+c*this._bearingStep,pitch:z.pitch+d*this._pitchStep,offset:[-y*this._panStep,-x*this._panStep],center:z.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function hd(g){return g*(2-g)}const Qo=4.000244140625,Rs=1/450;class gu{constructor(t,a){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=t,this._tr=new Ya(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Rs}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=xe(),d=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,a!==0&&a%Qo==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=ie.mousePos(this._map.getCanvas(),t),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(l.V.convert(c.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const C=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=C),typeof this._targetZoom=="number"&&(this._targetZoom+=C)}if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Qo?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&z!==0&&(z=1/z);const L=typeof this._targetZoom!="number"?t.scale:l.aq(this._targetZoom),k=t.applyConstrain(t.getCameraLngLat(),l.at(L*z)).zoom,V=this._map.getZoomSnap();if(this._type==="wheel"&&V>0){const j=l.cx(t.zoom,V);this._targetZoom=l.cx(k,V,k-j)}else this._targetZoom=k;this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,c=this._startZoom,d=this._easing;let y,x=!1;if(this._type==="wheel"&&c&&d){const C=xe()-this._lastWheelEventTime,z=Math.min((C+5)/200,1),L=d(z);y=l.G.number(c,a,L),z<1?this._frameId||(this._frameId=!0):x=!0}else y=a,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!x,zoomDelta:y-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=l.cz;if(this._prevEase){const c=this._prevEase,d=(xe()-c.start)/c.duration,y=c.easing(d+.01)-c.easing(d),x=.27/Math.sqrt(y*y+1e-4)*.01,C=Math.sqrt(.0729-x*x);a=l.cw(x,C,.25,1)}return this._prevEase={start:xe(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class ph{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class dl{constructor(t){this._tr=new Ya(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:l.cx(this._tr.zoom+(t.shiftKey?-1:1),c.getZoomSnap()),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _u{constructor(){this._tap=new du({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,c){if(!this._swipePoint)if(this._tapTime){const d=a[0],y=t.timeStamp-this._tapTime<500,x=this._tapPoint.dist(d)<30;y&&x?c.length>0&&(this._swipePoint=d,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(t,a,c)}touchmove(t,a,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const d=a[0],y=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(t,a,c)}touchend(t,a,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const d=this._tap.touchend(t,a,c);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dd{constructor(t,a,c){this._el=t,this._mousePan=a,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ha{constructor(t,a,c,d){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=a,this._mousePitch=c,this._mouseRoll=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class fl{constructor(t,a,c,d){this._el=t,this._touchZoom=a,this._touchRotate=c,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Dt{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=ie.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=a,this._container.appendChild(d);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=c,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ie.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new l.l("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Bt=g=>g.zoom||g.drag||g.roll||g.pitch||g.rotate;class Da extends l.l{}function uc(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta||g.rollDelta}class yu{get _ownerDocument(){var t;return((t=this._el)===null||t===void 0?void 0:t.ownerDocument)||document}get _ownerWindow(){var t,a;return((a=(t=this._el)===null||t===void 0?void 0:t.ownerDocument)===null||a===void 0?void 0:a.defaultView)||window}constructor(t,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,y)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=d.type==="renderFrame"?void 0:d,C={needsRenderFrame:!1},z={},L={};for(const{handlerName:j,handler:$,allowed:W}of this._handlers){if(!$.isEnabled())continue;let ae;if(this._blockedByActive(L,W,j))$.reset();else if($[y||d.type]){if(l.cA(d,y||d.type)){const se=ie.mousePos(this._map.getCanvas(),d);ae=$[y||d.type](d,se)}else if(l.cB(d,y||d.type)){const se=this._getMapTouches(d.touches),oe=ie.touchPos(this._map.getCanvas(),se);ae=$[y||d.type](d,oe,se)}else l.cC(y||d.type)||(ae=$[y||d.type](d));this.mergeHandlerResult(C,z,ae,j,x),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()}(ae||$.isActive())&&(L[j]=$)}const k={};for(const j in this._previousActiveHandlers)L[j]||(k[j]=x);this._previousActiveHandlers=L,(Object.keys(k).length||uc(C))&&(this._changes.push([C,z,k]),this._triggerRenderFrame()),(Object.keys(L).length||uc(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=C;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new im(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[this._ownerDocument,"mousemove",{capture:!0}],[this._ownerDocument,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[this._ownerWindow,"blur",void 0]];for(const[d,y,x]of this._listeners)ie.addEventListener(d,y,d===this._ownerDocument?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,a,c]of this._listeners)ie.removeEventListener(t,a,t===this._ownerDocument?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const a=this._map,c=a.getCanvasContainer();this._add("mapEvent",new ch(a,t));const d=a.boxZoom=new Ps(a,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const y=a.cooperativeGestures=new Dt(a,t.cooperativeGestures);this._add("cooperativeGestures",y),t.cooperativeGestures&&y.enable();const x=new uh(a),C=new dl(a);a.doubleClickZoom=new ph(C,x),this._add("tapZoom",x),this._add("clickZoom",C),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const z=new _u;this._add("tapDragZoom",z);const L=a.touchPitch=new Ko(a);this._add("touchPitch",L),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const k=()=>a.project(a.getCenter()),V=(function({enable:he,clickTolerance:_e,aroundCenter:we=!0,minPixelCenterThreshold:ge=100,rotateDegreesPerPixelMoved:Ae=.8},Ge){const Fe=new Ao({checkCorrectEvent:je=>ie.mouseButton(je)===0&&je.ctrlKey||ie.mouseButton(je)===2&&!je.ctrlKey});return new Aa({clickTolerance:_e,move:(je,Ve)=>{const vt=Ge();if(we&&Math.abs(vt.y-je.y)>ge)return{bearingDelta:l.cy(new l.P(je.x,Ve.y),Ve,vt)};let xt=(Ve.x-je.x)*Ae;return we&&Ve.y<vt.y&&(xt=-xt),{bearingDelta:xt}},moveStateManager:Fe,enable:he,assignEvents:zo})})(t,k),j=(function({enable:he,clickTolerance:_e,pitchDegreesPerPixelMoved:we=-.5}){const ge=new Ao({checkCorrectEvent:Ae=>ie.mouseButton(Ae)===0&&Ae.ctrlKey||ie.mouseButton(Ae)===2});return new Aa({clickTolerance:_e,move:(Ae,Ge)=>({pitchDelta:(Ge.y-Ae.y)*we}),moveStateManager:ge,enable:he,assignEvents:zo})})(t),$=(function({enable:he,clickTolerance:_e,rollDegreesPerPixelMoved:we=.3},ge){const Ae=new Ao({checkCorrectEvent:Ge=>ie.mouseButton(Ge)===2&&Ge.ctrlKey});return new Aa({clickTolerance:_e,move:(Ge,Fe)=>{const je=ge();let Ve=(Fe.x-Ge.x)*we;return Fe.y<je.y&&(Ve=-Ve),{rollDelta:Ve}},moveStateManager:Ae,enable:he,assignEvents:zo})})(t,k);a.dragRotate=new ha(t,V,j,$),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",j,["mouseRotate","mouseRoll"]),this._add("mouseRoll",$,["mousePitch"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const W=(function({enable:he,clickTolerance:_e}){const we=new Ao({checkCorrectEvent:ge=>ie.mouseButton(ge)===0&&!ge.ctrlKey});return new Aa({clickTolerance:_e,move:(ge,Ae)=>({around:Ae,panDelta:Ae.sub(ge)}),activateOnStart:!0,moveStateManager:we,enable:he,assignEvents:zo})})(t),ae=new dh(t,a);a.dragPan=new dd(c,W,ae),this._add("mousePan",W),this._add("touchPan",ae,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const se=new mu,oe=new Po;a.touchZoomRotate=new fl(c,oe,se,z),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate),this._add("blockableMapEvent",new Rf(a));const fe=a.scrollZoom=new gu(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",fe,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const ye=a.keyboard=new On(a);this._add("keyboard",ye),t.interactive&&t.keyboard&&a.keyboard.enable()}_add(t,a,c){this._handlers.push({handlerName:t,handler:a,allowed:c}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Bt(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,c){for(const d in t)if(d!==c&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const c of t)this._el.contains(c.target)&&a.push(c);return a}mergeHandlerResult(t,a,c,d,y){if(!c)return;l.e(t,c);const x={handlerName:d,originalEvent:c.originalEvent||y};c.zoomDelta!==void 0&&(a.zoom=x),c.panDelta!==void 0&&(a.drag=x),c.rollDelta!==void 0&&(a.roll=x),c.pitchDelta!==void 0&&(a.pitch=x),c.bearingDelta!==void 0&&(a.rotate=x)}_applyChanges(){const t={},a={},c={};for(const[d,y,x]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new l.P(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.rollDelta&&(t.rollDelta=(t.rollDelta||0)+d.rollDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),l.e(a,y),l.e(c,x);this._updateMapTransform(t,a,c),this._changes=[]}_updateMapTransform(t,a,c){const d=this._map,y=d._getTransformForUpdate(),x=d.terrain;if(!(uc(t)||x&&this._terrainMovement))return this._fireEvents(a,c,!0);d._stop(!0);let{panDelta:C,zoomDelta:z,bearingDelta:L,pitchDelta:k,rollDelta:V,around:j,pinchAround:$}=t;$!==void 0&&(j=$),j=j||d.transform.centerPoint,x&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const W={panDelta:C,zoomDelta:z,rollDelta:V,pitchDelta:k,bearingDelta:L,around:j};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(j)&&(j=y.centerPoint);const ae=j.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(C?j.sub(C):j);this._handleMapControls({terrain:x,tr:y,deltasForHelper:W,preZoomAroundLoc:ae,combinedEventsInProgress:a,panDelta:C}),d._applyUpdatedTransform(y),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,c,!0)}_handleMapControls({terrain:t,tr:a,deltasForHelper:c,preZoomAroundLoc:d,combinedEventsInProgress:y,panDelta:x}){const C=this._map.cameraHelper;if(C.handleMapControlsRollPitchBearingZoom(c,a),t)return C.useGlobeControls?(this._terrainMovement||!y.drag&&!y.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void C.handleMapControlsPan(c,a,d)):this._terrainMovement||!y.drag&&!y.zoom?void(y.drag&&this._terrainMovement&&x?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(x))):C.handleMapControlsPan(c,a,d)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void C.handleMapControlsPan(c,a,d));C.handleMapControlsPan(c,a,d)}_fireEvents(t,a,c){const d=Bt(this._eventsInProgress),y=Bt(t),x={};for(const V in t){const{originalEvent:j}=t[V];this._eventsInProgress[V]||(x[`${V}start`]=j),this._eventsInProgress[V]=t[V]}!d&&y&&this._fireEvent("movestart",y.originalEvent);for(const V in x)this._fireEvent(V,x[V]);y&&this._fireEvent("move",y.originalEvent);for(const V in t){const{originalEvent:j}=t[V];this._fireEvent(V,j)}const C={};let z;for(const V in this._eventsInProgress){const{handlerName:j,originalEvent:$}=this._eventsInProgress[V];this._handlersById[j].isActive()||(delete this._eventsInProgress[V],z=a[j]||$,C[`${V}end`]=z)}for(const V in C)this._fireEvent(V,C[V]);const L=Bt(this._eventsInProgress),k=(d||y)&&!L;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const V=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&V.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(V)}if(c&&k){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;!V||!V.essential&&ce.prefersReducedMotion?(this._map.fire(new l.l("moveend",{originalEvent:z})),j(this._map.getBearing())&&this._map.resetNorth()):(j(V.bearing||this._map.getBearing())&&(V.bearing=0),V.freezeElevation=!0,this._map.easeTo(V,{originalEvent:z})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new l.l(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Da("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Li extends l.E{constructor(t,a,c){super(),this._renderFrameCallback=()=>{const d=Math.min((xe()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=c.bearingSnap,this._zoomSnap=c.zoomSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,a){t.apply(this.transform,!0),this.transform=t,this.cameraHelper=a}getCenter(){return new l.V(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,a){return this.jumpTo({elevation:t},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,a,c){return t=l.P.convert(t).mult(-1),this.panTo(this.transform.center,l.e({offset:t},a),c)}panTo(t,a,c){return this.easeTo(l.e({center:t},a),c)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,c){return this.easeTo(l.e({zoom:t},a),c)}zoomIn(t,a){return this.zoomTo(l.cx(this.getZoom()+1,this._zoomSnap),t,a),this}zoomOut(t,a){return this.zoomTo(l.cx(this.getZoom()-1,this._zoomSnap),t,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,a){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new l.l("movestart",a)).fire(new l.l("move",a)).fire(new l.l("moveend",a))),this}getBearing(){return this.transform.bearing}setZoomSnap(t){return this._zoomSnap=t,this}getZoomSnap(){return this._zoomSnap}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,c){return this.easeTo(l.e({bearing:t},a),c)}resetNorth(t,a){return this.rotateTo(0,l.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(l.e({bearing:0,pitch:0,roll:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}getRoll(){return this.transform.roll}setRoll(t,a){return this.jumpTo({roll:t},a),this}cameraForBounds(t,a){t=Zn.convert(t).adjustAntiMeridian();const c=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,a)}_cameraForBoxAndBearing(t,a,c,d){const y={top:0,bottom:0,right:0,left:0};if(typeof(d=l.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const L=d.padding;d.padding={top:L,bottom:L,right:L,left:L}}const x=l.e(y,d.padding);d.padding=x;const C=this.transform,z=new Zn(t,a);return this.cameraHelper.cameraForBoxAndBearing(d,x,z,c,C)}fitBounds(t,a,c){return this._fitInternal(this.cameraForBounds(t,a),a,c)}fitScreenCoordinates(t,a,c,d,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(l.P.convert(t)),this.transform.screenPointToLocation(l.P.convert(a)),c,d),d,y)}_fitInternal(t,a,c){return t?(delete(a=l.e(t,a)).padding,a.linear?this.easeTo(a,c):this.flyTo(a,c)):this}jumpTo(t,a){this.stop();const c=this._getTransformForUpdate();let d=!1,y=!1,x=!1;const C=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,t);const z=c.zoom!==C;return"elevation"in t&&c.elevation!==+t.elevation&&c.setElevation(+t.elevation),"bearing"in t&&c.bearing!==+t.bearing&&(d=!0,c.setBearing(+t.bearing)),"pitch"in t&&c.pitch!==+t.pitch&&(y=!0,c.setPitch(+t.pitch)),"roll"in t&&c.roll!==+t.roll&&(x=!0,c.setRoll(+t.roll)),t.padding==null||c.isPaddingEqual(t.padding)||c.setPadding(t.padding),this._applyUpdatedTransform(c),this.fire(new l.l("movestart",a)).fire(new l.l("move",a)),z&&this.fire(new l.l("zoomstart",a)).fire(new l.l("zoom",a)).fire(new l.l("zoomend",a)),d&&this.fire(new l.l("rotatestart",a)).fire(new l.l("rotate",a)).fire(new l.l("rotateend",a)),y&&this.fire(new l.l("pitchstart",a)).fire(new l.l("pitch",a)).fire(new l.l("pitchend",a)),x&&this.fire(new l.l("rollstart",a)).fire(new l.l("roll",a)).fire(new l.l("rollend",a)),this.fire(new l.l("moveend",a))}calculateCameraOptionsFromTo(t,a,c,d=0){const y=l.a9.fromLngLat(t,a),x=l.a9.fromLngLat(c,d),C=x.x-y.x,z=x.y-y.y,L=x.z-y.z,k=Math.hypot(C,z,L);if(k===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(C,z),j=l.at(this.transform.cameraToCenterDistance/k/this.transform.tileSize),$=180*Math.atan2(C,-z)/Math.PI;let W=180*Math.acos(V/k)/Math.PI;return W=L<0?90-W:90+W,{center:x.toLngLat(),elevation:d,zoom:j,pitch:W,bearing:$}}calculateCameraOptionsFromCameraLngLatAltRotation(t,a,c,d,y){const x=this.transform.calculateCenterFromCameraLngLatAlt(t,a,c,d);return{center:x.center,elevation:x.elevation,zoom:x.zoom,bearing:c,pitch:d,roll:y}}easeTo(t,a){this._stop(!1,t.easeId),((t=l.e({offset:[0,0],duration:500,easing:l.cz},t)).animate===!1||!t.essential&&ce.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),d=this.getBearing(),y=c.pitch,x=c.roll,C="bearing"in t?this._normalizeBearing(t.bearing,d):d,z="pitch"in t?+t.pitch:y,L="roll"in t?this._normalizeBearing(t.roll,x):x,k="padding"in t?t.padding:c.padding,V=l.P.convert(t.offset);let j,$;t.around&&(j=l.V.convert(t.around),$=c.locationToScreenPoint(j));const W={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ae=this.cameraHelper.handleEaseTo(c,{bearing:C,pitch:z,roll:L,padding:k,around:j,aroundPoint:$,offsetAsPoint:V,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||d!==C,this._pitching=this._pitching||z!==y,this._rolling=this._rolling||L!==x,this._padding=!c.isPaddingEqual(k),this._zooming=this._zooming||ae.isZooming,this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,W),this.terrain&&this._prepareElevation(ae.elevationCenter),this._ease((se=>{ae.easeFunc(se),this.terrain&&!t.freezeElevation&&this._updateElevation(se),this._applyUpdatedTransform(c),this._fireMoveEvents(a)}),(se=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,se)}),t),this}_prepareEase(t,a,c={}){this._moving=!0,a||c.moving||this.fire(new l.l("movestart",t)),this._zooming&&!c.zooming&&this.fire(new l.l("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new l.l("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new l.l("pitchstart",t)),this._rolling&&!c.rolling&&this.fire(new l.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(a-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.setElevation(l.G.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const a=t.getCameraLngLat(),c=t.getCameraAltitude(),d=this.terrain?this.terrain.getElevationForLngLatZoom(a,t.zoom):0;if(c<d){const y=this.calculateCameraOptionsFromTo(a,d,t.center,t.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(a.push((d=>this._elevateCameraIfInsideTerrain(d))),this.transformCameraUpdate&&a.push((d=>this.transformCameraUpdate(d))),!a.length)return;const c=t.clone();for(const d of a){const y=c.clone(),{center:x,zoom:C,roll:z,pitch:L,bearing:k,elevation:V}=d(y);x&&y.setCenter(x),V!==void 0&&y.setElevation(V),C!==void 0&&y.setZoom(C),z!==void 0&&y.setRoll(z),L!==void 0&&y.setPitch(L),k!==void 0&&y.setBearing(k),c.apply(y,!1)}this.transform.apply(c,!1)}_fireMoveEvents(t){this.fire(new l.l("move",t)),this._zooming&&this.fire(new l.l("zoom",t)),this._rotating&&this.fire(new l.l("rotate",t)),this._pitching&&this.fire(new l.l("pitch",t)),this._rolling&&this.fire(new l.l("roll",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const c=this._zooming,d=this._rotating,y=this._pitching,x=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new l.l("zoomend",t)),d&&this.fire(new l.l("rotateend",t)),y&&this.fire(new l.l("pitchend",t)),x&&this.fire(new l.l("rollend",t)),this.fire(new l.l("moveend",t))}flyTo(t,a){if(!t.essential&&ce.prefersReducedMotion){const Ve=l.U(t,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Ve,a)}this.stop(),t=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.cz},t);const c=this._getTransformForUpdate(),d=c.bearing,y=c.pitch,x=c.roll,C=c.padding,z="bearing"in t?this._normalizeBearing(t.bearing,d):d,L="pitch"in t?+t.pitch:y,k="roll"in t?this._normalizeBearing(t.roll,x):x,V="padding"in t?t.padding:c.padding,j=l.P.convert(t.offset);let $=c.centerPoint.add(j);const W=c.screenPointToLocation($),ae=this.cameraHelper.handleFlyTo(c,{bearing:z,pitch:L,roll:k,padding:V,locationAtOffset:W,offsetAsPoint:j,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let se=t.curve;const oe=Math.max(c.width,c.height),fe=oe/ae.scaleOfZoom,ye=ae.pixelPathLength;typeof ae.scaleOfMinZoom=="number"&&(se=Math.sqrt(oe/ae.scaleOfMinZoom/ye*2));const he=se*se;function _e(Ve){const vt=(fe*fe-oe*oe+(Ve?-1:1)*he*he*ye*ye)/(2*(Ve?fe:oe)*he*ye);return Math.log(Math.sqrt(vt*vt+1)-vt)}function we(Ve){return(Math.exp(Ve)-Math.exp(-Ve))/2}function ge(Ve){return(Math.exp(Ve)+Math.exp(-Ve))/2}const Ae=_e(!1);let Ge=function(Ve){return ge(Ae)/ge(Ae+se*Ve)},Fe=function(Ve){return oe*((ge(Ae)*(we(vt=Ae+se*Ve)/ge(vt))-we(Ae))/he)/ye;var vt},je=(_e(!0)-Ae)/se;if(Math.abs(ye)<2e-6||!isFinite(je)){if(Math.abs(oe-fe)<1e-6)return this.easeTo(t,a);const Ve=fe<oe?-1:1;je=Math.abs(Math.log(fe/oe))/se,Fe=()=>0,Ge=vt=>Math.exp(Ve*se*vt)}return t.duration="duration"in t?+t.duration:1e3*je/("screenSpeed"in t?+t.screenSpeed/se:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=d!==z,this._pitching=L!==y,this._rolling=k!==x,this._padding=!c.isPaddingEqual(V),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(ae.targetCenter),this._ease((Ve=>{const vt=Ve*je,xt=1/Ge(vt),ct=Fe(vt);this._rotating&&c.setBearing(l.G.number(d,z,Ve)),this._pitching&&c.setPitch(l.G.number(y,L,Ve)),this._rolling&&c.setRoll(l.G.number(x,k,Ve)),this._padding&&(c.interpolatePadding(C,V,Ve),$=c.centerPoint.add(j)),ae.easeFunc(Ve,xt,ct,$),this.terrain&&!t.freezeElevation&&this._updateElevation(Ve),this._applyUpdatedTransform(c),this._fireMoveEvents(a)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,a)}return t||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(t,a,c){c.animate===!1||c.duration===0?(t(1),a()):(this._easeStart=xe(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=l.W(t,-180,180);const c=Math.abs(t-a);return Math.abs(t-360-a)<c&&(t-=360),Math.abs(t+360-a)<c&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLat(l.V.convert(t),this.transform):null}}const gi={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ti{constructor(t=gi){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=ie.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ie.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ie.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ie.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const c=this._map._getUIString(`AttributionControl.${a}`);t.title=c,t.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((d=>typeof d!="string"?"":d))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.tileManagers;for(const d in a){const y=a[d];if(y.used||y.usedForTerrain){const x=y.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t=t.filter((d=>String(d).trim())),t.sort(((d,y)=>d.length-y.length)),t=t.filter(((d,y)=>{for(let x=y+1;x<t.length;x++)if(t[x].indexOf(d)>=0)return!1;return!0}));const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=ie.sanitize(c),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class vu{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const c=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=ie.create("div","maplibregl-ctrl");const a=ie.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ie.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Jo{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,c=a?this._queue.concat(a):this._queue;for(const d of c)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const c of a)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var dn=l.aU([{name:"a_pos3d",type:"Int16",components:3}]);class In extends l.E{constructor(t){super(),this._lastTilesetChange=xe(),this.tileManager=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(t,a){this.tileManager.update(t,a),this._renderableTilesKeys=[];const c={};for(const d of ti(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.tileManager._source.calculateTileZoom}))c[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.terrainRttPosMatrix32f=new Float64Array(16),l.c7(d.terrainRttPosMatrix32f,0,l.a5,l.a5,0,0,1),this._tiles[d.key]=new Ie(d,this.tileSize),this._lastTilesetChange=xe());for(const d in this._tiles)c[d]||delete this._tiles[d]}freeRtt(t){for(const a in this._tiles){const c=this._tiles[a];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,a){return a?this._getTerrainCoordsForTileRanges(t,a):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const a={};for(const c of this._renderableTilesKeys){const d=this._tiles[c].tileID,y=t.clone(),x=l.bk();if(d.canonical.equals(t.canonical))l.c7(x,0,l.a5,l.a5,0,0,1);else if(d.canonical.isChildOf(t.canonical)){const C=d.canonical.z-t.canonical.z,z=d.canonical.x-(d.canonical.x>>C<<C),L=d.canonical.y-(d.canonical.y>>C<<C),k=l.a5>>C;l.c7(x,0,k,k,0,0,1),l.O(x,x,[-z*k,-L*k,0])}else{if(!t.canonical.isChildOf(d.canonical))continue;{const C=t.canonical.z-d.canonical.z,z=t.canonical.x-(t.canonical.x>>C<<C),L=t.canonical.y-(t.canonical.y>>C<<C),k=l.a5>>C;l.c7(x,0,l.a5,l.a5,0,0,1),l.O(x,x,[z*k,L*k,0]),l.Q(x,x,[1/2**C,1/2**C,0])}}y.terrainRttPosMatrix32f=new Float32Array(x),a[c]=y}return a}_getTerrainCoordsForTileRanges(t,a){const c={};for(const d of this._renderableTilesKeys){const y=this._tiles[d].tileID;if(!this._isWithinTileRanges(y,a))continue;const x=t.clone(),C=l.bk();if(y.canonical.z===t.canonical.z){const z=t.canonical.x-y.canonical.x+t.wrap*(1<<t.canonical.z),L=t.canonical.y-y.canonical.y;l.c7(C,0,l.a5,l.a5,0,0,1),l.O(C,C,[z*l.a5,L*l.a5,0])}else if(y.canonical.z>t.canonical.z){const z=y.canonical.z-t.canonical.z,L=y.canonical.x-(y.canonical.x>>z<<z)+t.wrap*(1<<y.canonical.z),k=y.canonical.y-(y.canonical.y>>z<<z),V=t.canonical.x-(y.canonical.x>>z),j=t.canonical.y-(y.canonical.y>>z),$=l.a5>>z;l.c7(C,0,$,$,0,0,1),l.O(C,C,[-L*$+V*l.a5,-k*$+j*l.a5,0])}else{const z=t.canonical.z-y.canonical.z,L=t.canonical.x-(t.canonical.x>>z<<z)+t.wrap*(1<<t.canonical.z),k=t.canonical.y-(t.canonical.y>>z<<z),V=(t.canonical.x>>z)-y.canonical.x,j=(t.canonical.y>>z)-y.canonical.y,$=l.a5<<z;l.c7(C,0,$,$,0,0,1),l.O(C,C,[L*l.a5+V*$,k*l.a5+j*$,0])}x.terrainRttPosMatrix32f=new Float32Array(C),c[d]=x}return c}getSourceTile(t,a){const c=this.tileManager._source;let d=t.overscaledZ-this.deltaZoom;if(d>c.maxzoom&&(d=c.maxzoom),d<c.minzoom)return;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let y=this.findTileInCaches(this._sourceTileCache[t.key]);if(!y?.dem&&a)for(;d>=c.minzoom&&!y?.dem;)y=this.findTileInCaches(t.scaledTo(d--).key);return y}findTileInCaches(t){let a=this.tileManager.getTileByID(t);return a||(a=this.tileManager._outOfViewCache.getByKey(t),a)}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,a){const c=a[t.canonical.z];return!!c&&(t.wrap>c.minWrap||t.wrap<c.maxWrap||t.canonical.x>=c.minTileXWrapped&&t.canonical.x<=c.maxTileXWrapped&&t.canonical.y>=c.minTileY&&t.canonical.y<=c.maxTileY)}}class hn{constructor(t,a,c){this._meshCache={},this.painter=t,this.tileManager=new In(a),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,c,d=l.a5){var y;if(!(a>=0&&a<d&&c>=0&&c<d))return 0;const x=this.getTerrainData(t),C=(y=x.tile)===null||y===void 0?void 0:y.dem;if(!C)return 0;const z=l.cD([],[a/d*l.a5,c/d*l.a5],x.u_terrain_matrix),L=[z[0]*C.dim,z[1]*C.dim],k=Math.floor(L[0]),V=Math.floor(L[1]),j=L[0]-k,$=L[1]-V;return C.get(k,V)*(1-j)*(1-$)+C.get(k+1,V)*j*(1-$)+C.get(k,V+1)*(1-j)*$+C.get(k+1,V+1)*j*$}getElevationForLngLatZoom(t,a){if(!l.cE(a,t.wrap()))return 0;const{tileID:c,mercatorX:d,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(c,d%l.a5,y%l.a5,l.a5)}getElevationForLngLat(t,a){const c=ti(a,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let d=0;for(const y of c)y.canonical.z>d&&(d=Math.min(y.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(t,d)}getElevation(t,a,c,d=l.a5){return this.getDEMElevation(t,a,c,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,y=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new l.T(d,y,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new l.T(d,new l.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ar([])}const a=this.tileManager.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new l.T(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const c=a&&a.toString()+a.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const d=this.tileManager.getSource().maxzoom;let y=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?y=t.canonical.z-d:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=t.canonical.x-(t.canonical.x>>y<<y),C=t.canonical.y-(t.canonical.y>>y<<y),z=l.cF(new Float64Array(16),[1/(l.a5<<y),1/(l.a5<<y),0]);l.O(z,z,[x*l.a5,C*l.a5,0]),this._demMatrixCache[t.key]={matrix:z,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,c=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new l.T(a.context,{width:c,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new l.T(a.context,{width:c,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(c,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,c,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,x=0;y<this._coordsTextureSize;y++)for(let C=0;C<this._coordsTextureSize;C++,x+=4)a[x+0]=255&C,a[x+1]=255&y,a[x+2]=C>>8<<4|y>>8,a[x+3]=0;const c=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new l.T(t,c,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),c=this.painter.context,d=c.gl,y=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),C=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(y,C-x-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),c.bindFramebuffer.set(null);const z=a[0]+(a[2]>>4<<8),L=a[1]+((15&a[2])<<8),k=this.coordsIndex[255-a[3]],V=k&&this.tileManager.getTileByID(k);if(!V)return null;const j=this._coordsTextureSize,$=(1<<V.tileID.canonical.z)*j;return new l.a9((V.tileID.canonical.x*j+z)/$+V.tileID.wrap,(V.tileID.canonical.y*j+L)/$,this.getElevation(V.tileID,z,L,j))}depthAtPoint(t){const a=new Uint8Array(4),c=this.painter.context,d=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),c.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(t){var a;const c=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,d=c&&t.canonical.y===0,y=c&&t.canonical.y===(1<<t.canonical.z)-1,x=`m_${d?"n":""}_${y?"s":""}`;if(this._meshCache[x])return this._meshCache[x];const C=this.painter.context,z=new l.cG,L=new l.aY,k=this.meshSize,V=l.a5/k,j=k*k;for(let ge=0;ge<=k;ge++)for(let Ae=0;Ae<=k;Ae++)z.emplaceBack(Ae*V,ge*V,0);for(let ge=0;ge<j;ge+=k+1)for(let Ae=0;Ae<k;Ae++)L.emplaceBack(Ae+ge,k+Ae+ge+1,k+Ae+ge+2),L.emplaceBack(Ae+ge,k+Ae+ge+2,Ae+ge+1);const $=z.length,W=$+(k+1),ae=(k+1)*k,se=d?l.br:0,oe=d?0:1,fe=y?l.bs:l.a5,ye=y?0:1;for(let ge=0;ge<=k;ge++)z.emplaceBack(ge*V,se,oe);for(let ge=0;ge<=k;ge++)z.emplaceBack(ge*V,fe,ye);for(let ge=0;ge<k;ge++)L.emplaceBack(ae+ge,W+ge,W+ge+1),L.emplaceBack(ae+ge,W+ge+1,ae+ge+1),L.emplaceBack(0+ge,$+ge+1,$+ge),L.emplaceBack(0+ge,0+ge+1,$+ge+1);const he=z.length,_e=he+2*(k+1);for(const ge of[0,1])for(let Ae=0;Ae<=k;Ae++)for(const Ge of[0,1])z.emplaceBack(ge*l.a5,Ae*V,Ge);for(let ge=0;ge<2*k;ge+=2)L.emplaceBack(he+ge,he+ge+1,he+ge+3),L.emplaceBack(he+ge,he+ge+3,he+ge+2),L.emplaceBack(_e+ge,_e+ge+3,_e+ge+1),L.emplaceBack(_e+ge,_e+ge+2,_e+ge+3);const we=new Hn(C.createVertexBuffer(z,dn.members),C.createIndexBuffer(L),l.aX.simpleSegment(0,0,z.length,L.length));return this._meshCache[x]=we,we}getMeshFrameDelta(t){return 2*Math.PI*l.bE/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,a){var c;if(!l.cE(a,t.wrap()))return 0;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(c=this.getMinMaxElevation(d).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return a&&a.dem&&(c.minElevation=a.dem.min*this.exaggeration,c.maxElevation=a.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(t,a){const c=l.a9.fromLngLat(t.wrap()),d=(1<<a)*l.a5,y=c.x*d,x=c.y*d,C=Math.floor(y/l.a5),z=Math.floor(x/l.a5);return{tileID:new l.a2(a,0,a,C,z),mercatorX:y,mercatorY:x}}}class ui{constructor(t,a,c){this._context=t,this._size=a,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new l.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(c.texture),{id:t,fbo:a,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>t.id!==a)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const Pa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Ka{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new ui(t.context,30,a.tileManager.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=t._order.filter((c=>!t._layers[c].isHidden(a))),this._coordsAscending={};for(const c in t.tileManagers){this._coordsAscending[c]={};const d=t.tileManagers[c].getVisibleCoordinates(),y=t.tileManagers[c].getSource(),x=y instanceof Dr?y.terrainTileRanges:null;for(const C of d){const z=this.terrain.tileManager.getTerrainCoords(C,x);for(const L in z)this._coordsAscending[c][L]||(this._coordsAscending[c][L]=[]),this._coordsAscending[c][L].push(z[L])}}this._coordsAscendingStr={};for(const c of t._order){const d=t._layers[c],y=d.source;if(Pa[d.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const x in this._coordsAscending[y])this._coordsAscendingStr[y][x]=this._coordsAscending[y][x].map((C=>C.key)).sort().join()}}for(const c of this._renderableTiles)for(const d in this._coordsAscendingStr){const y=this._coordsAscendingStr[d][c.tileID.key];y&&y!==c.rttCoords[d]&&(c.rtt=[])}}renderLayer(t,a){if(t.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),d=t.type,y=this.painter,x=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Pa[d]&&(this._prevType&&Pa[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(t.id),!x))return!0;if(Pa[this._prevType]||Pa[d]&&x){this._prevType=d;const C=this._stacks.length-1,z=this._stacks[C]||[];for(const L of this._renderableTiles){if(this.pool.isFull()&&(sh(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(L),L.rtt[C]){const V=this.pool.getObjectForId(L.rtt[C].id);if(V.stamp===L.rtt[C].stamp){this.pool.useObject(V);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),L.rtt[C]={id:k.id,stamp:k.stamp},y.context.bindFramebuffer.set(k.fbo.framebuffer),y.context.clear({color:l.bp.transparent,stencil:0}),y.currentStencilSource=void 0;for(let V=0;V<z.length;V++){const j=y.style._layers[z[V]],$=j.source?this._coordsAscending[j.source][L.tileID.key]:[L.tileID];y.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),y._renderTileClippingMasks(j,$,!0),y.renderLayer(y,y.style.tileManagers[j.source],j,$,c),j.source&&(L.rttCoords[j.source]=this._coordsAscendingStr[j.source][L.tileID.key])}}return sh(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),Pa[d]}return!1}}const pl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ml=N,es={hash:!1,interactive:!0,bearingSnap:7,zoomSnap:0,attributionControl:gi,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},fd={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class ri{constructor(t,a,c=!1){this.mousedown=y=>{this.startMove(y,ie.mousePos(this.element,y)),ie.addEventListener(window,"mousemove",this.mousemove),ie.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,ie.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHandler.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ie.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),ie.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=ie.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const d=new fu;this._rotatePitchHandler=new Aa({clickTolerance:3,move:(y,x)=>{const C=a.getBoundingClientRect(),z=new l.P((C.bottom-C.top)/2,(C.right-C.left)/2);return{bearingDelta:l.cy(new l.P(y.x,x.y),x,z),pitchDelta:c?-.5*(x.y-y.y):void 0}},moveStateManager:d,enable:!0,assignEvents:()=>{}}),this.map=t,ie.addEventListener(a,"mousedown",this.mousedown),ie.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),ie.addEventListener(a,"touchcancel",this.reset)}startMove(t,a){this._rotatePitchHandler.dragStart(t,a),ie.disableDrag()}move(t,a){const c=this.map,{bearingDelta:d,pitchDelta:y}=this._rotatePitchHandler.dragMove(t,a)||{};d&&c.setBearing(c.getBearing()+d),y&&c.setPitch(c.getPitch()+y)}off(){const t=this.element;ie.removeEventListener(t,"mousedown",this.mousedown),ie.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),ie.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.removeEventListener(window,"touchend",this.touchend),ie.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){ie.enableDrag(),ie.removeEventListener(window,"mousemove",this.mousemove),ie.removeEventListener(window,"mouseup",this.mouseup),ie.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.removeEventListener(window,"touchend",this.touchend)}}let Qa;function hc(g,t,a,c=!1){if(c||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return g?.wrap();const d=new l.V(g.lng,g.lat);if(g=new l.V(g.lng,g.lat),t){const y=new l.V(g.lng-360,g.lat),x=new l.V(g.lng+360,g.lat),C=a.locationToScreenPoint(g).distSqr(t);a.locationToScreenPoint(y).distSqr(t)<C?g=y:a.locationToScreenPoint(x).distSqr(t)<C&&(g=x)}for(;Math.abs(g.lng-a.center.lng)>180;){const y=a.locationToScreenPoint(g);if(y.x>=0&&y.y>=0&&y.x<=a.width&&y.y<=a.height)break;g.lng>a.center.lng?g.lng-=360:g.lng+=360}return g.lng!==d.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(g))?g:d}const dc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xu(g,t,a){const c=g.classList;for(const d in dc)c.remove(`maplibregl-${a}-anchor-${d}`);c.add(`maplibregl-${a}-anchor-${t}`)}class bu extends l.E{constructor(t){if(super(),this._onKeyPress=a=>{const c=a.code,d=a.charCode||a.keyCode;c!=="Space"&&c!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const c=a.originalEvent.target,d=this._element;this._popup&&(c===d||d.contains(c))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=hc(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),ie.setTransform(this._element,`${dc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${d}`),ce.frameAsync(new AbortController,this._map._ownerWindow).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.l("dragstart"))),this.fire(new l.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=l.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=ie.create("div");const a=ie.createNS("http://www.w3.org/2000/svg","svg"),c=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${c}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${c}`);const y=ie.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const x=ie.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const C=ie.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const oe of z){const fe=ie.createNS("http://www.w3.org/2000/svg","ellipse");fe.setAttributeNS(null,"opacity","0.04"),fe.setAttributeNS(null,"cx","10.5"),fe.setAttributeNS(null,"cy","5.80029008"),fe.setAttributeNS(null,"rx",oe.rx),fe.setAttributeNS(null,"ry",oe.ry),C.appendChild(fe)}const L=ie.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill",this._color);const k=ie.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),L.appendChild(k);const V=ie.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const j=ie.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(j);const $=ie.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const W=ie.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ae=ie.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#000000"),ae.setAttributeNS(null,"opacity","0.25"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962");const se=ie.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),W.appendChild(ae),W.appendChild(se),x.appendChild(C),x.appendChild(L),x.appendChild(V),x.appendChild($),x.appendChild(W),a.appendChild(x),a.setAttributeNS(null,"height",c*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=l.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),xu(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ie.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.V.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,c;const d=(a=this._map)===null||a===void 0?void 0:a.terrain,y=this._map.transform.isLocationOccluded(this._lngLat);if(!d||y){const $=y?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==$&&(this._element.style.opacity=$))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const x=this._map,C=x.terrain.depthAtPoint(this._pos),z=x.terrain.getElevationForLngLat(this._lngLat,x.transform);if(x.transform.lngLatToCameraDepth(this._lngLat,z)-C<.006)return void(this._element.style.opacity=this._opacity);const L=-this._offset.y/x.transform.pixelsPerMeter,k=Math.sin(x.getPitch()*Math.PI/180)*L,V=x.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),j=x.transform.lngLatToCameraDepth(this._lngLat,z+k)-V>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&j&&this._popup.remove(),this._element.style.opacity=j?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=l.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return(this._opacity===void 0||t===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const wu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Is=0,ts=!1;const _r={maxWidth:100,unit:"metric"};function hi(g,t,a){const c=a&&a.maxWidth||100,d=g._container.clientHeight/2,y=g._container.clientWidth/2,x=g.unproject([y-c/2,d]),C=g.unproject([y+c/2,d]),z=Math.round(g.project(C).x-g.project(x).x),L=Math.min(c,z,g._container.clientWidth),k=x.distanceTo(C);if(a&&a.unit==="imperial"){const V=3.2808*k;V>5280?Io(t,L,V/5280,g._getUIString("ScaleControl.Miles")):Io(t,L,V,g._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Io(t,L,k/1852,g._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Io(t,L,k/1e3,g._getUIString("ScaleControl.Kilometers")):Io(t,L,k,g._getUIString("ScaleControl.Meters"))}function Io(g,t,a,c){const d=(function(y){const x=Math.pow(10,`${Math.floor(y)}`.length-1);let C=y/x;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:(function(z){const L=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*L)/L})(C),x*C})(a);g.style.width=t*(d/a)+"px",g.innerHTML=`${d}&nbsp;${c}`}const gl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},_l=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function fc(g){if(g){if(typeof g=="number"){const t=Math.round(Math.abs(g)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,g),"top-left":new l.P(t,t),"top-right":new l.P(-t,t),bottom:new l.P(0,-g),"bottom-left":new l.P(t,-t),"bottom-right":new l.P(-t,-t),left:new l.P(g,0),right:new l.P(-g,0)}}if(g instanceof l.P||Array.isArray(g)){const t=l.P.convert(g);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.P.convert(g.center||[0,0]),top:l.P.convert(g.top||[0,0]),"top-left":l.P.convert(g["top-left"]||[0,0]),"top-right":l.P.convert(g["top-right"]||[0,0]),bottom:l.P.convert(g.bottom||[0,0]),"bottom-left":l.P.convert(g["bottom-left"]||[0,0]),"bottom-right":l.P.convert(g["bottom-right"]||[0,0]),left:l.P.convert(g.left||[0,0]),right:l.P.convert(g.right||[0,0])}}return fc(new l.P(0,0))}const Ja=N;E.AJAXError=l.cJ,E.Event=l.l,E.Evented=l.E,E.LngLat=l.V,E.MercatorCoordinate=l.a9,E.Point=l.P,E.addProtocol=l.cK,E.config=l.c,E.removeProtocol=l.cL,E.AttributionControl=Ti,E.BoxZoomHandler=Ps,E.CanvasSource=xi,E.CooperativeGesturesHandler=Dt,E.DoubleClickZoomHandler=ph,E.DragPanHandler=dd,E.DragRotateHandler=ha,E.EdgeInsets=na,E.FullscreenControl=class extends l.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ie.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=ie.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ie.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=Hi,E.GeolocateControl=class extends l.E{constructor(g){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new l.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new l.V(t.coords.longitude,t.coords.latitude),c=t.coords.accuracy,d=this._map.getBearing(),y=l.e({bearing:d},this.options.fitBoundsOptions),x=Zn.fromLngLat(a,c);this._map.fitBounds(x,y,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new l.V(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&ts)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=ie.create("button","maplibregl-ctrl-geolocate",this._container),ie.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ie.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new bu({element:this._dotElement}),this._circleElement=ie.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new bu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const c=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.l("trackuserlocationend")),this.fire(new l.l("userlocationlostfocus")))}))}},this.options=l.e({},wu,g)}onAdd(g){return this._map=g,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return l._(this,arguments,void 0,(function*(t=!1){if(Qa!==void 0&&!t)return Qa;if(window.navigator.permissions===void 0)return Qa=!!window.navigator.geolocation,Qa;try{Qa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Qa=!!window.navigator.geolocation}return Qa}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ie.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Is=0,ts=!1}_isOutOfMapMaxBounds(g){const t=this._map.getMaxBounds(),a=g.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const g=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&g))return;const t=this._map.project(g),a=this._map.unproject([t.x+100,t.y]),c=g.distanceTo(a)/100,d=2*this._accuracy/c;this._circleElement.style.width=`${d.toFixed(2)}px`,this._circleElement.style.height=`${d.toFixed(2)}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Is--,ts=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.l("trackuserlocationstart")),this.fire(new l.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Is++,Is>1?(g={maximumAge:6e5,timeout:0},ts=!0):(g=this.options.positionOptions,ts=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.GlobeControl=class{constructor(){this._toggleProjection=()=>{var g;const t=(g=this._map.getProjection())===null||g===void 0?void 0:g.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var g;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((g=this._map.getProjection())===null||g===void 0?void 0:g.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(g){return this._map=g,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ie.create("button","maplibregl-ctrl-globe",this._container),ie.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ie.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},E.Hash=Ii,E.ImageSource=Dr,E.KeyboardHandler=On,E.LngLatBounds=Zn,E.LogoControl=vu,E.Map=class extends Li{get _ownerWindow(){var g,t;return((t=(g=this._container)===null||g===void 0?void 0:g.ownerDocument)===null||t===void 0?void 0:t.defaultView)||window}constructor(g){var t,a;l.cH.mark(l.cI.create);const c=Object.assign(Object.assign(Object.assign({},es),g),{canvasContextAttributes:Object.assign(Object.assign({},es.canvasContextAttributes),g.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const d=new Wi,y=new Js;c.minZoom!==void 0&&d.setMinZoom(c.minZoom),c.maxZoom!==void 0&&d.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&d.setMinPitch(c.minPitch),c.maxPitch!==void 0&&d.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&d.setRenderWorldCopies(c.renderWorldCopies),c.transformConstrain!==null&&d.setConstrainOverride(c.transformConstrain),super(d,y,{bearingSnap:c.bearingSnap,zoomSnap:c.zoomSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Jo,this._controls=[],this._mapId=l.af(),this._lostContextStyle={style:null,images:null},this._contextLost=C=>{C.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const z of Object.values(this.style._layers))if(z.type==="custom"&&console.warn(`Custom layer with id '${z.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),z._listeners)for(const[L]of Object.entries(z._listeners))console.warn(`Custom layer with id '${z.id}' had event listeners for event '${L}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new l.l("webglcontextlost",{originalEvent:C}))},this._contextRestored=C=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new l.l("webglcontextrestored",{originalEvent:C}))},this._onMapScroll=C=>{if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._zoomSnap=c.zoomSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},pl),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this._zoomLevelsToOverscale=c.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=c.transformCameraUpdate,this.transformConstrain=c.transformConstrain,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,c.reduceMotion!==void 0&&(ce.prefersReducedMotion=c.reduceMotion),this._imageQueueHandle=Qe.addThrottleControl((()=>this.isMoving())),this._requestManager=new _t(c.transformRequest),this._container=this._resolveContainer(c.container),c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"&&(this._ownerWindow.addEventListener("online",this._onWindowOnline,!1),this._setupResizeObserver()),this.handlers=new yu(this,c),this._hash=c.hash&&new Ii(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,l.e({},c.fitBoundsOptions,{duration:0}))));const x=typeof c.style=="string"||((a=(t=c.style)===null||t===void 0?void 0:t.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,x),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new Ti(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new vu,c.logoPosition),this.on("style.load",(()=>{if(x||this._resizeTransform(),this.transform.unmodified){const C=l.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(C)}})),this.on("data",(C=>{this._update(C.dataType==="style"),this.fire(new l.l(`${C.dataType}data`,C))})),this.on("dataloading",(C=>{this.fire(new l.l(`${C.dataType}dataloading`,C))})),this.on("dataabort",(C=>{this.fire(new l.l("sourcedataabort",C))}))}_getMapId(){return this._mapId}setGlobalStateProperty(g,t){return this.style.setGlobalStateProperty(g,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(g,t){if(t===void 0&&(t=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new l.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=g.onAdd(this);this._controls.push(g);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(a,c.firstChild):c.appendChild(a),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new l.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(g);return t>-1&&this._controls.splice(t,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}coveringTiles(g){return ti(this.transform,g)}calculateCameraOptionsFromTo(g,t,a,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLat(a,this.transform)),super.calculateCameraOptionsFromTo(g,t,a,c)}resize(g,t=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(t);const a=!this._moving;return a&&(this.stop(),this.fire(new l.l("movestart",g)).fire(new l.l("move",g))),this.fire(new l.l("resize",g)),a&&this.fire(new l.l("moveend",g)),this}_resizeInternal(g=!0){const[t,a]=this._containerDimensions(),c=this._getClampedPixelRatio(t,a);if(this._resizeCanvas(t,a,c),this.painter.resize(t,a,c),this.painter.overLimit()){const d=this.painter.context.gl;this._maxCanvasSize=[d.drawingBufferWidth,d.drawingBufferHeight];const y=this._getClampedPixelRatio(t,a);this._resizeCanvas(t,a,y),this.painter.resize(t,a,y)}this._resizeTransform(g)}_resizeTransform(g=!0){var t;const[a,c]=this._containerDimensions();this.transform.resize(a,c,g),(t=this._requestedCameraState)===null||t===void 0||t.resize(a,c,g)}_getClampedPixelRatio(g,t){const{0:a,1:c}=this._maxCanvasSize,d=this.getPixelRatio(),y=g*d,x=t*d;return Math.min(y>a?a/y:1,x>c?c/x:1)*d}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(Zn.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom){const t=this.transform.zoom,a=this._getTransformForUpdate();return a.setMinZoom(g),this._applyUpdatedTransform(a),this._update(),t!==this.transform.zoom&&this.fire(new l.l("zoomstart")).fire(new l.l("zoom")).fire(new l.l("zoomend")).fire(new l.l("movestart")).fire(new l.l("move")).fire(new l.l("moveend")),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom){const t=this.transform.zoom,a=this._getTransformForUpdate();return a.setMaxZoom(g),this._applyUpdatedTransform(a),this._update(),t!==this.transform.zoom&&this.fire(new l.l("zoomstart")).fire(new l.l("zoom")).fire(new l.l("zoomend")).fire(new l.l("movestart")).fire(new l.l("move")).fire(new l.l("moveend")),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch){const t=this.transform.pitch,a=this._getTransformForUpdate();return a.setMinPitch(g),this._applyUpdatedTransform(a),this._update(),t!==this.transform.pitch&&this.fire(new l.l("pitchstart")).fire(new l.l("pitch")).fire(new l.l("pitchend")).fire(new l.l("movestart")).fire(new l.l("move")).fire(new l.l("moveend")),this}throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(g>=this.transform.minPitch){const t=this.transform.pitch,a=this._getTransformForUpdate();return a.setMaxPitch(g),this._applyUpdatedTransform(a),this._update(),t!==this.transform.pitch&&this.fire(new l.l("pitchstart")).fire(new l.l("pitch")).fire(new l.l("pitchend")).fire(new l.l("movestart")).fire(new l.l("move")).fire(new l.l("moveend")),this}throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.setRenderWorldCopies(g),this._update()}setTransformConstrain(g){return this.transform.setConstrainOverride(g),this._update()}project(g){return this.transform.locationToScreenPoint(l.V.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.screenPointToLocation(l.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,t,a){if(g==="mouseenter"||g==="mouseover"){let c=!1;return{layers:t,listener:a,delegates:{mousemove:y=>{const x=t.filter((z=>this.getLayer(z))),C=x.length!==0?this.queryRenderedFeatures(y.point,{layers:x}):[];C.length?c||(c=!0,a.call(this,new ir(g,this,y.originalEvent,{features:C}))):c=!1},mouseout:()=>{c=!1}}}}if(g==="mouseleave"||g==="mouseout"){let c=!1;return{layers:t,listener:a,delegates:{mousemove:x=>{const C=t.filter((z=>this.getLayer(z)));(C.length!==0?this.queryRenderedFeatures(x.point,{layers:C}):[]).length?c=!0:c&&(c=!1,a.call(this,new ir(g,this,x.originalEvent)))},mouseout:x=>{c&&(c=!1,a.call(this,new ir(g,this,x.originalEvent)))}}}}{const c=d=>{const y=t.filter((C=>this.getLayer(C))),x=y.length!==0?this.queryRenderedFeatures(d.point,{layers:y}):[];x.length&&(d.features=x,a.call(this,d),delete d.features)};return{layers:t,listener:a,delegates:{[g]:c}}}}_saveDelegatedListener(g,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(t)}_removeDelegatedListener(g,t,a){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const c=this._delegatedListeners[g];for(let d=0;d<c.length;d++){const y=c[d];if(y.listener===a&&y.layers.length===t.length&&y.layers.every((x=>t.includes(x)))){for(const x in y.delegates)this.off(x,y.delegates[x]);return void c.splice(d,1)}}}on(g,t,a){if(a===void 0)return super.on(g,t);const c=typeof t=="string"?[t]:t,d=this._createDelegatedListener(g,c,a);this._saveDelegatedListener(g,d);for(const y in d.delegates)this.on(y,d.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(g,c,a)}}}once(g,t,a){if(a===void 0)return super.once(g,t);const c=typeof t=="string"?[t]:t,d=this._createDelegatedListener(g,c,a);for(const y in d.delegates){const x=d.delegates[y];d.delegates[y]=(...C)=>{this._removeDelegatedListener(g,c,a),x(...C)}}this._saveDelegatedListener(g,d);for(const y in d.delegates)this.once(y,d.delegates[y]);return this}off(g,t,a){return a===void 0?super.off(g,t):(this._removeDelegatedListener(g,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(g,t){if(!this.style)return[];let a;const c=g instanceof l.P||Array.isArray(g),d=c?g:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:g)||{},d instanceof l.P||typeof d[0]=="number")a=[l.P.convert(d)];else{const y=l.P.convert(d[0]),x=l.P.convert(d[1]);a=[y,new l.P(x.x,y.y),x,new l.P(y.x,x.y),y]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(g,t){return this.style.querySourceFeatures(g,t)}setStyle(g,t){return(t=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(g,t))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const t=this._locale[g];if(t==null)throw new Error(`Missing UI string '${g}'`);return t}_updateStyle(g,t){var a,c;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(g,t)));const d=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new bs(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,t,d):this.style.loadJSON(g,t,d),this):((c=(a=this.style)===null||a===void 0?void 0:a.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new bs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,t){if(typeof g=="string"){const a=this._requestManager.transformRequest(g,"Style");l.j(a,new AbortController).then((c=>{this._updateDiff(c.data,t)})).catch((c=>{c&&this.fire(new l.k(c))}))}else typeof g=="object"&&this._updateDiff(g,t)}_updateDiff(g,t){try{this.style.setState(g,t)&&this._update(!0)}catch(a){l.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(g,t)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(g,t){return this._lazyInitEmptyStyle(),this.style.addSource(g,t),this._update(!0)}isSourceLoaded(g){const t=this.style&&this.style.tileManagers[g];if(t!==void 0)return t.loaded();this.fire(new l.k(new Error(`There is no tile manager with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const t=this.style.tileManagers[g.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const c=this.style._layers[a];c.type==="hillshade"&&c.source===g.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),c.type==="color-relief"&&c.source===g.source&&l.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new hn(this.painter,t,g),this.painter.renderToTexture=new Ka(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var c;a.dataType==="style"?this.terrain.tileManager.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==g.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((c=a.source)===null||c===void 0?void 0:c.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new l.l("terrain",{terrain:g})),this}getTerrain(){var g,t;return(t=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const g=this.style&&this.style.tileManagers;for(const t of Object.values(g))if(!t.areTilesLoaded())return!1;return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}setSourceTileLodParams(g,t,a){if(a){const c=this.getSource(a);if(!c)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);c.calculateTileZoom=jt(Math.max(1,g),Math.max(1,t))}else for(const c in this.style.tileManagers)this.style.tileManagers[c].getSource().calculateTileZoom=jt(Math.max(1,g),Math.max(1,t));return this._update(!0),this}refreshTiles(g,t){const a=this.style.tileManagers[g];if(!a)throw new Error(`There is no tile manager with ID "${g}", cannot refresh tile`);t===void 0?a.reload(!0):a.refreshTiles(t.map((c=>new l.ac(c.z,c.x,c.y))))}addImage(g,t,a={}){const{pixelRatio:c=1,sdf:d=!1,stretchX:y,stretchY:x,content:C,textFitWidth:z,textFitHeight:L}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||l.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:V,data:j}=t,$=t;return this.style.addImage(g,{data:new l.R({width:k,height:V},new Uint8Array(j)),pixelRatio:c,stretchX:y,stretchY:x,content:C,textFitWidth:z,textFitHeight:L,sdf:d,version:0,userImage:$}),$.onAdd&&$.onAdd(this,g),this}}{const{width:k,height:V,data:j}=ce.getImageData(t);this.style.addImage(g,{data:new l.R({width:k,height:V},j),pixelRatio:c,stretchX:y,stretchY:x,content:C,textFitWidth:z,textFitHeight:L,sdf:d,version:0})}}updateImage(g,t){const a=this.style.getImage(g);if(!a)return this.fire(new l.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||l.b(t)?ce.getImageData(t):t,{width:d,height:y,data:x}=c;if(d===void 0||y===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||y!==a.data.height)return this.fire(new l.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(t instanceof HTMLImageElement||l.b(t));return a.data.replace(x,C),this.style.updateImage(g,a),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new l.k(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return Qe.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,t){return this._lazyInitEmptyStyle(),this.style.addLayer(g,t),this._update(!0)}moveLayer(g,t){return this.style.moveLayer(g,t),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,t,a){return this.style.setLayerZoomRange(g,t,a),this._update(!0)}setFilter(g,t,a={}){return this.style.setFilter(g,t,a),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,t,a,c={}){return this.style.setPaintProperty(g,t,a,c),this._update(!0)}getPaintProperty(g,t){return this.style.getPaintProperty(g,t)}setLayoutProperty(g,t,a,c={}){return this.style.setLayoutProperty(g,t,a,c),this._update(!0)}getLayoutProperty(g,t){return this.style.getLayoutProperty(g,t)}setGlyphs(g,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,t,a,(c=>{c||this._update(!0)})),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,t,(a=>{a||this._update(!0)})),this}setLight(g,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(g,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,t){return this.style.setFeatureState(g,t),this._update()}removeFeatureState(g,t){return this.style.removeFeatureState(g,t),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,t=0;return this._container&&(g=this._container.clientWidth||400,t=this._container.clientHeight||300),[g,t]}_setupResizeObserver(){var g;let t=!1;const a=cd((d=>{this._trackResize&&!this._removed&&(this.resize(d),this.redraw())}),50),c=(g=this._ownerWindow.ResizeObserver)!==null&&g!==void 0?g:ResizeObserver;this._resizeObserver=new c((d=>{t?a(d):t=!0})),this._resizeObserver.observe(this._container)}_resolveContainer(g){if(typeof g=="string"){const t=document.getElementById(g);if(!t)throw new Error(`Container '${g}' not found.`);return t}if(g instanceof HTMLElement||g&&typeof g=="object"&&g.nodeType===1)return g;throw new Error("Invalid type: 'container' must be a String or HTMLElement.")}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const t=this._canvasContainer=ie.create("div","maplibregl-canvas-container",g);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=ie.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),c=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],c);const d=this._controlContainer=ie.create("div","maplibregl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((x=>{y[x]=ie.create("div",`maplibregl-ctrl-${x} `,d)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,t,a){this._canvas.width=Math.floor(a*g),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const g=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(c=>{t={requestedAttributes:g},c&&(t.statusMessage=c.statusMessage,t.type=c.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,g):this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g),!a){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new Pf(a,this.transform),Ue.testSupport(a)}migrateProjection(g,t){super.migrateProjection(g,t),this.painter.transform=g,this.fire(new l.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){var t,a,c,d,y;const x=this._idleTriggered?this._fadeDuration:0,C=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let z=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,j=xe();this.style.zoomHistory.update(V,j);const $=new l.H(V,{now:j,fadeDuration:x,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),W=$.crossFadingFactor();W===1&&W===this._crossFadingFactor||(z=!0,this._crossFadingFactor=W),this.style.update($)}const L=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==C;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((d=this.style.projection)===null||d===void 0?void 0:d.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||L)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,L),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,showPadding:this.showPadding}),this.fire(new l.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.cH.mark(l.cI.load),this.fire(new l.l("load"))),this.style&&(this.style.hasTransitions()||z)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,l.cH.mark(l.cI.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&this._ownerWindow.removeEventListener("online",this._onWindowOnline,!1),Qe.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ie.remove(this._canvasContainer),ie.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),l.cH.clearMetrics(),this._removed=!0,this.fire(new l.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ce.frame(this._frameRequest,(g=>{l.cH.frame(g),this._frameRequest=null;try{this._render(g)}catch(t){if(!l.Z(t)&&!(function(a){return a.message===zs})(t))throw t}}),(()=>{}),this._ownerWindow))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return ml}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),this.style.setProjection(g),this._update(!0)}},E.MapMouseEvent=ir,E.MapTouchEvent=Xa,E.MapWheelEvent=lh,E.Marker=bu,E.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),c=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,a)=>{const c=this._map._getUIString(`NavigationControl.${a}`);t.title=c,t.setAttribute("aria-label",c)},this.options=l.e({},fd,g),this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),ie.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),ie.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=ie.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ri(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ie.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,t){const a=ie.create("button",g,this._container);return a.type="button",a.addEventListener("click",t),a}},E.Popup=class extends l.E{constructor(g){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&ie.remove(this._content),this._container&&(ie.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ie.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ie.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=hc(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const a=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let c=this.options.anchor;const d=fc(this.options.offset);if(!c){const x=this._container.offsetWidth,C=this._container.offsetHeight,z=(function(k){var V,j,$,W;return k?{top:(V=k.top)!==null&&V!==void 0?V:0,right:(j=k.right)!==null&&j!==void 0?j:0,bottom:($=k.bottom)!==null&&$!==void 0?$:0,left:(W=k.left)!==null&&W!==void 0?W:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding);let L;L=a.y+d.bottom.y<C+z.top?["top"]:a.y>this._map.transform.height-C-z.bottom?["bottom"]:[],a.x<x/2+z.left?L.push("left"):a.x>this._map.transform.width-x/2-z.right&&L.push("right"),c=L.length===0?"bottom":L.join("-")}let y=a.add(d[c]);this.options.subpixelPositioning||(y=y.round()),ie.setTransform(this._container,`${dc[c]} translate(${y.x}px,${y.y}px)`),xu(this._container,c,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(gl),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=l.V.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const t=document.createDocumentFragment(),a=document.createElement("body");let c;for(a.innerHTML=g;c=a.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ie.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}setPadding(g){this.options.padding=g,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=ie.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(_l);g&&g.focus()}},E.RasterDEMTileSource=zr,E.RasterTileSource=va,E.ScaleControl=class{constructor(g){this._onMove=()=>{hi(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,hi(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},_r),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ie.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=gu,E.Style=bs,E.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ie.create("button","maplibregl-ctrl-terrain",this._container),ie.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ie.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=Ko,E.TwoFingersTouchRotateHandler=mu,E.TwoFingersTouchZoomHandler=Po,E.TwoFingersTouchZoomRotateHandler=fl,E.VectorTileSource=ea,E.VideoSource=xa,E.addSourceType=(g,t)=>l._(void 0,void 0,void 0,(function*(){if(fs(g))throw new Error(`A source type called "${g}" already exists.`);((a,c)=>{qa[a]=c})(g,t)})),E.clearPrewarmedResources=function(){const g=tn;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(At),tn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.createTileMesh=yf,E.getMaxParallelImageRequests=function(){return l.c.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return K().getRTLTextPluginStatus()},E.getVersion=function(){return Ja},E.getWorkerCount=function(){return Ut.workerCount},E.getWorkerUrl=function(){return l.c.WORKER_URL},E.importScriptInWorkers=function(g){return Fn().broadcast("IS",g)},E.isTimeFrozen=function(){return Ce.isFrozen()},E.now=xe,E.prewarm=function(){_n().acquire(At)},E.restoreNow=function(){Ce.restoreNow()},E.setMaxParallelImageRequests=function(g){l.c.MAX_PARALLEL_IMAGE_REQUESTS=g},E.setNow=function(g){Ce.setNow(g)},E.setRTLTextPlugin=function(g,t){return K().setRTLTextPlugin(g,t)},E.setWorkerCount=function(g){Ut.workerCount=g},E.setWorkerUrl=function(g){l.c.WORKER_URL=g}}));var I=T;return I}))})(I_)),I_.exports}var WC=YC();const KC=j_(WC),QC="https://demotiles.maplibre.org/globe.json",xx="rgb(28, 126, 214)",JC=({country:p,geoJson:b})=>{const T=ue.useRef(null),S=ue.useRef(null);ue.useEffect(()=>{if(S.current)return;S.current=new KC.Map({container:"map",style:QC,center:[0,0],zoom:1});const E=S.current;E.on("style.load",()=>{R(S.current,p),E.getStyle().layers?.forEach(N=>{N.type==="symbol"&&E.setLayoutProperty(N.id,"visibility","none")})})},[b]),ue.useEffect(()=>{if(!S.current)return;const E=S.current;E.isStyleLoaded()?R(E,p):E.once("style.load",()=>R(E,p))},[p]);function R(E,l){E.getLayer("country-outline")&&E.removeLayer("country-outline"),E.getSource("country-outline")&&E.removeSource("country-outline"),E.getLayer("country-fill")&&E.removeLayer("country-fill"),E.getSource("country-fill")&&E.removeSource("country-fill");const N=b?.features.find(ce=>ce.properties.NAME.toLowerCase()===l.toLowerCase());if(!N){console.warn(`Country "${l}" not found`);return}E.addSource("country-outline",{type:"geojson",data:N}),E.addLayer({id:"country-outline",type:"line",source:"country-outline",paint:{"line-color":xx,"line-width":5}}),E.addSource("country-fill",{type:"geojson",data:N}),E.addLayer({id:"country-fill",type:"fill",source:"country-fill",paint:{"fill-color":xx,"fill-opacity":.5}});const[X,Q,ee,le]=N.bbox?N.bbox:I(N);E.fitBounds([[X,Q],[ee,le]],{padding:40})}function I(E){const l=[];(ee=>{ee.type==="Polygon"?ee.coordinates.forEach(le=>le.forEach(ce=>l.push(ce))):ee.type==="MultiPolygon"&&ee.coordinates.forEach(le=>le.forEach(ce=>ce.forEach(Ce=>l.push(Ce))))})(E.geometry);const X=l.map(ee=>ee[0]),Q=l.map(ee=>ee[1]);return[Math.min(...X),Math.min(...Q),Math.max(...X),Math.max(...Q)]}return Te.jsx(un,{ref:T,id:"map",style:{height:`${window.innerHeight-_1}px`,width:"100%"}})},ug=34;function eM({ALL_COUNTRIES:p,onSubmit:b}){const[T,S]=ue.useState("");return Te.jsx(uf,{style:{zIndex:999},pos:"absolute",bottom:0,h:ug,justify:"center",align:"flex-end",w:"100%",my:l0,children:Te.jsxs(uf,{w:"100%",justify:"center",gap:"sm",children:[Te.jsx(n0,{styles:{dropdown:{zIndex:999,opacity:"80%"}},placeholder:"Enter country","aria-label":"Enter country",data:p,maxDropdownHeight:200,h:ug,rightSection:Te.jsx(m1,{height:ug/2,onClick:()=>S(""),cursor:"pointer"}),value:T,onChange:R=>S(R),onKeyDown:R=>{R.key==="Enter"&&p.includes(T)&&(b(T),S(""))}}),Te.jsx(qh,{variant:"filled","aria-label":"Submit",disabled:!p.includes(T),h:ug,w:ug,onClick:()=>{b(T),S("")},children:Te.jsx(kC,{style:{width:"70%",height:"70%"},stroke:1.5})})]})})}const bx=new URL("/borders/assets/countries-Cxl1xflq.geojson",import.meta.url).href,l0="md";function tM(){const[p,b]=ue.useState(null),[T,S]=ue.useState(),[R,I]=ue.useState([]),[E,l]=ue.useState(new Set),[N,X]=ue.useState(0),Q=ue.useMemo(()=>R.length-E.size,[R,E]),ee=ce=>{const Ce=Math.floor(Math.random()*ce.size),xe=[...ce][Ce];b(xe),E.delete(xe)};ue.useEffect(()=>{fetch(bx).then(ce=>{if(!ce.ok)throw new Error(ce.statusText);return ce.json()}).then(ce=>{S(ce);const Ce=ce.features.map(ie=>ie.properties?.NAME).sort();I(Ce);const xe=new Set([...Ce]);ee(xe),l(xe)}).catch(ce=>console.error("load error",ce))},[bx]);const le=ce=>{const Ce=ce===p;Ce&&X(N+1),df.show({position:"top-center",withCloseButton:!0,withBorder:!0,autoClose:5e3,title:Te.jsx("b",{children:Ce?"Correct!":"Incorrect!"}),message:Te.jsxs(Te.Fragment,{children:["The country was ",Te.jsx("b",{children:p}),"."]}),color:Ce?"green":"red",icon:Ce?Te.jsx(yx,{}):Te.jsx(m1,{}),className:"notification"}),ee(E),l(new Set([...E]))};return Te.jsxs(Te.Fragment,{children:[Te.jsx(hy,{pos:"absolute",right:0,m:l0,p:"xs",py:5,style:{zIndex:99},withBorder:!0,children:Te.jsxs(uf,{gap:"xs",align:"center",children:[Te.jsxs($v,{truncate:!0,lh:"sm",size:"lg",m:0,children:[N," / ",Q]}),Te.jsx(a0,{color:"green",radius:"lg",size:"xs","aria-label":"correct",children:Te.jsx(yx,{style:{width:"70%",height:"70%"}})})]})}),Te.jsx(ry,{w:"100%",children:p&&Te.jsx(JC,{country:p,geoJson:T})}),Te.jsx(eM,{ALL_COUNTRIES:R,onSubmit:le})]})}const nM="Borders",_1=50,Xy=1.5,Vp="80%",Yy="subtle";function iM(){return Te.jsx(un,{h:_1,style:{borderBottom:"1px solid light-dark(var(--mantine-color-gray-3), var(--mantine-color-dark-4))"},py:"xs",px:l0,children:Te.jsxs(uf,{justify:"space-between",align:"center",children:[Te.jsxs(o0,{size:"md",children:["",nM]}),Te.jsxs(uf,{gap:"xs",children:[Te.jsx(qh,{onClick:()=>{},variant:Yy,size:"md","aria-label":"Toggle color scheme",children:Te.jsx(NC,{stroke:Xy,style:{width:Vp,height:Vp}})}),Te.jsx(HC,{stroke:Xy,style:{width:Vp,height:Vp},variant:Yy}),Te.jsx(qh,{onClick:()=>{},variant:Yy,size:"md","aria-label":"Toggle color scheme",children:Te.jsx(GC,{stroke:Xy,style:{width:Vp,height:Vp}})})]})]})})}function rM(){return Te.jsxs(Te.Fragment,{children:[Te.jsx(iM,{}),Te.jsx(tM,{})]})}function aM(){return ue.useEffect(()=>{window.addEventListener("beforeinstallprompt",p=>{p.preventDefault(),console.log("PWA install prompt available")})},[]),Te.jsxs(Wx,{theme:uC,children:[Te.jsx(ju,{}),Te.jsx(rM,{})]})}U1.createRoot(document.getElementById("root")).render(Te.jsx(aM,{}));
